<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: diagnostic_federator_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">diagnostic_federator_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This diagnostics federator will take in data fields sent from a MONC, perform operators on these as required by the diagnostics definition to produce diagnostic instantaneous fields which are then sent along to anything interested in them.  
<a href="namespacediagnostic__federator__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__type.html">diagnostics_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a808b726c916d9dc52e2020eacbe2be0f"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a808b726c916d9dc52e2020eacbe2be0f">initialise_diagnostic_federator</a> (io_configuration)</td></tr>
<tr class="memdesc:a808b726c916d9dc52e2020eacbe2be0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the diagnostics action and sets up the diagnostics master definitions.  <a href="namespacediagnostic__federator__mod.html#a808b726c916d9dc52e2020eacbe2be0f">More...</a><br /></td></tr>
<tr class="separator:a808b726c916d9dc52e2020eacbe2be0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac193bf96ef5cbd37745e615516e8517c"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ac193bf96ef5cbd37745e615516e8517c">check_diagnostic_federator_for_completion</a> (io_configuration)</td></tr>
<tr class="memdesc:ac193bf96ef5cbd37745e615516e8517c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the diagnostics federator has completed or not, this is really checking all the underlying operations and communications to ensure that the data has been sent all the way through.  <a href="namespacediagnostic__federator__mod.html#ac193bf96ef5cbd37745e615516e8517c">More...</a><br /></td></tr>
<tr class="separator:ac193bf96ef5cbd37745e615516e8517c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b10b5d2cd3d99855d3abb64dd45e29"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ae2b10b5d2cd3d99855d3abb64dd45e29">finalise_diagnostic_federator</a> (io_configuration)</td></tr>
<tr class="memdesc:ae2b10b5d2cd3d99855d3abb64dd45e29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalises the diagnostics federator, waiting for all outstanding requests and then freeing data.  <a href="namespacediagnostic__federator__mod.html#ae2b10b5d2cd3d99855d3abb64dd45e29">More...</a><br /></td></tr>
<tr class="separator:ae2b10b5d2cd3d99855d3abb64dd45e29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b55ebfb6f9bf71a42f716fc9d6dad8c"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a5b55ebfb6f9bf71a42f716fc9d6dad8c">determine_diagnostics_fields_available</a> (monc_field_names)</td></tr>
<tr class="memdesc:a5b55ebfb6f9bf71a42f716fc9d6dad8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the diagnostics fields that are available based upon the input MONC fields on registration that will be sent from MONC to the IO server.  <a href="namespacediagnostic__federator__mod.html#a5b55ebfb6f9bf71a42f716fc9d6dad8c">More...</a><br /></td></tr>
<tr class="separator:a5b55ebfb6f9bf71a42f716fc9d6dad8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a471607fc4ee8c3a1ce66d31dc68e5522"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522">pass_fields_to_diagnostics_federator</a> (io_configuration, source, data_id, data_dump)</td></tr>
<tr class="memdesc:a471607fc4ee8c3a1ce66d31dc68e5522"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules based upon the input data.  <a href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522">More...</a><br /></td></tr>
<tr class="separator:a471607fc4ee8c3a1ce66d31dc68e5522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd05cf714b11815d87be556954d5d35"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35">check_all_activities_against_completed_fields</a> (io_configuration, timestep_entry, diagnostics_by_timestep)</td></tr>
<tr class="memdesc:adcd05cf714b11815d87be556954d5d35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks all pending activities against the completed fields and runs them if the required fields are now available.  <a href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35">More...</a><br /></td></tr>
<tr class="separator:adcd05cf714b11815d87be556954d5d35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02876dfa818535426c6d0be66696404"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ae02876dfa818535426c6d0be66696404">handle_operator_completion</a> (io_configuration, timestep_entry, specific_activity)</td></tr>
<tr class="memdesc:ae02876dfa818535426c6d0be66696404"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the completion of the operator.  <a href="namespacediagnostic__federator__mod.html#ae02876dfa818535426c6d0be66696404">More...</a><br /></td></tr>
<tr class="separator:ae02876dfa818535426c6d0be66696404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6be721f59f382ad66707a4021d3be1b5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5">handle_completion</a> (io_configuration, values, field_name, timestep)</td></tr>
<tr class="memdesc:a6be721f59f382ad66707a4021d3be1b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles inter io reduction completion, it adds the resulting value to the appropriate completion lists and then checks the pending activities and runs them if we can execute any of these based upon this value.  <a href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5">More...</a><br /></td></tr>
<tr class="separator:a6be721f59f382ad66707a4021d3be1b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01a2bc5cfd142c6bf40157c9a482aad8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8">handle_completion_for_specific_monc_timestep_entry</a> (io_configuration, result_to_add, field_name, timestep_entry, diagnostics_by_timestep)</td></tr>
<tr class="memdesc:a01a2bc5cfd142c6bf40157c9a482aad8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This handles inter IO completion for a specific timestep entry. This is required as at a timestep there can be multiple entires based on each MONC which communicates with the IO server so we handle an individual one here.  <a href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8">More...</a><br /></td></tr>
<tr class="separator:a01a2bc5cfd142c6bf40157c9a482aad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab25878578b48aaac7c3841a560b67497"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ab25878578b48aaac7c3841a560b67497">handle_diagnostic_calculation_completed</a> (io_configuration, diagnostic_index, timestep_entry, diagnostics_by_timestep)</td></tr>
<tr class="memdesc:ab25878578b48aaac7c3841a560b67497"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles completion of a diagnostic calculation and will then pass this onto interested parties.  <a href="namespacediagnostic__federator__mod.html#ab25878578b48aaac7c3841a560b67497">More...</a><br /></td></tr>
<tr class="separator:ab25878578b48aaac7c3841a560b67497"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dd07cccfe88be5418168241b19f2b10"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a6dd07cccfe88be5418168241b19f2b10">are_fields_available_for_activity</a> (timestep_entry, activity)</td></tr>
<tr class="memdesc:a6dd07cccfe88be5418168241b19f2b10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines whether the fields required for an activity are available so that activity can be run.  <a href="namespacediagnostic__federator__mod.html#a6dd07cccfe88be5418168241b19f2b10">More...</a><br /></td></tr>
<tr class="separator:a6dd07cccfe88be5418168241b19f2b10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137b3e2865e5dd85e2352afbf6c12de6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6">perform_inter_io_communication</a> (io_configuration, timestep_entry, all_entries_at_timestep, activity, value_to_send, communication_field_name)</td></tr>
<tr class="memdesc:a137b3e2865e5dd85e2352afbf6c12de6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the actual inter IO communication by calling out to the appropriate inter IO module.  <a href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6">More...</a><br /></td></tr>
<tr class="separator:a137b3e2865e5dd85e2352afbf6c12de6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac72eade80d986df91f8008af3873a22e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e">issue_communication_calls</a> (io_configuration, timestep_entry, diagnostics_by_timestep, source, data_id, data_dump)</td></tr>
<tr class="memdesc:ac72eade80d986df91f8008af3873a22e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC.  <a href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e">More...</a><br /></td></tr>
<tr class="separator:ac72eade80d986df91f8008af3873a22e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a57c70da8b58d633fdafedc4010719a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a3a57c70da8b58d633fdafedc4010719a">check_diagnostics_entries_against_data</a> (io_configuration, source, data_id, data_dump, timestep_diagnostics_entry)</td></tr>
<tr class="memdesc:a3a57c70da8b58d633fdafedc4010719a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks the outstanding fields of a time step entry against the data recieved from MONC and moves any acquired data from the outstanding set to the completed, along with its value.  <a href="namespacediagnostic__federator__mod.html#a3a57c70da8b58d633fdafedc4010719a">More...</a><br /></td></tr>
<tr class="separator:a3a57c70da8b58d633fdafedc4010719a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee7c2e6b24616cd79159ff8cdec96e0e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#aee7c2e6b24616cd79159ff8cdec96e0e">clean_diagnostic_states</a> (current_timestep)</td></tr>
<tr class="memdesc:aee7c2e6b24616cd79159ff8cdec96e0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleans the diagnostic states if required (based on the timestep period)  <a href="namespacediagnostic__federator__mod.html#aee7c2e6b24616cd79159ff8cdec96e0e">More...</a><br /></td></tr>
<tr class="separator:aee7c2e6b24616cd79159ff8cdec96e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae91e4630f78c985e6cf8a9815e313aee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ae91e4630f78c985e6cf8a9815e313aee">deallocate_diagnostics_at_timestep</a> (key)</td></tr>
<tr class="memdesc:ae91e4630f78c985e6cf8a9815e313aee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates all the diagnostics at a specific timestep, this removes all the individual MONC timestep entries and deallocates internal all diagnostic data, but keeps the all diagnostic entry in the list (which is removed by the caller)  <a href="namespacediagnostic__federator__mod.html#ae91e4630f78c985e6cf8a9815e313aee">More...</a><br /></td></tr>
<tr class="separator:ae91e4630f78c985e6cf8a9815e313aee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9ef4878802571ca765b6fd34b90607b"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structconfiguration__parser__mod_1_1data__values__type.html">data_values_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ab9ef4878802571ca765b6fd34b90607b">get_value_from_monc_data</a> (io_configuration, source, data_id, data_dump, field_name)</td></tr>
<tr class="memdesc:ab9ef4878802571ca765b6fd34b90607b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves a value from the communicated MONC data. If this was an integer then converts to a real.  <a href="namespacediagnostic__federator__mod.html#ab9ef4878802571ca765b6fd34b90607b">More...</a><br /></td></tr>
<tr class="separator:ab9ef4878802571ca765b6fd34b90607b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa264a6878f40365037fea7292ecd4f45"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#aa264a6878f40365037fea7292ecd4f45">get_datatype_of_field</a> (fields, field_name)</td></tr>
<tr class="memdesc:aa264a6878f40365037fea7292ecd4f45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the data type of a field or 0 if the field was not found.  <a href="namespacediagnostic__federator__mod.html#aa264a6878f40365037fea7292ecd4f45">More...</a><br /></td></tr>
<tr class="separator:aa264a6878f40365037fea7292ecd4f45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb86d57115a32c34cdfb03dacf573e05"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#afb86d57115a32c34cdfb03dacf573e05">find_or_register_timestep_entry</a> (io_configuration, timestep, source, time)</td></tr>
<tr class="memdesc:afb86d57115a32c34cdfb03dacf573e05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locates or registers a new (if it does not exist) time step entry based upon the timestep and source MONC process. This is a timestep/source specific state which represents progress through the overall diagnostic configuration.  <a href="namespacediagnostic__federator__mod.html#afb86d57115a32c34cdfb03dacf573e05">More...</a><br /></td></tr>
<tr class="separator:afb86d57115a32c34cdfb03dacf573e05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94a3c0584d150d32aaf9c066295cd400"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a94a3c0584d150d32aaf9c066295cd400">create_timestep_entry</a> (io_configuration, timestep, time, source)</td></tr>
<tr class="memdesc:a94a3c0584d150d32aaf9c066295cd400"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a timestep entry and processes all members, determining activities their required fields etc...  <a href="namespacediagnostic__federator__mod.html#a94a3c0584d150d32aaf9c066295cd400">More...</a><br /></td></tr>
<tr class="separator:a94a3c0584d150d32aaf9c066295cd400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f03b205c686950116708bc8ae39db4c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a2f03b205c686950116708bc8ae39db4c">add_required_fields_if_needed</a> (required_fields)</td></tr>
<tr class="memdesc:a2f03b205c686950116708bc8ae39db4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the required fields of an activity to the overall required fields which are cloned for each new timestep entry.  <a href="namespacediagnostic__federator__mod.html#a2f03b205c686950116708bc8ae39db4c">More...</a><br /></td></tr>
<tr class="separator:a2f03b205c686950116708bc8ae39db4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7951029c07b91b6398c93636f9442dfa"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa">retrieve_next_activity</a> (iterator)</td></tr>
<tr class="memdesc:a7951029c07b91b6398c93636f9442dfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the next activity in a collection being iterated over by an iterator.  <a href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa">More...</a><br /></td></tr>
<tr class="separator:a7951029c07b91b6398c93636f9442dfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bebd63c0c83c5f7428c276a22d2f9e2"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a7bebd63c0c83c5f7428c276a22d2f9e2">get_timestep_entry</a> (timestep, source, do_lock)</td></tr>
<tr class="memdesc:a7bebd63c0c83c5f7428c276a22d2f9e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the timestep at a specific timestep and source MONC.  <a href="namespacediagnostic__federator__mod.html#a7bebd63c0c83c5f7428c276a22d2f9e2">More...</a><br /></td></tr>
<tr class="separator:a7bebd63c0c83c5f7428c276a22d2f9e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a650167911efdc3cde6e7e22650dce8a3"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a650167911efdc3cde6e7e22650dce8a3">find_or_add_diagnostics_by_timestep</a> (timestep)</td></tr>
<tr class="memdesc:a650167911efdc3cde6e7e22650dce8a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds or adds diagnostics by timestep. This is used to maintain a list of all diagnostic entries for a specific timestep for every MONC source process.  <a href="namespacediagnostic__federator__mod.html#a650167911efdc3cde6e7e22650dce8a3">More...</a><br /></td></tr>
<tr class="separator:a650167911efdc3cde6e7e22650dce8a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cb374b99d120fa5f27485256d6349e0"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a9cb374b99d120fa5f27485256d6349e0">get_diagnostics_by_timestep</a> (timestep, do_lock)</td></tr>
<tr class="memdesc:a9cb374b99d120fa5f27485256d6349e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the diagnostics list (each MONC source) at a specific timestep.  <a href="namespacediagnostic__federator__mod.html#a9cb374b99d120fa5f27485256d6349e0">More...</a><br /></td></tr>
<tr class="separator:a9cb374b99d120fa5f27485256d6349e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a188fde5ea81a9d9b3e9ced68b058a"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a">retrieve_next_specific_monc_timestep_entry</a> (iterator)</td></tr>
<tr class="memdesc:ac9a188fde5ea81a9d9b3e9ced68b058a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator.  <a href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a">More...</a><br /></td></tr>
<tr class="separator:ac9a188fde5ea81a9d9b3e9ced68b058a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0356ed294110a413ed3ceb8349b23cb5"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a0356ed294110a413ed3ceb8349b23cb5">get_diagnostic_by_key</a> (key)</td></tr>
<tr class="memdesc:a0356ed294110a413ed3ceb8349b23cb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves all diagnostics at a timestep by its key.  <a href="namespacediagnostic__federator__mod.html#a0356ed294110a413ed3ceb8349b23cb5">More...</a><br /></td></tr>
<tr class="separator:a0356ed294110a413ed3ceb8349b23cb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b2a93ef33d3a40c357b408e116d3d75"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a7b2a93ef33d3a40c357b408e116d3d75">retrieve_diagnostics</a> (mapentry)</td></tr>
<tr class="memdesc:a7b2a93ef33d3a40c357b408e116d3d75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the all diagnostics at a specific timestep from its map entry.  <a href="namespacediagnostic__federator__mod.html#a7b2a93ef33d3a40c357b408e116d3d75">More...</a><br /></td></tr>
<tr class="separator:a7b2a93ef33d3a40c357b408e116d3d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4ce0078dbbff85dbe8799cfb6d7f839"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#aa4ce0078dbbff85dbe8799cfb6d7f839">get_comm_activity_from_fieldname</a> (diagnostics_by_timestep, field_name)</td></tr>
<tr class="memdesc:aa4ce0078dbbff85dbe8799cfb6d7f839"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves a communication activity from its field name.  <a href="namespacediagnostic__federator__mod.html#aa4ce0078dbbff85dbe8799cfb6d7f839">More...</a><br /></td></tr>
<tr class="separator:aa4ce0078dbbff85dbe8799cfb6d7f839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ff4a4217f56d3a3c1c19120a8b0d3f5"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__misc__item__type.html">io_configuration_misc_item_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a5ff4a4217f56d3a3c1c19120a8b0d3f5">get_misc_action_at_index</a> (action_members, index)</td></tr>
<tr class="memdesc:a5ff4a4217f56d3a3c1c19120a8b0d3f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves a misc action from the parsed user XML configuration at a specific index.  <a href="namespacediagnostic__federator__mod.html#a5ff4a4217f56d3a3c1c19120a8b0d3f5">More...</a><br /></td></tr>
<tr class="separator:a5ff4a4217f56d3a3c1c19120a8b0d3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfa8e7bd16249cdacd8c1c0bd904f2b2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#abfa8e7bd16249cdacd8c1c0bd904f2b2">define_diagnostics</a> (io_configuration, diagnostic_generation_frequency)</td></tr>
<tr class="memdesc:abfa8e7bd16249cdacd8c1c0bd904f2b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Based upon the IO configuration this will define the diagnostics structure. It is done once at initialisation and then this same information is used for execution at each data arrival point.  <a href="namespacediagnostic__federator__mod.html#abfa8e7bd16249cdacd8c1c0bd904f2b2">More...</a><br /></td></tr>
<tr class="separator:abfa8e7bd16249cdacd8c1c0bd904f2b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e8da478c02af7810229f55e7fbc1005"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a8e8da478c02af7810229f55e7fbc1005">get_diagnostic_activity_by_result_name</a> (result_name, diagnostic_entry_index)</td></tr>
<tr class="memdesc:a8e8da478c02af7810229f55e7fbc1005"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrives a diagnostic activity based upon its result name or null if none is found.  <a href="namespacediagnostic__federator__mod.html#a8e8da478c02af7810229f55e7fbc1005">More...</a><br /></td></tr>
<tr class="separator:a8e8da478c02af7810229f55e7fbc1005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1427333f9511d5199d60ad2c4c7077a7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a1427333f9511d5199d60ad2c4c7077a7">process_auto_dimensions</a> (io_configuration, diagnostic_configuration, entry_index)</td></tr>
<tr class="memdesc:a1427333f9511d5199d60ad2c4c7077a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes all auto dimensions by looking them up and resolving them based upon the operators.  <a href="namespacediagnostic__federator__mod.html#a1427333f9511d5199d60ad2c4c7077a7">More...</a><br /></td></tr>
<tr class="separator:a1427333f9511d5199d60ad2c4c7077a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd74ee4c4a330a69fb9c0bc0a993d9b4"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#acd74ee4c4a330a69fb9c0bc0a993d9b4">get_diagnostic_generation_frequency</a> (io_configuration, required_fields)</td></tr>
<tr class="memdesc:acd74ee4c4a330a69fb9c0bc0a993d9b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the max diagnostic generation frequency for a set of fields.  <a href="namespacediagnostic__federator__mod.html#acd74ee4c4a330a69fb9c0bc0a993d9b4">More...</a><br /></td></tr>
<tr class="separator:acd74ee4c4a330a69fb9c0bc0a993d9b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5c90a0a8585af8abd1e13f0b41beff3"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ad5c90a0a8585af8abd1e13f0b41beff3">get_field_frequency</a> (io_configuration, field_name)</td></tr>
<tr class="memdesc:ad5c90a0a8585af8abd1e13f0b41beff3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the generation frequency for a specific field.  <a href="namespacediagnostic__federator__mod.html#ad5c90a0a8585af8abd1e13f0b41beff3">More...</a><br /></td></tr>
<tr class="separator:ad5c90a0a8585af8abd1e13f0b41beff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10c82e5e43f4e3f306baf250bbda6df5"><td class="memItemLeft" align="right" valign="top">character(len=string_length) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a10c82e5e43f4e3f306baf250bbda6df5">generate_activity_diagnostic_key</a> (diagnostic, activity)</td></tr>
<tr class="memdesc:a10c82e5e43f4e3f306baf250bbda6df5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a unique key for an activity within a diagnostic, which is unique amongst all diagnostics and their activities.  <a href="namespacediagnostic__federator__mod.html#a10c82e5e43f4e3f306baf250bbda6df5">More...</a><br /></td></tr>
<tr class="separator:a10c82e5e43f4e3f306baf250bbda6df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a10b275651a9f8a09ec6343e001809c9e"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a10b275651a9f8a09ec6343e001809c9e">operator_type</a> =1</td></tr>
<tr class="separator:a10b275651a9f8a09ec6343e001809c9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfe5d8a45660b2de91943f45593ec7d1"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#acfe5d8a45660b2de91943f45593ec7d1">reduction_type</a> =2</td></tr>
<tr class="separator:acfe5d8a45660b2de91943f45593ec7d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65df719fafe4236caf1ccf82567ef06f"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a65df719fafe4236caf1ccf82567ef06f">broadcast_type</a> =3</td></tr>
<tr class="separator:a65df719fafe4236caf1ccf82567ef06f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa49a326e9b108c51d7f22579b542dcc4"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#aa49a326e9b108c51d7f22579b542dcc4">allreduction_type</a> =4</td></tr>
<tr class="separator:aa49a326e9b108c51d7f22579b542dcc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52624c33280dda0a0c35736ca473be88"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a52624c33280dda0a0c35736ca473be88">perform_clean_every</a> =100</td></tr>
<tr class="memdesc:a52624c33280dda0a0c35736ca473be88"><td class="mdescLeft">&#160;</td><td class="mdescRight">A wrapper type containing all the diagnostics for MONC source processes at a specific timestep.  <a href="namespacediagnostic__federator__mod.html#a52624c33280dda0a0c35736ca473be88">More...</a><br /></td></tr>
<tr class="separator:a52624c33280dda0a0c35736ca473be88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa41db3af8139e0cac6192b0c726a613f"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#aa41db3af8139e0cac6192b0c726a613f">diagnostics_per_monc_at_timestep</a></td></tr>
<tr class="separator:aa41db3af8139e0cac6192b0c726a613f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9c4690d1ed9ae834c7f8b6261b846af"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ab9c4690d1ed9ae834c7f8b6261b846af">all_diagnostics_at_timestep</a></td></tr>
<tr class="separator:ab9c4690d1ed9ae834c7f8b6261b846af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d10aab350c609819b4ecf6e040f46ff"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a8d10aab350c609819b4ecf6e040f46ff">all_outstanding_fields</a></td></tr>
<tr class="separator:a8d10aab350c609819b4ecf6e040f46ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e134fb2f4b0cf28ac72d2d46d80b70"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a23e134fb2f4b0cf28ac72d2d46d80b70">available_fields</a></td></tr>
<tr class="separator:a23e134fb2f4b0cf28ac72d2d46d80b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2873520be29ed70dd28e89d63eeb2ad8"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__type.html">diagnostics_type</a>), dimension(:), allocatable, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a2873520be29ed70dd28e89d63eeb2ad8">diagnostic_definitions</a></td></tr>
<tr class="separator:a2873520be29ed70dd28e89d63eeb2ad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3393a0dcc36de159558059efe9052f4"><td class="memItemLeft" align="right" valign="top">integer, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#ab3393a0dcc36de159558059efe9052f4">timestep_entries_rwlock</a></td></tr>
<tr class="separator:ab3393a0dcc36de159558059efe9052f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4377f39c9d9d42d83c2cf4fc8eaa124f"><td class="memItemLeft" align="right" valign="top">integer, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a4377f39c9d9d42d83c2cf4fc8eaa124f">all_diagnostics_per_timestep_rwlock</a></td></tr>
<tr class="separator:a4377f39c9d9d42d83c2cf4fc8eaa124f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92b850f32b130e6e8dcf0cc5a96250c5"><td class="memItemLeft" align="right" valign="top">integer, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a92b850f32b130e6e8dcf0cc5a96250c5">clean_progress_mutex</a></td></tr>
<tr class="separator:a92b850f32b130e6e8dcf0cc5a96250c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a318df4d25c73b2b566ac9bad22457eb1"><td class="memItemLeft" align="right" valign="top">integer, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a318df4d25c73b2b566ac9bad22457eb1">previous_clean_point</a></td></tr>
<tr class="separator:a318df4d25c73b2b566ac9bad22457eb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65551734894fd5efb77362fb73aa205d"><td class="memItemLeft" align="right" valign="top">integer, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a65551734894fd5efb77362fb73aa205d">previous_viewed_timestep</a></td></tr>
<tr class="separator:a65551734894fd5efb77362fb73aa205d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2089e85afe15846ece18e08eb314902f"><td class="memItemLeft" align="right" valign="top">integer, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacediagnostic__federator__mod.html#a2089e85afe15846ece18e08eb314902f">current_point</a></td></tr>
<tr class="separator:a2089e85afe15846ece18e08eb314902f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This diagnostics federator will take in data fields sent from a MONC, perform operators on these as required by the diagnostics definition to produce diagnostic instantaneous fields which are then sent along to anything interested in them. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a2f03b205c686950116708bc8ae39db4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f03b205c686950116708bc8ae39db4c">&#9670;&nbsp;</a></span>add_required_fields_if_needed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::add_required_fields_if_needed </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1list__type.html">list_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>required_fields</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds the required fields of an activity to the overall required fields which are cloned for each new timestep entry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">required_fields</td><td>The required fields of an activity </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00879">879</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordtype">type</span>(list_type), <span class="keywordtype">intent(inout)</span> :: required_fields</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">if</span> (.not. c_is_empty(required_fields)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      iterator=c_get_iterator(required_fields)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keyword">call </span>c_add_string(all_outstanding_fields, c_next_string(iterator))</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="keywordflow">      end do</span>     </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a2f03b205c686950116708bc8ae39db4c_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a2f03b205c686950116708bc8ae39db4c_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a2f03b205c686950116708bc8ae39db4c_icgraph" id="anamespacediagnostic__federator__mod_a2f03b205c686950116708bc8ae39db4c_icgraph">
<area shape="rect" title="Adds the required fields of an activity to the overall required fields which are cloned for each new ..." alt="" coords="680,5,851,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#abfa8e7bd16249cdacd8c1c0bd904f2b2" title="Based upon the IO configuration this will define the diagnostics structure. It is done once at initia..." alt="" coords="465,13,632,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a808b726c916d9dc52e2020eacbe2be0f" title="Initialises the diagnostics action and sets up the diagnostics master definitions." alt="" coords="244,5,417,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a6dd07cccfe88be5418168241b19f2b10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dd07cccfe88be5418168241b19f2b10">&#9670;&nbsp;</a></span>are_fields_available_for_activity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function diagnostic_federator_mod::are_fields_available_for_activity </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>timestep_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a>)&#160;</td>
          <td class="paramname"><em>activity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines whether the fields required for an activity are available so that activity can be run. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestep_entry</td><td>The timestep entry that we are checking the completed fields for </td></tr>
    <tr><td class="paramname">activity</td><td>The activity that we are checking </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the required fields for the activity are available </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00474">474</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: timestep_entry</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type) :: activity</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: field_name</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    are_fields_available_for_activity=.true.</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (.not. c_is_empty(activity%required_fields)) <span class="keywordflow">then</span>      </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      iterator=c_get_iterator(activity%required_fields)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        field_name=c_next_string(iterator)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">if</span> (.not. c_contains(timestep_entry%completed_fields, field_name)) <span class="keywordflow">then</span>          </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;          are_fields_available_for_activity=.false.</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;          <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keywordflow">      end do</span>      </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a6dd07cccfe88be5418168241b19f2b10_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a6dd07cccfe88be5418168241b19f2b10_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a6dd07cccfe88be5418168241b19f2b10_icgraph" id="anamespacediagnostic__federator__mod_a6dd07cccfe88be5418168241b19f2b10_icgraph">
<area shape="rect" title="Determines whether the fields required for an activity are available so that activity can be run." alt="" coords="2251,36,2424,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="2028,36,2203,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="1753,36,1980,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,72,1020,128"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1537,43,1705,84"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1336,36,1489,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1068,47,1288,88"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,79,819,120"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,72,620,128"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,79,395,120"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,86,196,113"/>
</map>
</div>

</div>
</div>
<a id="adcd05cf714b11815d87be556954d5d35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd05cf714b11815d87be556954d5d35">&#9670;&nbsp;</a></span>check_all_activities_against_completed_fields()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::check_all_activities_against_completed_fields </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>timestep_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diagnostics_by_timestep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks all pending activities against the completed fields and runs them if the required fields are now available. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">timestep_entry</td><td>The timestep entry that we are checking against </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00231">231</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: timestep_entry</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: diagnostics_by_timestep</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">integer</span> :: j, num_diags</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">pointer</span> :: activity</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: field_name, activity_diag_key</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">logical</span> :: updated_entry, entry_in_completed_diagnostics, operator_produced_values</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">type</span>(data_values_type) :: value_to_send</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: activities_iterator</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    updated_entry=.true.</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(timestep_entry%activity_completion_mutex))</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (updated_entry)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      updated_entry=.false.      </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      num_diags=<span class="keyword">size</span>(diagnostic_definitions)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">do</span> j=1, num_diags</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        entry_in_completed_diagnostics=c_contains(diagnostics_by_timestep%completed_diagnostics, &amp;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;             diagnostic_definitions(j)%diagnostic_name)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span> (diagnostic_definitions(j)%collective .or. .not. entry_in_completed_diagnostics) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          activities_iterator=c_get_iterator(diagnostic_definitions(j)%activities)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(activities_iterator))</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            activity=&gt;retrieve_next_activity(activities_iterator)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            activity_diag_key=generate_activity_diagnostic_key(diagnostic_definitions(j), activity)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">if</span> (.not. c_contains(timestep_entry%completed_activities, activity_diag_key)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;              <span class="keywordflow">if</span> (are_fields_available_for_activity(timestep_entry, activity)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keyword">call </span>c_add_string(timestep_entry%completed_activities, activity_diag_key)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                updated_entry=.true.              </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keywordflow">if</span> (activity%activity_type == operator_type) <span class="keywordflow">then</span>                        </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                  operator_produced_values=handle_operator_completion(io_configuration, timestep_entry, activity)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                  <span class="keywordflow">if</span> (operator_produced_values .and. activity%result_name == diagnostic_definitions(j)%diagnostic_name) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    <span class="keyword">call </span>handle_diagnostic_calculation_completed(io_configuration, j, timestep_entry, diagnostics_by_timestep)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keywordflow">                  end if</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (activity%activity_type == reduction_type .or. activity%activity_type == broadcast_type &amp;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                     .or. activity%activity_type == allreduction_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                  field_name=c_get_string(activity%required_fields, 1)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                  <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                  value_to_send=get_data_value_by_field_name(timestep_entry%completed_fields, field_name)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                  <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                  <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(timestep_entry%activity_completion_mutex))</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                  <span class="keyword">call </span>perform_inter_io_communication(io_configuration, timestep_entry, diagnostics_by_timestep, &amp;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                       activity, value_to_send, field_name)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                  <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(timestep_entry%activity_completion_mutex))</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordflow">      end do</span>  </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(timestep_entry%activity_completion_mutex))</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_adcd05cf714b11815d87be556954d5d35_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_adcd05cf714b11815d87be556954d5d35_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_adcd05cf714b11815d87be556954d5d35_cgraph" id="anamespacediagnostic__federator__mod_adcd05cf714b11815d87be556954d5d35_cgraph">
<area shape="rect" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="5,201,180,257"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6dd07cccfe88be5418168241b19f2b10" title="Determines whether the fields required for an activity are available so that activity can be run." alt="" coords="233,5,406,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a10c82e5e43f4e3f306baf250bbda6df5" title="Generates a unique key for an activity within a diagnostic, which is unique amongst all diagnostics a..." alt="" coords="240,85,399,141"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab25878578b48aaac7c3841a560b67497" title="Handles completion of a diagnostic calculation and will then pass this onto interested parties." alt="" coords="952,136,1116,192"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ae02876dfa818535426c6d0be66696404" title="Handles the completion of the operator." alt="" coords="243,347,395,403"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="243,267,396,323"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="228,426,411,467"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a" title="Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator." alt="" coords="1167,209,1352,265"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="459,281,627,322"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a9cb374b99d120fa5f27485256d6349e0" title="Retrieves the diagnostics list (each MONC source) at a specific timestep." alt="" coords="713,347,863,403"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="675,216,901,272"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aa4ce0078dbbff85dbe8799cfb6d7f839" title="Retrieves a communication activity from its field name." alt="" coords="949,216,1119,272"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_adcd05cf714b11815d87be556954d5d35_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_adcd05cf714b11815d87be556954d5d35_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_adcd05cf714b11815d87be556954d5d35_icgraph" id="anamespacediagnostic__federator__mod_adcd05cf714b11815d87be556954d5d35_icgraph">
<area shape="rect" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="2028,36,2203,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="1753,36,1980,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,72,1020,128"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1537,43,1705,84"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1336,36,1489,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1068,47,1288,88"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,79,819,120"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,72,620,128"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,79,395,120"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,86,196,113"/>
</map>
</div>

</div>
</div>
<a id="ac193bf96ef5cbd37745e615516e8517c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac193bf96ef5cbd37745e615516e8517c">&#9670;&nbsp;</a></span>check_diagnostic_federator_for_completion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public diagnostic_federator_mod::check_diagnostic_federator_for_completion </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether the diagnostics federator has completed or not, this is really checking all the underlying operations and communications to ensure that the data has been sent all the way through. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration state of the IO server </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the federator has completed </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00110">110</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    check_diagnostic_federator_for_completion=check_reduction_inter_io_for_completion(io_configuration)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (check_diagnostic_federator_for_completion) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      check_diagnostic_federator_for_completion=check_broadcast_inter_io_for_completion(io_configuration)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">if</span> (check_diagnostic_federator_for_completion) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        check_diagnostic_federator_for_completion=check_allreduction_inter_io_for_completion(io_configuration)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ac193bf96ef5cbd37745e615516e8517c_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ac193bf96ef5cbd37745e615516e8517c_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ac193bf96ef5cbd37745e615516e8517c_icgraph" id="anamespacediagnostic__federator__mod_ac193bf96ef5cbd37745e615516e8517c_icgraph">
<area shape="rect" title="Checks whether the diagnostics federator has completed or not, this is really checking all the underl..." alt="" coords="436,5,608,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ada1b8581f80d696dc8aa636405c73aea" title="Awaits a command or shutdown from MONC processes and other IO servers." alt="" coords="244,13,388,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a3a57c70da8b58d633fdafedc4010719a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a57c70da8b58d633fdafedc4010719a">&#9670;&nbsp;</a></span>check_diagnostics_entries_against_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::check_diagnostics_entries_against_data </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>data_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character, dimension(:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>data_dump</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>timestep_diagnostics_entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks the outstanding fields of a time step entry against the data recieved from MONC and moves any acquired data from the outstanding set to the completed, along with its value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration of the IO server <br  />
 </td></tr>
    <tr><td class="paramname">source</td><td>The source PID of the MONC process </td></tr>
    <tr><td class="paramname">data_id</td><td>The ID of the data definition that is represented by the dump </td></tr>
    <tr><td class="paramname">data_dump</td><td>The data we have received from MONC </td></tr>
    <tr><td class="paramname">timestep_diagnostics_entry</td><td>The timestep entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00596">596</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: source, data_id</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordtype">character</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(in)</span> :: data_dump</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: timestep_diagnostics_entry</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: field_name</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">pointer</span> :: field_value</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordtype">type</span>(hashset_type) :: removed_entries</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">if</span> (.not. c_is_empty(timestep_diagnostics_entry%outstanding_fields)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(timestep_diagnostics_entry%outstanding_fields_rwlock))</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      iterator=c_get_iterator(timestep_diagnostics_entry%outstanding_fields)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        field_name=c_next_string(iterator)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span> (is_field_present(io_configuration, source, data_id, field_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          field_value=&gt;get_value_from_monc_data(io_configuration, source, data_id, data_dump, field_name)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          generic=&gt;field_value</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(timestep_diagnostics_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <span class="keyword">call </span>c_put_generic(timestep_diagnostics_entry%completed_fields, trim(field_name), generic, .false.)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_diagnostics_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          <span class="keyword">call </span>c_add_string(removed_entries, field_name)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_diagnostics_entry%outstanding_fields_rwlock))</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">if</span> (.not. c_is_empty(removed_entries)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        iterator=c_get_iterator(removed_entries)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(timestep_diagnostics_entry%outstanding_fields_rwlock))</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          <span class="keyword">call </span>c_remove(timestep_diagnostics_entry%outstanding_fields, c_next_string(iterator))</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_diagnostics_entry%outstanding_fields_rwlock))</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keyword">call </span>c_free(removed_entries)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a3a57c70da8b58d633fdafedc4010719a_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a3a57c70da8b58d633fdafedc4010719a_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a3a57c70da8b58d633fdafedc4010719a_cgraph" id="anamespacediagnostic__federator__mod_a3a57c70da8b58d633fdafedc4010719a_cgraph">
<area shape="rect" title="Checks the outstanding fields of a time step entry against the data recieved from MONC and moves any ..." alt="" coords="5,5,173,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab9ef4878802571ca765b6fd34b90607b" title="Retrieves a value from the communicated MONC data. If this was an integer then converts to a real." alt="" coords="221,5,371,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aa264a6878f40365037fea7292ecd4f45" title="Retrieves the data type of a field or 0 if the field was not found." alt="" coords="419,13,601,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a3a57c70da8b58d633fdafedc4010719a_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a3a57c70da8b58d633fdafedc4010719a_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a3a57c70da8b58d633fdafedc4010719a_icgraph" id="anamespacediagnostic__federator__mod_a3a57c70da8b58d633fdafedc4010719a_icgraph">
<area shape="rect" title="Checks the outstanding fields of a time step entry against the data recieved from MONC and moves any ..." alt="" coords="1068,5,1236,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="aee7c2e6b24616cd79159ff8cdec96e0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee7c2e6b24616cd79159ff8cdec96e0e">&#9670;&nbsp;</a></span>clean_diagnostic_states()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::clean_diagnostic_states </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_timestep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cleans the diagnostic states if required (based on the timestep period) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_timestep</td><td>The current timestep which is checked against the previous run timestep </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00638">638</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: current_timestep</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordtype">integer</span> :: have_lock, outstanding_diags, outstanding_datas</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordtype">type</span>(list_type) :: entries_to_remove</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator, all_diagnostics_iterator</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordtype">type</span>(mapentry_type) :: all_diag_mapentry</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: specific_all_diagnostics_for_ts</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: specific_monc_timestep_entry</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordtype">logical</span> :: all_completed</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: entry_key</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    have_lock=forthread_mutex_trylock(clean_progress_mutex)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">if</span> (have_lock == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="keywordflow">if</span> (previous_viewed_timestep .ne. current_timestep) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        current_point=current_point+1</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        previous_viewed_timestep=current_timestep</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">if</span> (previous_clean_point + perform_clean_every .lt. current_point) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        previous_clean_point=current_point</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        all_diagnostics_iterator=c_get_iterator(all_diagnostics_at_timestep)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">do</span> <span class="keywordflow">while</span>(c_has_next(all_diagnostics_iterator))</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          all_diag_mapentry=c_next_mapentry(all_diagnostics_iterator)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          specific_all_diagnostics_for_ts=&gt;retrieve_diagnostics(all_diag_mapentry)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;          <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(specific_all_diagnostics_for_ts%completed_num_mutex))</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;          <span class="keywordflow">if</span> (specific_all_diagnostics_for_ts%completed_num == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            iterator=c_get_iterator(specific_all_diagnostics_for_ts%diagnostic_entries)</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            all_completed=.true.</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;              specific_monc_timestep_entry=&gt;retrieve_next_specific_monc_timestep_entry(iterator)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;              <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(specific_monc_timestep_entry%deletion_metric_mutex))</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;              outstanding_diags=specific_monc_timestep_entry%number_diags_outstanding</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;              outstanding_datas=specific_monc_timestep_entry%number_datas_outstanding</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;              <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(specific_monc_timestep_entry%deletion_metric_mutex))</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;              <span class="keywordflow">if</span> (outstanding_diags .gt. 0 .or. outstanding_datas .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                all_completed=.false.</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="keywordflow">if</span> (all_completed) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;              <span class="keyword">call </span>c_add_string(entries_to_remove, all_diag_mapentry%key)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(specific_all_diagnostics_for_ts%completed_num_mutex))</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">if</span> (.not. c_is_empty(entries_to_remove)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          iterator=c_get_iterator(entries_to_remove)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            entry_key=c_next_string(iterator)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keyword">call </span>deallocate_diagnostics_at_timestep(entry_key)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="keyword">call </span>c_remove(all_diagnostics_at_timestep, entry_key)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          <span class="keyword">call </span>c_free(entries_to_remove)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(clean_progress_mutex))</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_aee7c2e6b24616cd79159ff8cdec96e0e_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_aee7c2e6b24616cd79159ff8cdec96e0e_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_aee7c2e6b24616cd79159ff8cdec96e0e_cgraph" id="anamespacediagnostic__federator__mod_aee7c2e6b24616cd79159ff8cdec96e0e_cgraph">
<area shape="rect" title="Cleans the diagnostic states if required (based on the timestep period)" alt="" coords="5,85,163,141"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ae91e4630f78c985e6cf8a9815e313aee" title="Deallocates all the diagnostics at a specific timestep, this removes all the individual MONC timestep..." alt="" coords="211,20,403,76"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a" title="Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator." alt="" coords="451,85,636,141"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7b2a93ef33d3a40c357b408e116d3d75" title="Retrieves the all diagnostics at a specific timestep from its map entry." alt="" coords="219,151,395,193"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a0356ed294110a413ed3ceb8349b23cb5" title="Retrieves all diagnostics at a timestep by its key." alt="" coords="471,5,615,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_aee7c2e6b24616cd79159ff8cdec96e0e_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_aee7c2e6b24616cd79159ff8cdec96e0e_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_aee7c2e6b24616cd79159ff8cdec96e0e_icgraph" id="anamespacediagnostic__federator__mod_aee7c2e6b24616cd79159ff8cdec96e0e_icgraph">
<area shape="rect" title="Cleans the diagnostic states if required (based on the timestep period)" alt="" coords="1068,5,1225,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a94a3c0584d150d32aaf9c066295cd400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94a3c0584d150d32aaf9c066295cd400">&#9670;&nbsp;</a></span>create_timestep_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>) function, pointer diagnostic_federator_mod::create_timestep_entry </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a timestep entry and processes all members, determining activities their required fields etc... </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestep</td><td>The timestep that we are locating for </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The new timestep entry </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00837">837</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep, source</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span> :: time</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: create_timestep_entry</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordtype">integer</span> :: i, matched_datadefn_index</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keyword">allocate</span>(create_timestep_entry)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    create_timestep_entry%timestep=timestep</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    create_timestep_entry%time=time</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    create_timestep_entry%number_diags_outstanding=c_size(available_fields)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    create_timestep_entry%source=source</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    create_timestep_entry%source_location=get_monc_location(io_configuration, source)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    create_timestep_entry%number_datas_outstanding=0</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(io_configuration%registered_moncs(create_timestep_entry%source_location)%definition_names)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      matched_datadefn_index=retrieve_data_definition(io_configuration, &amp;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;           io_configuration%registered_moncs(create_timestep_entry%source_location)%definition_names(i))</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keywordflow">if</span> (matched_datadefn_index .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordflow">if</span> (io_configuration%data_definitions(matched_datadefn_index)%frequency .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;          <span class="keywordflow">if</span> (mod(timestep, io_configuration%data_definitions(matched_datadefn_index)%frequency) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            create_timestep_entry%number_datas_outstanding=create_timestep_entry%number_datas_outstanding+1</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#a10e28447dd10ef9f92d205bc98fb26d3">log_warn</a>, <span class="stringliteral">&quot;IO server can not find data definition with name &quot;</span>&amp;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;             //io_configuration%registered_moncs(create_timestep_entry%source_location)%definition_names(i))</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    iterator=c_get_iterator(all_outstanding_fields)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))      </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keyword">call </span>c_add_string(create_timestep_entry%outstanding_fields, c_next_string(iterator))</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_init(create_timestep_entry%activity_completion_mutex, -1))</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_init(create_timestep_entry%deletion_metric_mutex, -1))</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_init(create_timestep_entry%completed_fields_rwlock, -1))</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_init(create_timestep_entry%outstanding_fields_rwlock, -1))</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a94a3c0584d150d32aaf9c066295cd400_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a94a3c0584d150d32aaf9c066295cd400_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a94a3c0584d150d32aaf9c066295cd400_icgraph" id="anamespacediagnostic__federator__mod_a94a3c0584d150d32aaf9c066295cd400_icgraph">
<area shape="rect" title="Creates a timestep entry and processes all members, determining activities their required fields etc...." alt="" coords="1264,13,1452,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#afb86d57115a32c34cdfb03dacf573e05" title="Locates or registers a new (if it does not exist) time step entry based upon the timestep and source ..." alt="" coords="1068,5,1216,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="ae91e4630f78c985e6cf8a9815e313aee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae91e4630f78c985e6cf8a9815e313aee">&#9670;&nbsp;</a></span>deallocate_diagnostics_at_timestep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::deallocate_diagnostics_at_timestep </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deallocates all the diagnostics at a specific timestep, this removes all the individual MONC timestep entries and deallocates internal all diagnostic data, but keeps the all diagnostic entry in the list (which is removed by the caller) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The look up key which corresponds to the all diagnostics entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00705">705</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: key</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: all_diagnostics_at_ts</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: specific_monc_timestep_entry</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">pointer</span> :: field_data_value</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordtype">integer</span> :: cfentries, j</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator, completed_fields_iterator</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    all_diagnostics_at_ts=&gt;get_diagnostic_by_key(key)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(all_diagnostics_at_ts)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      iterator=c_get_iterator(all_diagnostics_at_ts%diagnostic_entries)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        specific_monc_timestep_entry=&gt;retrieve_next_specific_monc_timestep_entry(iterator)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_destroy(specific_monc_timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_destroy(specific_monc_timestep_entry%outstanding_fields_rwlock))</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_destroy(specific_monc_timestep_entry%activity_completion_mutex))</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_destroy(specific_monc_timestep_entry%deletion_metric_mutex))</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keyword">call </span>c_free(specific_monc_timestep_entry%outstanding_fields)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keyword">call </span>c_free(specific_monc_timestep_entry%completed_activities)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        completed_fields_iterator=c_get_iterator(specific_monc_timestep_entry%completed_fields)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(completed_fields_iterator))</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          field_data_value=&gt;get_data_value_from_map_entry(c_next_mapentry(completed_fields_iterator))</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(field_data_value%values)) <span class="keyword">deallocate</span>(field_data_value%values)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;          <span class="keyword">deallocate</span>(field_data_value)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordflow">        end do</span>                </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keyword">call </span>c_free(specific_monc_timestep_entry%completed_fields)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="keyword">call </span>c_free(all_diagnostics_at_ts%completed_diagnostics)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keyword">call </span>c_free(all_diagnostics_at_ts%communication_corresponding_activities)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      iterator=c_get_iterator(all_diagnostics_at_ts%diagnostic_entries)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        generic=&gt;c_next_generic(iterator)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">associated</span>(generic)) <span class="keyword">deallocate</span>(generic)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="keyword">call </span>c_free(all_diagnostics_at_ts%diagnostic_entries)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_destroy(all_diagnostics_at_ts%communication_corresponding_activities_rwlock))</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_destroy(all_diagnostics_at_ts%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_destroy(all_diagnostics_at_ts%completed_num_mutex))</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ae91e4630f78c985e6cf8a9815e313aee_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ae91e4630f78c985e6cf8a9815e313aee_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ae91e4630f78c985e6cf8a9815e313aee_cgraph" id="anamespacediagnostic__federator__mod_ae91e4630f78c985e6cf8a9815e313aee_cgraph">
<area shape="rect" title="Deallocates all the diagnostics at a specific timestep, this removes all the individual MONC timestep..." alt="" coords="5,45,197,101"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a0356ed294110a413ed3ceb8349b23cb5" title="Retrieves all diagnostics at a timestep by its key." alt="" coords="266,5,410,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a" title="Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator." alt="" coords="245,85,431,141"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ae91e4630f78c985e6cf8a9815e313aee_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ae91e4630f78c985e6cf8a9815e313aee_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ae91e4630f78c985e6cf8a9815e313aee_icgraph" id="anamespacediagnostic__federator__mod_ae91e4630f78c985e6cf8a9815e313aee_icgraph">
<area shape="rect" title="Deallocates all the diagnostics at a specific timestep, this removes all the individual MONC timestep..." alt="" coords="1273,5,1465,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aee7c2e6b24616cd79159ff8cdec96e0e" title="Cleans the diagnostic states if required (based on the timestep period)" alt="" coords="1068,5,1225,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="abfa8e7bd16249cdacd8c1c0bd904f2b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfa8e7bd16249cdacd8c1c0bd904f2b2">&#9670;&nbsp;</a></span>define_diagnostics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::define_diagnostics </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), intent(out)&#160;</td>
          <td class="paramname"><em>diagnostic_generation_frequency</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Based upon the IO configuration this will define the diagnostics structure. It is done once at initialisation and then this same information is used for execution at each data arrival point. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">diagnostic_generation_frequency</td><td>Map of diagnostic name to the frequency (in timesteps) of generation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l01103">1103</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordtype">type</span>(hashmap_type), <span class="keywordtype">intent(out)</span> :: diagnostic_generation_frequency</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="keywordtype">integer</span> :: i, j, entries, action_entities, activity_freq</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordtype">type</span>(io_configuration_misc_item_type), <span class="keywordtype">pointer</span> :: misc_action</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">pointer</span> :: item</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: activity_name</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    entries=io_configuration%number_of_diagnostics</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">if</span> (entries .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keyword">allocate</span>(diagnostic_definitions(entries))</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keywordflow">do</span> i=1, entries</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        diagnostic_definitions(i)%uuid=conv_to_string(i)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        diagnostic_definitions(i)%generation_timestep_frequency=0</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        diagnostic_definitions(i)%diagnostic_name=io_configuration%diagnostics(i)%name</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        diagnostic_definitions(i)%diagnostic_namespace=io_configuration%diagnostics(i)%namespace</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        diagnostic_definitions(i)%collective=io_configuration%diagnostics(i)%collective</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        action_entities=c_size(io_configuration%diagnostics(i)%members)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="keywordflow">if</span> (action_entities .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;          <span class="keywordflow">do</span> j=1, action_entities</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            misc_action=&gt;get_misc_action_at_index(io_configuration%diagnostics(i)%members, j)</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            <span class="keyword">allocate</span>(item)</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            item%uuid=conv_to_string(j)</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            item%result_name=c_get_string(misc_action%embellishments, <span class="stringliteral">&quot;result&quot;</span>)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            <span class="keywordflow">if</span> (c_contains(misc_action%embellishments, <span class="stringliteral">&quot;root&quot;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;              <span class="keywordflow">if</span> (get_action_attribute_string(misc_action%embellishments, <span class="stringliteral">&quot;root&quot;</span>) .eq. <span class="stringliteral">&quot;auto&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                item%root=mod(i, io_configuration%number_of_io_servers)</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                item%root=get_action_attribute_integer(misc_action%embellishments, <span class="stringliteral">&quot;root&quot;</span>)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;              item%root=-1</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            <span class="keywordflow">if</span> (misc_action%type .eq. <span class="stringliteral">&quot;operator&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;              activity_name=c_get_string(misc_action%embellishments, <span class="stringliteral">&quot;name&quot;</span>)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;              item%activity_name=activity_name</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;              item%required_fields=get_operator_required_fields(activity_name, misc_action%embellishments)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;              item%activity_attributes=misc_action%embellishments</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;              item%operator_procedure=&gt;get_operator_perform_procedure(activity_name)</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;              item%activity_type=operator_type          </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (misc_action%type .eq. <span class="stringliteral">&quot;communication&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;              <span class="keywordflow">if</span> (item%root .lt. 0) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Root must be supplied and 0 or greater for communication actions&quot;</span>)</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;              activity_name=c_get_string(misc_action%embellishments, <span class="stringliteral">&quot;name&quot;</span>)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;              <span class="keywordflow">if</span> (activity_name .eq. <span class="stringliteral">&quot;reduction&quot;</span> .or. activity_name .eq. <span class="stringliteral">&quot;allreduction&quot;</span>) <span class="keywordflow">then</span>            </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                <span class="keyword">call </span>c_add_string(item%required_fields, c_get_string(misc_action%embellishments, <span class="stringliteral">&quot;field&quot;</span>))</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                item%activity_type=merge(reduction_type, allreduction_type, activity_name .eq. <span class="stringliteral">&quot;reduction&quot;</span>)</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                item%communication_operator=get_reduction_operator(c_get_string(misc_action%embellishments, <span class="stringliteral">&quot;operator&quot;</span>))</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (activity_name .eq. <span class="stringliteral">&quot;broadcast&quot;</span>) <span class="keywordflow">then</span>            </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                <span class="keyword">call </span>c_add_string(item%required_fields, c_get_string(misc_action%embellishments, <span class="stringliteral">&quot;field&quot;</span>))</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                item%activity_type=broadcast_type</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="keyword">call </span>add_required_fields_if_needed(item%required_fields)</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            activity_freq=get_diagnostic_generation_frequency(io_configuration, item%required_fields)</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="keywordflow">if</span> (diagnostic_definitions(i)%generation_timestep_frequency .lt. activity_freq) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;              diagnostic_definitions(i)%generation_timestep_frequency=activity_freq</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            generic=&gt;item</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="keyword">call </span>c_add_generic(diagnostic_definitions(i)%activities, generic, .false.)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        <span class="keyword">call </span>c_put_integer(diagnostic_generation_frequency, diagnostic_definitions(i)%diagnostic_name, &amp;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;             diagnostic_definitions(i)%generation_timestep_frequency)</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="keyword">call </span>process_auto_dimensions(io_configuration, io_configuration%diagnostics(i), i)</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_abfa8e7bd16249cdacd8c1c0bd904f2b2_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_abfa8e7bd16249cdacd8c1c0bd904f2b2_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_abfa8e7bd16249cdacd8c1c0bd904f2b2_cgraph" id="anamespacediagnostic__federator__mod_abfa8e7bd16249cdacd8c1c0bd904f2b2_cgraph">
<area shape="rect" title="Based upon the IO configuration this will define the diagnostics structure. It is done once at initia..." alt="" coords="5,133,172,174"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a2f03b205c686950116708bc8ae39db4c" title="Adds the required fields of an activity to the overall required fields which are cloned for each new ..." alt="" coords="240,5,411,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#acd74ee4c4a330a69fb9c0bc0a993d9b4" title="Retrieves the max diagnostic generation frequency for a set of fields." alt="" coords="249,85,401,141"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a5ff4a4217f56d3a3c1c19120a8b0d3f5" title="Retrieves a misc action from the parsed user XML configuration at a specific index." alt="" coords="248,165,403,221"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a1427333f9511d5199d60ad2c4c7077a7" title="Processes all auto dimensions by looking them up and resolving them based upon the operators." alt="" coords="220,245,431,286"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ad5c90a0a8585af8abd1e13f0b41beff3" title="Retrieves the generation frequency for a specific field." alt="" coords="479,93,649,134"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a8e8da478c02af7810229f55e7fbc1005" title="Retrives a diagnostic activity based upon its result name or null if none is found." alt="" coords="480,237,648,293"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="697,245,880,286"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_abfa8e7bd16249cdacd8c1c0bd904f2b2_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_abfa8e7bd16249cdacd8c1c0bd904f2b2_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_abfa8e7bd16249cdacd8c1c0bd904f2b2_icgraph" id="anamespacediagnostic__federator__mod_abfa8e7bd16249cdacd8c1c0bd904f2b2_icgraph">
<area shape="rect" title="Based upon the IO configuration this will define the diagnostics structure. It is done once at initia..." alt="" coords="465,13,632,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a808b726c916d9dc52e2020eacbe2be0f" title="Initialises the diagnostics action and sets up the diagnostics master definitions." alt="" coords="244,5,417,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a5b55ebfb6f9bf71a42f716fc9d6dad8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b55ebfb6f9bf71a42f716fc9d6dad8c">&#9670;&nbsp;</a></span>determine_diagnostics_fields_available()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>) function, public diagnostic_federator_mod::determine_diagnostics_fields_available </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>monc_field_names</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the diagnostics fields that are available based upon the input MONC fields on registration that will be sent from MONC to the IO server. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">monc_field_names</td><td>Set of field names that are made available from MONC to the IO server </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The set of available diagnostics </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00141">141</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">type</span>(hashset_type), <span class="keywordtype">intent(inout)</span> :: monc_field_names</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">integer</span> :: i, k, num_fields, diag_root</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type) :: specific_activity</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">type</span>(hashset_type) :: result_names_for_activities</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: required_fields_iterator, activities_iterator</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: specific_field_name</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">logical</span> :: diagnostic_provided</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">allocated</span>(diagnostic_definitions)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(diagnostic_definitions)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      diag_root=-1</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      diagnostic_provided=.true.</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      activities_iterator=c_get_iterator(diagnostic_definitions(i)%activities)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(activities_iterator))</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        specific_activity=retrieve_next_activity(activities_iterator)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keyword">call </span>c_add_string(result_names_for_activities, specific_activity%result_name)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      activities_iterator=c_get_iterator(diagnostic_definitions(i)%activities)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(activities_iterator))</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        specific_activity=retrieve_next_activity(activities_iterator)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">if</span> (specific_activity%root .ne. -1 .and. diag_root == -1) diag_root=specific_activity%root</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        required_fields_iterator=c_get_iterator(specific_activity%required_fields)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(required_fields_iterator))</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          specific_field_name=c_next_string(required_fields_iterator)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          <span class="keywordflow">if</span> (.not. c_contains(result_names_for_activities, specific_field_name) .and. &amp;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;               .not. c_contains(monc_field_names, specific_field_name)) <span class="keywordflow">then</span>            </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            diagnostic_provided=.false.</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keywordflow">        end do</span>        </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span> (.not. diagnostic_provided) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">if</span> (diagnostic_provided) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keyword">call </span>c_put_integer(determine_diagnostics_fields_available, diagnostic_definitions(i)%diagnostic_name, diag_root)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keyword">call </span>c_add_string(available_fields, diagnostic_definitions(i)%diagnostic_name)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keyword">call </span>c_free(result_names_for_activities)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a5b55ebfb6f9bf71a42f716fc9d6dad8c_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a5b55ebfb6f9bf71a42f716fc9d6dad8c_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a5b55ebfb6f9bf71a42f716fc9d6dad8c_cgraph" id="anamespacediagnostic__federator__mod_a5b55ebfb6f9bf71a42f716fc9d6dad8c_cgraph">
<area shape="rect" title="Determines the diagnostics fields that are available based upon the input MONC fields on registration..." alt="" coords="5,5,196,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="244,13,427,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a5b55ebfb6f9bf71a42f716fc9d6dad8c_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a5b55ebfb6f9bf71a42f716fc9d6dad8c_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a5b55ebfb6f9bf71a42f716fc9d6dad8c_icgraph" id="anamespacediagnostic__federator__mod_a5b55ebfb6f9bf71a42f716fc9d6dad8c_icgraph">
<area shape="rect" title="Determines the diagnostics fields that are available based upon the input MONC fields on registration..." alt="" coords="1035,5,1225,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a75db617985efd39b9db284a0dc512d34" title="Registers with the writer federator the set of fields (prognostic and diagnostic) that are available,..." alt="" coords="820,5,987,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="641,13,772,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="443,13,593,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="ae2b10b5d2cd3d99855d3abb64dd45e29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2b10b5d2cd3d99855d3abb64dd45e29">&#9670;&nbsp;</a></span>finalise_diagnostic_federator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public diagnostic_federator_mod::finalise_diagnostic_federator </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalises the diagnostics federator, waiting for all outstanding requests and then freeing data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration state of the IO server </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00124">124</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keyword">call </span>finalise_broadcast_inter_io()</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">call </span>finalise_reduction_inter_io(io_configuration)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keyword">call </span>finalise_allreduction_inter_io(io_configuration)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">call </span>finalise_global_callback_inter_io(io_configuration)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_destroy(timestep_entries_rwlock))</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_destroy(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_destroy(clean_progress_mutex))</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">call </span>finalise_operators()   </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ae2b10b5d2cd3d99855d3abb64dd45e29_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ae2b10b5d2cd3d99855d3abb64dd45e29_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ae2b10b5d2cd3d99855d3abb64dd45e29_icgraph" id="anamespacediagnostic__federator__mod_ae2b10b5d2cd3d99855d3abb64dd45e29_icgraph">
<area shape="rect" title="Finalises the diagnostics federator, waiting for all outstanding requests and then freeing data." alt="" coords="244,5,411,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a650167911efdc3cde6e7e22650dce8a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a650167911efdc3cde6e7e22650dce8a3">&#9670;&nbsp;</a></span>find_or_add_diagnostics_by_timestep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>) function, pointer diagnostic_federator_mod::find_or_add_diagnostics_by_timestep </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds or adds diagnostics by timestep. This is used to maintain a list of all diagnostic entries for a specific timestep for every MONC source process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestep</td><td>The corresponding timestep </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The diagnostics at the timestep or a new diagnostics if none was found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00942">942</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: find_or_add_diagnostics_by_timestep</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    find_or_add_diagnostics_by_timestep=&gt;get_diagnostics_by_timestep(timestep, .true.)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(find_or_add_diagnostics_by_timestep)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      find_or_add_diagnostics_by_timestep=&gt;get_diagnostics_by_timestep(timestep, .false.)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(find_or_add_diagnostics_by_timestep)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keyword">allocate</span>(find_or_add_diagnostics_by_timestep)</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_init(&amp;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;             find_or_add_diagnostics_by_timestep%communication_corresponding_activities_rwlock, -1))</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_init(find_or_add_diagnostics_by_timestep%completed_diagnostics_rwlock, -1))</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_init(find_or_add_diagnostics_by_timestep%completed_num_mutex, -1))</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        find_or_add_diagnostics_by_timestep%completed_num=0</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        generic=&gt;find_or_add_diagnostics_by_timestep</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="keyword">call </span>c_put_generic(all_diagnostics_at_timestep, conv_to_string(timestep), generic, .false.)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a650167911efdc3cde6e7e22650dce8a3_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a650167911efdc3cde6e7e22650dce8a3_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a650167911efdc3cde6e7e22650dce8a3_cgraph" id="anamespacediagnostic__federator__mod_a650167911efdc3cde6e7e22650dce8a3_cgraph">
<area shape="rect" title="Finds or adds diagnostics by timestep. This is used to maintain a list of all diagnostic entries for ..." alt="" coords="5,5,204,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a9cb374b99d120fa5f27485256d6349e0" title="Retrieves the diagnostics list (each MONC source) at a specific timestep." alt="" coords="252,5,403,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a650167911efdc3cde6e7e22650dce8a3_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a650167911efdc3cde6e7e22650dce8a3_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a650167911efdc3cde6e7e22650dce8a3_icgraph" id="anamespacediagnostic__federator__mod_a650167911efdc3cde6e7e22650dce8a3_icgraph">
<area shape="rect" title="Finds or adds diagnostics by timestep. This is used to maintain a list of all diagnostic entries for ..." alt="" coords="1264,5,1463,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#afb86d57115a32c34cdfb03dacf573e05" title="Locates or registers a new (if it does not exist) time step entry based upon the timestep and source ..." alt="" coords="1068,5,1216,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="afb86d57115a32c34cdfb03dacf573e05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb86d57115a32c34cdfb03dacf573e05">&#9670;&nbsp;</a></span>find_or_register_timestep_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>) function, pointer diagnostic_federator_mod::find_or_register_timestep_entry </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Locates or registers a new (if it does not exist) time step entry based upon the timestep and source MONC process. This is a timestep/source specific state which represents progress through the overall diagnostic configuration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestep</td><td>The timestep that we are locating for </td></tr>
    <tr><td class="paramname">source</td><td>The source MONC process ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The specific timestep entry </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00807">807</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep, source</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span> :: time</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: find_or_register_timestep_entry</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: all_diags_by_timestep</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    find_or_register_timestep_entry=&gt;get_timestep_entry(timestep, source, .true.)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(find_or_register_timestep_entry)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(timestep_entries_rwlock))</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      find_or_register_timestep_entry=&gt;get_timestep_entry(timestep, source, .false.)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(find_or_register_timestep_entry)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        find_or_register_timestep_entry=&gt;create_timestep_entry(io_configuration, timestep, time, source)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        generic=&gt;find_or_register_timestep_entry</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keyword">call </span>c_put_generic(diagnostics_per_monc_at_timestep, conv_to_string(timestep)//<span class="stringliteral">&quot;#&quot;</span>//conv_to_string(source), &amp;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;             generic, .false.)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        all_diags_by_timestep=&gt;find_or_add_diagnostics_by_timestep(timestep)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keyword">call </span>c_add_generic(all_diags_by_timestep%diagnostic_entries, generic, .false.)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_entries_rwlock))</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_afb86d57115a32c34cdfb03dacf573e05_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_afb86d57115a32c34cdfb03dacf573e05_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_afb86d57115a32c34cdfb03dacf573e05_cgraph" id="anamespacediagnostic__federator__mod_afb86d57115a32c34cdfb03dacf573e05_cgraph">
<area shape="rect" title="Locates or registers a new (if it does not exist) time step entry based upon the timestep and source ..." alt="" coords="5,70,153,126"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a94a3c0584d150d32aaf9c066295cd400" title="Creates a timestep entry and processes all members, determining activities their required fields etc...." alt="" coords="207,5,395,47"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a650167911efdc3cde6e7e22650dce8a3" title="Finds or adds diagnostics by timestep. This is used to maintain a list of all diagnostic entries for ..." alt="" coords="201,70,400,126"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7bebd63c0c83c5f7428c276a22d2f9e2" title="Retrieves the timestep at a specific timestep and source MONC." alt="" coords="215,149,386,191"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a9cb374b99d120fa5f27485256d6349e0" title="Retrieves the diagnostics list (each MONC source) at a specific timestep." alt="" coords="448,70,599,126"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_afb86d57115a32c34cdfb03dacf573e05_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_afb86d57115a32c34cdfb03dacf573e05_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_afb86d57115a32c34cdfb03dacf573e05_icgraph" id="anamespacediagnostic__federator__mod_afb86d57115a32c34cdfb03dacf573e05_icgraph">
<area shape="rect" title="Locates or registers a new (if it does not exist) time step entry based upon the timestep and source ..." alt="" coords="1068,5,1216,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a10c82e5e43f4e3f306baf250bbda6df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10c82e5e43f4e3f306baf250bbda6df5">&#9670;&nbsp;</a></span>generate_activity_diagnostic_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=string_length) function diagnostic_federator_mod::generate_activity_diagnostic_key </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__type.html">diagnostics_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diagnostic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>activity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates a unique key for an activity within a diagnostic, which is unique amongst all diagnostics and their activities. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">diagnostic</td><td>The diagnostic part of the key </td></tr>
    <tr><td class="paramname">activity</td><td>The activity part of the key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A unique activity-diagnostic key </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l01274">1274</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordtype">type</span>(diagnostics_type), <span class="keywordtype">intent(in)</span> :: diagnostic</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">intent(in)</span> :: activity</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    generate_activity_diagnostic_key=trim(diagnostic%uuid)//<span class="stringliteral">&quot;#&quot;</span>//trim(activity%uuid)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a10c82e5e43f4e3f306baf250bbda6df5_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a10c82e5e43f4e3f306baf250bbda6df5_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a10c82e5e43f4e3f306baf250bbda6df5_icgraph" id="anamespacediagnostic__federator__mod_a10c82e5e43f4e3f306baf250bbda6df5_icgraph">
<area shape="rect" title="Generates a unique key for an activity within a diagnostic, which is unique amongst all diagnostics a..." alt="" coords="2251,43,2409,99"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="2028,75,2203,131"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1068,75,1288,117"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="1753,43,1980,99"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,127,1020,183"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1537,53,1705,94"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1336,68,1489,124"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,134,819,175"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,127,620,183"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,134,395,175"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,141,196,168"/>
</map>
</div>

</div>
</div>
<a id="aa4ce0078dbbff85dbe8799cfb6d7f839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4ce0078dbbff85dbe8799cfb6d7f839">&#9670;&nbsp;</a></span>get_comm_activity_from_fieldname()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a>) function, pointer diagnostic_federator_mod::get_comm_activity_from_fieldname </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diagnostics_by_timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves a communication activity from its field name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestep_entry</td><td>The timestep entry to base the look up upon </td></tr>
    <tr><td class="paramname">field_name</td><td>The field name to look up </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The activity or null if none is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l01057">1057</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: diagnostics_by_timestep</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">pointer</span> :: get_comm_activity_from_fieldname</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(diagnostics_by_timestep%communication_corresponding_activities_rwlock))</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    generic=&gt;c_get_generic(diagnostics_by_timestep%communication_corresponding_activities, field_name)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(diagnostics_by_timestep%communication_corresponding_activities_rwlock))</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(generic)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="keywordflow">        type is</span>(diagnostics_activity_type)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          get_comm_activity_from_fieldname=&gt;generic</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="keywordflow">      end select</span>      </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      get_comm_activity_from_fieldname=&gt;null()</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_aa4ce0078dbbff85dbe8799cfb6d7f839_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_aa4ce0078dbbff85dbe8799cfb6d7f839_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_aa4ce0078dbbff85dbe8799cfb6d7f839_icgraph" id="anamespacediagnostic__federator__mod_aa4ce0078dbbff85dbe8799cfb6d7f839_icgraph">
<area shape="rect" title="Retrieves a communication activity from its field name." alt="" coords="2028,41,2197,97"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="1753,41,1980,97"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1537,17,1705,58"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1336,5,1489,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="1091,71,1265,127"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1068,6,1288,47"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,35,1020,91"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,42,819,83"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,35,620,91"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,42,395,83"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,49,196,76"/>
</map>
</div>

</div>
</div>
<a id="aa264a6878f40365037fea7292ecd4f45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa264a6878f40365037fea7292ecd4f45">&#9670;&nbsp;</a></span>get_datatype_of_field()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function diagnostic_federator_mod::get_datatype_of_field </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__field__type.html">io_configuration_field_type</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the data type of a field or 0 if the field was not found. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fields</td><td>Array of fields to search </td></tr>
    <tr><td class="paramname">field_name</td><td>The name of the field to locate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The data type of this field or 0 if the field was not found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00787">787</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordtype">type</span>(io_configuration_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: fields</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(fields)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordflow">if</span> (fields(i)%name .eq. field_name) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        get_datatype_of_field=fields(i)%data_type</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    get_datatype_of_field=0</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_aa264a6878f40365037fea7292ecd4f45_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_aa264a6878f40365037fea7292ecd4f45_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_aa264a6878f40365037fea7292ecd4f45_icgraph" id="anamespacediagnostic__federator__mod_aa264a6878f40365037fea7292ecd4f45_icgraph">
<area shape="rect" title="Retrieves the data type of a field or 0 if the field was not found." alt="" coords="1533,49,1716,90"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab9ef4878802571ca765b6fd34b90607b" title="Retrieves a value from the communicated MONC data. If this was an integer then converts to a real." alt="" coords="1336,41,1485,97"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a3a57c70da8b58d633fdafedc4010719a" title="Checks the outstanding fields of a time step entry against the data recieved from MONC and moves any ..." alt="" coords="1094,5,1262,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1068,85,1288,126"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,41,1020,97"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,49,819,90"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,41,620,97"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,49,395,90"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,56,196,83"/>
</map>
</div>

</div>
</div>
<a id="a8e8da478c02af7810229f55e7fbc1005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e8da478c02af7810229f55e7fbc1005">&#9670;&nbsp;</a></span>get_diagnostic_activity_by_result_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a>) function, pointer diagnostic_federator_mod::get_diagnostic_activity_by_result_name </td>
          <td>(</td>
          <td class="paramtype">character(len=string_length), intent(inout)&#160;</td>
          <td class="paramname"><em>result_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>diagnostic_entry_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrives a diagnostic activity based upon its result name or null if none is found. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">result_name</td><td>The name of the result we are looking up </td></tr>
    <tr><td class="paramname">diagnostic_entry_index</td><td>The diagnostic index that we are concerned with </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The corresponding activity or null if none is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l01179">1179</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span>, <span class="keywordtype">intent(inout)</span> :: result_name</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: diagnostic_entry_index</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">pointer</span> :: get_diagnostic_activity_by_result_name</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    iterator=c_get_iterator(diagnostic_definitions(diagnostic_entry_index)%activities)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      get_diagnostic_activity_by_result_name=&gt;retrieve_next_activity(iterator)</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="keywordflow">if</span> (get_diagnostic_activity_by_result_name%result_name == result_name) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    get_diagnostic_activity_by_result_name=&gt;null()</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a8e8da478c02af7810229f55e7fbc1005_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a8e8da478c02af7810229f55e7fbc1005_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a8e8da478c02af7810229f55e7fbc1005_cgraph" id="anamespacediagnostic__federator__mod_a8e8da478c02af7810229f55e7fbc1005_cgraph">
<area shape="rect" title="Retrives a diagnostic activity based upon its result name or null if none is found." alt="" coords="5,5,173,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="221,13,404,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a8e8da478c02af7810229f55e7fbc1005_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a8e8da478c02af7810229f55e7fbc1005_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a8e8da478c02af7810229f55e7fbc1005_icgraph" id="anamespacediagnostic__federator__mod_a8e8da478c02af7810229f55e7fbc1005_icgraph">
<area shape="rect" title="Retrives a diagnostic activity based upon its result name or null if none is found." alt="" coords="939,5,1107,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a1427333f9511d5199d60ad2c4c7077a7" title="Processes all auto dimensions by looking them up and resolving them based upon the operators." alt="" coords="680,13,891,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#abfa8e7bd16249cdacd8c1c0bd904f2b2" title="Based upon the IO configuration this will define the diagnostics structure. It is done once at initia..." alt="" coords="465,13,632,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a808b726c916d9dc52e2020eacbe2be0f" title="Initialises the diagnostics action and sets up the diagnostics master definitions." alt="" coords="244,5,417,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a0356ed294110a413ed3ceb8349b23cb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0356ed294110a413ed3ceb8349b23cb5">&#9670;&nbsp;</a></span>get_diagnostic_by_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>) function, pointer diagnostic_federator_mod::get_diagnostic_by_key </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves all diagnostics at a timestep by its key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The key to look up </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The corresponding all diagnostics at this timestep or null if none is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l01014">1014</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: key</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: get_diagnostic_by_key</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    generic=&gt;c_get_generic(all_diagnostics_at_timestep, key)    </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(generic)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="keywordflow">      type is</span>(all_diagnostics_at_timestep_type)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        get_diagnostic_by_key=&gt;generic</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      get_diagnostic_by_key=&gt;null()</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a0356ed294110a413ed3ceb8349b23cb5_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a0356ed294110a413ed3ceb8349b23cb5_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a0356ed294110a413ed3ceb8349b23cb5_icgraph" id="anamespacediagnostic__federator__mod_a0356ed294110a413ed3ceb8349b23cb5_icgraph">
<area shape="rect" title="Retrieves all diagnostics at a timestep by its key." alt="" coords="1513,5,1657,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ae91e4630f78c985e6cf8a9815e313aee" title="Deallocates all the diagnostics at a specific timestep, this removes all the individual MONC timestep..." alt="" coords="1273,5,1465,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aee7c2e6b24616cd79159ff8cdec96e0e" title="Cleans the diagnostic states if required (based on the timestep period)" alt="" coords="1068,5,1225,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="acd74ee4c4a330a69fb9c0bc0a993d9b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd74ee4c4a330a69fb9c0bc0a993d9b4">&#9670;&nbsp;</a></span>get_diagnostic_generation_frequency()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function diagnostic_federator_mod::get_diagnostic_generation_frequency </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1list__type.html">list_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>required_fields</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the max diagnostic generation frequency for a set of fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">required_fields</td><td>List of required fields that we are looking up </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The max generation frequency </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l01235">1235</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordtype">type</span>(list_type), <span class="keywordtype">intent(inout)</span> :: required_fields</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordtype">integer</span> :: field_freq</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    get_diagnostic_generation_frequency=0</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    iterator=c_get_iterator(required_fields)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      field_freq=get_field_frequency(io_configuration, c_next_string(iterator))</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="keywordflow">if</span> (get_diagnostic_generation_frequency .lt. field_freq) get_diagnostic_generation_frequency=field_freq</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_acd74ee4c4a330a69fb9c0bc0a993d9b4_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_acd74ee4c4a330a69fb9c0bc0a993d9b4_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_acd74ee4c4a330a69fb9c0bc0a993d9b4_cgraph" id="anamespacediagnostic__federator__mod_acd74ee4c4a330a69fb9c0bc0a993d9b4_cgraph">
<area shape="rect" title="Retrieves the max diagnostic generation frequency for a set of fields." alt="" coords="5,5,157,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ad5c90a0a8585af8abd1e13f0b41beff3" title="Retrieves the generation frequency for a specific field." alt="" coords="205,13,376,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_acd74ee4c4a330a69fb9c0bc0a993d9b4_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_acd74ee4c4a330a69fb9c0bc0a993d9b4_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_acd74ee4c4a330a69fb9c0bc0a993d9b4_icgraph" id="anamespacediagnostic__federator__mod_acd74ee4c4a330a69fb9c0bc0a993d9b4_icgraph">
<area shape="rect" title="Retrieves the max diagnostic generation frequency for a set of fields." alt="" coords="680,5,832,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#abfa8e7bd16249cdacd8c1c0bd904f2b2" title="Based upon the IO configuration this will define the diagnostics structure. It is done once at initia..." alt="" coords="465,13,632,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a808b726c916d9dc52e2020eacbe2be0f" title="Initialises the diagnostics action and sets up the diagnostics master definitions." alt="" coords="244,5,417,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a9cb374b99d120fa5f27485256d6349e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cb374b99d120fa5f27485256d6349e0">&#9670;&nbsp;</a></span>get_diagnostics_by_timestep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>) function, pointer diagnostic_federator_mod::get_diagnostics_by_timestep </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>do_lock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the diagnostics list (each MONC source) at a specific timestep. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestep</td><td>The timestep to look up </td></tr>
    <tr><td class="paramname">do_lock</td><td>Whether to issue read locks </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The diagnostics container at this timestep or null if none is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00970">970</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: do_lock</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: get_diagnostics_by_timestep</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">if</span> (do_lock) <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    generic=&gt;c_get_generic(all_diagnostics_at_timestep, conv_to_string(timestep))</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">if</span> (do_lock) <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(all_diagnostics_per_timestep_rwlock))</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(generic)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="keywordflow">      type is</span>(all_diagnostics_at_timestep_type)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        get_diagnostics_by_timestep=&gt;generic</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      get_diagnostics_by_timestep=&gt;null()</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a9cb374b99d120fa5f27485256d6349e0_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a9cb374b99d120fa5f27485256d6349e0_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a9cb374b99d120fa5f27485256d6349e0_icgraph" id="anamespacediagnostic__federator__mod_a9cb374b99d120fa5f27485256d6349e0_icgraph">
<area shape="rect" title="Retrieves the diagnostics list (each MONC source) at a specific timestep." alt="" coords="1857,71,2008,127"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a650167911efdc3cde6e7e22650dce8a3" title="Finds or adds diagnostics by timestep. This is used to maintain a list of all diagnostic entries for ..." alt="" coords="1611,5,1809,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="903,112,1057,168"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1626,175,1794,217"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#afb86d57115a32c34cdfb03dacf573e05" title="Locates or registers a new (if it does not exist) time step entry based upon the timestep and source ..." alt="" coords="1412,5,1560,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,119,819,161"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,112,620,168"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,119,395,161"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,127,196,153"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1409,168,1563,224"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="1164,201,1339,257"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1141,137,1361,178"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="867,220,1093,276"/>
</map>
</div>

</div>
</div>
<a id="ad5c90a0a8585af8abd1e13f0b41beff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5c90a0a8585af8abd1e13f0b41beff3">&#9670;&nbsp;</a></span>get_field_frequency()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function diagnostic_federator_mod::get_field_frequency </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the generation frequency for a specific field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>IO server configuration </td></tr>
    <tr><td class="paramname">field_name</td><td>The name of the field we are looking up </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The generation frequency for this specific field </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l01254">1254</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordtype">integer</span> :: i, j</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">do</span> i=1, io_configuration%number_of_data_definitions</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="keywordflow">do</span> j=1, io_configuration%data_definitions(i)%number_of_data_fields</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="keywordflow">if</span> (io_configuration%data_definitions(i)%fields(j)%name == field_name) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;          get_field_frequency=io_configuration%data_definitions(i)%frequency</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;          <span class="keywordflow">return</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    get_field_frequency=0</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ad5c90a0a8585af8abd1e13f0b41beff3_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ad5c90a0a8585af8abd1e13f0b41beff3_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ad5c90a0a8585af8abd1e13f0b41beff3_icgraph" id="anamespacediagnostic__federator__mod_ad5c90a0a8585af8abd1e13f0b41beff3_icgraph">
<area shape="rect" title="Retrieves the generation frequency for a specific field." alt="" coords="880,13,1051,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#acd74ee4c4a330a69fb9c0bc0a993d9b4" title="Retrieves the max diagnostic generation frequency for a set of fields." alt="" coords="680,5,832,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#abfa8e7bd16249cdacd8c1c0bd904f2b2" title="Based upon the IO configuration this will define the diagnostics structure. It is done once at initia..." alt="" coords="465,13,632,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a808b726c916d9dc52e2020eacbe2be0f" title="Initialises the diagnostics action and sets up the diagnostics master definitions." alt="" coords="244,5,417,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a5ff4a4217f56d3a3c1c19120a8b0d3f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ff4a4217f56d3a3c1c19120a8b0d3f5">&#9670;&nbsp;</a></span>get_misc_action_at_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__misc__item__type.html">io_configuration_misc_item_type</a>) function, pointer diagnostic_federator_mod::get_misc_action_at_index </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1list__type.html">list_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>action_members</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves a misc action from the parsed user XML configuration at a specific index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action_members</td><td>The members to extract from </td></tr>
    <tr><td class="paramname">index</td><td>The index to look up </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The misc item at this index or null if none is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l01081">1081</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordtype">type</span>(list_type), <span class="keywordtype">intent(inout)</span> :: action_members</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: index</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordtype">type</span>(io_configuration_misc_item_type), <span class="keywordtype">pointer</span> :: get_misc_action_at_index</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    generic=&gt;c_get_generic(action_members, index)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(generic)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="keywordflow">      type is</span>(io_configuration_misc_item_type)</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        get_misc_action_at_index=&gt;generic</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      get_misc_action_at_index=&gt;null()</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a5ff4a4217f56d3a3c1c19120a8b0d3f5_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a5ff4a4217f56d3a3c1c19120a8b0d3f5_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a5ff4a4217f56d3a3c1c19120a8b0d3f5_icgraph" id="anamespacediagnostic__federator__mod_a5ff4a4217f56d3a3c1c19120a8b0d3f5_icgraph">
<area shape="rect" title="Retrieves a misc action from the parsed user XML configuration at a specific index." alt="" coords="680,5,835,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#abfa8e7bd16249cdacd8c1c0bd904f2b2" title="Based upon the IO configuration this will define the diagnostics structure. It is done once at initia..." alt="" coords="465,13,632,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a808b726c916d9dc52e2020eacbe2be0f" title="Initialises the diagnostics action and sets up the diagnostics master definitions." alt="" coords="244,5,417,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a7bebd63c0c83c5f7428c276a22d2f9e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bebd63c0c83c5f7428c276a22d2f9e2">&#9670;&nbsp;</a></span>get_timestep_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>) function, pointer diagnostic_federator_mod::get_timestep_entry </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>do_lock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the timestep at a specific timestep and source MONC. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestep</td><td>The timestep to look up </td></tr>
    <tr><td class="paramname">source</td><td>The source MONC process id </td></tr>
    <tr><td class="paramname">do_lock</td><td>Whether to issue a read lock over the timeseries collection </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The timestep entry or null if none is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00918">918</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep, source</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: do_lock</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: get_timestep_entry</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">if</span> (do_lock) <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(timestep_entries_rwlock))</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    generic=&gt;c_get_generic(diagnostics_per_monc_at_timestep, conv_to_string(timestep)//<span class="stringliteral">&quot;#&quot;</span>//conv_to_string(source))</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">if</span> (do_lock) <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_entries_rwlock))</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(generic)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="keywordflow">        type is</span>(diagnostics_at_timestep_type)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;          get_timestep_entry=&gt;generic</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="keywordflow">      end select</span>      </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      get_timestep_entry=&gt;null()</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a7bebd63c0c83c5f7428c276a22d2f9e2_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a7bebd63c0c83c5f7428c276a22d2f9e2_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a7bebd63c0c83c5f7428c276a22d2f9e2_icgraph" id="anamespacediagnostic__federator__mod_a7bebd63c0c83c5f7428c276a22d2f9e2_icgraph">
<area shape="rect" title="Retrieves the timestep at a specific timestep and source MONC." alt="" coords="1264,13,1435,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#afb86d57115a32c34cdfb03dacf573e05" title="Locates or registers a new (if it does not exist) time step entry based upon the timestep and source ..." alt="" coords="1068,5,1216,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="ab9ef4878802571ca765b6fd34b90607b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9ef4878802571ca765b6fd34b90607b">&#9670;&nbsp;</a></span>get_value_from_monc_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structconfiguration__parser__mod_1_1data__values__type.html">data_values_type</a>) function, pointer diagnostic_federator_mod::get_value_from_monc_data </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>data_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character, dimension(:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>data_dump</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves a value from the communicated MONC data. If this was an integer then converts to a real. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration of the IO server <br  />
 </td></tr>
    <tr><td class="paramname">source</td><td>The source PID of the MONC process </td></tr>
    <tr><td class="paramname">data_id</td><td>The ID of the data definition that is represented by the dump </td></tr>
    <tr><td class="paramname">data_dump</td><td>The data we have received from MONC </td></tr>
    <tr><td class="paramname">field_name</td><td>The field to retrieve </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Data value wrapper containing the values and meta-data </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00755">755</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: source, data_id</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordtype">character</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(in)</span> :: data_dump</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">pointer</span> :: get_value_from_monc_data</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordtype">integer</span> :: field_data_type, i</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: int_values</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keyword">allocate</span>(get_value_from_monc_data)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    field_data_type=get_datatype_of_field(io_configuration%data_definitions(data_id)%fields, field_name)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">if</span> (field_data_type == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;No data type for field &#39;&quot;</span>//trim(field_name)//<span class="stringliteral">&quot;&#39;&quot;</span>)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    get_value_from_monc_data%dimensions=get_number_field_dimensions(io_configuration, field_name, source, data_id)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">if</span> (field_data_type == double_data_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      get_value_from_monc_data%values=get_array_double_from_monc(io_configuration, source, data_id, data_dump, field_name)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (field_data_type == integer_data_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      int_values=get_array_integer_from_monc(io_configuration, source, data_id, data_dump, field_name)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keyword">allocate</span>(get_value_from_monc_data%values(<span class="keyword">size</span>(int_values)))</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(int_values)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        get_value_from_monc_data%values(i)=conv_to_real(int_values(i))</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keyword">deallocate</span>(int_values)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ab9ef4878802571ca765b6fd34b90607b_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ab9ef4878802571ca765b6fd34b90607b_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ab9ef4878802571ca765b6fd34b90607b_cgraph" id="anamespacediagnostic__federator__mod_ab9ef4878802571ca765b6fd34b90607b_cgraph">
<area shape="rect" title="Retrieves a value from the communicated MONC data. If this was an integer then converts to a real." alt="" coords="5,5,155,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aa264a6878f40365037fea7292ecd4f45" title="Retrieves the data type of a field or 0 if the field was not found." alt="" coords="203,13,385,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ab9ef4878802571ca765b6fd34b90607b_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ab9ef4878802571ca765b6fd34b90607b_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ab9ef4878802571ca765b6fd34b90607b_icgraph" id="anamespacediagnostic__federator__mod_ab9ef4878802571ca765b6fd34b90607b_icgraph">
<area shape="rect" title="Retrieves a value from the communicated MONC data. If this was an integer then converts to a real." alt="" coords="1336,41,1485,97"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a3a57c70da8b58d633fdafedc4010719a" title="Checks the outstanding fields of a time step entry against the data recieved from MONC and moves any ..." alt="" coords="1094,5,1262,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1068,85,1288,126"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,41,1020,97"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,49,819,90"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,41,620,97"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,49,395,90"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,56,196,83"/>
</map>
</div>

</div>
</div>
<a id="a6be721f59f382ad66707a4021d3be1b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6be721f59f382ad66707a4021d3be1b5">&#9670;&nbsp;</a></span>handle_completion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::handle_completion </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(default_precision), dimension(:)&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=string_length)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>timestep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles inter io reduction completion, it adds the resulting value to the appropriate completion lists and then checks the pending activities and runs them if we can execute any of these based upon this value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration of the IO server </td></tr>
    <tr><td class="paramname">values</td><td>Array of values resulting from the communication </td></tr>
    <tr><td class="paramname">field_name</td><td>Corresponding field name </td></tr>
    <tr><td class="paramname">timestep</td><td>Corresponding timestep </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00329">329</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordtype">    real</span>(DEFAULT_PRECISION), <span class="keywordtype">dimension(:)</span> :: values</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: field_name</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordtype">integer</span> :: timestep</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: diagnostics_by_timestep</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">pointer</span> :: result_to_add</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    diagnostics_by_timestep=&gt;get_diagnostics_by_timestep(timestep, .true.)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(diagnostics_by_timestep%completed_num_mutex))</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    diagnostics_by_timestep%completed_num=diagnostics_by_timestep%completed_num+1</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(diagnostics_by_timestep%completed_num_mutex))</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">if</span> (.not. c_is_empty(diagnostics_by_timestep%diagnostic_entries)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      iterator=c_get_iterator(diagnostics_by_timestep%diagnostic_entries)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keyword">allocate</span>(result_to_add)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keyword">allocate</span>(result_to_add%values(<span class="keyword">size</span>(values)), source=values)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keyword">call </span>handle_completion_for_specific_monc_timestep_entry(io_configuration, result_to_add, &amp;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;             field_name, retrieve_next_specific_monc_timestep_entry(iterator), diagnostics_by_timestep)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(diagnostics_by_timestep%communication_corresponding_activities_rwlock))</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">call </span>c_remove(diagnostics_by_timestep%communication_corresponding_activities, trim(field_name))</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(diagnostics_by_timestep%communication_corresponding_activities_rwlock))</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(diagnostics_by_timestep%completed_num_mutex))</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    diagnostics_by_timestep%completed_num=diagnostics_by_timestep%completed_num-1</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(diagnostics_by_timestep%completed_num_mutex))</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a6be721f59f382ad66707a4021d3be1b5_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a6be721f59f382ad66707a4021d3be1b5_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a6be721f59f382ad66707a4021d3be1b5_cgraph" id="anamespacediagnostic__federator__mod_a6be721f59f382ad66707a4021d3be1b5_cgraph">
<area shape="rect" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="5,111,173,153"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a9cb374b99d120fa5f27485256d6349e0" title="Retrieves the diagnostics list (each MONC source) at a specific timestep." alt="" coords="259,5,410,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="221,169,448,225"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a" title="Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator." alt="" coords="949,104,1135,160"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="496,288,671,344"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab25878578b48aaac7c3841a560b67497" title="Handles completion of a diagnostic calculation and will then pass this onto interested parties." alt="" coords="728,136,892,192"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aa4ce0078dbbff85dbe8799cfb6d7f839" title="Retrieves a communication activity from its field name." alt="" coords="499,201,668,257"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6dd07cccfe88be5418168241b19f2b10" title="Determines whether the fields required for an activity are available so that activity can be run." alt="" coords="723,360,897,416"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a10c82e5e43f4e3f306baf250bbda6df5" title="Generates a unique key for an activity within a diagnostic, which is unique amongst all diagnostics a..." alt="" coords="731,440,889,496"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ae02876dfa818535426c6d0be66696404" title="Handles the completion of the operator." alt="" coords="734,216,886,272"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="733,520,887,576"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="719,295,901,337"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a6be721f59f382ad66707a4021d3be1b5_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a6be721f59f382ad66707a4021d3be1b5_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a6be721f59f382ad66707a4021d3be1b5_icgraph" id="anamespacediagnostic__federator__mod_a6be721f59f382ad66707a4021d3be1b5_icgraph">
<area shape="rect" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1611,111,1779,152"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1409,70,1563,126"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="1164,70,1339,126"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1141,5,1361,47"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="867,107,1093,163"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="903,13,1057,69"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,20,819,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,13,620,69"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,20,395,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,27,196,54"/>
</map>
</div>

</div>
</div>
<a id="a01a2bc5cfd142c6bf40157c9a482aad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01a2bc5cfd142c6bf40157c9a482aad8">&#9670;&nbsp;</a></span>handle_completion_for_specific_monc_timestep_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::handle_completion_for_specific_monc_timestep_entry </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1data__values__type.html">data_values_type</a>), intent(in), pointer&#160;</td>
          <td class="paramname"><em>result_to_add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=string_length), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>), pointer&#160;</td>
          <td class="paramname"><em>timestep_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diagnostics_by_timestep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This handles inter IO completion for a specific timestep entry. This is required as at a timestep there can be multiple entires based on each MONC which communicates with the IO server so we handle an individual one here. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration of the IO server </td></tr>
    <tr><td class="paramname">values</td><td>Array of values resulting from the communication </td></tr>
    <tr><td class="paramname">field_name</td><td>Corresponding field name </td></tr>
    <tr><td class="paramname">timestep</td><td>Corresponding timestep </td></tr>
    <tr><td class="paramname">timestep_entry</td><td>The specific timestep entry which relates to an individual MONC communicating with the IO server </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00367">367</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: result_to_add</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span>, <span class="keywordtype">intent(in)</span> :: field_name</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: timestep_entry</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: diagnostics_by_timestep</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordtype">logical</span> :: entry_in_completed_diagnostics</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">pointer</span> :: activity</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    activity=&gt;get_comm_activity_from_fieldname(diagnostics_by_timestep, field_name)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    generic=&gt;result_to_add</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">call </span>c_put_generic(timestep_entry%completed_fields, trim(activity%result_name), generic, .false.)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(timestep_entry%outstanding_fields_rwlock))</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">! is field name here correct?</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keyword">call </span>c_remove(timestep_entry%outstanding_fields, trim(field_name))</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_entry%outstanding_fields_rwlock))</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(diagnostic_definitions)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">if</span> (activity%result_name == diagnostic_definitions(i)%diagnostic_name) <span class="keywordflow">then</span>                      </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> (diagnostic_definitions(i)%collective) <span class="keywordflow">then</span>          </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          <span class="keyword">call </span>handle_diagnostic_calculation_completed(io_configuration, i, timestep_entry, diagnostics_by_timestep)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;          <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          entry_in_completed_diagnostics=c_contains(diagnostics_by_timestep%completed_diagnostics, &amp;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;               diagnostic_definitions(i)%diagnostic_name)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          <span class="keywordflow">if</span> (.not. entry_in_completed_diagnostics) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keyword">call </span>handle_diagnostic_calculation_completed(io_configuration, i, timestep_entry, diagnostics_by_timestep)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keyword">call </span>check_all_activities_against_completed_fields(io_configuration, timestep_entry, diagnostics_by_timestep)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a01a2bc5cfd142c6bf40157c9a482aad8_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a01a2bc5cfd142c6bf40157c9a482aad8_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a01a2bc5cfd142c6bf40157c9a482aad8_cgraph" id="anamespacediagnostic__federator__mod_a01a2bc5cfd142c6bf40157c9a482aad8_cgraph">
<area shape="rect" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="5,245,232,301"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="280,205,455,261"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab25878578b48aaac7c3841a560b67497" title="Handles completion of a diagnostic calculation and will then pass this onto interested parties." alt="" coords="512,5,676,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aa4ce0078dbbff85dbe8799cfb6d7f839" title="Retrieves a communication activity from its field name." alt="" coords="283,285,452,341"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6dd07cccfe88be5418168241b19f2b10" title="Determines whether the fields required for an activity are available so that activity can be run." alt="" coords="507,85,681,141"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a10c82e5e43f4e3f306baf250bbda6df5" title="Generates a unique key for an activity within a diagnostic, which is unique amongst all diagnostics a..." alt="" coords="515,165,673,221"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ae02876dfa818535426c6d0be66696404" title="Handles the completion of the operator." alt="" coords="518,245,670,301"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="517,325,671,381"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="503,405,685,446"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a" title="Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator." alt="" coords="949,125,1135,181"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="733,333,901,374"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a9cb374b99d120fa5f27485256d6349e0" title="Retrieves the diagnostics list (each MONC source) at a specific timestep." alt="" coords="967,325,1117,381"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a01a2bc5cfd142c6bf40157c9a482aad8_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a01a2bc5cfd142c6bf40157c9a482aad8_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a01a2bc5cfd142c6bf40157c9a482aad8_icgraph" id="anamespacediagnostic__federator__mod_a01a2bc5cfd142c6bf40157c9a482aad8_icgraph">
<area shape="rect" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="1753,41,1980,97"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1537,17,1705,58"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1336,5,1489,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="1091,71,1265,127"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1068,6,1288,47"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,35,1020,91"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,42,819,83"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,35,620,91"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,42,395,83"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,49,196,76"/>
</map>
</div>

</div>
</div>
<a id="ab25878578b48aaac7c3841a560b67497"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab25878578b48aaac7c3841a560b67497">&#9670;&nbsp;</a></span>handle_diagnostic_calculation_completed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::handle_diagnostic_calculation_completed </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>diagnostic_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>timestep_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diagnostics_by_timestep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles completion of a diagnostic calculation and will then pass this onto interested parties. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">diagnostic_index</td><td>The diagnostics which has completed </td></tr>
    <tr><td class="paramname">timestep_entry</td><td>The timestep entry which has just completed this diagnostic </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00414">414</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: diagnostic_index</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: timestep_entry</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: diagnostics_by_timestep</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">pointer</span> :: diagnostics_value_entry</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: activity_at_index</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    diagnostics_value_entry=&gt;get_data_value_by_field_name(timestep_entry%completed_fields, &amp;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;         trim(diagnostic_definitions(diagnostic_index)%diagnostic_name))</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> (diagnostic_definitions(diagnostic_index)%collective) <span class="keywordflow">then</span>      </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keyword">call </span>provide_field_to_writer_federator(io_configuration, diagnostic_definitions(diagnostic_index)%diagnostic_name, &amp;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;           diagnostic_definitions(diagnostic_index)%diagnostic_namespace, diagnostics_value_entry%values, &amp;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;           timestep_entry%timestep, timestep_entry%time, &amp;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;           diagnostic_definitions(diagnostic_index)%generation_timestep_frequency, timestep_entry%source)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(timestep_entry%deletion_metric_mutex))</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      timestep_entry%number_diags_outstanding=timestep_entry%number_diags_outstanding-1</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(timestep_entry%deletion_metric_mutex))</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(diagnostics_value_entry%values)) <span class="keyword">deallocate</span>(diagnostics_value_entry%values)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">if</span> (.not. c_contains(diagnostics_by_timestep%completed_diagnostics, &amp;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;           diagnostic_definitions(diagnostic_index)%diagnostic_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">if</span> (.not. c_contains(diagnostics_by_timestep%completed_diagnostics,&amp;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;             diagnostic_definitions(diagnostic_index)%diagnostic_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          <span class="keyword">call </span>c_add_string(diagnostics_by_timestep%completed_diagnostics, &amp;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;               diagnostic_definitions(diagnostic_index)%diagnostic_name)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <span class="keyword">call </span>provide_field_to_writer_federator(io_configuration, diagnostic_definitions(diagnostic_index)%diagnostic_name, &amp;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;               diagnostic_definitions(diagnostic_index)%diagnostic_namespace, diagnostics_value_entry%values, &amp;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;               timestep_entry%timestep, timestep_entry%time, &amp;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;               diagnostic_definitions(diagnostic_index)%generation_timestep_frequency)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          iterator=c_get_iterator(diagnostics_by_timestep%diagnostic_entries)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            activity_at_index=&gt;retrieve_next_specific_monc_timestep_entry(iterator)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(activity_at_index%deletion_metric_mutex))</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            activity_at_index%number_diags_outstanding=activity_at_index%number_diags_outstanding-1</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(activity_at_index%deletion_metric_mutex))</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordflow">          end do</span>          </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(diagnostics_value_entry%values)) <span class="keyword">deallocate</span>(diagnostics_value_entry%values)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="keywordflow">    end if</span>        </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ab25878578b48aaac7c3841a560b67497_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ab25878578b48aaac7c3841a560b67497_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ab25878578b48aaac7c3841a560b67497_cgraph" id="anamespacediagnostic__federator__mod_ab25878578b48aaac7c3841a560b67497_cgraph">
<area shape="rect" title="Handles completion of a diagnostic calculation and will then pass this onto interested parties." alt="" coords="5,5,169,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a" title="Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator." alt="" coords="217,5,403,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ab25878578b48aaac7c3841a560b67497_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ab25878578b48aaac7c3841a560b67497_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ab25878578b48aaac7c3841a560b67497_icgraph" id="anamespacediagnostic__federator__mod_ab25878578b48aaac7c3841a560b67497_icgraph">
<area shape="rect" title="Handles completion of a diagnostic calculation and will then pass this onto interested parties." alt="" coords="2251,39,2415,95"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="2028,71,2203,127"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="1753,5,1980,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,92,1020,148"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1537,17,1705,58"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1336,56,1489,112"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1068,67,1288,109"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,99,819,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,92,620,148"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,99,395,141"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,107,196,133"/>
</map>
</div>

</div>
</div>
<a id="ae02876dfa818535426c6d0be66696404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae02876dfa818535426c6d0be66696404">&#9670;&nbsp;</a></span>handle_operator_completion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function diagnostic_federator_mod::handle_operator_completion </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>timestep_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>specific_activity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles the completion of the operator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestep_entry</td><td>The specific timestep entry </td></tr>
    <tr><td class="paramname">specific_activity</td><td>The specific activity that just completed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00291">291</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: timestep_entry</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">intent(inout)</span> :: specific_activity</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">pointer</span> :: operator_result</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: operator_result_values</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keyword">call </span>specific_activity%operator_procedure(io_configuration, timestep_entry%completed_fields, &amp;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;         specific_activity%activity_attributes, timestep_entry%source_location, timestep_entry%source, operator_result_values)    </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(operator_result_values)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keyword">allocate</span>(operator_result)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keyword">allocate</span>(operator_result%values(<span class="keyword">size</span>(operator_result_values)), source=operator_result_values)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      operator_result%values=operator_result_values</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keyword">deallocate</span>(operator_result_values)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      generic=&gt;operator_result</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keyword">call </span>c_put_generic(timestep_entry%completed_fields, specific_activity%result_name, generic, .false.)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_entry%completed_fields_rwlock))</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(timestep_entry%outstanding_fields_rwlock))       </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keyword">call </span>c_remove(timestep_entry%outstanding_fields, specific_activity%result_name)        </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(timestep_entry%outstanding_fields_rwlock)) </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      handle_operator_completion=.true.</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      handle_operator_completion=.false.</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ae02876dfa818535426c6d0be66696404_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ae02876dfa818535426c6d0be66696404_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ae02876dfa818535426c6d0be66696404_icgraph" id="anamespacediagnostic__federator__mod_ae02876dfa818535426c6d0be66696404_icgraph">
<area shape="rect" title="Handles the completion of the operator." alt="" coords="2251,36,2403,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="2028,36,2203,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="1753,36,1980,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,72,1020,128"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1537,43,1705,84"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1336,36,1489,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1068,47,1288,88"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,79,819,120"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,72,620,128"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,79,395,120"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,86,196,113"/>
</map>
</div>

</div>
</div>
<a id="a808b726c916d9dc52e2020eacbe2be0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a808b726c916d9dc52e2020eacbe2be0f">&#9670;&nbsp;</a></span>initialise_diagnostic_federator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>) function, public diagnostic_federator_mod::initialise_diagnostic_federator </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises the diagnostics action and sets up the diagnostics master definitions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The map of diagnostic fields to the frequency (in timesteps) of generation </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00089">89</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">call </span>initialise_operators()</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_init(timestep_entries_rwlock, -1))</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_init(all_diagnostics_per_timestep_rwlock, -1))</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_init(clean_progress_mutex, -1))    </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keyword">call </span>init_reduction_inter_io(io_configuration)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keyword">call </span>init_broadcast_inter_io(io_configuration)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">call </span>init_allreduction_inter_io(io_configuration)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">call </span>init_global_callback_inter_io(io_configuration)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">call </span>define_diagnostics(io_configuration, initialise_diagnostic_federator)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    previous_clean_point=0</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    previous_viewed_timestep=0</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    current_point=0</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a808b726c916d9dc52e2020eacbe2be0f_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a808b726c916d9dc52e2020eacbe2be0f_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a808b726c916d9dc52e2020eacbe2be0f_cgraph" id="anamespacediagnostic__federator__mod_a808b726c916d9dc52e2020eacbe2be0f_cgraph">
<area shape="rect" title="Initialises the diagnostics action and sets up the diagnostics master definitions." alt="" coords="5,822,179,878"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="1896,785,2051,827"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#abfa8e7bd16249cdacd8c1c0bd904f2b2" title="Based upon the IO configuration this will define the diagnostics structure. It is done once at initia..." alt="" coords="227,1143,393,1184"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="1657,869,1820,911"/>
<area shape="rect" href="namespaceforthread__mod.html#a84f66d5153e8adc21918d4b4d627087f" title=" " alt="" coords="929,801,1091,843"/>
<area shape="rect" href="namespaceallreduction__inter__io__mod.html#afa84e1c95ac2cd88f9220f5bde57087d" title="Initialises the all reduction inter IO functionality." alt="" coords="463,717,630,773"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a75700a7e7429e95b4233d0e068c8aafb" title="Initialises the broadcast inter IO functionality." alt="" coords="715,657,856,713"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a7169f0a03e60e46122e71b490e1905eb" title="Initialises the reduction action." alt="" coords="717,881,854,937"/>
<area shape="rect" href="namespaceglobal__callback__inter__io__mod.html#a112cd288476ab34b687759a6124b912c" title="Initialises the global callback." alt="" coords="239,757,381,813"/>
<area shape="rect" href="namespaceoperator__mod.html#a25db5c38fb4887066ea226511e217442" title="Initialises any operators that require initialisation." alt="" coords="233,1208,387,1249"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="2120,793,2263,819"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="2311,785,2477,827"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a2f03b205c686950116708bc8ae39db4c" title="Adds the required fields of an activity to the overall required fields which are cloned for each new ..." alt="" coords="461,1243,632,1299"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#acd74ee4c4a330a69fb9c0bc0a993d9b4" title="Retrieves the max diagnostic generation frequency for a set of fields." alt="" coords="471,1323,623,1379"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a5ff4a4217f56d3a3c1c19120a8b0d3f5" title="Retrieves a misc action from the parsed user XML configuration at a specific index." alt="" coords="469,1099,624,1155"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a1427333f9511d5199d60ad2c4c7077a7" title="Processes all auto dimensions by looking them up and resolving them based upon the operators." alt="" coords="441,1179,652,1220"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ad5c90a0a8585af8abd1e13f0b41beff3" title="Retrieves the generation frequency for a specific field." alt="" coords="700,1331,871,1372"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a8e8da478c02af7810229f55e7fbc1005" title="Retrives a diagnostic activity based upon its result name or null if none is found." alt="" coords="701,1171,869,1227"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="919,1179,1101,1220"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a4db5d64e7a2f546eeaaa4bb825012d43" title="Handles receiving data from another IO server and processing this. If the request has already been re..." alt="" coords="1159,419,1322,475"/>
<area shape="rect" href="namespaceinter__io__specifics__mod.html#ac8b76c9e3792326dd7da0557f828e19f" title="Registers an inter IO communication operation." alt="" coords="943,722,1077,778"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#aabce3a8dfe788e5f00583999b3688f80" title="Locates and returns or adds and returns a specific broadcast item representing a timestep and field." alt="" coords="1380,1100,1603,1141"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="1892,87,2055,128"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="1892,395,2055,436"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a231ba532141420ad11d921c509a5a06a" title="Issues the call into the thread pool to call the completion procedure, this runs in a seperate thread..." alt="" coords="1411,235,1572,291"/>
<area shape="rect" href="namespaceinter__io__specifics__mod.html#a0dc71dae28791bc5c07bc4ad20c0be41" title="Unpackages some binary data into its individual fields. The field values are allocated here and the s..." alt="" coords="1394,485,1589,541"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a46e749703e2e791961b93a72fc517664" title="Finds a specific broadcast item or null if none is found." alt="" coords="1651,1139,1827,1180"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="1892,1328,2055,1369"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="1892,1524,2055,1565"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="1892,1200,2055,1241"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#aa3e19e373e1f3520f836197cd9516519" title="Called by the thread pool, this will call onto the completion procedure before cleaning up @arguments..." alt="" coords="1668,170,1809,226"/>
<area shape="rect" href="namespaceconfiguration__parser__mod.html#a93bd1e4353c781242c2ead4919973e87" title="Extends the array of inter io communications from its current suze to current size+data_stride+curren..." alt="" coords="1167,722,1314,778"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a85941bfa01b3ffc89f04d2ace55a7f4d" title="Handles the receiving of data from some other IO server. This is issued call back style within a thre..." alt="" coords="929,918,1091,974"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a6b0356e066bb9478654f150c322e9f01" title="Handles the data received from another IO server, locates the correct reduction progress,..." alt="" coords="1149,902,1332,958"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a2ed33f2a10ddbfc3d66a54abb6db3687" title="Finds or adds a specific reduction progress based upon the timestep and reduction operator...." alt="" coords="1398,1325,1585,1381"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a458a37210e06eb9d9b370eee7be082ec" title="Handles the situation where collective communication for a specific reduction has completed across al..." alt="" coords="1411,1245,1571,1301"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#ab41f299ba351aa0bb6895b884e99aa3a" title="Integrates the collective values from another IO server into the currently stored values." alt="" coords="1406,1165,1577,1221"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a77d19aa56a2f87228010cfc74bf7677c" title="Locates a specific reduction progress based upon the timestep, operator and field name." alt="" coords="1669,1321,1809,1377"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a58c1e46c1eea51c17d72cd35b75b86b9" title="Generates the lookup key that is used for the map storage of reduction progresses." alt="" coords="1875,1459,2072,1500"/>
<area shape="rect" href="namespaceforthread__mod.html#a34912c5c002de467e6b116d65d917881" title=" " alt="" coords="1657,1256,1820,1297"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a4ddd54c71143c5974c8f7fdafd7dbc0a" title="Removes a specific reduction progress." alt="" coords="1657,1451,1820,1507"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a808b726c916d9dc52e2020eacbe2be0f_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a808b726c916d9dc52e2020eacbe2be0f_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a808b726c916d9dc52e2020eacbe2be0f_icgraph" id="anamespacediagnostic__federator__mod_a808b726c916d9dc52e2020eacbe2be0f_icgraph">
<area shape="rect" title="Initialises the diagnostics action and sets up the diagnostics master definitions." alt="" coords="244,5,417,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="ac72eade80d986df91f8008af3873a22e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac72eade80d986df91f8008af3873a22e">&#9670;&nbsp;</a></span>issue_communication_calls()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::issue_communication_calls </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>timestep_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diagnostics_by_timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>data_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character, dimension(:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>data_dump</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration of the IO server </td></tr>
    <tr><td class="paramname">timestep_entry</td><td>The timestep entry </td></tr>
    <tr><td class="paramname">source</td><td>The source PID of the MONC process </td></tr>
    <tr><td class="paramname">data_id</td><td>The ID of the data definition that is represented by the dump </td></tr>
    <tr><td class="paramname">data_dump</td><td>The data we have received from MONC </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00542">542</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: timestep_entry</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: source, data_id</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordtype">character</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(in)</span> :: data_dump</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: diagnostics_by_timestep</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordtype">logical</span> :: completed_diagnostics_entry</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordtype">integer</span> :: j, num_diags</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">pointer</span> :: activity</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: communication_field_name, activity_diag_key</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(timestep_entry%activity_completion_mutex))</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    num_diags=<span class="keyword">size</span>(diagnostic_definitions)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">do</span> j=1, num_diags</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      completed_diagnostics_entry=c_contains(diagnostics_by_timestep%completed_diagnostics, &amp;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;           diagnostic_definitions(j)%diagnostic_name)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(diagnostics_by_timestep%completed_diagnostics_rwlock))</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">if</span> (.not. completed_diagnostics_entry) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        iterator=c_get_iterator(diagnostic_definitions(j)%activities)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          activity=&gt;retrieve_next_activity(iterator)</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          activity_diag_key=generate_activity_diagnostic_key(diagnostic_definitions(j), activity)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          <span class="keywordflow">if</span> (.not. c_contains(timestep_entry%completed_activities, activity_diag_key)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordflow">if</span> ((activity%activity_type == reduction_type .or. activity%activity_type == broadcast_type &amp;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                 .or. activity%activity_type == allreduction_type)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;              <span class="keywordflow">if</span> (.not. c_is_empty(activity%required_fields)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                communication_field_name=c_get_string(activity%required_fields, 1)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <span class="keywordflow">if</span> (is_field_present(io_configuration, source, data_id, communication_field_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                  <span class="keyword">call </span>c_add_string(timestep_entry%completed_activities, activity_diag_key)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                  <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(timestep_entry%activity_completion_mutex))</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                  <span class="keyword">call </span>perform_inter_io_communication(io_configuration, timestep_entry, diagnostics_by_timestep, activity, &amp;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                       get_value_from_monc_data(io_configuration, source, data_id, data_dump, communication_field_name), &amp;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                       communication_field_name)            </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                  <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(timestep_entry%activity_completion_mutex))</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(timestep_entry%activity_completion_mutex))</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ac72eade80d986df91f8008af3873a22e_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ac72eade80d986df91f8008af3873a22e_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ac72eade80d986df91f8008af3873a22e_cgraph" id="anamespacediagnostic__federator__mod_ac72eade80d986df91f8008af3873a22e_cgraph">
<area shape="rect" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="5,311,225,353"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a10c82e5e43f4e3f306baf250bbda6df5" title="Generates a unique key for an activity within a diagnostic, which is unique amongst all diagnostics a..." alt="" coords="1215,5,1373,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab9ef4878802571ca765b6fd34b90607b" title="Retrieves a value from the communicated MONC data. If this was an integer then converts to a real." alt="" coords="275,427,425,483"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="273,245,427,301"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="1203,377,1385,418"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aa264a6878f40365037fea7292ecd4f45" title="Retrieves the data type of a field or 0 if the field was not found." alt="" coords="475,434,657,475"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="482,253,650,294"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a9cb374b99d120fa5f27485256d6349e0" title="Retrieves the diagnostics list (each MONC source) at a specific timestep." alt="" coords="743,245,894,301"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="705,165,932,221"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a" title="Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator." alt="" coords="1433,279,1619,335"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="980,100,1155,156"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab25878578b48aaac7c3841a560b67497" title="Handles completion of a diagnostic calculation and will then pass this onto interested parties." alt="" coords="1212,245,1376,301"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aa4ce0078dbbff85dbe8799cfb6d7f839" title="Retrieves a communication activity from its field name." alt="" coords="983,180,1152,236"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6dd07cccfe88be5418168241b19f2b10" title="Determines whether the fields required for an activity are available so that activity can be run." alt="" coords="1207,85,1381,141"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ae02876dfa818535426c6d0be66696404" title="Handles the completion of the operator." alt="" coords="1218,165,1370,221"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ac72eade80d986df91f8008af3873a22e_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ac72eade80d986df91f8008af3873a22e_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ac72eade80d986df91f8008af3873a22e_icgraph" id="anamespacediagnostic__federator__mod_ac72eade80d986df91f8008af3873a22e_icgraph">
<area shape="rect" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1068,13,1288,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a471607fc4ee8c3a1ce66d31dc68e5522"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a471607fc4ee8c3a1ce66d31dc68e5522">&#9670;&nbsp;</a></span>pass_fields_to_diagnostics_federator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public diagnostic_federator_mod::pass_fields_to_diagnostics_federator </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>data_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character, dimension(:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>data_dump</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules based upon the input data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration of the IO server </td></tr>
    <tr><td class="paramname">source</td><td>The source PID of the MONC process </td></tr>
    <tr><td class="paramname">data_id</td><td>The ID of the data definition that is represented by the dump </td></tr>
    <tr><td class="paramname">data_dump</td><td>The data we have received from MONC </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00191">191</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: source, data_id</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">character</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(in)</span> :: data_dump</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">integer</span> :: timestep</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: time</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">logical</span> :: terminated</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: timestep_entry</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: diagnostics_by_timestep</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">allocated</span>(diagnostic_definitions)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (c_is_empty(available_fields)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> (is_field_present(io_configuration, source, data_id, <span class="stringliteral">&quot;timestep&quot;</span>) .and. &amp;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;         is_field_present(io_configuration, source, data_id, <span class="stringliteral">&quot;time&quot;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      timestep=get_scalar_integer_from_monc(io_configuration, source, data_id, data_dump, <span class="stringliteral">&quot;timestep&quot;</span>)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      time=get_scalar_real_from_monc(io_configuration, source, data_id, data_dump, <span class="stringliteral">&quot;time&quot;</span>)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      timestep_entry=&gt;find_or_register_timestep_entry(io_configuration, timestep, source, time)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      diagnostics_by_timestep=&gt;get_diagnostics_by_timestep(timestep, .true.)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      terminated=.false.</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">if</span> (is_field_present(io_configuration, source, data_id, <span class="stringliteral">&quot;terminated&quot;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        terminated=get_scalar_logical_from_monc(io_configuration, source, data_id, data_dump, <span class="stringliteral">&quot;terminated&quot;</span>)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">if</span> (.not. terminated) <span class="keyword">call </span>clean_diagnostic_states(timestep)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keyword">call </span>issue_communication_calls(io_configuration, timestep_entry, diagnostics_by_timestep, source, data_id, data_dump)      </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keyword">call </span>check_diagnostics_entries_against_data(io_configuration, source, data_id, data_dump, timestep_entry)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keyword">call </span>check_all_activities_against_completed_fields(io_configuration, timestep_entry, diagnostics_by_timestep)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(timestep_entry%deletion_metric_mutex))</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      timestep_entry%number_datas_outstanding=timestep_entry%number_datas_outstanding-1</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(timestep_entry%deletion_metric_mutex))</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#a10e28447dd10ef9f92d205bc98fb26d3">log_warn</a>, <span class="stringliteral">&quot;Can not run the diagnostics federator without a timestep and time field in the MONC data&quot;</span>)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a471607fc4ee8c3a1ce66d31dc68e5522_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a471607fc4ee8c3a1ce66d31dc68e5522_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a471607fc4ee8c3a1ce66d31dc68e5522_cgraph" id="anamespacediagnostic__federator__mod_a471607fc4ee8c3a1ce66d31dc68e5522_cgraph">
<area shape="rect" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="5,543,159,599"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="229,235,404,291"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a9cb374b99d120fa5f27485256d6349e0" title="Retrieves the diagnostics list (each MONC source) at a specific timestep." alt="" coords="995,545,1146,601"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a3a57c70da8b58d633fdafedc4010719a" title="Checks the outstanding fields of a time step entry against the data recieved from MONC and moves any ..." alt="" coords="233,512,401,568"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aee7c2e6b24616cd79159ff8cdec96e0e" title="Cleans the diagnostic states if required (based on the timestep period)" alt="" coords="992,625,1149,681"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#afb86d57115a32c34cdfb03dacf573e05" title="Locates or registers a new (if it does not exist) time step entry based upon the timestep and source ..." alt="" coords="243,604,391,660"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="207,418,427,459"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6dd07cccfe88be5418168241b19f2b10" title="Determines whether the fields required for an activity are available so that activity can be run." alt="" coords="482,136,655,192"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a10c82e5e43f4e3f306baf250bbda6df5" title="Generates a unique key for an activity within a diagnostic, which is unique amongst all diagnostics a..." alt="" coords="489,411,648,467"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab25878578b48aaac7c3841a560b67497" title="Handles completion of a diagnostic calculation and will then pass this onto interested parties." alt="" coords="1246,143,1410,199"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ae02876dfa818535426c6d0be66696404" title="Handles the completion of the operator." alt="" coords="493,5,645,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="492,267,645,323"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="477,346,660,387"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a" title="Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator." alt="" coords="1472,451,1657,507"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="726,274,894,315"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="957,223,1184,279"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aa4ce0078dbbff85dbe8799cfb6d7f839" title="Retrieves a communication activity from its field name." alt="" coords="1243,223,1413,279"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab9ef4878802571ca765b6fd34b90607b" title="Retrieves a value from the communicated MONC data. If this was an integer then converts to a real." alt="" coords="494,491,643,547"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aa264a6878f40365037fea7292ecd4f45" title="Retrieves the data type of a field or 0 if the field was not found." alt="" coords="719,491,901,533"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ae91e4630f78c985e6cf8a9815e313aee" title="Deallocates all the diagnostics at a specific timestep, this removes all the individual MONC timestep..." alt="" coords="1232,541,1424,597"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7b2a93ef33d3a40c357b408e116d3d75" title="Retrieves the all diagnostics at a specific timestep from its map entry." alt="" coords="1240,633,1416,674"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a0356ed294110a413ed3ceb8349b23cb5" title="Retrieves all diagnostics at a timestep by its key." alt="" coords="1493,541,1637,597"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a94a3c0584d150d32aaf9c066295cd400" title="Creates a timestep entry and processes all members, determining activities their required fields etc...." alt="" coords="475,622,663,663"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a650167911efdc3cde6e7e22650dce8a3" title="Finds or adds diagnostics by timestep. This is used to maintain a list of all diagnostic entries for ..." alt="" coords="711,556,909,612"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7bebd63c0c83c5f7428c276a22d2f9e2" title="Retrieves the timestep at a specific timestep and source MONC." alt="" coords="483,687,654,729"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a471607fc4ee8c3a1ce66d31dc68e5522_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a471607fc4ee8c3a1ce66d31dc68e5522_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a471607fc4ee8c3a1ce66d31dc68e5522_icgraph" id="anamespacediagnostic__federator__mod_a471607fc4ee8c3a1ce66d31dc68e5522_icgraph">
<area shape="rect" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a137b3e2865e5dd85e2352afbf6c12de6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a137b3e2865e5dd85e2352afbf6c12de6">&#9670;&nbsp;</a></span>perform_inter_io_communication()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::perform_inter_io_communication </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>timestep_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>all_entries_at_timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a>), intent(in), pointer&#160;</td>
          <td class="paramname"><em>activity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1data__values__type.html">data_values_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>value_to_send</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=string_length), intent(in)&#160;</td>
          <td class="paramname"><em>communication_field_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the actual inter IO communication by calling out to the appropriate inter IO module. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration of the IO server </td></tr>
    <tr><td class="paramname">timestep_entry</td><td>The timestep entry </td></tr>
    <tr><td class="paramname">activity</td><td>The activity this is executing </td></tr>
    <tr><td class="paramname">value_to_send</td><td>The value to communicate </td></tr>
    <tr><td class="paramname">communication_field_name</td><td>Name of the field that we are communicating </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00502">502</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: timestep_entry</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">intent(inout)</span> :: all_entries_at_timestep</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: activity</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">intent(in)</span> :: value_to_send</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span>, <span class="keywordtype">intent(in)</span> :: communication_field_name</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    generic=&gt;activity</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(all_entries_at_timestep%communication_corresponding_activities_rwlock))</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keyword">call </span>c_put_generic(all_entries_at_timestep%communication_corresponding_activities, trim(communication_field_name), &amp;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;         generic, .false.)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(all_entries_at_timestep%communication_corresponding_activities_rwlock))</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">if</span> (activity%activity_type == reduction_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keyword">call </span>perform_inter_io_reduction(io_configuration, value_to_send%values, <span class="keyword">size</span>(value_to_send%values), &amp;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;           communication_field_name, activity%communication_operator, activity%root, timestep_entry%timestep, handle_completion)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordflow">if</span> (activity%root .ne. io_configuration%my_io_rank) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(timestep_entry%deletion_metric_mutex))</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        timestep_entry%number_diags_outstanding=timestep_entry%number_diags_outstanding-1</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(timestep_entry%deletion_metric_mutex))</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (activity%activity_type == allreduction_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keyword">call </span>perform_inter_io_allreduction(io_configuration, value_to_send%values, <span class="keyword">size</span>(value_to_send%values), &amp;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;           communication_field_name, activity%communication_operator, activity%root, timestep_entry%timestep, handle_completion)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (activity%activity_type == broadcast_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keyword">call </span>perform_inter_io_broadcast(io_configuration, value_to_send%values, <span class="keyword">size</span>(value_to_send%values), &amp;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;           communication_field_name, activity%root, timestep_entry%timestep, handle_completion)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a137b3e2865e5dd85e2352afbf6c12de6_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a137b3e2865e5dd85e2352afbf6c12de6_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a137b3e2865e5dd85e2352afbf6c12de6_cgraph" id="anamespacediagnostic__federator__mod_a137b3e2865e5dd85e2352afbf6c12de6_cgraph">
<area shape="rect" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="5,173,159,229"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="207,107,375,148"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a9cb374b99d120fa5f27485256d6349e0" title="Retrieves the diagnostics list (each MONC source) at a specific timestep." alt="" coords="461,59,611,115"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="423,139,649,195"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac9a188fde5ea81a9d9b3e9ced68b058a" title="Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator." alt="" coords="1151,27,1336,83"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="697,205,872,261"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab25878578b48aaac7c3841a560b67497" title="Handles completion of a diagnostic calculation and will then pass this onto interested parties." alt="" coords="929,61,1093,117"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aa4ce0078dbbff85dbe8799cfb6d7f839" title="Retrieves a communication activity from its field name." alt="" coords="700,74,869,130"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6dd07cccfe88be5418168241b19f2b10" title="Determines whether the fields required for an activity are available so that activity can be run." alt="" coords="925,205,1098,261"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a10c82e5e43f4e3f306baf250bbda6df5" title="Generates a unique key for an activity within a diagnostic, which is unique amongst all diagnostics a..." alt="" coords="932,285,1091,341"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ae02876dfa818535426c6d0be66696404" title="Handles the completion of the operator." alt="" coords="935,365,1087,421"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="920,140,1103,181"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a137b3e2865e5dd85e2352afbf6c12de6_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a137b3e2865e5dd85e2352afbf6c12de6_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a137b3e2865e5dd85e2352afbf6c12de6_icgraph" id="anamespacediagnostic__federator__mod_a137b3e2865e5dd85e2352afbf6c12de6_icgraph">
<area shape="rect" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1427,36,1580,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="1181,36,1356,92"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1159,119,1379,160"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="884,34,1111,90"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="921,114,1074,170"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="668,10,836,51"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="677,122,827,163"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,114,620,170"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,122,395,163"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,129,196,156"/>
</map>
</div>

</div>
</div>
<a id="a1427333f9511d5199d60ad2c4c7077a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1427333f9511d5199d60ad2c4c7077a7">&#9670;&nbsp;</a></span>process_auto_dimensions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diagnostic_federator_mod::process_auto_dimensions </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__diagnostic__field__type.html">io_configuration_diagnostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diagnostic_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>entry_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Processes all auto dimensions by looking them up and resolving them based upon the operators. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration of the IO server </td></tr>
    <tr><td class="paramname">diagnostic_configuration</td><td>Configuration of the diagnostic field </td></tr>
    <tr><td class="paramname">entry_index</td><td>The specific diagnostic entry that we care about </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l01200">1200</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordtype">type</span>(io_configuration_diagnostic_field_type), <span class="keywordtype">intent(inout)</span> :: diagnostic_configuration</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: entry_index</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordtype">integer</span> :: i, auto_index, diag_modified_dim_size</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: specific_dimension</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">pointer</span> :: diagnostic_activity</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    diagnostic_activity=&gt;get_diagnostic_activity_by_result_name(diagnostic_definitions(entry_index)%diagnostic_name, entry_index)</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(diagnostic_activity)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">if</span> (diagnostic_activity%activity_type==operator_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="keywordflow">do</span> i=1, diagnostic_configuration%dimensions</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;          auto_index=index(diagnostic_configuration%dim_size_defns(i), <span class="stringliteral">&quot;-auto&quot;</span>)</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;          <span class="keywordflow">if</span> (auto_index .ne. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            specific_dimension=diagnostic_configuration%dim_size_defns(i)(1:auto_index-1)</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            diag_modified_dim_size=get_operator_auto_size(io_configuration, diagnostic_activity%activity_name, &amp;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                 specific_dimension, diagnostic_activity%activity_attributes)</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            <span class="keywordflow">if</span> (diag_modified_dim_size .ge. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;              specific_dimension=trim(specific_dimension)//<span class="stringliteral">&quot;_&quot;</span>//trim(conv_to_string(diag_modified_dim_size))</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;              diagnostic_configuration%dim_size_defns(i)=specific_dimension</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;              <span class="keyword">call </span>c_put_integer(io_configuration%dimension_sizing, specific_dimension, diag_modified_dim_size)</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;              diagnostic_configuration%dim_size_defns(i)=specific_dimension</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a1427333f9511d5199d60ad2c4c7077a7_cgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a1427333f9511d5199d60ad2c4c7077a7_cgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a1427333f9511d5199d60ad2c4c7077a7_cgraph" id="anamespacediagnostic__federator__mod_a1427333f9511d5199d60ad2c4c7077a7_cgraph">
<area shape="rect" title="Processes all auto dimensions by looking them up and resolving them based upon the operators." alt="" coords="5,13,216,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a8e8da478c02af7810229f55e7fbc1005" title="Retrives a diagnostic activity based upon its result name or null if none is found." alt="" coords="264,5,432,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a7951029c07b91b6398c93636f9442dfa" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="480,13,663,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a1427333f9511d5199d60ad2c4c7077a7_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a1427333f9511d5199d60ad2c4c7077a7_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a1427333f9511d5199d60ad2c4c7077a7_icgraph" id="anamespacediagnostic__federator__mod_a1427333f9511d5199d60ad2c4c7077a7_icgraph">
<area shape="rect" title="Processes all auto dimensions by looking them up and resolving them based upon the operators." alt="" coords="680,13,891,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#abfa8e7bd16249cdacd8c1c0bd904f2b2" title="Based upon the IO configuration this will define the diagnostics structure. It is done once at initia..." alt="" coords="465,13,632,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a808b726c916d9dc52e2020eacbe2be0f" title="Initialises the diagnostics action and sets up the diagnostics master definitions." alt="" coords="244,5,417,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a7b2a93ef33d3a40c357b408e116d3d75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b2a93ef33d3a40c357b408e116d3d75">&#9670;&nbsp;</a></span>retrieve_diagnostics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1all__diagnostics__at__timestep__type.html">all_diagnostics_at_timestep_type</a>) function, pointer diagnostic_federator_mod::retrieve_diagnostics </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1mapentry__type.html">mapentry_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mapentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the all diagnostics at a specific timestep from its map entry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mapentry</td><td>The map entry to extract the all diagnostics from </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The corresponding all diagnostics or null if none is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l01035">1035</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordtype">type</span>(mapentry_type), <span class="keywordtype">intent(in)</span> :: mapentry</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordtype">type</span>(all_diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: retrieve_diagnostics</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    generic=&gt;c_get_generic(mapentry)</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(generic)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="keywordflow">      type is</span>(all_diagnostics_at_timestep_type)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        retrieve_diagnostics=&gt;generic</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      retrieve_diagnostics=&gt;null()</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a7b2a93ef33d3a40c357b408e116d3d75_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a7b2a93ef33d3a40c357b408e116d3d75_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a7b2a93ef33d3a40c357b408e116d3d75_icgraph" id="anamespacediagnostic__federator__mod_a7b2a93ef33d3a40c357b408e116d3d75_icgraph">
<area shape="rect" title="Retrieves the all diagnostics at a specific timestep from its map entry." alt="" coords="1273,13,1449,54"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aee7c2e6b24616cd79159ff8cdec96e0e" title="Cleans the diagnostic states if required (based on the timestep period)" alt="" coords="1068,5,1225,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="867,5,1020,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,13,819,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,5,620,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,13,395,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,20,196,47"/>
</map>
</div>

</div>
</div>
<a id="a7951029c07b91b6398c93636f9442dfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7951029c07b91b6398c93636f9442dfa">&#9670;&nbsp;</a></span>retrieve_next_activity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__activity__type.html">diagnostics_activity_type</a>) function, pointer diagnostic_federator_mod::retrieve_next_activity </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1iterator__type.html">iterator_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>iterator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the next activity in a collection being iterated over by an iterator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iterator</td><td>The iterator we are using to iterate over the collection </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The next activity or null if none is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00895">895</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordtype">type</span>(iterator_type), <span class="keywordtype">intent(inout)</span> :: iterator</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordtype">type</span>(diagnostics_activity_type), <span class="keywordtype">pointer</span> :: retrieve_next_activity</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    generic=&gt;c_next_generic(iterator)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(generic)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="keywordflow">        type is</span>(diagnostics_activity_type)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;          retrieve_next_activity=&gt;generic</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="keywordflow">      end select</span>      </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      retrieve_next_activity=&gt;null()</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_a7951029c07b91b6398c93636f9442dfa_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_a7951029c07b91b6398c93636f9442dfa_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_a7951029c07b91b6398c93636f9442dfa_icgraph" id="anamespacediagnostic__federator__mod_a7951029c07b91b6398c93636f9442dfa_icgraph">
<area shape="rect" title="Retrieves the next activity in a collection being iterated over by an iterator." alt="" coords="2287,167,2469,209"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="2056,115,2231,171"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1088,74,1308,115"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a5b55ebfb6f9bf71a42f716fc9d6dad8c" title="Determines the diagnostics fields that are available based upon the input MONC fields on registration..." alt="" coords="2048,200,2239,256"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a8e8da478c02af7810229f55e7fbc1005" title="Retrives a diagnostic activity based upon its result name or null if none is found." alt="" coords="2059,291,2227,347"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="1773,93,2000,149"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="877,159,1030,215"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1557,97,1725,138"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1356,67,1509,123"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,166,819,207"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,159,620,215"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,231,395,273"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,271,196,297"/>
<area shape="rect" href="namespaceio__server__mod.html#a75db617985efd39b9db284a0dc512d34" title="Registers with the writer federator the set of fields (prognostic and diagnostic) that are available,..." alt="" coords="1803,224,1970,280"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="1576,231,1707,273"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="1123,231,1273,273"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a1427333f9511d5199d60ad2c4c7077a7" title="Processes all auto dimensions by looking them up and resolving them based upon the operators." alt="" coords="1781,303,1992,345"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#abfa8e7bd16249cdacd8c1c0bd904f2b2" title="Based upon the IO configuration this will define the diagnostics structure. It is done once at initia..." alt="" coords="1558,299,1725,341"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a808b726c916d9dc52e2020eacbe2be0f" title="Initialises the diagnostics action and sets up the diagnostics master definitions." alt="" coords="867,289,1040,345"/>
</map>
</div>

</div>
</div>
<a id="ac9a188fde5ea81a9d9b3e9ced68b058a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a188fde5ea81a9d9b3e9ced68b058a">&#9670;&nbsp;</a></span>retrieve_next_specific_monc_timestep_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__at__timestep__type.html">diagnostics_at_timestep_type</a>) function, pointer diagnostic_federator_mod::retrieve_next_specific_monc_timestep_entry </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1iterator__type.html">iterator_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>iterator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iterator</td><td>The iterator we are using to iterate ove the collection </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The next MONC timestep entry or null if none is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00993">993</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordtype">type</span>(iterator_type), <span class="keywordtype">intent(inout)</span> :: iterator</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordtype">type</span>(diagnostics_at_timestep_type), <span class="keywordtype">pointer</span> :: retrieve_next_specific_monc_timestep_entry</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    generic=&gt;c_next_generic(iterator)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(generic)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="keywordflow">      type is</span> (diagnostics_at_timestep_type)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        retrieve_next_specific_monc_timestep_entry=&gt;generic</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      retrieve_next_specific_monc_timestep_entry=&gt;null()</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacediagnostic__federator__mod_ac9a188fde5ea81a9d9b3e9ced68b058a_icgraph.png" border="0" usemap="#anamespacediagnostic__federator__mod_ac9a188fde5ea81a9d9b3e9ced68b058a_icgraph" alt=""/></div>
<map name="namespacediagnostic__federator__mod_ac9a188fde5ea81a9d9b3e9ced68b058a_icgraph" id="anamespacediagnostic__federator__mod_ac9a188fde5ea81a9d9b3e9ced68b058a_icgraph">
<area shape="rect" title="Retrieves the next MONC timestep entry from the all diagnostics based upon a collections iterator." alt="" coords="1861,107,2047,163"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#aee7c2e6b24616cd79159ff8cdec96e0e" title="Cleans the diagnostic states if required (based on the timestep period)" alt="" coords="1413,5,1570,61"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ae91e4630f78c985e6cf8a9815e313aee" title="Deallocates all the diagnostics at a specific timestep, this removes all the individual MONC timestep..." alt="" coords="1621,71,1813,127"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a6be721f59f382ad66707a4021d3be1b5" title="Handles inter io reduction completion, it adds the resulting value to the appropriate completion list..." alt="" coords="1633,150,1801,191"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ab25878578b48aaac7c3841a560b67497" title="Handles completion of a diagnostic calculation and will then pass this onto interested parties." alt="" coords="1409,241,1573,297"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a471607fc4ee8c3a1ce66d31dc68e5522" title="Entry point into the diagnostics federator this runs the diagnostics, executing the defined rules bas..." alt="" coords="903,39,1057,95"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="668,46,819,87"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="443,39,620,95"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="244,46,395,87"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="5,53,196,80"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a137b3e2865e5dd85e2352afbf6c12de6" title="Performs the actual inter IO communication by calling out to the appropriate inter IO module." alt="" coords="1415,111,1568,167"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#adcd05cf714b11815d87be556954d5d35" title="Checks all pending activities against the completed fields and runs them if the required fields are n..." alt="" coords="1164,111,1339,167"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#ac72eade80d986df91f8008af3873a22e" title="Issues any inter io communucation calls that are appropriate based upon the data recieved from MONC." alt="" coords="1141,46,1361,87"/>
<area shape="rect" href="namespacediagnostic__federator__mod.html#a01a2bc5cfd142c6bf40157c9a482aad8" title="This handles inter IO completion for a specific timestep entry. This is required as at a timestep the..." alt="" coords="867,176,1093,232"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab9c4690d1ed9ae834c7f8b6261b846af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9c4690d1ed9ae834c7f8b6261b846af">&#9670;&nbsp;</a></span>all_diagnostics_at_timestep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), volatile diagnostic_federator_mod::all_diagnostics_at_timestep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00076">76</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="a4377f39c9d9d42d83c2cf4fc8eaa124f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4377f39c9d9d42d83c2cf4fc8eaa124f">&#9670;&nbsp;</a></span>all_diagnostics_per_timestep_rwlock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, volatile diagnostic_federator_mod::all_diagnostics_per_timestep_rwlock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00079">79</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="a8d10aab350c609819b4ecf6e040f46ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d10aab350c609819b4ecf6e040f46ff">&#9670;&nbsp;</a></span>all_outstanding_fields</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), volatile diagnostic_federator_mod::all_outstanding_fields</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00077">77</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">type</span>(hashset_type), <span class="keywordtype">volatile</span> :: all_outstanding_fields, available_fields</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa49a326e9b108c51d7f22579b542dcc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa49a326e9b108c51d7f22579b542dcc4">&#9670;&nbsp;</a></span>allreduction_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter diagnostic_federator_mod::allreduction_type =4</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00039">39</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="a23e134fb2f4b0cf28ac72d2d46d80b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e134fb2f4b0cf28ac72d2d46d80b70">&#9670;&nbsp;</a></span>available_fields</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), volatile diagnostic_federator_mod::available_fields</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00077">77</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="a65df719fafe4236caf1ccf82567ef06f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65df719fafe4236caf1ccf82567ef06f">&#9670;&nbsp;</a></span>broadcast_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter diagnostic_federator_mod::broadcast_type =3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00039">39</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="a92b850f32b130e6e8dcf0cc5a96250c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92b850f32b130e6e8dcf0cc5a96250c5">&#9670;&nbsp;</a></span>clean_progress_mutex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, volatile diagnostic_federator_mod::clean_progress_mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00079">79</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="a2089e85afe15846ece18e08eb314902f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2089e85afe15846ece18e08eb314902f">&#9670;&nbsp;</a></span>current_point</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, volatile diagnostic_federator_mod::current_point</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00079">79</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="a2873520be29ed70dd28e89d63eeb2ad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2873520be29ed70dd28e89d63eeb2ad8">&#9670;&nbsp;</a></span>diagnostic_definitions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structdiagnostic__federator__mod_1_1diagnostics__type.html">diagnostics_type</a>), dimension(:), allocatable, volatile diagnostic_federator_mod::diagnostic_definitions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00078">78</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">type</span>(diagnostics_type), <span class="keywordtype">volatile</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: diagnostic_definitions</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa41db3af8139e0cac6192b0c726a613f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa41db3af8139e0cac6192b0c726a613f">&#9670;&nbsp;</a></span>diagnostics_per_monc_at_timestep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), volatile diagnostic_federator_mod::diagnostics_per_monc_at_timestep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00076">76</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">type</span>(hashmap_type), <span class="keywordtype">volatile</span> :: diagnostics_per_monc_at_timestep, all_diagnostics_at_timestep</div>
</div><!-- fragment -->
</div>
</div>
<a id="a10b275651a9f8a09ec6343e001809c9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10b275651a9f8a09ec6343e001809c9e">&#9670;&nbsp;</a></span>operator_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter diagnostic_federator_mod::operator_type =1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00039">39</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: OPERATOR_TYPE=1, reduction_type=2, broadcast_type=3, allreduction_type=4, perform_clean_every=100</div>
</div><!-- fragment -->
</div>
</div>
<a id="a52624c33280dda0a0c35736ca473be88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52624c33280dda0a0c35736ca473be88">&#9670;&nbsp;</a></span>perform_clean_every</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter diagnostic_federator_mod::perform_clean_every =100</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A wrapper type containing all the diagnostics for MONC source processes at a specific timestep. </p>

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00039">39</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="a318df4d25c73b2b566ac9bad22457eb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a318df4d25c73b2b566ac9bad22457eb1">&#9670;&nbsp;</a></span>previous_clean_point</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, volatile diagnostic_federator_mod::previous_clean_point</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00079">79</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="a65551734894fd5efb77362fb73aa205d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65551734894fd5efb77362fb73aa205d">&#9670;&nbsp;</a></span>previous_viewed_timestep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, volatile diagnostic_federator_mod::previous_viewed_timestep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00079">79</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="acfe5d8a45660b2de91943f45593ec7d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfe5d8a45660b2de91943f45593ec7d1">&#9670;&nbsp;</a></span>reduction_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter diagnostic_federator_mod::reduction_type =2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00039">39</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>

</div>
</div>
<a id="ab3393a0dcc36de159558059efe9052f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3393a0dcc36de159558059efe9052f4">&#9670;&nbsp;</a></span>timestep_entries_rwlock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, volatile diagnostic_federator_mod::timestep_entries_rwlock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="diagnostic__federator_8F90_source.html#l00079">79</a> of file <a class="el" href="diagnostic__federator_8F90_source.html">diagnostic_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">volatile</span> :: timestep_entries_rwlock, all_diagnostics_per_timestep_rwlock, clean_progress_mutex, &amp;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       previous_clean_point, previous_viewed_timestep, current_point</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="anamespacelogging__mod_html_ad68309846cd8f9e77edaa6abd02f65a0"><div class="ttname"><a href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">logging_mod::log_error</a></div><div class="ttdeci">integer, parameter, public log_error</div><div class="ttdoc">Only log ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00011">logging.F90:11</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_a10e28447dd10ef9f92d205bc98fb26d3"><div class="ttname"><a href="namespacelogging__mod.html#a10e28447dd10ef9f92d205bc98fb26d3">logging_mod::log_warn</a></div><div class="ttdeci">integer, parameter, public log_warn</div><div class="ttdoc">Log WARNING and ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00012">logging.F90:12</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ac4f13ac385499c85190cb184030e4f45"><div class="ttname"><a href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">logging_mod::log_log</a></div><div class="ttdeci">subroutine, public log_log(level, message, str)</div><div class="ttdoc">Logs a message at the specified level. If the level is above the current level then the message is ig...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00074">logging.F90:75</a></div></div>
<div class="ttc" id="anamespacedatadefn__mod_html_a39b79f8cc843d236d3b47f5c81b64368"><div class="ttname"><a href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">datadefn_mod::default_precision</a></div><div class="ttdeci">integer, parameter, public default_precision</div><div class="ttdoc">MPI communication type which we use for the prognostic and calculation data.</div><div class="ttdef"><b>Definition:</b> <a href="datadefn_8F90_source.html#l00017">datadefn.F90:17</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

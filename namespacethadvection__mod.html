<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: thadvection_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">thadvection_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Specific theta advection, which involves the vertical advection of reference state and advection of mean baroclinicity.  
<a href="namespacethadvection__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa3a66036a48786d8846a242110e96590"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structmonc__component__mod_1_1component__descriptor__type.html">component_descriptor_type</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590">thadvection_get_descriptor</a> ()</td></tr>
<tr class="memdesc:aa3a66036a48786d8846a242110e96590"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides a description of this component for the core to register.  <a href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590">More...</a><br /></td></tr>
<tr class="separator:aa3a66036a48786d8846a242110e96590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf88aa826be438abd234748262372cee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#adf88aa826be438abd234748262372cee">initialisation_callback</a> (current_state)</td></tr>
<tr class="memdesc:adf88aa826be438abd234748262372cee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation callback to set up the variables and data needed by the component.  <a href="namespacethadvection__mod.html#adf88aa826be438abd234748262372cee">More...</a><br /></td></tr>
<tr class="separator:adf88aa826be438abd234748262372cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a4a9ea2a9012878a1e12ce6188e8191"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a6a4a9ea2a9012878a1e12ce6188e8191">finalisation_callback</a> (current_state)</td></tr>
<tr class="separator:a6a4a9ea2a9012878a1e12ce6188e8191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09d1b793a23456817a68ec1c07c1257b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a09d1b793a23456817a68ec1c07c1257b">timestep_callback</a> (current_state)</td></tr>
<tr class="memdesc:a09d1b793a23456817a68ec1c07c1257b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestep callback, will call the two separate procedures to do their advection if needed.  <a href="namespacethadvection__mod.html#a09d1b793a23456817a68ec1c07c1257b">More...</a><br /></td></tr>
<tr class="separator:a09d1b793a23456817a68ec1c07c1257b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadad7cf391b176d99be59815af29feb6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#aadad7cf391b176d99be59815af29feb6">vertical_advection_of_reference_state</a> (current_state, local_y, local_x)</td></tr>
<tr class="memdesc:aadad7cf391b176d99be59815af29feb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vertical advection of the reference state. It doesn't seem consistent to do the advection in this way if TVD advection of the deviation from the reference state has been selected. Separate vertical advection of the reference state was introduced to improve energy conservation when carrying out idealized gravity wave simulations in a deep, dry isothermal layer, for which the difference in potential temp between top and bottom was of order 100K. In less extreme cases the benefits are unlikely to be significant and with TVD advection energy conservation has been compromised so the best way forward might be to recombine the reference state into l_th.  <a href="namespacethadvection__mod.html#aadad7cf391b176d99be59815af29feb6">More...</a><br /></td></tr>
<tr class="separator:aadad7cf391b176d99be59815af29feb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b19a797f5a9555cf25c4f97a6f53d54"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a7b19a797f5a9555cf25c4f97a6f53d54">advection_of_mean_baroclinicity</a> (current_state, local_y, local_x)</td></tr>
<tr class="memdesc:a7b19a797f5a9555cf25c4f97a6f53d54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs advection of the mean baroclinicity if appropriate.  <a href="namespacethadvection__mod.html#a7b19a797f5a9555cf25c4f97a6f53d54">More...</a><br /></td></tr>
<tr class="separator:a7b19a797f5a9555cf25c4f97a6f53d54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af414b9967eb65e448d9d937f84076a6a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#af414b9967eb65e448d9d937f84076a6a">save_precomponent_tendencies</a> (current_state, cxn, cyn, txn, tyn)</td></tr>
<tr class="memdesc:af414b9967eb65e448d9d937f84076a6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the 3d tendencies coming into the component.  <a href="namespacethadvection__mod.html#af414b9967eb65e448d9d937f84076a6a">More...</a><br /></td></tr>
<tr class="separator:af414b9967eb65e448d9d937f84076a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca0838c1d444d0a29a1b7ac211ae0ac"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#acca0838c1d444d0a29a1b7ac211ae0ac">compute_component_tendencies</a> (current_state, cxn, cyn, txn, tyn)</td></tr>
<tr class="memdesc:acca0838c1d444d0a29a1b7ac211ae0ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computation of component tendencies.  <a href="namespacethadvection__mod.html#acca0838c1d444d0a29a1b7ac211ae0ac">More...</a><br /></td></tr>
<tr class="separator:acca0838c1d444d0a29a1b7ac211ae0ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50aad1af96470f2debcd7a6191c6c110"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a50aad1af96470f2debcd7a6191c6c110">field_information_retrieval_callback</a> (current_state, name, field_information)</td></tr>
<tr class="memdesc:a50aad1af96470f2debcd7a6191c6c110"><td class="mdescLeft">&#160;</td><td class="mdescRight">Field information retrieval callback, this returns information for a specific component's published field.  <a href="namespacethadvection__mod.html#a50aad1af96470f2debcd7a6191c6c110">More...</a><br /></td></tr>
<tr class="separator:a50aad1af96470f2debcd7a6191c6c110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a22c4e41063ea55633b24702d7fff4f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a1a22c4e41063ea55633b24702d7fff4f">field_value_retrieval_callback</a> (current_state, name, field_value)</td></tr>
<tr class="memdesc:a1a22c4e41063ea55633b24702d7fff4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Field value retrieval callback, this returns the value of a specific published field.  <a href="namespacethadvection__mod.html#a1a22c4e41063ea55633b24702d7fff4f">More...</a><br /></td></tr>
<tr class="separator:a1a22c4e41063ea55633b24702d7fff4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad95878bb451ea6f40760492bab2d3ccc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#ad95878bb451ea6f40760492bab2d3ccc">set_published_field_value</a> (field_value, real_1d_field, real_2d_field, real_3d_field)</td></tr>
<tr class="memdesc:ad95878bb451ea6f40760492bab2d3ccc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the published field value from the temporary diagnostic values held by this component.  <a href="namespacethadvection__mod.html#ad95878bb451ea6f40760492bab2d3ccc">More...</a><br /></td></tr>
<tr class="separator:ad95878bb451ea6f40760492bab2d3ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6890b280d0a038bed4334ff74c8b5df3"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a6890b280d0a038bed4334ff74c8b5df3">baroclinicity_use_geostrophic_shear</a></td></tr>
<tr class="separator:a6890b280d0a038bed4334ff74c8b5df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c194ec186fb01867184f7783a93f17"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#aa0c194ec186fb01867184f7783a93f17">l_advect_mean_baroclinicity</a></td></tr>
<tr class="separator:aa0c194ec186fb01867184f7783a93f17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae567a1be5c97cc52df73ecfddf08b740"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#ae567a1be5c97cc52df73ecfddf08b740">fcoriol</a></td></tr>
<tr class="separator:ae567a1be5c97cc52df73ecfddf08b740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d7220f01227627b9d0ce1f70b3ce95"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a40d7220f01227627b9d0ce1f70b3ce95">fcoriol_over_g</a></td></tr>
<tr class="separator:a40d7220f01227627b9d0ce1f70b3ce95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bdc24a4de0deeab1e464fe26a811e7b"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a8bdc24a4de0deeab1e464fe26a811e7b">rate_change_geostrophic_wind_x</a></td></tr>
<tr class="separator:a8bdc24a4de0deeab1e464fe26a811e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f761e0495b03da85f5c95dba870eb74"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a3f761e0495b03da85f5c95dba870eb74">rate_change_geostrophic_wind_y</a></td></tr>
<tr class="separator:a3f761e0495b03da85f5c95dba870eb74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9100518570437cd458a1c0f19fe8671"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#ab9100518570437cd458a1c0f19fe8671">multiplicative_factor_x</a></td></tr>
<tr class="separator:ab9100518570437cd458a1c0f19fe8671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a788224a6b535c10c26ee9280cd488ae3"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a788224a6b535c10c26ee9280cd488ae3">multiplicative_factor_y</a></td></tr>
<tr class="separator:a788224a6b535c10c26ee9280cd488ae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d17dd15447010be07b7c20e07aa13fb"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a4d17dd15447010be07b7c20e07aa13fb">tend_3d_th</a></td></tr>
<tr class="separator:a4d17dd15447010be07b7c20e07aa13fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac45e02b9e66c20e3fdbc3aaec01d7a6a"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#ac45e02b9e66c20e3fdbc3aaec01d7a6a">tend_3d_tabs</a></td></tr>
<tr class="separator:ac45e02b9e66c20e3fdbc3aaec01d7a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abccca55f73e9fed3304b036c885ffbb9"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#abccca55f73e9fed3304b036c885ffbb9">l_tend_3d_th</a></td></tr>
<tr class="separator:abccca55f73e9fed3304b036c885ffbb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa019cd3b36ae4c3183dfe5658aa23a"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#adaa019cd3b36ae4c3183dfe5658aa23a">l_tend_3d_tabs</a></td></tr>
<tr class="separator:adaa019cd3b36ae4c3183dfe5658aa23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86193f4fa3cbfac3121d3222e0beaf6c"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a86193f4fa3cbfac3121d3222e0beaf6c">tend_pr_tot_th</a></td></tr>
<tr class="separator:a86193f4fa3cbfac3121d3222e0beaf6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4856c6b8bb3a1ff2244aab0251c7a293"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a4856c6b8bb3a1ff2244aab0251c7a293">tend_pr_tot_tabs</a></td></tr>
<tr class="separator:a4856c6b8bb3a1ff2244aab0251c7a293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eab866a95422869e463fcbb2ab80e58"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a9eab866a95422869e463fcbb2ab80e58">l_tend_pr_tot_th</a></td></tr>
<tr class="separator:a9eab866a95422869e463fcbb2ab80e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad95bdbfe8b671df6a109a64a452ffbb"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#aad95bdbfe8b671df6a109a64a452ffbb">l_tend_pr_tot_tabs</a></td></tr>
<tr class="separator:aad95bdbfe8b671df6a109a64a452ffbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b7521e09ca56f751cbc84e1bd7f7567"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a2b7521e09ca56f751cbc84e1bd7f7567">diagnostic_generation_frequency</a></td></tr>
<tr class="separator:a2b7521e09ca56f751cbc84e1bd7f7567"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Specific theta advection, which involves the vertical advection of reference state and advection of mean baroclinicity. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a7b19a797f5a9555cf25c4f97a6f53d54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b19a797f5a9555cf25c4f97a6f53d54">&#9670;&nbsp;</a></span>advection_of_mean_baroclinicity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine thadvection_mod::advection_of_mean_baroclinicity </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>local_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>local_x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs advection of the mean baroclinicity if appropriate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">local_y</td><td>The local Y of the column </td></tr>
    <tr><td class="paramname">local_x</td><td>The local X of the column </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00201">201</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: local_y, local_x</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">integer</span> :: k</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (l_advect_mean_baroclinicity) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;       <span class="keywordflow">if</span> (current_state%use_anelastic_equations) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="keywordflow">do</span> k=2, current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a>)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;             current_state%sth%data(k, local_y, local_x)=current_state%sth%data(k, local_y, local_x)+&amp;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                  current_state%global_grid%configuration%vertical%thref(k)*fcoriol_over_g*&amp;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                  ((current_state%v%data(k, local_y, local_x) + current_state%vgal) * rate_change_geostrophic_wind_x-&amp;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                  (current_state%u%data(k, local_y, local_x) + current_state%ugal) * rate_change_geostrophic_wind_y)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          <span class="keywordflow">do</span> k=2, current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a>)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;             current_state%sth%data(k, local_y, local_x)=current_state%sth%data(k, local_y, local_x)+&amp;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                  ((current_state%v%data(k, local_y, local_x) + current_state%vgal) * multiplicative_factor_x-&amp;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                  (current_state%u%data(k, local_y, local_x) + current_state%ugal) * multiplicative_factor_y)                    </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keywordflow">       end if</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_a7b19a797f5a9555cf25c4f97a6f53d54_icgraph.png" border="0" usemap="#anamespacethadvection__mod_a7b19a797f5a9555cf25c4f97a6f53d54_icgraph" alt=""/></div>
<map name="namespacethadvection__mod_a7b19a797f5a9555cf25c4f97a6f53d54_icgraph" id="anamespacethadvection__mod_a7b19a797f5a9555cf25c4f97a6f53d54_icgraph">
<area shape="rect" title="Performs advection of the mean baroclinicity if appropriate." alt="" coords="473,5,656,47"/>
<area shape="rect" href="namespacethadvection__mod.html#a09d1b793a23456817a68ec1c07c1257b" title="Timestep callback, will call the two separate procedures to do their advection if needed." alt="" coords="248,5,425,47"/>
<area shape="rect" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590" title="Provides a description of this component for the core to register." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<a id="acca0838c1d444d0a29a1b7ac211ae0ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acca0838c1d444d0a29a1b7ac211ae0ac">&#9670;&nbsp;</a></span>compute_component_tendencies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine thadvection_mod::compute_component_tendencies </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cyn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>txn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>tyn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computation of component tendencies. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>Current model state </td></tr>
    <tr><td class="paramname">cxn</td><td>The current slice, x, index </td></tr>
    <tr><td class="paramname">cyn</td><td>The current column, y, index. </td></tr>
    <tr><td class="paramname">txn</td><td>target_x_index </td></tr>
    <tr><td class="paramname">tyn</td><td>target_y_index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00254">254</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> ::  cxn, cyn, txn, tyn</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">! Calculate change in tendency due to component</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (l_tend_3d_th) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      tend_3d_th(:,tyn,txn)=current_state%sth%data(:,cyn,cxn)     - tend_3d_th(:,tyn,txn)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (l_tend_3d_tabs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      tend_3d_tabs(:,tyn,txn)=   &amp;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;       current_state%sth%data(:,cyn,cxn) * current_state%global_grid%configuration%vertical%rprefrcp(:)   &amp;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        - tend_3d_tabs(:,tyn,txn)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <span class="comment">! Add local tendency fields to the profile total</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (l_tend_pr_tot_th) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      tend_pr_tot_th(:)=tend_pr_tot_th(:) + tend_3d_th(:,tyn,txn)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (l_tend_pr_tot_tabs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      tend_pr_tot_tabs(:)=tend_pr_tot_tabs(:) + tend_3d_tabs(:,tyn,txn)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_acca0838c1d444d0a29a1b7ac211ae0ac_icgraph.png" border="0" usemap="#anamespacethadvection__mod_acca0838c1d444d0a29a1b7ac211ae0ac_icgraph" alt=""/></div>
<map name="namespacethadvection__mod_acca0838c1d444d0a29a1b7ac211ae0ac_icgraph" id="anamespacethadvection__mod_acca0838c1d444d0a29a1b7ac211ae0ac_icgraph">
<area shape="rect" title="Computation of component tendencies." alt="" coords="473,5,651,47"/>
<area shape="rect" href="namespacethadvection__mod.html#a09d1b793a23456817a68ec1c07c1257b" title="Timestep callback, will call the two separate procedures to do their advection if needed." alt="" coords="248,5,425,47"/>
<area shape="rect" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590" title="Provides a description of this component for the core to register." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<a id="a50aad1af96470f2debcd7a6191c6c110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50aad1af96470f2debcd7a6191c6c110">&#9670;&nbsp;</a></span>field_information_retrieval_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine thadvection_mod::field_information_retrieval_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmonc__component__mod_1_1component__field__information__type.html">component_field_information_type</a>), intent(out)&#160;</td>
          <td class="paramname"><em>field_information</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Field information retrieval callback, this returns information for a specific component's published field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>Current model state </td></tr>
    <tr><td class="paramname">name</td><td>The name of the field to retrieve information for </td></tr>
    <tr><td class="paramname">field_information</td><td>Populated with information about the field </td></tr>
    <tr><td class="paramname">strcomp</td><td>Starting index within 1st argument string that matches substring (2nd argument); 0 if not a match. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00284">284</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">type</span>(component_field_information_type), <span class="keywordtype">intent(out)</span> :: field_information</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">integer</span> :: strcomp</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">! Field information for 3d</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    strcomp=index(name, <span class="stringliteral">&quot;thadvection_3d_local&quot;</span>)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (strcomp .ne. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      field_information%field_type=component_array_field_type</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      field_information%number_dimensions=3</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      field_information%dimension_sizes(1)=current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a>)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      field_information%dimension_sizes(2)=current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">y_index</a>)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      field_information%dimension_sizes(3)=current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">x_index</a>)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      field_information%data_type=component_double_data_type</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">if</span> (name .eq. <span class="stringliteral">&quot;tend_th_thadvection_3d_local&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        field_information%enabled=l_tend_3d_th</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name .eq. <span class="stringliteral">&quot;tend_tabs_thadvection_3d_local&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        field_information%enabled=l_tend_3d_tabs</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        field_information%enabled=.true.</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordflow">    end if</span> <span class="comment">!end 3d check</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">! Field information for profiles</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    strcomp=index(name, <span class="stringliteral">&quot;thadvection_profile_total_local&quot;</span>)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> (strcomp .ne. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      field_information%field_type=component_array_field_type</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      field_information%number_dimensions=1</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      field_information%dimension_sizes(1)=current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a>)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      field_information%data_type=component_double_data_type</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">if</span> (name .eq. <span class="stringliteral">&quot;tend_th_thadvection_profile_total_local&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        field_information%enabled=l_tend_pr_tot_th</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name .eq. <span class="stringliteral">&quot;tend_tabs_thadvection_profile_total_local&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        field_information%enabled=l_tend_pr_tot_tabs</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        field_information%enabled=.true.</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordflow">    end if</span> <span class="comment">!end profile check</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_a50aad1af96470f2debcd7a6191c6c110_icgraph.png" border="0" usemap="#anamespacethadvection__mod_a50aad1af96470f2debcd7a6191c6c110_icgraph" alt=""/></div>
<map name="namespacethadvection__mod_a50aad1af96470f2debcd7a6191c6c110_icgraph" id="anamespacethadvection__mod_a50aad1af96470f2debcd7a6191c6c110_icgraph">
<area shape="rect" title="Field information retrieval callback, this returns information for a specific component&#39;s published f..." alt="" coords="248,5,399,61"/>
<area shape="rect" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590" title="Provides a description of this component for the core to register." alt="" coords="5,13,200,54"/>
</map>
</div>

</div>
</div>
<a id="a1a22c4e41063ea55633b24702d7fff4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a22c4e41063ea55633b24702d7fff4f">&#9670;&nbsp;</a></span>field_value_retrieval_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine thadvection_mod::field_value_retrieval_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmonc__component__mod_1_1component__field__value__type.html">component_field_value_type</a>), intent(out)&#160;</td>
          <td class="paramname"><em>field_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Field value retrieval callback, this returns the value of a specific published field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>Current model state </td></tr>
    <tr><td class="paramname">name</td><td>The name of the field to retrieve the value for </td></tr>
    <tr><td class="paramname">field_value</td><td>Populated with the value of the field </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00335">335</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: name</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">type</span>(component_field_value_type), <span class="keywordtype">intent(out)</span> :: field_value</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">! 3d Tendency Fields</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span> (name .eq. <span class="stringliteral">&quot;tend_th_thadvection_3d_local&quot;</span> .and. <span class="keyword">allocated</span>(tend_3d_th)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keyword">call </span>set_published_field_value(field_value, real_3d_field=tend_3d_th)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name .eq. <span class="stringliteral">&quot;tend_tabs_thadvection_3d_local&quot;</span> .and. <span class="keyword">allocated</span>(tend_3d_tabs)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keyword">call </span>set_published_field_value(field_value, real_3d_field=tend_3d_tabs)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">! Profile Tendency Fields</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name .eq. <span class="stringliteral">&quot;tend_th_thadvection_profile_total_local&quot;</span> .and. <span class="keyword">allocated</span>(tend_pr_tot_th)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keyword">call </span>set_published_field_value(field_value, real_1d_field=tend_pr_tot_th)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name .eq. <span class="stringliteral">&quot;tend_tabs_thadvection_profile_total_local&quot;</span> .and. <span class="keyword">allocated</span>(tend_pr_tot_tabs)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keyword">call </span>set_published_field_value(field_value, real_1d_field=tend_pr_tot_tabs)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_a1a22c4e41063ea55633b24702d7fff4f_cgraph.png" border="0" usemap="#anamespacethadvection__mod_a1a22c4e41063ea55633b24702d7fff4f_cgraph" alt=""/></div>
<map name="namespacethadvection__mod_a1a22c4e41063ea55633b24702d7fff4f_cgraph" id="anamespacethadvection__mod_a1a22c4e41063ea55633b24702d7fff4f_cgraph">
<area shape="rect" title="Field value retrieval callback, this returns the value of a specific published field." alt="" coords="5,5,173,47"/>
<area shape="rect" href="namespacethadvection__mod.html#ad95878bb451ea6f40760492bab2d3ccc" title="Sets the published field value from the temporary diagnostic values held by this component." alt="" coords="221,5,373,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_a1a22c4e41063ea55633b24702d7fff4f_icgraph.png" border="0" usemap="#anamespacethadvection__mod_a1a22c4e41063ea55633b24702d7fff4f_icgraph" alt=""/></div>
<map name="namespacethadvection__mod_a1a22c4e41063ea55633b24702d7fff4f_icgraph" id="anamespacethadvection__mod_a1a22c4e41063ea55633b24702d7fff4f_icgraph">
<area shape="rect" title="Field value retrieval callback, this returns the value of a specific published field." alt="" coords="248,5,416,47"/>
<area shape="rect" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590" title="Provides a description of this component for the core to register." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<a id="a6a4a9ea2a9012878a1e12ce6188e8191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a4a9ea2a9012878a1e12ce6188e8191">&#9670;&nbsp;</a></span>finalisation_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine thadvection_mod::finalisation_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00119">119</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(tend_3d_th)) <span class="keyword">deallocate</span>(tend_3d_th)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(tend_3d_tabs)) <span class="keyword">deallocate</span>(tend_3d_tabs)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(tend_pr_tot_th)) <span class="keyword">deallocate</span>(tend_pr_tot_th)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(tend_pr_tot_tabs)) <span class="keyword">deallocate</span>(tend_pr_tot_tabs)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_a6a4a9ea2a9012878a1e12ce6188e8191_icgraph.png" border="0" usemap="#anamespacethadvection__mod_a6a4a9ea2a9012878a1e12ce6188e8191_icgraph" alt=""/></div>
<map name="namespacethadvection__mod_a6a4a9ea2a9012878a1e12ce6188e8191_icgraph" id="anamespacethadvection__mod_a6a4a9ea2a9012878a1e12ce6188e8191_icgraph">
<area shape="rect" title=" " alt="" coords="248,5,436,47"/>
<area shape="rect" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590" title="Provides a description of this component for the core to register." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<a id="adf88aa826be438abd234748262372cee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf88aa826be438abd234748262372cee">&#9670;&nbsp;</a></span>initialisation_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine thadvection_mod::initialisation_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialisation callback to set up the variables and data needed by the component. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00060">60</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">!AH (08/02/18) - by default l_advect_mean_baroclinicity is false. It</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">!                is switch to true if passive_q true and baroclinicity_use_geostrophic_shear is true</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">!                If passive q is false code will run but a warning is issued.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">!                Mean advection of baroclinicity only works for dry case</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    baroclinicity_use_geostrophic_shear=<a class="code" href="namespaceoptionsdatabase__mod.html#aa3f0213d8028773523e6194a0ddf8e18">options_get_logical</a>(current_state%options_database, <span class="stringliteral">&quot;baroclinicity_use_geostrophic_shear&quot;</span>)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (baroclinicity_use_geostrophic_shear) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;       <span class="keywordflow">if</span> (current_state%passive_q) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          l_advect_mean_baroclinicity = .true.</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#a10e28447dd10ef9f92d205bc98fb26d3">log_warn</a>, <span class="stringliteral">&quot;The combination if baroclinicity and active q is not allowed, code will run but&quot;</span>// &amp; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;               <span class="stringliteral">&quot; no advection of mean baroclinicity&quot;</span>)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;          l_advect_mean_baroclinicity = .false.</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keywordflow">       endif</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    fcoriol=<a class="code" href="namespaceoptionsdatabase__mod.html#ab054641ac0fa0287adb3c461987c4f0b">options_get_real</a>(current_state%options_database, <span class="stringliteral">&quot;fcoriol&quot;</span>)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    rate_change_geostrophic_wind_x=<a class="code" href="namespaceoptionsdatabase__mod.html#ab054641ac0fa0287adb3c461987c4f0b">options_get_real</a>(current_state%options_database, <span class="stringliteral">&quot;rate_change_geostrophic_wind_x&quot;</span>)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    rate_change_geostrophic_wind_y=<a class="code" href="namespaceoptionsdatabase__mod.html#ab054641ac0fa0287adb3c461987c4f0b">options_get_real</a>(current_state%options_database, <span class="stringliteral">&quot;rate_change_geostrophic_wind_y&quot;</span>)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    fcoriol_over_g = fcoriol/g</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    multiplicative_factor_x=rate_change_geostrophic_wind_x*current_state%thref0*fcoriol_over_g</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    multiplicative_factor_y=rate_change_geostrophic_wind_y*current_state%thref0*fcoriol_over_g</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">! Set tendency diagnostic logicals based on availability</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">! Need to use 3d tendencies to compute the profiles, so they will be allocated</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">!      in the case where profiles are available</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    l_tend_pr_tot_th  = current_state%th%active </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    l_tend_pr_tot_tabs  = l_tend_pr_tot_th</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    l_tend_3d_th  = current_state%th%active .or. l_tend_pr_tot_th</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    l_tend_3d_tabs = l_tend_3d_th</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">! Allocate 3d tendency fields upon availability</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span> (l_tend_3d_th) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keyword">allocate</span>( tend_3d_th(current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a>),  &amp;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                           current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">y_index</a>),  &amp;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                           current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">x_index</a>)   )    )</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (l_tend_3d_tabs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keyword">allocate</span>( tend_3d_tabs(current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a>),  &amp;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                             current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">y_index</a>),  &amp;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                             current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">x_index</a>)   )    )</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">! Allocate profile tendency fields upon availability</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (l_tend_pr_tot_th) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keyword">allocate</span>( tend_pr_tot_th(current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a>)) )</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (l_tend_pr_tot_tabs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keyword">allocate</span>( tend_pr_tot_tabs(current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a>)) )</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">! Save the sampling_frequency to force diagnostic calculation on select time steps</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    diagnostic_generation_frequency=<a class="code" href="namespaceoptionsdatabase__mod.html#ae6f0a2a95fcacd3491b7b8fdb161e022">options_get_integer</a>(current_state%options_database, <span class="stringliteral">&quot;sampling_frequency&quot;</span>)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_adf88aa826be438abd234748262372cee_icgraph.png" border="0" usemap="#anamespacethadvection__mod_adf88aa826be438abd234748262372cee_icgraph" alt=""/></div>
<map name="namespacethadvection__mod_adf88aa826be438abd234748262372cee_icgraph" id="anamespacethadvection__mod_adf88aa826be438abd234748262372cee_icgraph">
<area shape="rect" title="Initialisation callback to set up the variables and data needed by the component." alt="" coords="248,5,443,47"/>
<area shape="rect" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590" title="Provides a description of this component for the core to register." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<a id="af414b9967eb65e448d9d937f84076a6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af414b9967eb65e448d9d937f84076a6a">&#9670;&nbsp;</a></span>save_precomponent_tendencies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine thadvection_mod::save_precomponent_tendencies </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cyn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>txn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>tyn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save the 3d tendencies coming into the component. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>Current model state </td></tr>
    <tr><td class="paramname">cxn</td><td>The current slice, x, index </td></tr>
    <tr><td class="paramname">cyn</td><td>The current column, y, index. </td></tr>
    <tr><td class="paramname">txn</td><td>target_x_index </td></tr>
    <tr><td class="paramname">tyn</td><td>target_y_index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00233">233</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: current_state</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> ::  cxn, cyn, txn, tyn</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">! Save 3d tendency fields upon request (of 3d or profiles) and availability</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (l_tend_3d_th) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      tend_3d_th(:,tyn,txn)=current_state%sth%data(:,cyn,cxn)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (l_tend_3d_tabs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      tend_3d_tabs(:,tyn,txn)=current_state%sth%data(:,cyn,cxn) * current_state%global_grid%configuration%vertical%rprefrcp(:)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_af414b9967eb65e448d9d937f84076a6a_icgraph.png" border="0" usemap="#anamespacethadvection__mod_af414b9967eb65e448d9d937f84076a6a_icgraph" alt=""/></div>
<map name="namespacethadvection__mod_af414b9967eb65e448d9d937f84076a6a_icgraph" id="anamespacethadvection__mod_af414b9967eb65e448d9d937f84076a6a_icgraph">
<area shape="rect" title="Save the 3d tendencies coming into the component." alt="" coords="473,5,655,47"/>
<area shape="rect" href="namespacethadvection__mod.html#a09d1b793a23456817a68ec1c07c1257b" title="Timestep callback, will call the two separate procedures to do their advection if needed." alt="" coords="248,5,425,47"/>
<area shape="rect" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590" title="Provides a description of this component for the core to register." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<a id="ad95878bb451ea6f40760492bab2d3ccc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad95878bb451ea6f40760492bab2d3ccc">&#9670;&nbsp;</a></span>set_published_field_value()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine thadvection_mod::set_published_field_value </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmonc__component__mod_1_1component__field__value__type.html">component_field_value_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>field_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:), optional&#160;</td>
          <td class="paramname"><em>real_1d_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:), optional&#160;</td>
          <td class="paramname"><em>real_2d_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), optional&#160;</td>
          <td class="paramname"><em>real_3d_field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the published field value from the temporary diagnostic values held by this component. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field_value</td><td>Populated with the value of the field </td></tr>
    <tr><td class="paramname">real_1d_field</td><td>Optional one dimensional real of values to publish </td></tr>
    <tr><td class="paramname">real_2d_field</td><td>Optional two dimensional real of values to publish </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00360">360</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordtype">type</span>(component_field_value_type), <span class="keywordtype">intent(inout)</span> :: field_value</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span> :: real_1d_field</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">optional</span> :: real_2d_field</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">optional</span> :: real_3d_field</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(real_1d_field)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keyword">allocate</span>(field_value%real_1d_array(<span class="keyword">size</span>(real_1d_field)), source=real_1d_field)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">present</span>(real_2d_field)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keyword">allocate</span>(field_value%real_2d_array(<span class="keyword">size</span>(real_2d_field, 1), <span class="keyword">size</span>(real_2d_field, 2)), source=real_2d_field)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">present</span>(real_3d_field)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keyword">allocate</span>(field_value%real_3d_array(<span class="keyword">size</span>(real_3d_field, 1), <span class="keyword">size</span>(real_3d_field, 2), <span class="keyword">size</span>(real_3d_field, 3)), &amp;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;               source=real_3d_field)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_ad95878bb451ea6f40760492bab2d3ccc_icgraph.png" border="0" usemap="#anamespacethadvection__mod_ad95878bb451ea6f40760492bab2d3ccc_icgraph" alt=""/></div>
<map name="namespacethadvection__mod_ad95878bb451ea6f40760492bab2d3ccc_icgraph" id="anamespacethadvection__mod_ad95878bb451ea6f40760492bab2d3ccc_icgraph">
<area shape="rect" title="Sets the published field value from the temporary diagnostic values held by this component." alt="" coords="464,5,616,47"/>
<area shape="rect" href="namespacethadvection__mod.html#a1a22c4e41063ea55633b24702d7fff4f" title="Field value retrieval callback, this returns the value of a specific published field." alt="" coords="248,5,416,47"/>
<area shape="rect" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590" title="Provides a description of this component for the core to register." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<a id="aa3a66036a48786d8846a242110e96590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3a66036a48786d8846a242110e96590">&#9670;&nbsp;</a></span>thadvection_get_descriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structmonc__component__mod_1_1component__descriptor__type.html">component_descriptor_type</a>) function, public thadvection_mod::thadvection_get_descriptor</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provides a description of this component for the core to register. </p>
<dl class="section return"><dt>Returns</dt><dd>The descriptor containing registration information for this component </dd></dl>

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00039">39</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    thadvection_get_descriptor%name=<span class="stringliteral">&quot;th_advection&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    thadvection_get_descriptor%version=0.1</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    thadvection_get_descriptor%initialisation=&gt;initialisation_callback</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    thadvection_get_descriptor%timestep=&gt;timestep_callback</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    thadvection_get_descriptor%finalisation=&gt;finalisation_callback</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    thadvection_get_descriptor%field_value_retrieval=&gt;field_value_retrieval_callback</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    thadvection_get_descriptor%field_information_retrieval=&gt;field_information_retrieval_callback</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">allocate</span>(thadvection_get_descriptor%published_fields(2+2))</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    thadvection_get_descriptor%published_fields(1)= <span class="stringliteral">&quot;tend_th_thadvection_3d_local&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    thadvection_get_descriptor%published_fields(2)= <span class="stringliteral">&quot;tend_tabs_thadvection_3d_local&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    thadvection_get_descriptor%published_fields(2+1)= <span class="stringliteral">&quot;tend_th_thadvection_profile_total_local&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    thadvection_get_descriptor%published_fields(2+2)= <span class="stringliteral">&quot;tend_tabs_thadvection_profile_total_local&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_aa3a66036a48786d8846a242110e96590_cgraph.png" border="0" usemap="#anamespacethadvection__mod_aa3a66036a48786d8846a242110e96590_cgraph" alt=""/></div>
<map name="namespacethadvection__mod_aa3a66036a48786d8846a242110e96590_cgraph" id="anamespacethadvection__mod_aa3a66036a48786d8846a242110e96590_cgraph">
<area shape="rect" title="Provides a description of this component for the core to register." alt="" coords="5,150,200,191"/>
<area shape="rect" href="namespacethadvection__mod.html#a50aad1af96470f2debcd7a6191c6c110" title="Field information retrieval callback, this returns information for a specific component&#39;s published f..." alt="" coords="270,5,421,61"/>
<area shape="rect" href="namespacethadvection__mod.html#a1a22c4e41063ea55633b24702d7fff4f" title="Field value retrieval callback, this returns the value of a specific published field." alt="" coords="261,85,429,126"/>
<area shape="rect" href="namespacethadvection__mod.html#a6a4a9ea2a9012878a1e12ce6188e8191" title=" " alt="" coords="251,150,439,191"/>
<area shape="rect" href="namespacethadvection__mod.html#adf88aa826be438abd234748262372cee" title="Initialisation callback to set up the variables and data needed by the component." alt="" coords="248,215,443,257"/>
<area shape="rect" href="namespacethadvection__mod.html#a09d1b793a23456817a68ec1c07c1257b" title="Timestep callback, will call the two separate procedures to do their advection if needed." alt="" coords="257,281,434,322"/>
<area shape="rect" href="namespacethadvection__mod.html#ad95878bb451ea6f40760492bab2d3ccc" title="Sets the published field value from the temporary diagnostic values held by this component." alt="" coords="515,85,667,126"/>
<area shape="rect" href="namespacethadvection__mod.html#a7b19a797f5a9555cf25c4f97a6f53d54" title="Performs advection of the mean baroclinicity if appropriate." alt="" coords="499,182,682,223"/>
<area shape="rect" href="namespacethadvection__mod.html#acca0838c1d444d0a29a1b7ac211ae0ac" title="Computation of component tendencies." alt="" coords="502,247,679,289"/>
<area shape="rect" href="namespacethadvection__mod.html#af414b9967eb65e448d9d937f84076a6a" title="Save the 3d tendencies coming into the component." alt="" coords="500,313,681,354"/>
<area shape="rect" href="namespacethadvection__mod.html#aadad7cf391b176d99be59815af29feb6" title="Vertical advection of the reference state. It doesn&#39;t seem consistent to do the advection in this way..." alt="" coords="491,378,691,419"/>
</map>
</div>

</div>
</div>
<a id="a09d1b793a23456817a68ec1c07c1257b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09d1b793a23456817a68ec1c07c1257b">&#9670;&nbsp;</a></span>timestep_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine thadvection_mod::timestep_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Timestep callback, will call the two separate procedures to do their advection if needed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">target_(x/y)_index</td><td>This is the index with the halos subtracted. This is needed so that diagnostic does not include halos and to prevent array out-of-bounds </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00135">135</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">integer</span> :: current_x_index, current_y_index, target_x_index, target_y_index</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    current_x_index=current_state%column_local_x</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    current_y_index=current_state%column_local_y</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    target_y_index=current_y_index-current_state%local_grid%halo_size(<a class="code" href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">y_index</a>)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    target_x_index=current_x_index-current_state%local_grid%halo_size(<a class="code" href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">x_index</a>)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">! Zero profile tendency totals on first instance in the sum</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (current_state%first_timestep_column) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">if</span> (l_tend_pr_tot_th) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        tend_pr_tot_th(:)=0.0_default_precision</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">if</span> (l_tend_pr_tot_tabs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        tend_pr_tot_tabs(:)=0.0_default_precision</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordflow">    endif</span>  <span class="comment">! zero totals</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">if</span> (mod(current_state%timestep, diagnostic_generation_frequency) == 0 .and. .not. current_state%halo_column) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keyword">call </span>save_precomponent_tendencies(current_state, current_x_index, current_y_index, target_x_index, target_y_index)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">call </span>vertical_advection_of_reference_state(current_state, current_state%column_local_y, current_state%column_local_x)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">call </span>advection_of_mean_baroclinicity(current_state, current_state%column_local_y, current_state%column_local_x)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (mod(current_state%timestep, diagnostic_generation_frequency) == 0 .and. .not. current_state%halo_column) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keyword">call </span>compute_component_tendencies(current_state, current_x_index, current_y_index, target_x_index, target_y_index)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_a09d1b793a23456817a68ec1c07c1257b_cgraph.png" border="0" usemap="#anamespacethadvection__mod_a09d1b793a23456817a68ec1c07c1257b_cgraph" alt=""/></div>
<map name="namespacethadvection__mod_a09d1b793a23456817a68ec1c07c1257b_cgraph" id="anamespacethadvection__mod_a09d1b793a23456817a68ec1c07c1257b_cgraph">
<area shape="rect" title="Timestep callback, will call the two separate procedures to do their advection if needed." alt="" coords="5,104,183,145"/>
<area shape="rect" href="namespacethadvection__mod.html#a7b19a797f5a9555cf25c4f97a6f53d54" title="Performs advection of the mean baroclinicity if appropriate." alt="" coords="239,5,422,47"/>
<area shape="rect" href="namespacethadvection__mod.html#acca0838c1d444d0a29a1b7ac211ae0ac" title="Computation of component tendencies." alt="" coords="242,71,419,112"/>
<area shape="rect" href="namespacethadvection__mod.html#af414b9967eb65e448d9d937f84076a6a" title="Save the 3d tendencies coming into the component." alt="" coords="240,136,421,177"/>
<area shape="rect" href="namespacethadvection__mod.html#aadad7cf391b176d99be59815af29feb6" title="Vertical advection of the reference state. It doesn&#39;t seem consistent to do the advection in this way..." alt="" coords="231,201,431,243"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_a09d1b793a23456817a68ec1c07c1257b_icgraph.png" border="0" usemap="#anamespacethadvection__mod_a09d1b793a23456817a68ec1c07c1257b_icgraph" alt=""/></div>
<map name="namespacethadvection__mod_a09d1b793a23456817a68ec1c07c1257b_icgraph" id="anamespacethadvection__mod_a09d1b793a23456817a68ec1c07c1257b_icgraph">
<area shape="rect" title="Timestep callback, will call the two separate procedures to do their advection if needed." alt="" coords="248,5,425,47"/>
<area shape="rect" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590" title="Provides a description of this component for the core to register." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<a id="aadad7cf391b176d99be59815af29feb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadad7cf391b176d99be59815af29feb6">&#9670;&nbsp;</a></span>vertical_advection_of_reference_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine thadvection_mod::vertical_advection_of_reference_state </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>local_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>local_x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vertical advection of the reference state. It doesn't seem consistent to do the advection in this way if TVD advection of the deviation from the reference state has been selected. Separate vertical advection of the reference state was introduced to improve energy conservation when carrying out idealized gravity wave simulations in a deep, dry isothermal layer, for which the difference in potential temp between top and bottom was of order 100K. In less extreme cases the benefits are unlikely to be significant and with TVD advection energy conservation has been compromised so the best way forward might be to recombine the reference state into l_th. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">local_y</td><td>The local Y of the column </td></tr>
    <tr><td class="paramname">local_x</td><td>The local X of the column </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00177">177</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: local_y, local_x</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">integer</span> :: k</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: sctmp1, sctmp2</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span> (current_state%use_anelastic_equations) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="comment">! This code only needs to be executed if anelastic, otherwise THREF is constant and the increment calculated here is zero</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordflow">do</span> k=2, current_state%local_grid%size(<a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a>)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        sctmp1=current_state%global_grid%configuration%vertical%tzc1(k)*2.0_default_precision*&amp;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;             current_state%global_grid%configuration%vertical%dthref(k-1)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        sctmp2=current_state%global_grid%configuration%vertical%tzc2(k)*2.0_default_precision*&amp;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;             current_state%global_grid%configuration%vertical%dthref(k)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        current_state%sth%data(k, local_y, local_x)=current_state%sth%data(k, local_y, local_x)-(sctmp1*&amp;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;             current_state%w%data(k-1, local_y, local_x) + sctmp2*current_state%w%data(k, local_y, local_x))</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacethadvection__mod_aadad7cf391b176d99be59815af29feb6_icgraph.png" border="0" usemap="#anamespacethadvection__mod_aadad7cf391b176d99be59815af29feb6_icgraph" alt=""/></div>
<map name="namespacethadvection__mod_aadad7cf391b176d99be59815af29feb6_icgraph" id="anamespacethadvection__mod_aadad7cf391b176d99be59815af29feb6_icgraph">
<area shape="rect" title="Vertical advection of the reference state. It doesn&#39;t seem consistent to do the advection in this way..." alt="" coords="473,5,673,47"/>
<area shape="rect" href="namespacethadvection__mod.html#a09d1b793a23456817a68ec1c07c1257b" title="Timestep callback, will call the two separate procedures to do their advection if needed." alt="" coords="248,5,425,47"/>
<area shape="rect" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590" title="Provides a description of this component for the core to register." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6890b280d0a038bed4334ff74c8b5df3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6890b280d0a038bed4334ff74c8b5df3">&#9670;&nbsp;</a></span>baroclinicity_use_geostrophic_shear</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical thadvection_mod::baroclinicity_use_geostrophic_shear</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00018">18</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="keywordtype">logical</span> :: baroclinicity_use_geostrophic_shear</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b7521e09ca56f751cbc84e1bd7f7567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b7521e09ca56f751cbc84e1bd7f7567">&#9670;&nbsp;</a></span>diagnostic_generation_frequency</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer thadvection_mod::diagnostic_generation_frequency</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00031">31</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">integer</span> :: diagnostic_generation_frequency</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae567a1be5c97cc52df73ecfddf08b740"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae567a1be5c97cc52df73ecfddf08b740">&#9670;&nbsp;</a></span>fcoriol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) thadvection_mod::fcoriol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00020">20</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keywordtype">  real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: fcoriol, fcoriol_over_g, rate_change_geostrophic_wind_x, rate_change_geostrophic_wind_y, &amp;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;       multiplicative_factor_x, multiplicative_factor_y</div>
</div><!-- fragment -->
</div>
</div>
<a id="a40d7220f01227627b9d0ce1f70b3ce95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40d7220f01227627b9d0ce1f70b3ce95">&#9670;&nbsp;</a></span>fcoriol_over_g</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) thadvection_mod::fcoriol_over_g</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00020">20</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>

</div>
</div>
<a id="aa0c194ec186fb01867184f7783a93f17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c194ec186fb01867184f7783a93f17">&#9670;&nbsp;</a></span>l_advect_mean_baroclinicity</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical thadvection_mod::l_advect_mean_baroclinicity</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00019">19</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordtype">logical</span> :: l_advect_mean_baroclinicity</div>
</div><!-- fragment -->
</div>
</div>
<a id="adaa019cd3b36ae4c3183dfe5658aa23a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaa019cd3b36ae4c3183dfe5658aa23a">&#9670;&nbsp;</a></span>l_tend_3d_tabs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical thadvection_mod::l_tend_3d_tabs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00026">26</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>

</div>
</div>
<a id="abccca55f73e9fed3304b036c885ffbb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abccca55f73e9fed3304b036c885ffbb9">&#9670;&nbsp;</a></span>l_tend_3d_th</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical thadvection_mod::l_tend_3d_th</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00026">26</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">logical</span> :: l_tend_3d_th, l_tend_3d_tabs</div>
</div><!-- fragment -->
</div>
</div>
<a id="aad95bdbfe8b671df6a109a64a452ffbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad95bdbfe8b671df6a109a64a452ffbb">&#9670;&nbsp;</a></span>l_tend_pr_tot_tabs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical thadvection_mod::l_tend_pr_tot_tabs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00029">29</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>

</div>
</div>
<a id="a9eab866a95422869e463fcbb2ab80e58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9eab866a95422869e463fcbb2ab80e58">&#9670;&nbsp;</a></span>l_tend_pr_tot_th</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical thadvection_mod::l_tend_pr_tot_th</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00029">29</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">logical</span> :: l_tend_pr_tot_th, l_tend_pr_tot_tabs</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab9100518570437cd458a1c0f19fe8671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9100518570437cd458a1c0f19fe8671">&#9670;&nbsp;</a></span>multiplicative_factor_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) thadvection_mod::multiplicative_factor_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00020">20</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>

</div>
</div>
<a id="a788224a6b535c10c26ee9280cd488ae3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a788224a6b535c10c26ee9280cd488ae3">&#9670;&nbsp;</a></span>multiplicative_factor_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) thadvection_mod::multiplicative_factor_y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00020">20</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>

</div>
</div>
<a id="a8bdc24a4de0deeab1e464fe26a811e7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bdc24a4de0deeab1e464fe26a811e7b">&#9670;&nbsp;</a></span>rate_change_geostrophic_wind_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) thadvection_mod::rate_change_geostrophic_wind_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00020">20</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>

</div>
</div>
<a id="a3f761e0495b03da85f5c95dba870eb74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f761e0495b03da85f5c95dba870eb74">&#9670;&nbsp;</a></span>rate_change_geostrophic_wind_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) thadvection_mod::rate_change_geostrophic_wind_y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00020">20</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>

</div>
</div>
<a id="ac45e02b9e66c20e3fdbc3aaec01d7a6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac45e02b9e66c20e3fdbc3aaec01d7a6a">&#9670;&nbsp;</a></span>tend_3d_tabs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), allocatable thadvection_mod::tend_3d_tabs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00025">25</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>

</div>
</div>
<a id="a4d17dd15447010be07b7c20e07aa13fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d17dd15447010be07b7c20e07aa13fb">&#9670;&nbsp;</a></span>tend_3d_th</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), allocatable thadvection_mod::tend_3d_th</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00025">25</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keywordtype">  real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span> :: tend_3d_th, tend_3d_tabs</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4856c6b8bb3a1ff2244aab0251c7a293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4856c6b8bb3a1ff2244aab0251c7a293">&#9670;&nbsp;</a></span>tend_pr_tot_tabs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:), allocatable thadvection_mod::tend_pr_tot_tabs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00028">28</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>

</div>
</div>
<a id="a86193f4fa3cbfac3121d3222e0beaf6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86193f4fa3cbfac3121d3222e0beaf6c">&#9670;&nbsp;</a></span>tend_pr_tot_th</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:), allocatable thadvection_mod::tend_pr_tot_th</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thadvection_8F90_source.html#l00028">28</a> of file <a class="el" href="thadvection_8F90_source.html">thadvection.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keywordtype">  real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> ::     tend_pr_tot_th, tend_pr_tot_tabs</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="anamespacelogging__mod_html_a10e28447dd10ef9f92d205bc98fb26d3"><div class="ttname"><a href="namespacelogging__mod.html#a10e28447dd10ef9f92d205bc98fb26d3">logging_mod::log_warn</a></div><div class="ttdeci">integer, parameter, public log_warn</div><div class="ttdoc">Log WARNING and ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00012">logging.F90:12</a></div></div>
<div class="ttc" id="anamespacegrids__mod_html_ab478bbfee0dae6b2e13f3a5eb85be214"><div class="ttname"><a href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">grids_mod::x_index</a></div><div class="ttdeci">integer, parameter, public x_index</div><div class="ttdef"><b>Definition:</b> <a href="grids_8F90_source.html#l00014">grids.F90:14</a></div></div>
<div class="ttc" id="anamespaceoptionsdatabase__mod_html_ae6f0a2a95fcacd3491b7b8fdb161e022"><div class="ttname"><a href="namespaceoptionsdatabase__mod.html#ae6f0a2a95fcacd3491b7b8fdb161e022">optionsdatabase_mod::options_get_integer</a></div><div class="ttdeci">integer function, public options_get_integer(options_database, key, index)</div><div class="ttdoc">Retrieves an integer value from the database that matches the provided key.</div><div class="ttdef"><b>Definition:</b> <a href="optionsdatabase_8F90_source.html#l00216">optionsdatabase.F90:217</a></div></div>
<div class="ttc" id="anamespacegrids__mod_html_aa0e3f2f5767ed33c4b47a761c2af171a"><div class="ttname"><a href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">grids_mod::y_index</a></div><div class="ttdeci">integer, parameter, public y_index</div><div class="ttdef"><b>Definition:</b> <a href="grids_8F90_source.html#l00014">grids.F90:14</a></div></div>
<div class="ttc" id="anamespacegrids__mod_html_aa1eee0ed41ef0446ae1a6155b78a2239"><div class="ttname"><a href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">grids_mod::z_index</a></div><div class="ttdeci">integer, parameter, public z_index</div><div class="ttdoc">Grid index parameters.</div><div class="ttdef"><b>Definition:</b> <a href="grids_8F90_source.html#l00014">grids.F90:14</a></div></div>
<div class="ttc" id="anamespaceoptionsdatabase__mod_html_aa3f0213d8028773523e6194a0ddf8e18"><div class="ttname"><a href="namespaceoptionsdatabase__mod.html#aa3f0213d8028773523e6194a0ddf8e18">optionsdatabase_mod::options_get_logical</a></div><div class="ttdeci">logical function, public options_get_logical(options_database, key, index)</div><div class="ttdoc">Retrieves a logical value from the database that matches the provided key.</div><div class="ttdef"><b>Definition:</b> <a href="optionsdatabase_8F90_source.html#l00153">optionsdatabase.F90:154</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ad95937a250467334622daeb5cff78c20"><div class="ttname"><a href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">logging_mod::log_master_log</a></div><div class="ttdeci">subroutine, public log_master_log(level, message)</div><div class="ttdoc">Will log just from the master process.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00046">logging.F90:47</a></div></div>
<div class="ttc" id="anamespaceoptionsdatabase__mod_html_ab054641ac0fa0287adb3c461987c4f0b"><div class="ttname"><a href="namespaceoptionsdatabase__mod.html#ab054641ac0fa0287adb3c461987c4f0b">optionsdatabase_mod::options_get_real</a></div><div class="ttdeci">real(kind=default_precision) function, public options_get_real(options_database, key, index)</div><div class="ttdoc">Retrieves a real value from the database that matches the provided key.</div><div class="ttdef"><b>Definition:</b> <a href="optionsdatabase_8F90_source.html#l00090">optionsdatabase.F90:91</a></div></div>
<div class="ttc" id="anamespacedatadefn__mod_html_a39b79f8cc843d236d3b47f5c81b64368"><div class="ttname"><a href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">datadefn_mod::default_precision</a></div><div class="ttdeci">integer, parameter, public default_precision</div><div class="ttdoc">MPI communication type which we use for the prognostic and calculation data.</div><div class="ttdef"><b>Definition:</b> <a href="datadefn_8F90_source.html#l00017">datadefn.F90:17</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

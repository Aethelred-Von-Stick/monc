<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: petsc_solver_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">petsc_solver_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>PETSc solver component to call out to PETSc for solving the Poisson equation for pressure.  
<a href="namespacepetsc__solver__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a451a0b7c857bd1c9a88afcb53784952a"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structmonc__component__mod_1_1component__descriptor__type.html">component_descriptor_type</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a">petsc_solver_get_descriptor</a> ()</td></tr>
<tr class="memdesc:a451a0b7c857bd1c9a88afcb53784952a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides the descriptor back to the caller and is used in component registration.  <a href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a">More...</a><br /></td></tr>
<tr class="separator:a451a0b7c857bd1c9a88afcb53784952a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16254aead68a763822c781f41feccf6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#ab16254aead68a763822c781f41feccf6">finalisation_callback</a> (current_state)</td></tr>
<tr class="separator:ab16254aead68a763822c781f41feccf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf2548341733155ba725373a96aef324"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#adf2548341733155ba725373a96aef324">init_callback</a> (current_state)</td></tr>
<tr class="memdesc:adf2548341733155ba725373a96aef324"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called upon model initialisation. Will basically read from the options database and set options in the database that are appropriate.  <a href="namespacepetsc__solver__mod.html#adf2548341733155ba725373a96aef324">More...</a><br /></td></tr>
<tr class="separator:adf2548341733155ba725373a96aef324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9c7894bec162985659cb8ef37b9cc2b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#ac9c7894bec162985659cb8ef37b9cc2b">ksp_monitor</a> (ksp, n, rnorm, dummy, ierr)</td></tr>
<tr class="memdesc:ac9c7894bec162985659cb8ef37b9cc2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Monitor procedure called on each iteration, this is provided only at debugging level.  <a href="namespacepetsc__solver__mod.html#ac9c7894bec162985659cb8ef37b9cc2b">More...</a><br /></td></tr>
<tr class="separator:ac9c7894bec162985659cb8ef37b9cc2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33751edb5b5265c8753e6034a62a15f4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a33751edb5b5265c8753e6034a62a15f4">timestep_callback</a> (current_state)</td></tr>
<tr class="memdesc:a33751edb5b5265c8753e6034a62a15f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestep hook which is called at each timestep to solve the pressure equation via PETSc. This will call to set and precondition the matrix on the first call (first timestep) only, and will set the RHS and X initial guess on each call as one would expect. At the end a halo swap is performed on p, which is needed for pstep.  <a href="namespacepetsc__solver__mod.html#a33751edb5b5265c8753e6034a62a15f4">More...</a><br /></td></tr>
<tr class="separator:a33751edb5b5265c8753e6034a62a15f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a046b3b5a00b4292d6ee39f569ebf2999"><td class="memItemLeft" align="right" valign="top">character(len=string_length) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a046b3b5a00b4292d6ee39f569ebf2999">determine_convegence_reason</a> (r_code)</td></tr>
<tr class="separator:a046b3b5a00b4292d6ee39f569ebf2999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c8a2ef7386643bd39d313d6aaf3363"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a93c8a2ef7386643bd39d313d6aaf3363">compute_initial_guess</a> (ksp, x, dummy, ierr)</td></tr>
<tr class="memdesc:a93c8a2ef7386643bd39d313d6aaf3363"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the initial guess, this is called from within PETSc and sets it to be the last value of P or zero if it is the first timestep.  <a href="namespacepetsc__solver__mod.html#a93c8a2ef7386643bd39d313d6aaf3363">More...</a><br /></td></tr>
<tr class="separator:a93c8a2ef7386643bd39d313d6aaf3363"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addbf44c53a577676daf2d99eb9c35160"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#addbf44c53a577676daf2d99eb9c35160">compute_rhs</a> (ksp, b, dummy, ierr)</td></tr>
<tr class="memdesc:addbf44c53a577676daf2d99eb9c35160"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback issued from the PETSc library to compute the RHS, this is called every timestep (as we have a different RHS)  <a href="namespacepetsc__solver__mod.html#addbf44c53a577676daf2d99eb9c35160">More...</a><br /></td></tr>
<tr class="separator:addbf44c53a577676daf2d99eb9c35160"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b88521612a1ff15c57aea2aa6dc5b68"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a7b88521612a1ff15c57aea2aa6dc5b68">copy_data_to_petsc_pointer</a> (x, zs, ys, xs, zm, ym, xm, src_values)</td></tr>
<tr class="memdesc:a7b88521612a1ff15c57aea2aa6dc5b68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies data into a data pointer which is provided by PETSc, doing it this ways allows us to give a shape to the pointer data and hence the data copy is simpler code wise.  <a href="namespacepetsc__solver__mod.html#a7b88521612a1ff15c57aea2aa6dc5b68">More...</a><br /></td></tr>
<tr class="separator:a7b88521612a1ff15c57aea2aa6dc5b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af59bc98b1fd5158fc880a6d900f57ff6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#af59bc98b1fd5158fc880a6d900f57ff6">copy_petsc_pointer_to_data</a> (x, z_start_idx, z_end_idx, y_start_idx, y_end_idx, x_start_idx, x_end_idx, target_values)</td></tr>
<tr class="memdesc:af59bc98b1fd5158fc880a6d900f57ff6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the data in a pointer that was provided by PETSc into some target data, doing it this way means we can give a shape to the pointer.  <a href="namespacepetsc__solver__mod.html#af59bc98b1fd5158fc880a6d900f57ff6">More...</a><br /></td></tr>
<tr class="separator:af59bc98b1fd5158fc880a6d900f57ff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b88c61d1e0c123d20dbe75c4bb83bb6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a2b88c61d1e0c123d20dbe75c4bb83bb6">compute_matrix</a> (ksp, A, B, dummy, ierr)</td></tr>
<tr class="memdesc:a2b88c61d1e0c123d20dbe75c4bb83bb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call back issued from within PETSc to create the matrix, this is only called once (the first PETSc run)  <a href="namespacepetsc__solver__mod.html#a2b88c61d1e0c123d20dbe75c4bb83bb6">More...</a><br /></td></tr>
<tr class="separator:a2b88c61d1e0c123d20dbe75c4bb83bb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a134894de62b094c42364e7ccfaba02"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a7a134894de62b094c42364e7ccfaba02">apply_dimension_bounds</a> (dim_size, dim_processes, length_array)</td></tr>
<tr class="memdesc:a7a134894de62b094c42364e7ccfaba02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies dimension bounds to determine the number of elements held locally for each process in that dimension.  <a href="namespacepetsc__solver__mod.html#a7a134894de62b094c42364e7ccfaba02">More...</a><br /></td></tr>
<tr class="separator:a7a134894de62b094c42364e7ccfaba02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b3240293d99bab7de6b5d6ece1342f1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a1b3240293d99bab7de6b5d6ece1342f1">complete_psrce_calculation</a> (current_state, y_halo_size, x_halo_size)</td></tr>
<tr class="memdesc:a1b3240293d99bab7de6b5d6ece1342f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Completes the psrce calculation by waiting on all outstanding psrce communications to complete and then combine the received values with the P field for U and V.  <a href="namespacepetsc__solver__mod.html#a1b3240293d99bab7de6b5d6ece1342f1">More...</a><br /></td></tr>
<tr class="separator:a1b3240293d99bab7de6b5d6ece1342f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab4576f6323bb0b7f34bfd32cfada9db"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#aab4576f6323bb0b7f34bfd32cfada9db">copy_p_to_halo_buffer</a> (current_state, neighbour_description, dim, source_index, pid_location, current_page, source_data)</td></tr>
<tr class="memdesc:aab4576f6323bb0b7f34bfd32cfada9db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the p field data to halo buffers for a specific process in a dimension and halo cell.  <a href="namespacepetsc__solver__mod.html#aab4576f6323bb0b7f34bfd32cfada9db">More...</a><br /></td></tr>
<tr class="separator:aab4576f6323bb0b7f34bfd32cfada9db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d3a3c93a05d87d97e38d81e09eba9c6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a3d3a3c93a05d87d97e38d81e09eba9c6">copy_halo_buffer_to_p</a> (current_state, neighbour_description, dim, target_index, neighbour_location, current_page, source_data)</td></tr>
<tr class="separator:a3d3a3c93a05d87d97e38d81e09eba9c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72645c0726f01a37b5a5f4c016b9e51d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a72645c0726f01a37b5a5f4c016b9e51d">perform_local_data_copy_for_p</a> (current_state, halo_depth, involve_corners, source_data)</td></tr>
<tr class="memdesc:a72645c0726f01a37b5a5f4c016b9e51d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does local data copying for P variable halo swap.  <a href="namespacepetsc__solver__mod.html#a72645c0726f01a37b5a5f4c016b9e51d">More...</a><br /></td></tr>
<tr class="separator:a72645c0726f01a37b5a5f4c016b9e51d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad3c6adbda077c8f90dbd9aae609409a8"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#ad3c6adbda077c8f90dbd9aae609409a8">z_start</a></td></tr>
<tr class="separator:ad3c6adbda077c8f90dbd9aae609409a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46c7d73ab716ad3f636d6f06dc2d16cf"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a46c7d73ab716ad3f636d6f06dc2d16cf">z_end</a></td></tr>
<tr class="separator:a46c7d73ab716ad3f636d6f06dc2d16cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a457ff5121ab099abe67e465d171fe19d"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a457ff5121ab099abe67e465d171fe19d">y_start</a></td></tr>
<tr class="separator:a457ff5121ab099abe67e465d171fe19d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0e6042016d5ce258a542b35adc00e5a"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#ae0e6042016d5ce258a542b35adc00e5a">y_end</a></td></tr>
<tr class="separator:ae0e6042016d5ce258a542b35adc00e5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54b3a29d4b49d4b28f58a359469a948f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a54b3a29d4b49d4b28f58a359469a948f">x_start</a></td></tr>
<tr class="separator:a54b3a29d4b49d4b28f58a359469a948f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56796946283179e75de58fe7a375e28a"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a56796946283179e75de58fe7a375e28a">x_end</a></td></tr>
<tr class="separator:a56796946283179e75de58fe7a375e28a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9fc72a089d8e1881e7bc8f9bd6e542d"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcommunication__types__mod_1_1halo__communication__type.html">halo_communication_type</a>), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#ad9fc72a089d8e1881e7bc8f9bd6e542d">halo_swap_state</a></td></tr>
<tr class="separator:ad9fc72a089d8e1881e7bc8f9bd6e542d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48dcc2baf3f3d5edbab576fc380701b5"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a48dcc2baf3f3d5edbab576fc380701b5">p_source</a></td></tr>
<tr class="separator:a48dcc2baf3f3d5edbab576fc380701b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05bacf56df2bbcbc3ab21d47e759cec7"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a05bacf56df2bbcbc3ab21d47e759cec7">prev_p</a></td></tr>
<tr class="separator:a05bacf56df2bbcbc3ab21d47e759cec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b8f52c1847557fab15749c1b514971c"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a3b8f52c1847557fab15749c1b514971c">cx</a></td></tr>
<tr class="separator:a3b8f52c1847557fab15749c1b514971c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7909ed04090b3bfffd7d5fc33539fcd"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#af7909ed04090b3bfffd7d5fc33539fcd">cy</a></td></tr>
<tr class="separator:af7909ed04090b3bfffd7d5fc33539fcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0726b9beb4039fc34bccbaaf0318f0b3"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a0726b9beb4039fc34bccbaaf0318f0b3">rdzn</a></td></tr>
<tr class="separator:a0726b9beb4039fc34bccbaaf0318f0b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a2540e20466327134ce888b965f3c08"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a9a2540e20466327134ce888b965f3c08">rdz</a></td></tr>
<tr class="separator:a9a2540e20466327134ce888b965f3c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b84c80ea5d7755ddbab62600239d8dd"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a9b84c80ea5d7755ddbab62600239d8dd">rho</a></td></tr>
<tr class="separator:a9b84c80ea5d7755ddbab62600239d8dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c58b8b99675ab89fa495a8cd74f5325"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a5c58b8b99675ab89fa495a8cd74f5325">rhon</a></td></tr>
<tr class="separator:a5c58b8b99675ab89fa495a8cd74f5325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb609729a980841b02373e46e40de705"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#abb609729a980841b02373e46e40de705">dz</a></td></tr>
<tr class="separator:abb609729a980841b02373e46e40de705"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a529b7788cbcf56a4b00add8b23179d34"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepetsc__solver__mod.html#a529b7788cbcf56a4b00add8b23179d34">dzn</a></td></tr>
<tr class="separator:a529b7788cbcf56a4b00add8b23179d34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>PETSc solver component to call out to PETSc for solving the Poisson equation for pressure. </p>
<p>Dummy stub when not compiling with PETSc iterative solver. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a7a134894de62b094c42364e7ccfaba02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a134894de62b094c42364e7ccfaba02">&#9670;&nbsp;</a></span>apply_dimension_bounds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::apply_dimension_bounds </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dim_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dim_processes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>length_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies dimension bounds to determine the number of elements held locally for each process in that dimension. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dim_size</td><td>The global size of the dimension </td></tr>
    <tr><td class="paramname">dim_processes</td><td>The number of processes in that dimension </td></tr>
    <tr><td class="paramname">length_array</td><td>Output array of size dim_processes which contains the number of elements held locally for each process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00418">418</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: dim_size, dim_processes</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: length_array(:)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">integer</span> :: i, dimension_division, dimension_extra</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    dimension_division = dim_size / dim_processes</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    length_array= dimension_division    </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    dimension_extra = dim_size - (dimension_division * dim_processes)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (dimension_extra .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">do</span> i=1, dimension_extra</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        length_array(i)=length_array(i)+1</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a7a134894de62b094c42364e7ccfaba02_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a7a134894de62b094c42364e7ccfaba02_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a7a134894de62b094c42364e7ccfaba02_icgraph" id="anamespacepetsc__solver__mod_a7a134894de62b094c42364e7ccfaba02_icgraph">
<area shape="rect" title="Applies dimension bounds to determine the number of elements held locally for each process in that di..." alt="" coords="419,5,583,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#adf2548341733155ba725373a96aef324" title="Called upon model initialisation. Will basically read from the options database and set options in th..." alt="" coords="220,5,371,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="a1b3240293d99bab7de6b5d6ece1342f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b3240293d99bab7de6b5d6ece1342f1">&#9670;&nbsp;</a></span>complete_psrce_calculation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::complete_psrce_calculation </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>y_halo_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_halo_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Completes the psrce calculation by waiting on all outstanding psrce communications to complete and then combine the received values with the P field for U and V. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">y_halo_size</td><td>The halo size in the Y dimension </td></tr>
    <tr><td class="paramname">x_halo_size</td><td>The halo size in the X dimension </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00440">440</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: y_halo_size, x_halo_size</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordtype">integer</span> :: ierr, combined_handles(2), i, j, k</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    combined_handles(1)=current_state%psrce_x_hs_recv_request</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    combined_handles(2)=current_state%psrce_y_hs_recv_request</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keyword">call </span>mpi_waitall(2, combined_handles, mpi_statuses_ignore, ierr)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">do</span> j=current_state%local_grid%local_domain_start_index(y_index), current_state%local_grid%local_domain_end_index(y_index)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordflow">do</span> k=2,current_state%local_grid%size(z_index)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor">#ifdef U_ACTIVE</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="preprocessor"></span>        current_state%p%data(k,j,x_halo_size+1)=current_state%p%data(k,j,x_halo_size+1)-&amp;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;               current_state%psrce_recv_buffer_x(k-1,j-x_halo_size)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> (j .gt. y_halo_size+1) current_state%p%data(k, j, x_halo_size+1)=current_state%p%data(k, j, x_halo_size+1)-&amp;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;             current_state%global_grid%configuration%horizontal%cy * current_state%sv%data(k, j-1, x_halo_size+1)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="preprocessor"></span><span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">do</span> i=current_state%local_grid%local_domain_start_index(x_index), current_state%local_grid%local_domain_end_index(x_index)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">do</span> k=2,current_state%local_grid%size(z_index)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        current_state%p%data(k,y_halo_size+1,i)=current_state%p%data(k,y_halo_size+1,i)-&amp;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;             current_state%psrce_recv_buffer_y(k-1,i-y_halo_size)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    combined_handles(1)=current_state%psrce_x_hs_send_request</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    combined_handles(2)=current_state%psrce_y_hs_send_request</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keyword">call </span>mpi_waitall(2, combined_handles, mpi_statuses_ignore, ierr)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a1b3240293d99bab7de6b5d6ece1342f1_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a1b3240293d99bab7de6b5d6ece1342f1_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a1b3240293d99bab7de6b5d6ece1342f1_icgraph" id="anamespacepetsc__solver__mod_a1b3240293d99bab7de6b5d6ece1342f1_icgraph">
<area shape="rect" title="Completes the psrce calculation by waiting on all outstanding psrce communications to complete and th..." alt="" coords="452,5,639,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a33751edb5b5265c8753e6034a62a15f4" title="Timestep hook which is called at each timestep to solve the pressure equation via PETSc...." alt="" coords="220,5,404,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="a93c8a2ef7386643bd39d313d6aaf3363"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93c8a2ef7386643bd39d313d6aaf3363">&#9670;&nbsp;</a></span>compute_initial_guess()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::compute_initial_guess </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ksp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*)&#160;</td>
          <td class="paramname"><em>dummy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines the initial guess, this is called from within PETSc and sets it to be the last value of P or zero if it is the first timestep. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ksp</td><td>The PETSc KSP data structure which contains the context of the solver </td></tr>
    <tr><td class="paramname">X</td><td>The X vector to create an initial guess for </td></tr>
    <tr><td class="paramname">dummy</td><td>Dummy argument to maintain consistency with the PETSc C interface </td></tr>
    <tr><td class="paramname">ierr</td><td>PETSc error code </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00234">234</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    petscerrorcode :: ierr</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    ksp :: ksp</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    vec :: x</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">integer</span> :: dummy(*)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    dm dm</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    petscscalar, <span class="keywordtype">pointer</span> :: xx(:)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    petscint :: zs, ys, xs, zm, ym, xm</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keyword">call </span>kspgetdm(ksp, dm, ierr)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keyword">call </span>dmdagetcorners(dm, zs, ys, xs, zm, ym, xm, ierr)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">call </span>vecgetarrayf90(x, xx, ierr)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keyword">call </span>copy_data_to_petsc_pointer(xx, zs, ys, xs, zm, ym, xm, prev_p)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">call </span>vecrestorearrayf90(x, xx, ierr)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a93c8a2ef7386643bd39d313d6aaf3363_cgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a93c8a2ef7386643bd39d313d6aaf3363_cgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a93c8a2ef7386643bd39d313d6aaf3363_cgraph" id="anamespacepetsc__solver__mod_a93c8a2ef7386643bd39d313d6aaf3363_cgraph">
<area shape="rect" title="Determines the initial guess, this is called from within PETSc and sets it to be the last value of P ..." alt="" coords="5,5,189,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a7b88521612a1ff15c57aea2aa6dc5b68" title="Copies data into a data pointer which is provided by PETSc, doing it this ways allows us to give a sh..." alt="" coords="237,5,399,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a93c8a2ef7386643bd39d313d6aaf3363_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a93c8a2ef7386643bd39d313d6aaf3363_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a93c8a2ef7386643bd39d313d6aaf3363_icgraph" id="anamespacepetsc__solver__mod_a93c8a2ef7386643bd39d313d6aaf3363_icgraph">
<area shape="rect" title="Determines the initial guess, this is called from within PETSc and sets it to be the last value of P ..." alt="" coords="419,5,603,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#adf2548341733155ba725373a96aef324" title="Called upon model initialisation. Will basically read from the options database and set options in th..." alt="" coords="220,5,371,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="a2b88c61d1e0c123d20dbe75c4bb83bb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b88c61d1e0c123d20dbe75c4bb83bb6">&#9670;&nbsp;</a></span>compute_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::compute_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ksp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*)&#160;</td>
          <td class="paramname"><em>dummy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Call back issued from within PETSc to create the matrix, this is only called once (the first PETSc run) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ksp</td><td>The solver data structure which provides context for this run </td></tr>
    <tr><td class="paramname">A</td><td>Matrix A this is the linear operator </td></tr>
    <tr><td class="paramname">B</td><td>Matrix B this is the preconditioning matrix </td></tr>
    <tr><td class="paramname">dummy</td><td>Dummy argument to ensure consistency with C PETSc interface </td></tr>
    <tr><td class="paramname">ierr</td><td>The PETSc error code </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00323">323</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    petscerrorcode :: ierr</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    ksp :: ksp</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    mat :: a, b</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordtype">integer</span> :: dummy(*)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    dm dm</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    petscint :: zs, ys,xs, zm, ym, xm, mz, my, mx</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) ::  v(7), hx, hy</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> ::  hzu, hzd, d_sc  </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    matstencil :: row(4),col(4,7)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordtype">integer</span> :: i, j, k, num</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">call </span>kspgetdm(ksp, dm, ierr)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">call </span>dmdagetinfo(dm,petsc_null_integer, mz, my, mx, petsc_null_integer, petsc_null_integer, petsc_null_integer, &amp;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;     petsc_null_integer, petsc_null_integer, petsc_null_integer, petsc_null_integer, petsc_null_integer, petsc_null_integer, ierr)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keyword">call </span>dmdagetcorners(dm, zs, ys, xs, zm, ym, xm, ierr)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">allocate</span>(hzu(0:mz-1), hzd(0:mz-1), d_sc(0:mz-1))</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">do</span> k=0, mz-1</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      d_sc(k)=rdz(k+1) / rhon(k+1)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">if</span> (k .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        hzd(k)=rho(k) * rdzn(k+1)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        hzd(k)=0.0_default_precision</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">if</span> (k .lt. mz-1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        hzu(k)=rho(k+1) * rdzn(k+2)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        hzu(k)=0.0_default_precision</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordflow">    end do</span>   </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    hx = cx * cx</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    hy = cy * cy  </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">do</span> i=xs, xs+xm-1</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">do</span> j=ys,ys+ym-1</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">do</span> k=zs, zs+zm-1</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;          row(matstencil_i) = k</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          row(matstencil_j) = j</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          row(matstencil_k) = i</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          v(1)=hy</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          col(matstencil_i, 1)=k</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          col(matstencil_j, 1)=j-1</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          col(matstencil_k, 1)=i</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          v(2)=hx</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;          col(matstencil_i, 2)=k</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          col(matstencil_j, 2)=j</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          col(matstencil_k, 2)=i-1</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          v(3)=d_sc(k) * (-(hzu(k) + hzd(k))) - (2.0*(hx + hy))</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          col(matstencil_i, 3)=k</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          col(matstencil_j, 3)=j</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          col(matstencil_k, 3)=i</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          v(4)=hx</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          col(matstencil_i, 4)=k</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          col(matstencil_j, 4)=j </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          col(matstencil_k, 4)=i+1</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          v(5)=hy</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;          col(matstencil_i, 5)=k</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          col(matstencil_j, 5)=j+1</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          col(matstencil_k, 5)=i</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          num=6</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          <span class="keywordflow">if</span> (k .gt. zs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            v(num)=(d_sc(k)*hzd(k))</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            col(matstencil_i, num)=k-1</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            col(matstencil_j, num)=j </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            col(matstencil_k, num)=i</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            num=num+1</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          <span class="keywordflow">if</span> (k .lt. mz-1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            v(num)=(d_sc(k)*hzu(k))</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            col(matstencil_i, num)=k+1</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            col(matstencil_j, num)=j</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            col(matstencil_k, num)=i</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            num=num+1</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          <span class="keyword">call </span>matsetvaluesstencil(b, 1, row, num-1, col, v, insert_values, ierr)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keyword">call </span>matassemblybegin(b, mat_final_assembly, ierr)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keyword">call </span>matassemblyend(b, mat_final_assembly, ierr)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">if</span> ( a .ne. b) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keyword">call </span>matassemblybegin(a, mat_final_assembly, ierr)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keyword">call </span>matassemblyend(a, mat_final_assembly, ierr)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keyword">deallocate</span>(hzu, hzd, d_sc)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a2b88c61d1e0c123d20dbe75c4bb83bb6_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a2b88c61d1e0c123d20dbe75c4bb83bb6_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a2b88c61d1e0c123d20dbe75c4bb83bb6_icgraph" id="anamespacepetsc__solver__mod_a2b88c61d1e0c123d20dbe75c4bb83bb6_icgraph">
<area shape="rect" title="Call back issued from within PETSc to create the matrix, this is only called once (the first PETSc ru..." alt="" coords="419,5,603,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#adf2548341733155ba725373a96aef324" title="Called upon model initialisation. Will basically read from the options database and set options in th..." alt="" coords="220,5,371,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="addbf44c53a577676daf2d99eb9c35160"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addbf44c53a577676daf2d99eb9c35160">&#9670;&nbsp;</a></span>compute_rhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::compute_rhs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ksp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*)&#160;</td>
          <td class="paramname"><em>dummy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback issued from the PETSc library to compute the RHS, this is called every timestep (as we have a different RHS) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ksp</td><td>The KSP data structure which contains the solver context </td></tr>
    <tr><td class="paramname">b</td><td>The RHS </td></tr>
    <tr><td class="paramname">dummy</td><td>Dummy argument for compatability with the C PETSc interface </td></tr>
    <tr><td class="paramname">ierr</td><td>Error code </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00256">256</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    petscerrorcode :: ierr</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    ksp :: ksp</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    vec :: b</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">integer</span> :: dummy(*)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    dm dm</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    petscscalar, <span class="keywordtype">pointer</span> :: xx(:)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    petscint :: zs, ys, xs, zm, ym, xm</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keyword">call </span>kspgetdm(ksp, dm, ierr)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">call </span>dmdagetcorners(dm, zs, ys, xs, zm, ym, xm, ierr)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keyword">call </span>vecgetarrayf90(b, xx, ierr)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">call </span>copy_data_to_petsc_pointer(xx, zs, ys, xs, zm, ym, xm, p_source)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keyword">call </span>vecrestorearrayf90(b, xx, ierr)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_addbf44c53a577676daf2d99eb9c35160_cgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_addbf44c53a577676daf2d99eb9c35160_cgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_addbf44c53a577676daf2d99eb9c35160_cgraph" id="anamespacepetsc__solver__mod_addbf44c53a577676daf2d99eb9c35160_cgraph">
<area shape="rect" title="Callback issued from the PETSc library to compute the RHS, this is called every timestep (as we have ..." alt="" coords="5,13,215,39"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a7b88521612a1ff15c57aea2aa6dc5b68" title="Copies data into a data pointer which is provided by PETSc, doing it this ways allows us to give a sh..." alt="" coords="263,5,424,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_addbf44c53a577676daf2d99eb9c35160_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_addbf44c53a577676daf2d99eb9c35160_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_addbf44c53a577676daf2d99eb9c35160_icgraph" id="anamespacepetsc__solver__mod_addbf44c53a577676daf2d99eb9c35160_icgraph">
<area shape="rect" title="Callback issued from the PETSc library to compute the RHS, this is called every timestep (as we have ..." alt="" coords="419,13,628,39"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#adf2548341733155ba725373a96aef324" title="Called upon model initialisation. Will basically read from the options database and set options in th..." alt="" coords="220,5,371,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="a7b88521612a1ff15c57aea2aa6dc5b68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b88521612a1ff15c57aea2aa6dc5b68">&#9670;&nbsp;</a></span>copy_data_to_petsc_pointer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::copy_data_to_petsc_pointer </td>
          <td>(</td>
          <td class="paramtype">dimension(zs:zs+zm-1, ys:ys+ym-1, xs:xs+xm-1), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>zs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>xs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>zm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>xm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>src_values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copies data into a data pointer which is provided by PETSc, doing it this ways allows us to give a shape to the pointer data and hence the data copy is simpler code wise. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The target pointer to copy into </td></tr>
    <tr><td class="paramname">zs</td><td>Local starting point in Z </td></tr>
    <tr><td class="paramname">ys</td><td>Local starting point in Y </td></tr>
    <tr><td class="paramname">xs</td><td>Local starting point in X </td></tr>
    <tr><td class="paramname">zm</td><td>Number of points held locally in Z </td></tr>
    <tr><td class="paramname">ym</td><td>Number of points held locally in Y </td></tr>
    <tr><td class="paramname">xm</td><td>Number of points held locally in X </td></tr>
    <tr><td class="paramname">src_values</td><td>The data values to copy from into this target data array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00283">283</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: zs, ys, xs, zm, ym, xm</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    petscscalar, <span class="keywordtype">intent(inout)</span> :: x(zs:zs+zm-1, ys:ys+ym-1, xs:xs+xm-1)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(in)</span> :: src_values</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">integer</span> :: i, j, k</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">do</span> i=xs, xs+xm-1</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">do</span> j=ys, ys+ym-1</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">do</span> k=zs, zs+zm-1</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          x(k, j, i)=src_values((k-zs)+1, (j-ys)+1, (i-xs)+1)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a7b88521612a1ff15c57aea2aa6dc5b68_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a7b88521612a1ff15c57aea2aa6dc5b68_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a7b88521612a1ff15c57aea2aa6dc5b68_icgraph" id="anamespacepetsc__solver__mod_a7b88521612a1ff15c57aea2aa6dc5b68_icgraph">
<area shape="rect" title="Copies data into a data pointer which is provided by PETSc, doing it this ways allows us to give a sh..." alt="" coords="676,35,837,76"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a93c8a2ef7386643bd39d313d6aaf3363" title="Determines the initial guess, this is called from within PETSc and sets it to be the last value of P ..." alt="" coords="431,5,615,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#addbf44c53a577676daf2d99eb9c35160" title="Callback issued from the PETSc library to compute the RHS, this is called every timestep (as we have ..." alt="" coords="419,71,628,98"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#adf2548341733155ba725373a96aef324" title="Called upon model initialisation. Will basically read from the options database and set options in th..." alt="" coords="220,35,371,76"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,35,172,76"/>
</map>
</div>

</div>
</div>
<a id="a3d3a3c93a05d87d97e38d81e09eba9c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d3a3c93a05d87d97e38d81e09eba9c6">&#9670;&nbsp;</a></span>copy_halo_buffer_to_p()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::copy_halo_buffer_to_p </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1neighbour__description__type.html">neighbour_description_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>neighbour_description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>target_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>neighbour_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>current_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1field__data__wrapper__type.html">field_data_wrapper_type</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>source_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00504">504</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: dim, target_index, neighbour_location</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: current_page(:)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordtype">type</span>(neighbour_description_type), <span class="keywordtype">intent(inout)</span> :: neighbour_description</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">type</span>(field_data_wrapper_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: source_data</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, current_state%p%data, &amp;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;         dim, target_index, current_page(neighbour_location))</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    current_page(neighbour_location)=current_page(neighbour_location)+1</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a3d3a3c93a05d87d97e38d81e09eba9c6_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a3d3a3c93a05d87d97e38d81e09eba9c6_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a3d3a3c93a05d87d97e38d81e09eba9c6_icgraph" id="anamespacepetsc__solver__mod_a3d3a3c93a05d87d97e38d81e09eba9c6_icgraph">
<area shape="rect" title=" " alt="" coords="452,5,613,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a33751edb5b5265c8753e6034a62a15f4" title="Timestep hook which is called at each timestep to solve the pressure equation via PETSc...." alt="" coords="220,5,404,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="aab4576f6323bb0b7f34bfd32cfada9db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab4576f6323bb0b7f34bfd32cfada9db">&#9670;&nbsp;</a></span>copy_p_to_halo_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::copy_p_to_halo_buffer </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1neighbour__description__type.html">neighbour_description_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>neighbour_description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>pid_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>current_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1field__data__wrapper__type.html">field_data_wrapper_type</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>source_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copies the p field data to halo buffers for a specific process in a dimension and halo cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">neighbour_descriptions</td><td>Description of the neighbour halo swapping status </td></tr>
    <tr><td class="paramname">dim</td><td>Dimension to copy from </td></tr>
    <tr><td class="paramname">source_index</td><td>The source index of the dimension we are reading from in the prognostic field </td></tr>
    <tr><td class="paramname">pid_location</td><td>Location of the neighbouring process in the local stored data structures </td></tr>
    <tr><td class="paramname">current_page</td><td>The current (next) buffer page to copy into </td></tr>
    <tr><td class="paramname">source_data</td><td>Optional source data which is read from </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00485">485</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: dim, pid_location, source_index</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: current_page(:)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">type</span>(neighbour_description_type), <span class="keywordtype">intent(inout)</span> :: neighbour_description</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordtype">type</span>(field_data_wrapper_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: source_data</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, neighbour_description%send_halo_buffer, current_state%p%data, &amp;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;         dim, source_index, current_page(pid_location))</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    current_page(pid_location)=current_page(pid_location)+1</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_aab4576f6323bb0b7f34bfd32cfada9db_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_aab4576f6323bb0b7f34bfd32cfada9db_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_aab4576f6323bb0b7f34bfd32cfada9db_icgraph" id="anamespacepetsc__solver__mod_aab4576f6323bb0b7f34bfd32cfada9db_icgraph">
<area shape="rect" title="Copies the p field data to halo buffers for a specific process in a dimension and halo cell." alt="" coords="452,5,613,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a33751edb5b5265c8753e6034a62a15f4" title="Timestep hook which is called at each timestep to solve the pressure equation via PETSc...." alt="" coords="220,5,404,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="af59bc98b1fd5158fc880a6d900f57ff6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af59bc98b1fd5158fc880a6d900f57ff6">&#9670;&nbsp;</a></span>copy_petsc_pointer_to_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::copy_petsc_pointer_to_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z_start_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z_end_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>y_start_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>y_end_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_start_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_end_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>target_values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copies the data in a pointer that was provided by PETSc into some target data, doing it this way means we can give a shape to the pointer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The pointer provided by PETSc that we copy from </td></tr>
    <tr><td class="paramname">z_start</td><td>Starting point for the target array in Z </td></tr>
    <tr><td class="paramname">z_end</td><td>Ending point for the target array in Z </td></tr>
    <tr><td class="paramname">y_start</td><td>Starting point for the target array in Y </td></tr>
    <tr><td class="paramname">y_end</td><td>Ending point for the target array in Y </td></tr>
    <tr><td class="paramname">x_start</td><td>Starting point for the target array in X </td></tr>
    <tr><td class="paramname">x_end</td><td>Ending point for the target array in X </td></tr>
    <tr><td class="paramname">target_values</td><td>Target array to copy into </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00309">309</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;     <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z_start_idx, z_end_idx, y_start_idx, y_end_idx, x_start_idx, x_end_idx</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;     petscscalar :: x((z_end_idx-z_start_idx)+1, (y_end_idx-y_start_idx)+1, (x_end_idx-x_start_idx)+1)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordtype">     real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(inout)</span> :: target_values</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;     target_values(z_start_idx:z_end_idx, y_start_idx:y_end_idx, x_start_idx:x_end_idx)=x</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_af59bc98b1fd5158fc880a6d900f57ff6_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_af59bc98b1fd5158fc880a6d900f57ff6_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_af59bc98b1fd5158fc880a6d900f57ff6_icgraph" id="anamespacepetsc__solver__mod_af59bc98b1fd5158fc880a6d900f57ff6_icgraph">
<area shape="rect" title="Copies the data in a pointer that was provided by PETSc into some target data, doing it this way mean..." alt="" coords="452,5,613,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a33751edb5b5265c8753e6034a62a15f4" title="Timestep hook which is called at each timestep to solve the pressure equation via PETSc...." alt="" coords="220,5,404,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="a046b3b5a00b4292d6ee39f569ebf2999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a046b3b5a00b4292d6ee39f569ebf2999">&#9670;&nbsp;</a></span>determine_convegence_reason()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=string_length) function petsc_solver_mod::determine_convegence_reason </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>r_code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00208">208</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: r_code</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (r_code == 1 .or. r_code == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      determine_convegence_reason=<span class="stringliteral">&quot;relative tolerance of residual norm&quot;</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r_code == 9 .or. r_code == 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      determine_convegence_reason=<span class="stringliteral">&quot;residual norm less than absolute tolerance&quot;</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r_code == 4) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      determine_convegence_reason=<span class="stringliteral">&quot;number of iterations exceeded maximum&quot;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r_code == -3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      determine_convegence_reason=<span class="stringliteral">&quot;diverged as number of iterations exceeded maximum before any convergence criteria&quot;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r_code == -4) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      determine_convegence_reason=<span class="stringliteral">&quot;diverged as divergence tolerance exceeded&quot;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r_code .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      determine_convegence_reason=<span class="stringliteral">&quot;convergence code of &quot;</span>//conv_to_string(r_code)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r_code .lt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      determine_convegence_reason=<span class="stringliteral">&quot;divergence code of &quot;</span>//conv_to_string(r_code)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a046b3b5a00b4292d6ee39f569ebf2999_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a046b3b5a00b4292d6ee39f569ebf2999_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a046b3b5a00b4292d6ee39f569ebf2999_icgraph" id="anamespacepetsc__solver__mod_a046b3b5a00b4292d6ee39f569ebf2999_icgraph">
<area shape="rect" title=" " alt="" coords="452,5,643,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a33751edb5b5265c8753e6034a62a15f4" title="Timestep hook which is called at each timestep to solve the pressure equation via PETSc...." alt="" coords="220,5,404,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="ab16254aead68a763822c781f41feccf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab16254aead68a763822c781f41feccf6">&#9670;&nbsp;</a></span>finalisation_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::finalisation_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00051">51</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    petscerrorcode :: ierr</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keyword">call </span>petscfinalize(ierr)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_ab16254aead68a763822c781f41feccf6_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_ab16254aead68a763822c781f41feccf6_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_ab16254aead68a763822c781f41feccf6_icgraph" id="anamespacepetsc__solver__mod_ab16254aead68a763822c781f41feccf6_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,415,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="adf2548341733155ba725373a96aef324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf2548341733155ba725373a96aef324">&#9670;&nbsp;</a></span>init_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::init_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called upon model initialisation. Will basically read from the options database and set options in the database that are appropriate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model <a class="el" href="namespacestate__mod.html" title="The model state which represents the current state of a run.">state_mod</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00062">62</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    petscerrorcode :: ierr</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    ksptype :: ksp_type</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    pc :: pc_instance</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    pctype :: pc_type</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">integer</span> :: y_lengths(current_state%parallel%dim_sizes(Y_INDEX)), x_lengths(current_state%parallel%dim_sizes(X_INDEX))</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">integer</span> new_communicator, my_transposed_rank, x_rank_val, y_rank_val</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">call </span>apply_dimension_bounds(current_state%global_grid%size(y_index), current_state%parallel%dim_sizes(y_index), y_lengths)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">call </span>apply_dimension_bounds(current_state%global_grid%size(x_index), current_state%parallel%dim_sizes(x_index), x_lengths)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keyword">allocate</span>(p_source(current_state%local_grid%size(z_index)-1, current_state%local_grid%size(y_index), &amp;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;         current_state%local_grid%size(x_index)), prev_p(current_state%local_grid%size(z_index)-1, &amp;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;         current_state%local_grid%size(y_index), current_state%local_grid%size(x_index)))</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    cx=current_state%global_grid%configuration%horizontal%cx</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    cy=current_state%global_grid%configuration%horizontal%cy</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keyword">allocate</span>(rdzn(current_state%local_grid%size(z_index)-1), rdz(current_state%local_grid%size(z_index)-1), &amp;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;         rho(current_state%local_grid%size(z_index)-1), rhon(current_state%local_grid%size(z_index)-1), &amp;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;         dz(current_state%local_grid%size(z_index)-1), dzn(current_state%local_grid%size(z_index)-1))</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    rdzn=current_state%global_grid%configuration%vertical%rdzn(2:)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    rdz=current_state%global_grid%configuration%vertical%rdz(2:)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    rho=current_state%global_grid%configuration%vertical%rho(2:)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    rhon=current_state%global_grid%configuration%vertical%rhon(2:)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    dz=current_state%global_grid%configuration%vertical%dz(2:)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    dzn=current_state%global_grid%configuration%vertical%dzn(2:)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    z_start=current_state%local_grid%halo_size(z_index)+2</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    z_end=current_state%local_grid%halo_size(z_index)+current_state%local_grid%size(z_index)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    y_start=current_state%local_grid%halo_size(y_index)+1</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    y_end=current_state%local_grid%halo_size(y_index)+current_state%local_grid%size(y_index)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    x_start=current_state%local_grid%halo_size(x_index)+1</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    x_end=current_state%local_grid%halo_size(x_index)+current_state%local_grid%size(x_index)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    y_rank_val = current_state%parallel%my_rank / current_state%parallel%dim_sizes(x_index)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    x_rank_val = mod(current_state%parallel%my_rank, current_state%parallel%dim_sizes(x_index))    </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    my_transposed_rank = x_rank_val*current_state%parallel%dim_sizes(y_index) + y_rank_val</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">call </span>mpi_comm_split(current_state%parallel%monc_communicator, 1, my_transposed_rank, new_communicator, ierr)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    petsc_comm_world = new_communicator</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">call </span>petscinitialize(petsc_null_character, ierr)    </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">call </span>kspcreate(petsc_comm_world, ksp, ierr)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">call </span>dmdacreate3d(petsc_comm_world, dm_boundary_none, dm_boundary_periodic, dm_boundary_periodic, dmda_stencil_star, &amp;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;         current_state%global_grid%size(z_index)-1, current_state%global_grid%size(y_index), &amp;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;         current_state%global_grid%size(x_index), 1, current_state%parallel%dim_sizes(y_index), &amp;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;         current_state%parallel%dim_sizes(x_index), 1, 1, (/ current_state%global_grid%size(z_index)-1 /), &amp;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;         y_lengths, x_lengths, da, ierr)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">call </span>kspsetdm(ksp, da, ierr)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">call </span>kspsetcomputerhs(ksp, compute_rhs, petsc_null_object, ierr)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keyword">call </span>kspsetcomputeoperators(ksp, compute_matrix, petsc_null_object, ierr)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">call </span>kspsetcomputeinitialguess(ksp, compute_initial_guess, petsc_null_object, ierr)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">call </span>petscoptionssetvalue(<span class="stringliteral">&quot;-options_left&quot;</span>, <span class="stringliteral">&quot;no&quot;</span>, ierr)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;solver_type&quot;</span>)) .ne. <span class="stringliteral">&quot;auto&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keyword">call </span>petscoptionssetvalue(<span class="stringliteral">&quot;-ksp_type&quot;</span>, trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;solver_type&quot;</span>)), ierr)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span> (trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;preconditioner_type&quot;</span>)) .ne. <span class="stringliteral">&quot;auto&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keyword">call </span>petscoptionssetvalue(<span class="stringliteral">&quot;-pc_type&quot;</span>, trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;preconditioner_type&quot;</span>)), ierr)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;norm_type&quot;</span>)) .ne. <span class="stringliteral">&quot;auto&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">if</span> (trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;norm_type&quot;</span>)) .eq. <span class="stringliteral">&quot;preconditioned&quot;</span> .or. &amp;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;           trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;norm_type&quot;</span>)) .eq. <span class="stringliteral">&quot;unpreconditioned&quot;</span> .or. &amp;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;           trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;norm_type&quot;</span>)) .eq. <span class="stringliteral">&quot;natural&quot;</span> .or. &amp;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;           trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;norm_type&quot;</span>)) .eq. <span class="stringliteral">&quot;none&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keyword">call </span>petscoptionssetvalue(<span class="stringliteral">&quot;-ksp_norm_type&quot;</span>, trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;norm_type&quot;</span>)), ierr)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Configured PETSc norm type of &#39;&quot;</span>//&amp;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;             trim(<a class="code" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">options_get_string</a>(current_state%options_database, <span class="stringliteral">&quot;norm_type&quot;</span>))//<span class="stringliteral">&quot;&#39; not recognised&quot;</span>)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordflow">    end if</span>    </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">call </span>petscoptionssetvalue(<span class="stringliteral">&quot;-ksp_rtol&quot;</span>, conv_to_string(<a class="code" href="namespaceoptionsdatabase__mod.html#ab054641ac0fa0287adb3c461987c4f0b">options_get_real</a>(current_state%options_database, <span class="stringliteral">&quot;tolerance&quot;</span>)), ierr)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceoptionsdatabase__mod.html#ae6f0a2a95fcacd3491b7b8fdb161e022">options_get_integer</a>(current_state%options_database, <span class="stringliteral">&quot;max_iterations&quot;</span>) .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keyword">call </span>petscoptionssetvalue(<span class="stringliteral">&quot;-ksp_max_it&quot;</span>, &amp;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;           conv_to_string(<a class="code" href="namespaceoptionsdatabase__mod.html#ae6f0a2a95fcacd3491b7b8fdb161e022">options_get_integer</a>(current_state%options_database, <span class="stringliteral">&quot;max_iterations&quot;</span>)), ierr)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">call </span>kspsetfromoptions(ksp, ierr)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keyword">call </span>kspsetinitialguessnonzero(ksp, petsc_true, ierr)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (log_is_master() .and. <a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() == <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keyword">call </span>kspmonitorset(ksp,ksp_monitor,petsc_null_object, petsc_null_function,ierr)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordflow">    end if</span>    </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    prev_p=0.0_default_precision</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">call </span>init_halo_communication(current_state, get_single_field_per_halo_cell, halo_swap_state, 1, .false.)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">call </span>kspgettype(ksp, ksp_type, ierr)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">call </span>kspgetpc(ksp, pc_instance, ierr)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">call </span>pcgettype(pc_instance, pc_type, ierr)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ac7d5c1fcb00d54277580c10556aa78a8">log_info</a>, <span class="stringliteral">&quot;PETSc iterative solver initialised, using &quot;</span>//trim(pc_type)//<span class="stringliteral">&quot; preconditioner with &quot;</span>//&amp;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;         trim(ksp_type)//<span class="stringliteral">&quot; solver&quot;</span>)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_adf2548341733155ba725373a96aef324_cgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_adf2548341733155ba725373a96aef324_cgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_adf2548341733155ba725373a96aef324_cgraph" id="anamespacepetsc__solver__mod_adf2548341733155ba725373a96aef324_cgraph">
<area shape="rect" title="Called upon model initialisation. Will basically read from the options database and set options in th..." alt="" coords="5,136,156,177"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a7a134894de62b094c42364e7ccfaba02" title="Applies dimension bounds to determine the number of elements held locally for each process in that di..." alt="" coords="227,5,391,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a93c8a2ef7386643bd39d313d6aaf3363" title="Determines the initial guess, this is called from within PETSc and sets it to be the last value of P ..." alt="" coords="217,71,401,112"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a2b88c61d1e0c123d20dbe75c4bb83bb6" title="Call back issued from within PETSc to create the matrix, this is only called once (the first PETSc ru..." alt="" coords="217,136,401,177"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#addbf44c53a577676daf2d99eb9c35160" title="Callback issued from the PETSc library to compute the RHS, this is called every timestep (as we have ..." alt="" coords="204,202,413,229"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#ac9c7894bec162985659cb8ef37b9cc2b" title="Monitor procedure called on each iteration, this is provided only at debugging level." alt="" coords="231,253,386,295"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a7b88521612a1ff15c57aea2aa6dc5b68" title="Copies data into a data pointer which is provided by PETSc, doing it this ways allows us to give a sh..." alt="" coords="461,133,623,175"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_adf2548341733155ba725373a96aef324_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_adf2548341733155ba725373a96aef324_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_adf2548341733155ba725373a96aef324_icgraph" id="anamespacepetsc__solver__mod_adf2548341733155ba725373a96aef324_icgraph">
<area shape="rect" title="Called upon model initialisation. Will basically read from the options database and set options in th..." alt="" coords="220,5,371,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="ac9c7894bec162985659cb8ef37b9cc2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9c7894bec162985659cb8ef37b9cc2b">&#9670;&nbsp;</a></span>ksp_monitor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::ksp_monitor </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ksp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rnorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dummy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Monitor procedure called on each iteration, this is provided only at debugging level. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ksp</td><td>The PETSc KSP data structure which contains the context of the solver </td></tr>
    <tr><td class="paramname">n</td><td>The iteration </td></tr>
    <tr><td class="paramname">rnorm</td><td>The relative norm </td></tr>
    <tr><td class="paramname">dummy</td><td>Dummy argument to maintain consistency with the PETSc C interface </td></tr>
    <tr><td class="paramname">ierr</td><td>PETSc error code </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00160">160</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    ksp              ksp</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    petscerrorcode ierr</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    petscint n,dummy</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    petscreal rnorm</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;Iteration=&quot;</span>//trim(conv_to_string(n))//<span class="stringliteral">&quot; Rnorm=&quot;</span>//trim(conv_to_string(rnorm, &amp;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;         exponent_small_numbers=.true.)))</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_ac9c7894bec162985659cb8ef37b9cc2b_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_ac9c7894bec162985659cb8ef37b9cc2b_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_ac9c7894bec162985659cb8ef37b9cc2b_icgraph" id="anamespacepetsc__solver__mod_ac9c7894bec162985659cb8ef37b9cc2b_icgraph">
<area shape="rect" title="Monitor procedure called on each iteration, this is provided only at debugging level." alt="" coords="419,5,573,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#adf2548341733155ba725373a96aef324" title="Called upon model initialisation. Will basically read from the options database and set options in th..." alt="" coords="220,5,371,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="a72645c0726f01a37b5a5f4c016b9e51d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72645c0726f01a37b5a5f4c016b9e51d">&#9670;&nbsp;</a></span>perform_local_data_copy_for_p()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::perform_local_data_copy_for_p </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>halo_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>involve_corners</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1field__data__wrapper__type.html">field_data_wrapper_type</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>source_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Does local data copying for P variable halo swap. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model <a class="el" href="namespacestate__mod.html" title="The model state which represents the current state of a run.">state_mod</a> </td></tr>
    <tr><td class="paramname">source_data</td><td>Optional source data which is written into </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00521">521</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: halo_depth</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: involve_corners</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordtype">type</span>(field_data_wrapper_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: source_data</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%p%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;         current_state%parallel%my_rank, halo_depth, involve_corners)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a72645c0726f01a37b5a5f4c016b9e51d_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a72645c0726f01a37b5a5f4c016b9e51d_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a72645c0726f01a37b5a5f4c016b9e51d_icgraph" id="anamespacepetsc__solver__mod_a72645c0726f01a37b5a5f4c016b9e51d_icgraph">
<area shape="rect" title="Does local data copying for P variable halo swap." alt="" coords="452,5,631,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a33751edb5b5265c8753e6034a62a15f4" title="Timestep hook which is called at each timestep to solve the pressure equation via PETSc...." alt="" coords="220,5,404,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="a451a0b7c857bd1c9a88afcb53784952a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a451a0b7c857bd1c9a88afcb53784952a">&#9670;&nbsp;</a></span>petsc_solver_get_descriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structmonc__component__mod_1_1component__descriptor__type.html">component_descriptor_type</a>) function, public petsc_solver_mod::petsc_solver_get_descriptor</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provides the descriptor back to the caller and is used in component registration. </p>
<dl class="section return"><dt>Returns</dt><dd>The PETSc solvre component descriptor</dd>
<dd>
The termination check component descriptor </dd></dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00043">43</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    petsc_solver_get_descriptor%name=<span class="stringliteral">&quot;petsc_solver&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    petsc_solver_get_descriptor%version=0.1</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    petsc_solver_get_descriptor%initialisation=&gt;init_callback</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    petsc_solver_get_descriptor%timestep=&gt;timestep_callback</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    petsc_solver_get_descriptor%finalisation=&gt;finalisation_callback</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a451a0b7c857bd1c9a88afcb53784952a_cgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a451a0b7c857bd1c9a88afcb53784952a_cgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a451a0b7c857bd1c9a88afcb53784952a_cgraph" id="anamespacepetsc__solver__mod_a451a0b7c857bd1c9a88afcb53784952a_cgraph">
<area shape="rect" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,165,172,207"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#ab16254aead68a763822c781f41feccf6" title=" " alt="" coords="220,100,415,141"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#adf2548341733155ba725373a96aef324" title="Called upon model initialisation. Will basically read from the options database and set options in th..." alt="" coords="242,165,393,207"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a33751edb5b5265c8753e6034a62a15f4" title="Timestep hook which is called at each timestep to solve the pressure equation via PETSc...." alt="" coords="225,449,409,491"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a7a134894de62b094c42364e7ccfaba02" title="Applies dimension bounds to determine the number of elements held locally for each process in that di..." alt="" coords="485,5,649,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a93c8a2ef7386643bd39d313d6aaf3363" title="Determines the initial guess, this is called from within PETSc and sets it to be the last value of P ..." alt="" coords="475,71,659,112"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a2b88c61d1e0c123d20dbe75c4bb83bb6" title="Call back issued from within PETSc to create the matrix, this is only called once (the first PETSc ru..." alt="" coords="475,136,659,177"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#addbf44c53a577676daf2d99eb9c35160" title="Callback issued from the PETSc library to compute the RHS, this is called every timestep (as we have ..." alt="" coords="463,202,672,229"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#ac9c7894bec162985659cb8ef37b9cc2b" title="Monitor procedure called on each iteration, this is provided only at debugging level." alt="" coords="490,253,645,295"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a7b88521612a1ff15c57aea2aa6dc5b68" title="Copies data into a data pointer which is provided by PETSc, doing it this ways allows us to give a sh..." alt="" coords="720,133,881,175"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a1b3240293d99bab7de6b5d6ece1342f1" title="Completes the psrce calculation by waiting on all outstanding psrce communications to complete and th..." alt="" coords="474,319,661,360"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a3d3a3c93a05d87d97e38d81e09eba9c6" title=" " alt="" coords="487,384,648,425"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#aab4576f6323bb0b7f34bfd32cfada9db" title="Copies the p field data to halo buffers for a specific process in a dimension and halo cell." alt="" coords="487,449,648,491"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#af59bc98b1fd5158fc880a6d900f57ff6" title="Copies the data in a pointer that was provided by PETSc into some target data, doing it this way mean..." alt="" coords="487,515,648,556"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a046b3b5a00b4292d6ee39f569ebf2999" title=" " alt="" coords="472,580,663,621"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a72645c0726f01a37b5a5f4c016b9e51d" title="Does local data copying for P variable halo swap." alt="" coords="478,645,657,687"/>
</map>
</div>

</div>
</div>
<a id="a33751edb5b5265c8753e6034a62a15f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33751edb5b5265c8753e6034a62a15f4">&#9670;&nbsp;</a></span>timestep_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine petsc_solver_mod::timestep_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Timestep hook which is called at each timestep to solve the pressure equation via PETSc. This will call to set and precondition the matrix on the first call (first timestep) only, and will set the RHS and X initial guess on each call as one would expect. At the end a halo swap is performed on p, which is needed for pstep. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model <a class="el" href="namespacestate__mod.html" title="The model state which represents the current state of a run.">state_mod</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00174">174</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    petscerrorcode :: ierr</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    vec x</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    petscscalar, <span class="keywordtype">pointer</span> :: xx(:)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">integer</span> :: its, i, j, k</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    petscreal :: rnorm</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    kspconvergedreason :: reason</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">call </span>complete_psrce_calculation(current_state, current_state%local_grid%halo_size(y_index), &amp;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;         current_state%local_grid%halo_size(x_index))    </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    p_source=current_state%p%data(z_start:z_end, y_start:y_end, x_start:x_end)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keyword">call </span>kspsolve(ksp, petsc_null_object, petsc_null_object, ierr)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keyword">call </span>kspgetsolution(ksp, x, ierr)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">call </span>vecgetarrayreadf90(x, xx, ierr)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">call </span>copy_petsc_pointer_to_data(xx, z_start, z_end, y_start, y_end, x_start, x_end, current_state%p%data)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">call </span>vecrestorearrayreadf90(x, xx, ierr)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    prev_p=current_state%p%data(z_start:z_end, y_start:y_end, x_start:x_end)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span> (log_is_master() .and. <a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() == <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keyword">call </span>kspgetiterationnumber(ksp, its, ierr)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keyword">call </span>kspgetresidualnorm(ksp, rnorm, ierr)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keyword">call </span>kspgetconvergedreason(ksp, reason, ierr)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;Converged in &quot;</span>//trim(conv_to_string(its))//<span class="stringliteral">&quot; rnorm=&quot;</span>//trim(conv_to_string(&amp;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;           rnorm, exponent_small_numbers=.true.))// <span class="stringliteral">&quot; (&quot;</span>//trim(determine_convegence_reason(reason))//<span class="stringliteral">&quot;)&quot;</span>)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keyword">call </span>blocking_halo_swap(current_state, halo_swap_state, copy_p_to_halo_buffer, &amp;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;         perform_local_data_copy_for_p, copy_halo_buffer_to_p)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a33751edb5b5265c8753e6034a62a15f4_cgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a33751edb5b5265c8753e6034a62a15f4_cgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a33751edb5b5265c8753e6034a62a15f4_cgraph" id="anamespacepetsc__solver__mod_a33751edb5b5265c8753e6034a62a15f4_cgraph">
<area shape="rect" title="Timestep hook which is called at each timestep to solve the pressure equation via PETSc...." alt="" coords="5,169,189,211"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a1b3240293d99bab7de6b5d6ece1342f1" title="Completes the psrce calculation by waiting on all outstanding psrce communications to complete and th..." alt="" coords="239,5,426,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a3d3a3c93a05d87d97e38d81e09eba9c6" title=" " alt="" coords="252,71,413,112"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#aab4576f6323bb0b7f34bfd32cfada9db" title="Copies the p field data to halo buffers for a specific process in a dimension and halo cell." alt="" coords="252,136,413,177"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#af59bc98b1fd5158fc880a6d900f57ff6" title="Copies the data in a pointer that was provided by PETSc into some target data, doing it this way mean..." alt="" coords="252,201,413,243"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a046b3b5a00b4292d6ee39f569ebf2999" title=" " alt="" coords="237,267,428,308"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a72645c0726f01a37b5a5f4c016b9e51d" title="Does local data copying for P variable halo swap." alt="" coords="243,332,422,373"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepetsc__solver__mod_a33751edb5b5265c8753e6034a62a15f4_icgraph.png" border="0" usemap="#anamespacepetsc__solver__mod_a33751edb5b5265c8753e6034a62a15f4_icgraph" alt=""/></div>
<map name="namespacepetsc__solver__mod_a33751edb5b5265c8753e6034a62a15f4_icgraph" id="anamespacepetsc__solver__mod_a33751edb5b5265c8753e6034a62a15f4_icgraph">
<area shape="rect" title="Timestep hook which is called at each timestep to solve the pressure equation via PETSc...." alt="" coords="220,5,404,47"/>
<area shape="rect" href="namespacepetsc__solver__mod.html#a451a0b7c857bd1c9a88afcb53784952a" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3b8f52c1847557fab15749c1b514971c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b8f52c1847557fab15749c1b514971c">&#9670;&nbsp;</a></span>cx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) petsc_solver_mod::cx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00034">34</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keywordtype">  real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: cx, cy</div>
</div><!-- fragment -->
</div>
</div>
<a id="af7909ed04090b3bfffd7d5fc33539fcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7909ed04090b3bfffd7d5fc33539fcd">&#9670;&nbsp;</a></span>cy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) petsc_solver_mod::cy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00034">34</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="abb609729a980841b02373e46e40de705"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb609729a980841b02373e46e40de705">&#9670;&nbsp;</a></span>dz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:), allocatable petsc_solver_mod::dz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00035">35</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="a529b7788cbcf56a4b00add8b23179d34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a529b7788cbcf56a4b00add8b23179d34">&#9670;&nbsp;</a></span>dzn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:), allocatable petsc_solver_mod::dzn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00035">35</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="ad9fc72a089d8e1881e7bc8f9bd6e542d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9fc72a089d8e1881e7bc8f9bd6e542d">&#9670;&nbsp;</a></span>halo_swap_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcommunication__types__mod_1_1halo__communication__type.html">halo_communication_type</a>), save petsc_solver_mod::halo_swap_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00031">31</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">type</span>(halo_communication_type), <span class="keywordtype">save</span> :: halo_swap_state</div>
</div><!-- fragment -->
</div>
</div>
<a id="a48dcc2baf3f3d5edbab576fc380701b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48dcc2baf3f3d5edbab576fc380701b5">&#9670;&nbsp;</a></span>p_source</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), allocatable petsc_solver_mod::p_source</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00033">33</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keywordtype">  real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span> :: p_source, prev_p</div>
</div><!-- fragment -->
</div>
</div>
<a id="a05bacf56df2bbcbc3ab21d47e759cec7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05bacf56df2bbcbc3ab21d47e759cec7">&#9670;&nbsp;</a></span>prev_p</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), allocatable petsc_solver_mod::prev_p</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00033">33</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="a9a2540e20466327134ce888b965f3c08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a2540e20466327134ce888b965f3c08">&#9670;&nbsp;</a></span>rdz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:), allocatable petsc_solver_mod::rdz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00035">35</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="a0726b9beb4039fc34bccbaaf0318f0b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0726b9beb4039fc34bccbaaf0318f0b3">&#9670;&nbsp;</a></span>rdzn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:), allocatable petsc_solver_mod::rdzn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00035">35</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keywordtype">  real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: rdzn, rdz, rho, rhon, dz, dzn</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b84c80ea5d7755ddbab62600239d8dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b84c80ea5d7755ddbab62600239d8dd">&#9670;&nbsp;</a></span>rho</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:), allocatable petsc_solver_mod::rho</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00035">35</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="a5c58b8b99675ab89fa495a8cd74f5325"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c58b8b99675ab89fa495a8cd74f5325">&#9670;&nbsp;</a></span>rhon</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:), allocatable petsc_solver_mod::rhon</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00035">35</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="a56796946283179e75de58fe7a375e28a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56796946283179e75de58fe7a375e28a">&#9670;&nbsp;</a></span>x_end</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer petsc_solver_mod::x_end</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00030">30</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="a54b3a29d4b49d4b28f58a359469a948f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54b3a29d4b49d4b28f58a359469a948f">&#9670;&nbsp;</a></span>x_start</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer petsc_solver_mod::x_start</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00030">30</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="ae0e6042016d5ce258a542b35adc00e5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0e6042016d5ce258a542b35adc00e5a">&#9670;&nbsp;</a></span>y_end</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer petsc_solver_mod::y_end</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00030">30</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="a457ff5121ab099abe67e465d171fe19d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a457ff5121ab099abe67e465d171fe19d">&#9670;&nbsp;</a></span>y_start</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer petsc_solver_mod::y_start</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00030">30</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="a46c7d73ab716ad3f636d6f06dc2d16cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46c7d73ab716ad3f636d6f06dc2d16cf">&#9670;&nbsp;</a></span>z_end</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer petsc_solver_mod::z_end</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00030">30</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>

</div>
</div>
<a id="ad3c6adbda077c8f90dbd9aae609409a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3c6adbda077c8f90dbd9aae609409a8">&#9670;&nbsp;</a></span>z_start</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer petsc_solver_mod::z_start</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="petsc__solver_8F90_source.html#l00030">30</a> of file <a class="el" href="petsc__solver_8F90_source.html">petsc_solver.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">integer</span> :: z_start, z_end, y_start, y_end, x_start, x_end</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="anamespacelogging__mod_html_ad68309846cd8f9e77edaa6abd02f65a0"><div class="ttname"><a href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">logging_mod::log_error</a></div><div class="ttdeci">integer, parameter, public log_error</div><div class="ttdoc">Only log ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00011">logging.F90:11</a></div></div>
<div class="ttc" id="anamespaceoptionsdatabase__mod_html_ae6f0a2a95fcacd3491b7b8fdb161e022"><div class="ttname"><a href="namespaceoptionsdatabase__mod.html#ae6f0a2a95fcacd3491b7b8fdb161e022">optionsdatabase_mod::options_get_integer</a></div><div class="ttdeci">integer function, public options_get_integer(options_database, key, index)</div><div class="ttdoc">Retrieves an integer value from the database that matches the provided key.</div><div class="ttdef"><b>Definition:</b> <a href="optionsdatabase_8F90_source.html#l00216">optionsdatabase.F90:217</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ac7d5c1fcb00d54277580c10556aa78a8"><div class="ttname"><a href="namespacelogging__mod.html#ac7d5c1fcb00d54277580c10556aa78a8">logging_mod::log_info</a></div><div class="ttdeci">integer, parameter, public log_info</div><div class="ttdoc">Log INFO, WARNING and ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00013">logging.F90:13</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ac4f13ac385499c85190cb184030e4f45"><div class="ttname"><a href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">logging_mod::log_log</a></div><div class="ttdeci">subroutine, public log_log(level, message, str)</div><div class="ttdoc">Logs a message at the specified level. If the level is above the current level then the message is ig...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00074">logging.F90:75</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ae0d255e756059bc76b2f4291825e59c9"><div class="ttname"><a href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">logging_mod::log_get_logging_level</a></div><div class="ttdeci">integer function, public log_get_logging_level()</div><div class="ttdoc">Retrieves the current logging level.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00121">logging.F90:122</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_aca1c925af27b4d533d548bfe69a819f3"><div class="ttname"><a href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">logging_mod::log_debug</a></div><div class="ttdeci">integer, parameter, public log_debug</div><div class="ttdoc">Log DEBUG, INFO, WARNING and ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00014">logging.F90:14</a></div></div>
<div class="ttc" id="anamespaceoptionsdatabase__mod_html_af2aeb42c9fdb961702216042b0330088"><div class="ttname"><a href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088">optionsdatabase_mod::options_get_string</a></div><div class="ttdeci">character(len=string_length) function, public options_get_string(options_database, key, index)</div><div class="ttdoc">Retrieves a string value from the database that matches the provided key.</div><div class="ttdef"><b>Definition:</b> <a href="optionsdatabase_8F90_source.html#l00279">optionsdatabase.F90:280</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ad95937a250467334622daeb5cff78c20"><div class="ttname"><a href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">logging_mod::log_master_log</a></div><div class="ttdeci">subroutine, public log_master_log(level, message)</div><div class="ttdoc">Will log just from the master process.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00046">logging.F90:47</a></div></div>
<div class="ttc" id="anamespaceoptionsdatabase__mod_html_ab054641ac0fa0287adb3c461987c4f0b"><div class="ttname"><a href="namespaceoptionsdatabase__mod.html#ab054641ac0fa0287adb3c461987c4f0b">optionsdatabase_mod::options_get_real</a></div><div class="ttdeci">real(kind=default_precision) function, public options_get_real(options_database, key, index)</div><div class="ttdoc">Retrieves a real value from the database that matches the provided key.</div><div class="ttdef"><b>Definition:</b> <a href="optionsdatabase_8F90_source.html#l00090">optionsdatabase.F90:91</a></div></div>
<div class="ttc" id="anamespacedatadefn__mod_html_a39b79f8cc843d236d3b47f5c81b64368"><div class="ttname"><a href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">datadefn_mod::default_precision</a></div><div class="ttdeci">integer, parameter, public default_precision</div><div class="ttdoc">MPI communication type which we use for the prognostic and calculation data.</div><div class="ttdef"><b>Definition:</b> <a href="datadefn_8F90_source.html#l00017">datadefn.F90:17</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

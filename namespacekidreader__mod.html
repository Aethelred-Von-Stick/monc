<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: kidreader_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">kidreader_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Component to set up the model based upon a KiD model configuration.  
<a href="namespacekidreader__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ac25b32ce129dab62a39885672825763e"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structmonc__component__mod_1_1component__descriptor__type.html">component_descriptor_type</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e">kidreader_get_descriptor</a> ()</td></tr>
<tr class="memdesc:ac25b32ce129dab62a39885672825763e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides the descriptor back to the caller and is used in component registration.  <a href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e">More...</a><br /></td></tr>
<tr class="separator:ac25b32ce129dab62a39885672825763e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f9656d6a5514b190a7cbe2d5b1c2b8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8">initialise_callback</a> (current_state)</td></tr>
<tr class="memdesc:af9f9656d6a5514b190a7cbe2d5b1c2b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation hook which will parse the configuration NetCDF file and set up the model based upon this.  <a href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8">More...</a><br /></td></tr>
<tr class="separator:af9f9656d6a5514b190a7cbe2d5b1c2b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9124154f06fb20c440ccb2818cf360b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ae9124154f06fb20c440ccb2818cf360b">set_up_q_fields</a> (current_state)</td></tr>
<tr class="separator:ae9124154f06fb20c440ccb2818cf360b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ec3363bff81914526d45d469f8f61f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a51ec3363bff81914526d45d469f8f61f">populate_q_tracer</a> (current_state, q_field)</td></tr>
<tr class="memdesc:a51ec3363bff81914526d45d469f8f61f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populates the Q tracer field based upon the configuration that has been read in from the simulation file.  <a href="namespacekidreader__mod.html#a51ec3363bff81914526d45d469f8f61f">More...</a><br /></td></tr>
<tr class="separator:a51ec3363bff81914526d45d469f8f61f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfc5e3800867c4f8c3a9bac5df585708"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#acfc5e3800867c4f8c3a9bac5df585708">initialise_single_q_field</a> (current_state, q_id, z_size, y_size, x_size)</td></tr>
<tr class="separator:acfc5e3800867c4f8c3a9bac5df585708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6988c065e5899948abbde8abc06483"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#abb6988c065e5899948abbde8abc06483">decompose_grid</a> (current_state)</td></tr>
<tr class="memdesc:abb6988c065e5899948abbde8abc06483"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls the decomposition procedure to decompose the grid and determine neighbouring processes If no decomposition procedure is specified then this results in an error.  <a href="namespacekidreader__mod.html#abb6988c065e5899948abbde8abc06483">More...</a><br /></td></tr>
<tr class="separator:abb6988c065e5899948abbde8abc06483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5071b64d431379aa743666f3ee06dc7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ab5071b64d431379aa743666f3ee06dc7">initalise_source_and_z_fields</a> (current_state)</td></tr>
<tr class="memdesc:ab5071b64d431379aa743666f3ee06dc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Based upon the local grid this will initialise the Source, Z and SAV fields for each prognostic.  <a href="namespacekidreader__mod.html#ab5071b64d431379aa743666f3ee06dc7">More...</a><br /></td></tr>
<tr class="separator:ab5071b64d431379aa743666f3ee06dc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af488eb180d4f79b7968365c498d2d7aa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#af488eb180d4f79b7968365c498d2d7aa">initialise_velocity_field</a> (local_grid, field, z_grid, y_grid, x_grid, data)</td></tr>
<tr class="memdesc:af488eb180d4f79b7968365c498d2d7aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will initialise a velocity field with the loaded data.  <a href="namespacekidreader__mod.html#af488eb180d4f79b7968365c498d2d7aa">More...</a><br /></td></tr>
<tr class="separator:af488eb180d4f79b7968365c498d2d7aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac553bcd0f1df9d9c7241337d0ab6d2b6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ac553bcd0f1df9d9c7241337d0ab6d2b6">create_grid</a> (specific_grid, z, x, z_dim, x_dim, my_rank)</td></tr>
<tr class="memdesc:ac553bcd0f1df9d9c7241337d0ab6d2b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a specific grid based upon the data read from the KiD model NetCDF file.  <a href="namespacekidreader__mod.html#ac553bcd0f1df9d9c7241337d0ab6d2b6">More...</a><br /></td></tr>
<tr class="separator:ac553bcd0f1df9d9c7241337d0ab6d2b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad348435e55eecf344b6aa120a8cbfdb8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ad348435e55eecf344b6aa120a8cbfdb8">define_vertical_levels</a> (current_state, z, z_size)</td></tr>
<tr class="memdesc:ad348435e55eecf344b6aa120a8cbfdb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the vertical levels of the grid. This is both the grid points and corresponding height for each point in metres.  <a href="namespacekidreader__mod.html#ad348435e55eecf344b6aa120a8cbfdb8">More...</a><br /></td></tr>
<tr class="separator:ad348435e55eecf344b6aa120a8cbfdb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a045f4b17a96ad277741c715d5a0852d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a045f4b17a96ad277741c715d5a0852d6">check_kinematics_file</a> (ncid)</td></tr>
<tr class="memdesc:a045f4b17a96ad277741c715d5a0852d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks that the kinematics file that has been loaded is consistent with what we expect.  <a href="namespacekidreader__mod.html#a045f4b17a96ad277741c715d5a0852d6">More...</a><br /></td></tr>
<tr class="separator:a045f4b17a96ad277741c715d5a0852d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aacef0b2cd322378c4ba2b83ecc7b43"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a0aacef0b2cd322378c4ba2b83ecc7b43">read_variables</a> (ncid, time_dim, z_dim, z_half_dim, x_dim, x_half_dim, time, x, z, x_half, z_half, u, w, v)</td></tr>
<tr class="memdesc:a0aacef0b2cd322378c4ba2b83ecc7b43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the variables from the NetCDF KiD model file.  <a href="namespacekidreader__mod.html#a0aacef0b2cd322378c4ba2b83ecc7b43">More...</a><br /></td></tr>
<tr class="separator:a0aacef0b2cd322378c4ba2b83ecc7b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a8e1c5ed9fe3eeb73f85c224aa10205"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a9a8e1c5ed9fe3eeb73f85c224aa10205">read_single_variable</a> (ncid, key, data1d, data3d)</td></tr>
<tr class="memdesc:a9a8e1c5ed9fe3eeb73f85c224aa10205"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a single variable out of a NetCDF file.  <a href="namespacekidreader__mod.html#a9a8e1c5ed9fe3eeb73f85c224aa10205">More...</a><br /></td></tr>
<tr class="separator:a9a8e1c5ed9fe3eeb73f85c224aa10205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae657e8566bd608d51e76bbaf1e541d90"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ae657e8566bd608d51e76bbaf1e541d90">read_dimensions</a> (ncid, time_dim, z_dim, z_half_dim, x_dim, x_half_dim)</td></tr>
<tr class="memdesc:ae657e8566bd608d51e76bbaf1e541d90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the dimensions from the NetCDF file.  <a href="namespacekidreader__mod.html#ae657e8566bd608d51e76bbaf1e541d90">More...</a><br /></td></tr>
<tr class="separator:ae657e8566bd608d51e76bbaf1e541d90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dd96fb9d146b7cf370e4d7d736536f7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a7dd96fb9d146b7cf370e4d7d736536f7">read_global_attributes</a> (ncid, pid)</td></tr>
<tr class="memdesc:a7dd96fb9d146b7cf370e4d7d736536f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will read the global attributes of the NetCDF KiD model dump and log_log them to debug.  <a href="namespacekidreader__mod.html#a7dd96fb9d146b7cf370e4d7d736536f7">More...</a><br /></td></tr>
<tr class="separator:a7dd96fb9d146b7cf370e4d7d736536f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf68e89b47dd29a41d3890be5b6c8dc6"><td class="memItemLeft" align="right" valign="top">character(len=:) function, allocatable, target&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#aaf68e89b47dd29a41d3890be5b6c8dc6">read_specific_global_attribute</a> (ncid, key)</td></tr>
<tr class="memdesc:aaf68e89b47dd29a41d3890be5b6c8dc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will read a specific global NetCDF attribute.  <a href="namespacekidreader__mod.html#aaf68e89b47dd29a41d3890be5b6c8dc6">More...</a><br /></td></tr>
<tr class="separator:aaf68e89b47dd29a41d3890be5b6c8dc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9f2bccbc716c31a3601423e6c0cf8cc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ae9f2bccbc716c31a3601423e6c0cf8cc">check_status</a> (status)</td></tr>
<tr class="memdesc:ae9f2bccbc716c31a3601423e6c0cf8cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will check a NetCDF status and write to log_log error any decoded statuses.  <a href="namespacekidreader__mod.html#ae9f2bccbc716c31a3601423e6c0cf8cc">More...</a><br /></td></tr>
<tr class="separator:ae9f2bccbc716c31a3601423e6c0cf8cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a628f29f4ef5b7e7952bfad91193a777c"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a628f29f4ef5b7e7952bfad91193a777c">number_q_coords</a> = 100</td></tr>
<tr class="memdesc:a628f29f4ef5b7e7952bfad91193a777c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of Q field value coords that can be specified.  <a href="namespacekidreader__mod.html#a628f29f4ef5b7e7952bfad91193a777c">More...</a><br /></td></tr>
<tr class="separator:a628f29f4ef5b7e7952bfad91193a777c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9b653d49f9483c5b1e9bea1f09afc95"><td class="memItemLeft" align="right" valign="top">character(len= *), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ae9b653d49f9483c5b1e9bea1f09afc95">time_key</a> = &quot;time&quot;</td></tr>
<tr class="memdesc:ae9b653d49f9483c5b1e9bea1f09afc95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corresponding NetCDF data time key.  <a href="namespacekidreader__mod.html#ae9b653d49f9483c5b1e9bea1f09afc95">More...</a><br /></td></tr>
<tr class="separator:ae9b653d49f9483c5b1e9bea1f09afc95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34750642752e8457bbc1530cec5017f1"><td class="memItemLeft" align="right" valign="top">character(len= *), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a34750642752e8457bbc1530cec5017f1">z_key</a> = &quot;z&quot;</td></tr>
<tr class="memdesc:a34750642752e8457bbc1530cec5017f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corresponding NetCDF data z (primal grid) key.  <a href="namespacekidreader__mod.html#a34750642752e8457bbc1530cec5017f1">More...</a><br /></td></tr>
<tr class="separator:a34750642752e8457bbc1530cec5017f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dbc5a01aaf39abda8fd68cb197500d8"><td class="memItemLeft" align="right" valign="top">character(len= *), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a2dbc5a01aaf39abda8fd68cb197500d8">z_half_key</a> = &quot;z_half&quot;</td></tr>
<tr class="memdesc:a2dbc5a01aaf39abda8fd68cb197500d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corresponding NetCDF data z half (dual grid) key.  <a href="namespacekidreader__mod.html#a2dbc5a01aaf39abda8fd68cb197500d8">More...</a><br /></td></tr>
<tr class="separator:a2dbc5a01aaf39abda8fd68cb197500d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f5641957cf95d6931eec7fc604c3d70"><td class="memItemLeft" align="right" valign="top">character(len= *), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a6f5641957cf95d6931eec7fc604c3d70">x_key</a> = &quot;x&quot;</td></tr>
<tr class="memdesc:a6f5641957cf95d6931eec7fc604c3d70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corresponding NetCDF data x (primal grid) key.  <a href="namespacekidreader__mod.html#a6f5641957cf95d6931eec7fc604c3d70">More...</a><br /></td></tr>
<tr class="separator:a6f5641957cf95d6931eec7fc604c3d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4f123b4b4414e624fcf4ecb1f411e52"><td class="memItemLeft" align="right" valign="top">character(len= *), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ad4f123b4b4414e624fcf4ecb1f411e52">x_half_key</a> = &quot;x_half&quot;</td></tr>
<tr class="memdesc:ad4f123b4b4414e624fcf4ecb1f411e52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corresponding NetCDF data x half (primal grid) key.  <a href="namespacekidreader__mod.html#ad4f123b4b4414e624fcf4ecb1f411e52">More...</a><br /></td></tr>
<tr class="separator:ad4f123b4b4414e624fcf4ecb1f411e52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b4bb65b29fb84ca7b50318b2b3103b5"><td class="memItemLeft" align="right" valign="top">character(len= *), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a3b4bb65b29fb84ca7b50318b2b3103b5">u_key</a> =&quot;u&quot;</td></tr>
<tr class="memdesc:a3b4bb65b29fb84ca7b50318b2b3103b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corresponding NetCDF data u flow field key.  <a href="namespacekidreader__mod.html#a3b4bb65b29fb84ca7b50318b2b3103b5">More...</a><br /></td></tr>
<tr class="separator:a3b4bb65b29fb84ca7b50318b2b3103b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a69c3e6302647b71bfbbc14b1dce2d"><td class="memItemLeft" align="right" valign="top">character(len= *), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ac5a69c3e6302647b71bfbbc14b1dce2d">w_key</a> =&quot;w&quot;</td></tr>
<tr class="memdesc:ac5a69c3e6302647b71bfbbc14b1dce2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corresponding NetCDF data w flow field key.  <a href="namespacekidreader__mod.html#ac5a69c3e6302647b71bfbbc14b1dce2d">More...</a><br /></td></tr>
<tr class="separator:ac5a69c3e6302647b71bfbbc14b1dce2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50102511477ac9b68677fd90c2688129"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a50102511477ac9b68677fd90c2688129">flood_q</a> = .false.</td></tr>
<tr class="separator:a50102511477ac9b68677fd90c2688129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e94b0fbf39db55abdf086630dc8038c"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a3e94b0fbf39db55abdf086630dc8038c">float_q</a> = .false.</td></tr>
<tr class="separator:a3e94b0fbf39db55abdf086630dc8038c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8f02ff2f49962431b1c012bf4b8ec9"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a0b8f02ff2f49962431b1c012bf4b8ec9">clone_to_3d</a> = .false.</td></tr>
<tr class="separator:a0b8f02ff2f49962431b1c012bf4b8ec9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e25ea32e1250b0a1bfd8b3ae60548cc"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a2e25ea32e1250b0a1bfd8b3ae60548cc">rotate_xy</a> =.false.</td></tr>
<tr class="separator:a2e25ea32e1250b0a1bfd8b3ae60548cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47461c9d85666711e2a9b17f7c8b5aa1"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a47461c9d85666711e2a9b17f7c8b5aa1">domain_multiplication</a> =1</td></tr>
<tr class="memdesc:a47461c9d85666711e2a9b17f7c8b5aa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Q field coordinates configured by the user.  <a href="namespacekidreader__mod.html#a47461c9d85666711e2a9b17f7c8b5aa1">More...</a><br /></td></tr>
<tr class="separator:a47461c9d85666711e2a9b17f7c8b5aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43a608fd43dbebbef5cd4eec7885e584"><td class="memItemLeft" align="right" valign="top">integer, dimension(<a class="el" href="namespacekidreader__mod.html#a628f29f4ef5b7e7952bfad91193a777c">number_q_coords</a>), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a43a608fd43dbebbef5cd4eec7885e584">q_coordinates_x</a></td></tr>
<tr class="separator:a43a608fd43dbebbef5cd4eec7885e584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad597a735cf8a1f2d8e748e633d55772f"><td class="memItemLeft" align="right" valign="top">integer, dimension(<a class="el" href="namespacekidreader__mod.html#a628f29f4ef5b7e7952bfad91193a777c">number_q_coords</a>), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ad597a735cf8a1f2d8e748e633d55772f">q_coordinates_y</a></td></tr>
<tr class="separator:ad597a735cf8a1f2d8e748e633d55772f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6c438a27c1dc459320efcc6ef505426"><td class="memItemLeft" align="right" valign="top">integer, dimension(<a class="el" href="namespacekidreader__mod.html#a628f29f4ef5b7e7952bfad91193a777c">number_q_coords</a>), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#ac6c438a27c1dc459320efcc6ef505426">q_coordinates_z</a></td></tr>
<tr class="separator:ac6c438a27c1dc459320efcc6ef505426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48935b661903548bd9decf9ad242e7d6"><td class="memItemLeft" align="right" valign="top">integer, dimension(<a class="el" href="namespacekidreader__mod.html#a628f29f4ef5b7e7952bfad91193a777c">number_q_coords</a>), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a48935b661903548bd9decf9ad242e7d6">q_coordinates_value</a></td></tr>
<tr class="separator:a48935b661903548bd9decf9ad242e7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74b5cf252871a0c62849d25775ed6954"><td class="memItemLeft" align="right" valign="top">character(len=string_length)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekidreader__mod.html#a74b5cf252871a0c62849d25775ed6954">configuration_file</a></td></tr>
<tr class="memdesc:a74b5cf252871a0c62849d25775ed6954"><td class="mdescLeft">&#160;</td><td class="mdescRight">NetCDF model file to load.  <a href="namespacekidreader__mod.html#a74b5cf252871a0c62849d25775ed6954">More...</a><br /></td></tr>
<tr class="separator:a74b5cf252871a0c62849d25775ed6954"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Component to set up the model based upon a KiD model configuration. </p>
<p>These data files are in NetCDF format </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a045f4b17a96ad277741c715d5a0852d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a045f4b17a96ad277741c715d5a0852d6">&#9670;&nbsp;</a></span>check_kinematics_file()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::check_kinematics_file </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks that the kinematics file that has been loaded is consistent with what we expect. </p>
<p>This checks the file against a number of limitations of the current KiD reading functionality to ensure that this component can parse it correctly </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00378">378</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncid</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">integer</span> :: ndims_in, nvars_in, ngatts_in, unlimdimid_in</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">call </span>check_status(nf90_inquire(ncid, ndims_in, nvars_in, ngatts_in, unlimdimid_in))</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (ndims_in /= 5) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;NetCDF KiD number of model dimensions must equal 5&quot;</span>)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (nvars_in /= 7) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;NetCDF KiD number of model variables must equal 5&quot;</span>)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> (ngatts_in .le. 0) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;NetCDF KiD global attributes must be specified&quot;</span>)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (unlimdimid_in .gt. 0) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;NetCDF KiD model number of unlimited dimensions must be 0&quot;</span>)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_a045f4b17a96ad277741c715d5a0852d6_cgraph.png" border="0" usemap="#anamespacekidreader__mod_a045f4b17a96ad277741c715d5a0852d6_cgraph" alt=""/></div>
<map name="namespacekidreader__mod_a045f4b17a96ad277741c715d5a0852d6_cgraph" id="anamespacekidreader__mod_a045f4b17a96ad277741c715d5a0852d6_cgraph">
<area shape="rect" title="Checks that the kinematics file that has been loaded is consistent with what we expect." alt="" coords="5,5,153,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9f2bccbc716c31a3601423e6c0cf8cc" title="Will check a NetCDF status and write to log_log error any decoded statuses." alt="" coords="201,5,349,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_a045f4b17a96ad277741c715d5a0852d6_icgraph.png" border="0" usemap="#anamespacekidreader__mod_a045f4b17a96ad277741c715d5a0852d6_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_a045f4b17a96ad277741c715d5a0852d6_icgraph" id="anamespacekidreader__mod_a045f4b17a96ad277741c715d5a0852d6_icgraph">
<area shape="rect" title="Checks that the kinematics file that has been loaded is consistent with what we expect." alt="" coords="428,5,576,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="ae9f2bccbc716c31a3601423e6c0cf8cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9f2bccbc716c31a3601423e6c0cf8cc">&#9670;&nbsp;</a></span>check_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::check_status </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will check a NetCDF status and write to log_log error any decoded statuses. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">status</td><td>The NetCDF status flag </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00535">535</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: status</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span> (status /= nf90_noerr) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;NetCDF returned error code of &quot;</span>//trim(nf90_strerror(status)))</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_ae9f2bccbc716c31a3601423e6c0cf8cc_icgraph.png" border="0" usemap="#anamespacekidreader__mod_ae9f2bccbc716c31a3601423e6c0cf8cc_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_ae9f2bccbc716c31a3601423e6c0cf8cc_icgraph" id="anamespacekidreader__mod_ae9f2bccbc716c31a3601423e6c0cf8cc_icgraph">
<area shape="rect" title="Will check a NetCDF status and write to log_log error any decoded statuses." alt="" coords="840,123,988,164"/>
<area shape="rect" href="namespacekidreader__mod.html#a045f4b17a96ad277741c715d5a0852d6" title="Checks that the kinematics file that has been loaded is consistent with what we expect." alt="" coords="428,5,576,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,123,380,164"/>
<area shape="rect" href="namespacekidreader__mod.html#ae657e8566bd608d51e76bbaf1e541d90" title="Reads the dimensions from the NetCDF file." alt="" coords="639,123,777,164"/>
<area shape="rect" href="namespacekidreader__mod.html#a9a8e1c5ed9fe3eeb73f85c224aa10205" title="Reads a single variable out of a NetCDF file." alt="" coords="639,188,777,229"/>
<area shape="rect" href="namespacekidreader__mod.html#aaf68e89b47dd29a41d3890be5b6c8dc6" title="Will read a specific global NetCDF attribute." alt="" coords="624,253,792,295"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,123,172,164"/>
<area shape="rect" href="namespacekidreader__mod.html#a0aacef0b2cd322378c4ba2b83ecc7b43" title="Reads the variables from the NetCDF KiD model file." alt="" coords="433,183,571,224"/>
<area shape="rect" href="namespacekidreader__mod.html#a7dd96fb9d146b7cf370e4d7d736536f7" title="Will read the global attributes of the NetCDF KiD model dump and log_log them to debug." alt="" coords="433,251,571,292"/>
</map>
</div>

</div>
</div>
<a id="ac553bcd0f1df9d9c7241337d0ab6d2b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac553bcd0f1df9d9c7241337d0ab6d2b6">&#9670;&nbsp;</a></span>create_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::create_grid </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrids__mod_1_1global__grid__type.html">global_grid_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>specific_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>my_rank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a specific grid based upon the data read from the KiD model NetCDF file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">specific_grid</td><td>The grid to create </td></tr>
    <tr><td class="paramname">z</td><td>Array of grid points in the z dimension </td></tr>
    <tr><td class="paramname">x</td><td>Array of grid points in the x dimension </td></tr>
    <tr><td class="paramname">z_dim</td><td>The number of points in the z dimension </td></tr>
    <tr><td class="paramname">x_dim</td><td>The number of points in the x dimension </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00304">304</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">type</span>(global_grid_type), <span class="keywordtype">intent(inout)</span> :: specific_grid</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z_dim, x_dim, my_rank</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: z, x</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    specific_grid%bottom(z_index) = int(z(1))</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    specific_grid%bottom(merge(y_index, x_index, rotate_xy)) = int(x(1))</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> (clone_to_3d) specific_grid%bottom(y_index) = int(x(1))</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    specific_grid%top(z_index) = int(z(z_dim))</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    specific_grid%top(merge(y_index, x_index, rotate_xy)) = int(x(x_dim)) * domain_multiplication</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (clone_to_3d) specific_grid%top(y_index) = int(x(x_dim)) * domain_multiplication</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    specific_grid%resolution(z_index) = int(z(2) - z(1))</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    specific_grid%resolution(merge(y_index, x_index, rotate_xy)) = int(x(2) - x(1))</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span> (clone_to_3d) specific_grid%resolution(y_index) = specific_grid%resolution(x_index)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    specific_grid%size(z_index) = z_dim</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    specific_grid%size(merge(y_index, x_index, rotate_xy)) = x_dim * domain_multiplication</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (clone_to_3d) specific_grid%size(y_index) = x_dim * domain_multiplication</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    specific_grid%active(z_index) = .true.</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    specific_grid%active(merge(y_index, x_index, rotate_xy)) = .true.</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> (clone_to_3d) specific_grid%active(y_index) = .true.</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">#ifdef U_ACTIVE</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (.not. specific_grid%active(x_index)) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, &amp;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         <span class="stringliteral">&quot;Model compiled with X active but inactive in configuration&quot;</span>)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (specific_grid%active(x_index)) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, &amp;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;         <span class="stringliteral">&quot;Model compiled with X inactive but active in configuration&quot;</span>)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (.not. specific_grid%active(y_index)) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, &amp;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         <span class="stringliteral">&quot;Model compiled with Y active but inactive in configuration&quot;</span>)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (specific_grid%active(y_index)) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, &amp;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;         <span class="stringliteral">&quot;Model compiled with Y inactive but active in configuration&quot;</span>)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W_ACTIVE</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (.not. specific_grid%active(z_index)) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, &amp;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;         <span class="stringliteral">&quot;Model compiled with Z active but inactive in configuration&quot;</span>)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (specific_grid%active(z_index)) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, &amp;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;         <span class="stringliteral">&quot;Model compiled with Z inactive but active in configuration&quot;</span>)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor"></span>    specific_grid%dimensions = merge(3, 2, clone_to_3d)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_ac553bcd0f1df9d9c7241337d0ab6d2b6_icgraph.png" border="0" usemap="#anamespacekidreader__mod_ac553bcd0f1df9d9c7241337d0ab6d2b6_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_ac553bcd0f1df9d9c7241337d0ab6d2b6_icgraph" id="anamespacekidreader__mod_ac553bcd0f1df9d9c7241337d0ab6d2b6_icgraph">
<area shape="rect" title="Creates a specific grid based upon the data read from the KiD model NetCDF file." alt="" coords="428,13,605,39"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="abb6988c065e5899948abbde8abc06483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb6988c065e5899948abbde8abc06483">&#9670;&nbsp;</a></span>decompose_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::decompose_grid </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calls the decomposition procedure to decompose the grid and determine neighbouring processes If no decomposition procedure is specified then this results in an error. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model <a class="el" href="namespacestate__mod.html" title="The model state which represents the current state of a run.">state_mod</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00191">191</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(current_state%parallel%decomposition_procedure)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keyword">call </span>current_state%parallel%decomposition_procedure(current_state)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;No decomposition specified&quot;</span>)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_abb6988c065e5899948abbde8abc06483_icgraph.png" border="0" usemap="#anamespacekidreader__mod_abb6988c065e5899948abbde8abc06483_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_abb6988c065e5899948abbde8abc06483_icgraph" id="anamespacekidreader__mod_abb6988c065e5899948abbde8abc06483_icgraph">
<area shape="rect" title="Calls the decomposition procedure to decompose the grid and determine neighbouring processes If no de..." alt="" coords="428,13,636,39"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="ad348435e55eecf344b6aa120a8cbfdb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad348435e55eecf344b6aa120a8cbfdb8">&#9670;&nbsp;</a></span>define_vertical_levels()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::define_vertical_levels </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defines the vertical levels of the grid. This is both the grid points and corresponding height for each point in metres. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model <a class="el" href="namespacestate__mod.html" title="The model state which represents the current state of a run.">state_mod</a> </td></tr>
    <tr><td class="paramname">z</td><td>Array of grid heights in metres </td></tr>
    <tr><td class="paramname">z_size</td><td>Number of grid points </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00358">358</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z_size</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keyword">allocate</span>(current_state%global_grid%configuration%vertical%kgd(z_size), &amp;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;         current_state%global_grid%configuration%vertical%hgd(z_size))</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">do</span> i=1,z_size</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      current_state%global_grid%configuration%vertical%kgd(i) = i</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      current_state%global_grid%configuration%vertical%hgd(i) = real(z(i))</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_ad348435e55eecf344b6aa120a8cbfdb8_icgraph.png" border="0" usemap="#anamespacekidreader__mod_ad348435e55eecf344b6aa120a8cbfdb8_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_ad348435e55eecf344b6aa120a8cbfdb8_icgraph" id="anamespacekidreader__mod_ad348435e55eecf344b6aa120a8cbfdb8_icgraph">
<area shape="rect" title="Defines the vertical levels of the grid. This is both the grid points and corresponding height for ea..." alt="" coords="428,5,575,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="ab5071b64d431379aa743666f3ee06dc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5071b64d431379aa743666f3ee06dc7">&#9670;&nbsp;</a></span>initalise_source_and_z_fields()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::initalise_source_and_z_fields </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Based upon the local grid this will initialise the Source, Z and SAV fields for each prognostic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00203">203</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">integer</span> :: x_size, y_size, z_size</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    z_size = current_state%local_grid%size(z_index) + current_state%local_grid%halo_size(z_index) * 2</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    y_size = current_state%local_grid%size(y_index) + current_state%local_grid%halo_size(y_index) * 2</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    x_size = current_state%local_grid%size(x_index) + current_state%local_grid%halo_size(x_index) * 2</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">#ifdef U_ACTIVE</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor"></span>    <span class="keyword">allocate</span>(current_state%zu%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keyword">allocate</span>(current_state%su%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">allocate</span>(current_state%savu%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    current_state%zu%data(:,:,:)= 0.0</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor"></span>    <span class="keyword">allocate</span>(current_state%zv%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keyword">allocate</span>(current_state%sv%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keyword">allocate</span>(current_state%savv%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    current_state%zv%data(:,:,:)= 0.0</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W_ACTIVE</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor"></span>    <span class="keyword">allocate</span>(current_state%zw%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">allocate</span>(current_state%sw%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">allocate</span>(current_state%savw%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    current_state%zw%data(:,:,:)= 0.0</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keyword">allocate</span>(current_state%zth%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keyword">allocate</span>(current_state%sth%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      current_state%zth%data(:,:,:)= 0.0</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_ab5071b64d431379aa743666f3ee06dc7_icgraph.png" border="0" usemap="#anamespacekidreader__mod_ab5071b64d431379aa743666f3ee06dc7_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_ab5071b64d431379aa743666f3ee06dc7_icgraph" id="anamespacekidreader__mod_ab5071b64d431379aa743666f3ee06dc7_icgraph">
<area shape="rect" title="Based upon the local grid this will initialise the Source, Z and SAV fields for each prognostic." alt="" coords="428,5,585,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="af9f9656d6a5514b190a7cbe2d5b1c2b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9f9656d6a5514b190a7cbe2d5b1c2b8">&#9670;&nbsp;</a></span>initialise_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::initialise_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialisation hook which will parse the configuration NetCDF file and set up the model based upon this. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model <a class="el" href="namespacestate__mod.html" title="The model state which represents the current state of a run.">state_mod</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00054">54</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">integer</span> :: ncid, time_dim, z_dim, z_half_dim, x_dim, x_half_dim</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: time, x, z, x_half, z_half</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span> :: u, w, v</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">if</span> (options_has_key(current_state%options_database, <span class="stringliteral">&quot;restart&quot;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;Ignoring KiD reader as restart from checkpoint file selected&quot;</span>)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    configuration_file=options_get_string(current_state%options_database, <span class="stringliteral">&quot;kid_configuration_file&quot;</span>)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    current_state%rhobous=options_get_real(current_state%options_database, <span class="stringliteral">&quot;rhobous&quot;</span>)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    current_state%thref0=options_get_real(current_state%options_database, <span class="stringliteral">&quot;thref0&quot;</span>)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    current_state%surface_pressure=options_get_real(current_state%options_database, <span class="stringliteral">&quot;surface_pressure&quot;</span>)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    flood_q=options_get_logical(current_state%options_database, <span class="stringliteral">&quot;flood_q&quot;</span>)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    float_q=options_get_logical(current_state%options_database, <span class="stringliteral">&quot;float_q&quot;</span>)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    clone_to_3d=options_get_logical(current_state%options_database, <span class="stringliteral">&quot;clone_to_3d&quot;</span>)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    rotate_xy=options_get_logical(current_state%options_database, <span class="stringliteral">&quot;rotate_xy&quot;</span>)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    domain_multiplication=options_get_integer(current_state%options_database, <span class="stringliteral">&quot;domain_multiplication&quot;</span>)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keyword">call </span>options_get_integer_array(current_state%options_database, <span class="stringliteral">&quot;q_coordinates_x&quot;</span>, q_coordinates_x)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keyword">call </span>options_get_integer_array(current_state%options_database, <span class="stringliteral">&quot;q_coordinates_y&quot;</span>, q_coordinates_y)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keyword">call </span>options_get_integer_array(current_state%options_database, <span class="stringliteral">&quot;q_coordinates_z&quot;</span>, q_coordinates_z)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">call </span>options_get_integer_array(current_state%options_database, <span class="stringliteral">&quot;q_coordinates_value&quot;</span>, q_coordinates_value)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keyword">call </span>check_status(nf90_open(path = trim(configuration_file), mode = nf90_nowrite, ncid = ncid))</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">call </span>check_kinematics_file(ncid)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() .ge. <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keyword">call </span>read_global_attributes(ncid, current_state%parallel%my_rank)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">call </span>read_dimensions(ncid, time_dim, z_dim, z_half_dim, x_dim, x_half_dim)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keyword">call </span>read_variables(ncid, time_dim, z_dim, z_half_dim, x_dim, x_half_dim, time, x, z, x_half, z_half, u, w, v)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">call </span>check_status(nf90_close(ncid))</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keyword">call </span>create_grid(current_state%global_grid, z_half, x_half, z_half_dim, x_half_dim, current_state%parallel%my_rank)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">call </span>define_vertical_levels(current_state, z_half, z_half_dim)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">call </span>decompose_grid(current_state)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> (rotate_xy) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keyword">call </span>initialise_velocity_field(current_state%local_grid, current_state%v, dual_grid, primal_grid, dual_grid, v)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keyword">call </span>initialise_velocity_field(current_state%local_grid, current_state%u, dual_grid, dual_grid, primal_grid, u)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">call </span>initialise_velocity_field(current_state%local_grid, current_state%w, primal_grid, dual_grid, dual_grid, w)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (clone_to_3d) <span class="keyword">call </span>initialise_velocity_field(current_state%local_grid, current_state%v, dual_grid, primal_grid, dual_grid, v)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">call </span>initalise_source_and_z_fields(current_state)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">call </span>set_up_q_fields(current_state)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    current_state%initialised=.true.</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ac7d5c1fcb00d54277580c10556aa78a8">log_info</a>, <span class="stringliteral">&quot;Initialised configuration from KiD model file `&quot;</span>//trim(configuration_file)//<span class="stringliteral">&quot;`&quot;</span>)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_af9f9656d6a5514b190a7cbe2d5b1c2b8_cgraph.png" border="0" usemap="#anamespacekidreader__mod_af9f9656d6a5514b190a7cbe2d5b1c2b8_cgraph" alt=""/></div>
<map name="namespacekidreader__mod_af9f9656d6a5514b190a7cbe2d5b1c2b8_cgraph" id="anamespacekidreader__mod_af9f9656d6a5514b190a7cbe2d5b1c2b8_cgraph">
<area shape="rect" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="5,289,165,331"/>
<area shape="rect" href="namespacekidreader__mod.html#a045f4b17a96ad277741c715d5a0852d6" title="Checks that the kinematics file that has been loaded is consistent with what we expect." alt="" coords="479,5,627,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9f2bccbc716c31a3601423e6c0cf8cc" title="Will check a NetCDF status and write to log_log error any decoded statuses." alt="" coords="685,407,833,448"/>
<area shape="rect" href="namespacekidreader__mod.html#ac553bcd0f1df9d9c7241337d0ab6d2b6" title="Creates a specific grid based upon the data read from the KiD model NetCDF file." alt="" coords="229,122,406,149"/>
<area shape="rect" href="namespacekidreader__mod.html#abb6988c065e5899948abbde8abc06483" title="Calls the decomposition procedure to decompose the grid and determine neighbouring processes If no de..." alt="" coords="213,173,421,199"/>
<area shape="rect" href="namespacekidreader__mod.html#ad348435e55eecf344b6aa120a8cbfdb8" title="Defines the vertical levels of the grid. This is both the grid points and corresponding height for ea..." alt="" coords="244,224,391,265"/>
<area shape="rect" href="namespacekidreader__mod.html#ab5071b64d431379aa743666f3ee06dc7" title="Based upon the local grid this will initialise the Source, Z and SAV fields for each prognostic." alt="" coords="239,289,396,331"/>
<area shape="rect" href="namespacekidreader__mod.html#af488eb180d4f79b7968365c498d2d7aa" title="Will initialise a velocity field with the loaded data." alt="" coords="237,355,397,396"/>
<area shape="rect" href="namespacekidreader__mod.html#ae657e8566bd608d51e76bbaf1e541d90" title="Reads the dimensions from the NetCDF file." alt="" coords="484,407,623,448"/>
<area shape="rect" href="namespacekidreader__mod.html#a7dd96fb9d146b7cf370e4d7d736536f7" title="Will read the global attributes of the NetCDF KiD model dump and log_log them to debug." alt="" coords="248,472,387,513"/>
<area shape="rect" href="namespacekidreader__mod.html#a0aacef0b2cd322378c4ba2b83ecc7b43" title="Reads the variables from the NetCDF KiD model file." alt="" coords="248,537,387,579"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9124154f06fb20c440ccb2818cf360b" title=" " alt="" coords="252,603,383,644"/>
<area shape="rect" href="namespacekidreader__mod.html#aaf68e89b47dd29a41d3890be5b6c8dc6" title="Will read a specific global NetCDF attribute." alt="" coords="469,472,637,513"/>
<area shape="rect" href="namespacekidreader__mod.html#a9a8e1c5ed9fe3eeb73f85c224aa10205" title="Reads a single variable out of a NetCDF file." alt="" coords="484,537,623,579"/>
<area shape="rect" href="namespacekidreader__mod.html#acfc5e3800867c4f8c3a9bac5df585708" title=" " alt="" coords="473,603,633,644"/>
<area shape="rect" href="namespacekidreader__mod.html#a51ec3363bff81914526d45d469f8f61f" title="Populates the Q tracer field based upon the configuration that has been read in from the simulation f..." alt="" coords="472,668,635,709"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_af9f9656d6a5514b190a7cbe2d5b1c2b8_icgraph.png" border="0" usemap="#anamespacekidreader__mod_af9f9656d6a5514b190a7cbe2d5b1c2b8_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_af9f9656d6a5514b190a7cbe2d5b1c2b8_icgraph" id="anamespacekidreader__mod_af9f9656d6a5514b190a7cbe2d5b1c2b8_icgraph">
<area shape="rect" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="acfc5e3800867c4f8c3a9bac5df585708"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfc5e3800867c4f8c3a9bac5df585708">&#9670;&nbsp;</a></span>initialise_single_q_field()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::initialise_single_q_field </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>q_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>y_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00174">174</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: q_id, x_size, y_size, z_size</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keyword">allocate</span>(current_state%q(q_id)%data(z_size, y_size, x_size), current_state%zq(q_id)%data(z_size, y_size, x_size), &amp;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;         current_state%sq(q_id)%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    current_state%q(q_id)%data(:,:,:) = 0.</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    current_state%zq(q_id)%data(:,:,:) = 0.</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    current_state%sq(q_id)%data(:,:,:) = 0.</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    current_state%q(q_id)%active=.true.</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    current_state%zq(q_id)%active=.true.</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    current_state%sq(q_id)%active=.true.</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_acfc5e3800867c4f8c3a9bac5df585708_icgraph.png" border="0" usemap="#anamespacekidreader__mod_acfc5e3800867c4f8c3a9bac5df585708_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_acfc5e3800867c4f8c3a9bac5df585708_icgraph" id="anamespacekidreader__mod_acfc5e3800867c4f8c3a9bac5df585708_icgraph">
<area shape="rect" title=" " alt="" coords="607,5,767,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9124154f06fb20c440ccb2818cf360b" title=" " alt="" coords="428,5,559,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="af488eb180d4f79b7968365c498d2d7aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af488eb180d4f79b7968365c498d2d7aa">&#9670;&nbsp;</a></span>initialise_velocity_field()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::initialise_velocity_field </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrids__mod_1_1local__grid__type.html">local_grid_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>local_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>y_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will initialise a velocity field with the loaded data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>The velocity field to initialise </td></tr>
    <tr><td class="paramname">z_dim</td><td>The size of the z dimension </td></tr>
    <tr><td class="paramname">y_dim</td><td>The size of the y dimension </td></tr>
    <tr><td class="paramname">x_dim</td><td>The size of the x dimension </td></tr>
    <tr><td class="paramname">grid</td><td>The applicable grid to place this field upon </td></tr>
    <tr><td class="paramname">data</td><td>The NetCDF KiD model data to load into the velocity field </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00244">244</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">type</span>(local_grid_type), <span class="keywordtype">intent(inout)</span> :: local_grid</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: field</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z_grid, y_grid, x_grid</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(in)</span> :: data</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">integer</span> :: i, j, k, preMulSizeY, preMulSizeX</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    field%grid(z_index) = z_grid</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    field%grid(y_index) = y_grid</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    field%grid(x_index) = x_grid</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    field%active = .true.</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keyword">allocate</span>(field%data(local_grid%size(z_index) + local_grid%halo_size(z_index) * 2, local_grid%size(y_index) + &amp;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         local_grid%halo_size(y_index) * 2, local_grid%size(x_index) + local_grid%halo_size(x_index) * 2))</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    field%data=0.0</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">! Divisions here are for the multiplication - we just fill up the original size and then duplicate this across dimensions</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">do</span> i=ceiling(local_grid%start(x_index)/real(domain_multiplication)),&amp;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;         ceiling(local_grid%end(x_index)/real(domain_multiplication))</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">do</span> j=ceiling(local_grid%start(y_index)/real(domain_multiplication)),&amp;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;           ceiling(local_grid%end(y_index)/real(domain_multiplication))</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">do</span> k=local_grid%start(z_index),local_grid%end(z_index)          </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          field%data(local_grid%halo_size(z_index)+(k-((local_grid%start(z_index)-1))), local_grid%halo_size(y_index)+&amp;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;               (j-((ceiling(local_grid%start(y_index)/ real(domain_multiplication))-1))), local_grid%halo_size(x_index)+&amp;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;               (i- ((ceiling(local_grid%start(x_index)/real(domain_multiplication))-1)))) = &amp;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keywordtype">               real</span>(data(1, k, merge(j, i, rotate_xy)), kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span> (domain_multiplication .ge. 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="comment">! If there is a domain multiplication then duplicate data across dimensions</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      premulsizey = ceiling(local_grid%size(y_index) / real(domain_multiplication))</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      premulsizex = ceiling(local_grid%size(x_index) / real(domain_multiplication))</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">if</span> (local_grid%active(y_index)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">do</span> i=1,domain_multiplication-1</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          field%data(:, local_grid%halo_size(y_index) + i*premulsizey +1 : local_grid%halo_size(y_index) + (i+1)*premulsizey, &amp;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;               local_grid%halo_size(x_index)+1: local_grid%halo_size(x_index)+premulsizex) = &amp;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;               field%data(:, local_grid%halo_size(y_index)+1 : local_grid%halo_size(y_index) + premulsizey, &amp;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;               local_grid%halo_size(x_index)+1 : local_grid%halo_size(x_index)+premulsizex)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">if</span> (local_grid%active(x_index)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">do</span> i=1,domain_multiplication-1</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          field%data(:, local_grid%local_domain_start_index(y_index) : local_grid%local_domain_end_index(y_index), &amp;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;               local_grid%halo_size(x_index) + i*premulsizex + 1 : local_grid%halo_size(x_index) + (i+1)*premulsizex) = &amp;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;               field%data(:, local_grid%local_domain_start_index(y_index) : local_grid%local_domain_end_index(y_index), &amp;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;               local_grid%halo_size(x_index)+1 : local_grid%halo_size(x_index)+premulsizex)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_af488eb180d4f79b7968365c498d2d7aa_icgraph.png" border="0" usemap="#anamespacekidreader__mod_af488eb180d4f79b7968365c498d2d7aa_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_af488eb180d4f79b7968365c498d2d7aa_icgraph" id="anamespacekidreader__mod_af488eb180d4f79b7968365c498d2d7aa_icgraph">
<area shape="rect" title="Will initialise a velocity field with the loaded data." alt="" coords="428,5,588,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="ac25b32ce129dab62a39885672825763e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac25b32ce129dab62a39885672825763e">&#9670;&nbsp;</a></span>kidreader_get_descriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structmonc__component__mod_1_1component__descriptor__type.html">component_descriptor_type</a>) function, public kidreader_mod::kidreader_get_descriptor</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provides the descriptor back to the caller and is used in component registration. </p>
<dl class="section return"><dt>Returns</dt><dd>The KidReader component descriptor </dd></dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00045">45</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    kidreader_get_descriptor%name=<span class="stringliteral">&quot;kidreader&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    kidreader_get_descriptor%version=0.1</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    kidreader_get_descriptor%initialisation=&gt;initialise_callback</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_ac25b32ce129dab62a39885672825763e_cgraph.png" border="0" usemap="#anamespacekidreader__mod_ac25b32ce129dab62a39885672825763e_cgraph" alt=""/></div>
<map name="namespacekidreader__mod_ac25b32ce129dab62a39885672825763e_cgraph" id="anamespacekidreader__mod_ac25b32ce129dab62a39885672825763e_cgraph">
<area shape="rect" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,289,172,331"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,289,380,331"/>
<area shape="rect" href="namespacekidreader__mod.html#a045f4b17a96ad277741c715d5a0852d6" title="Checks that the kinematics file that has been loaded is consistent with what we expect." alt="" coords="694,5,842,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9f2bccbc716c31a3601423e6c0cf8cc" title="Will check a NetCDF status and write to log_log error any decoded statuses." alt="" coords="900,407,1048,448"/>
<area shape="rect" href="namespacekidreader__mod.html#ac553bcd0f1df9d9c7241337d0ab6d2b6" title="Creates a specific grid based upon the data read from the KiD model NetCDF file." alt="" coords="443,122,621,149"/>
<area shape="rect" href="namespacekidreader__mod.html#abb6988c065e5899948abbde8abc06483" title="Calls the decomposition procedure to decompose the grid and determine neighbouring processes If no de..." alt="" coords="428,173,636,199"/>
<area shape="rect" href="namespacekidreader__mod.html#ad348435e55eecf344b6aa120a8cbfdb8" title="Defines the vertical levels of the grid. This is both the grid points and corresponding height for ea..." alt="" coords="459,224,605,265"/>
<area shape="rect" href="namespacekidreader__mod.html#ab5071b64d431379aa743666f3ee06dc7" title="Based upon the local grid this will initialise the Source, Z and SAV fields for each prognostic." alt="" coords="453,289,611,331"/>
<area shape="rect" href="namespacekidreader__mod.html#af488eb180d4f79b7968365c498d2d7aa" title="Will initialise a velocity field with the loaded data." alt="" coords="452,355,612,396"/>
<area shape="rect" href="namespacekidreader__mod.html#ae657e8566bd608d51e76bbaf1e541d90" title="Reads the dimensions from the NetCDF file." alt="" coords="699,407,837,448"/>
<area shape="rect" href="namespacekidreader__mod.html#a7dd96fb9d146b7cf370e4d7d736536f7" title="Will read the global attributes of the NetCDF KiD model dump and log_log them to debug." alt="" coords="463,472,601,513"/>
<area shape="rect" href="namespacekidreader__mod.html#a0aacef0b2cd322378c4ba2b83ecc7b43" title="Reads the variables from the NetCDF KiD model file." alt="" coords="463,537,601,579"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9124154f06fb20c440ccb2818cf360b" title=" " alt="" coords="467,603,597,644"/>
<area shape="rect" href="namespacekidreader__mod.html#aaf68e89b47dd29a41d3890be5b6c8dc6" title="Will read a specific global NetCDF attribute." alt="" coords="684,472,852,513"/>
<area shape="rect" href="namespacekidreader__mod.html#a9a8e1c5ed9fe3eeb73f85c224aa10205" title="Reads a single variable out of a NetCDF file." alt="" coords="699,537,837,579"/>
<area shape="rect" href="namespacekidreader__mod.html#acfc5e3800867c4f8c3a9bac5df585708" title=" " alt="" coords="688,603,848,644"/>
<area shape="rect" href="namespacekidreader__mod.html#a51ec3363bff81914526d45d469f8f61f" title="Populates the Q tracer field based upon the configuration that has been read in from the simulation f..." alt="" coords="687,668,849,709"/>
</map>
</div>

</div>
</div>
<a id="a51ec3363bff81914526d45d469f8f61f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51ec3363bff81914526d45d469f8f61f">&#9670;&nbsp;</a></span>populate_q_tracer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::populate_q_tracer </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>q_field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Populates the Q tracer field based upon the configuration that has been read in from the simulation file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model <a class="el" href="namespacestate__mod.html" title="The model state which represents the current state of a run.">state_mod</a> </td></tr>
    <tr><td class="paramname">q_field</td><td>The qfield that we are going to fill in </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00131">131</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: q_field</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">integer</span> :: i, x_local, y_local</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">do</span> i=1,number_q_coords</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">if</span> (q_coordinates_x(i) .ne. -1 .and. q_coordinates_y(i) .ne. -1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> (q_coordinates_x(i) .ne. 0 .and. .not. (q_coordinates_x(i) .ge. current_state%local_grid%start(x_index) .and. &amp;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;             q_coordinates_x(i) .le. current_state%local_grid%end(x_index))) cycle</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">if</span> (q_coordinates_y(i) .ne. 0 .and. .not. (q_coordinates_y(i) .ge. current_state%local_grid%start(y_index) .and. &amp;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;             q_coordinates_y(i) .le. current_state%local_grid%end(y_index))) cycle</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        x_local=(q_coordinates_x(i) - (current_state%local_grid%start(x_index)-1)) + current_state%local_grid%halo_size(x_index)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        y_local=(q_coordinates_y(i) - (current_state%local_grid%start(y_index)-1)) + current_state%local_grid%halo_size(y_index)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">if</span> (q_coordinates_z(i) == 0 .and. q_coordinates_y(i) == 0 .and. q_coordinates_x(i) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          q_field%data(:,current_state%local_grid%local_domain_start_index(y_index):&amp;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;               current_state%local_grid%local_domain_end_index(y_index),current_state%local_grid%local_domain_start_index(x_index):&amp;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;               current_state%local_grid%local_domain_end_index(x_index)) = q_coordinates_value(i)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q_coordinates_z(i) == 0 .and. q_coordinates_y(i) == 0 .and. q_coordinates_x(i) .ne. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          q_field%data(:,current_state%local_grid%local_domain_start_index(y_index):&amp;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;               current_state%local_grid%local_domain_end_index(y_index),x_local) = q_coordinates_value(i)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q_coordinates_z(i) == 0 .and. q_coordinates_y(i) .ne. 0 .and. q_coordinates_x(i) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          q_field%data(:,y_local,current_state%local_grid%local_domain_start_index(x_index):&amp;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;               current_state%local_grid%local_domain_end_index(x_index)) = q_coordinates_value(i)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q_coordinates_z(i) == 0 .and. q_coordinates_y(i) .ne. 0 .and. q_coordinates_x(i) .ne. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          q_field%data(:,y_local,x_local) = q_coordinates_value(i)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q_coordinates_z(i) .ne. 0 .and. q_coordinates_y(i) == 0 .and. q_coordinates_x(i) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          q_field%data(q_coordinates_z(i),current_state%local_grid%local_domain_start_index(y_index):&amp;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;               current_state%local_grid%local_domain_end_index(y_index),current_state%local_grid%local_domain_start_index(x_index):&amp;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;               current_state%local_grid%local_domain_end_index(x_index)) = q_coordinates_value(i)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q_coordinates_z(i) .ne. 0 .and. q_coordinates_y(i) == 0 .and. q_coordinates_x(i) .ne. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          q_field%data(q_coordinates_z(i),current_state%local_grid%local_domain_start_index(y_index):&amp;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;               current_state%local_grid%local_domain_end_index(y_index),x_local) = q_coordinates_value(i)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q_coordinates_z(i) .ne. 0 .and. q_coordinates_y(i) .ne. 0 .and. q_coordinates_x(i) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          q_field%data(q_coordinates_z(i),y_local,current_state%local_grid%local_domain_start_index(x_index):&amp;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;               current_state%local_grid%local_domain_end_index(x_index)) = q_coordinates_value(i)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q_coordinates_z(i) .ne. 0 .and. q_coordinates_y(i) .ne. 0 .and. q_coordinates_x(i) .ne. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          q_field%data(q_coordinates_z(i),y_local,x_local) = q_coordinates_value(i)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_a51ec3363bff81914526d45d469f8f61f_icgraph.png" border="0" usemap="#anamespacekidreader__mod_a51ec3363bff81914526d45d469f8f61f_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_a51ec3363bff81914526d45d469f8f61f_icgraph" id="anamespacekidreader__mod_a51ec3363bff81914526d45d469f8f61f_icgraph">
<area shape="rect" title="Populates the Q tracer field based upon the configuration that has been read in from the simulation f..." alt="" coords="607,5,769,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9124154f06fb20c440ccb2818cf360b" title=" " alt="" coords="428,5,559,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="ae657e8566bd608d51e76bbaf1e541d90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae657e8566bd608d51e76bbaf1e541d90">&#9670;&nbsp;</a></span>read_dimensions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::read_dimensions </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>time_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>z_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>z_half_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>x_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>x_half_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads the dimensions from the NetCDF file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>The NetCDF file id </td></tr>
    <tr><td class="paramname">time_dim</td><td>Number of elements in the time dimension </td></tr>
    <tr><td class="paramname">z_dim</td><td>Number of elements in the z dimension of the primal grid </td></tr>
    <tr><td class="paramname">z_half_dim</td><td>Number of elements in the z dimension of the dual grid </td></tr>
    <tr><td class="paramname">x_dim</td><td>Number of elements in the x dimension of the primal grid </td></tr>
    <tr><td class="paramname">x_half_dim</td><td>Number of elements in the x dimension of the dual grid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00482">482</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncid</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> ::  time_dim, z_dim, z_half_dim, x_dim, x_half_dim</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordtype">integer</span> ::  time_dimid, z_dimid, z_half_dimid, x_dimid, x_half_dimid</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keyword">call </span>check_status(nf90_inq_dimid(ncid, time_key, time_dimid))</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keyword">call </span>check_status(nf90_inq_dimid(ncid, z_key, z_dimid))</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keyword">call </span>check_status(nf90_inq_dimid(ncid, z_half_key, z_half_dimid))</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keyword">call </span>check_status(nf90_inq_dimid(ncid, x_key, x_dimid))</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keyword">call </span>check_status(nf90_inq_dimid(ncid, x_half_key, x_half_dimid))</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keyword">call </span>check_status(nf90_inquire_dimension(ncid, time_dimid, len=time_dim))</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keyword">call </span>check_status(nf90_inquire_dimension(ncid, z_dimid, len=z_dim))</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keyword">call </span>check_status(nf90_inquire_dimension(ncid, z_half_dimid, len=z_half_dim))</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keyword">call </span>check_status(nf90_inquire_dimension(ncid, x_dimid, len=x_dim))</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keyword">call </span>check_status(nf90_inquire_dimension(ncid, x_half_dimid, len=x_half_dim))</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_ae657e8566bd608d51e76bbaf1e541d90_cgraph.png" border="0" usemap="#anamespacekidreader__mod_ae657e8566bd608d51e76bbaf1e541d90_cgraph" alt=""/></div>
<map name="namespacekidreader__mod_ae657e8566bd608d51e76bbaf1e541d90_cgraph" id="anamespacekidreader__mod_ae657e8566bd608d51e76bbaf1e541d90_cgraph">
<area shape="rect" title="Reads the dimensions from the NetCDF file." alt="" coords="5,5,144,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9f2bccbc716c31a3601423e6c0cf8cc" title="Will check a NetCDF status and write to log_log error any decoded statuses." alt="" coords="192,5,340,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_ae657e8566bd608d51e76bbaf1e541d90_icgraph.png" border="0" usemap="#anamespacekidreader__mod_ae657e8566bd608d51e76bbaf1e541d90_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_ae657e8566bd608d51e76bbaf1e541d90_icgraph" id="anamespacekidreader__mod_ae657e8566bd608d51e76bbaf1e541d90_icgraph">
<area shape="rect" title="Reads the dimensions from the NetCDF file." alt="" coords="428,5,567,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="a7dd96fb9d146b7cf370e4d7d736536f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dd96fb9d146b7cf370e4d7d736536f7">&#9670;&nbsp;</a></span>read_global_attributes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::read_global_attributes </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>pid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will read the global attributes of the NetCDF KiD model dump and log_log them to debug. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>The NetCDF file id </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00503">503</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncid, pid</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">character(len=:)</span>, <span class="keywordtype">allocatable</span> :: attributeValue</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    attributevalue=read_specific_global_attribute(ncid, <span class="stringliteral">&quot;title&quot;</span>)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;KiD file title: &quot;</span>//attributevalue)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keyword">deallocate</span>(attributevalue)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    attributevalue=read_specific_global_attribute(ncid, <span class="stringliteral">&quot;creation date&quot;</span>)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;KiD file created: &quot;</span>//attributevalue)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keyword">deallocate</span>(attributevalue)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_a7dd96fb9d146b7cf370e4d7d736536f7_cgraph.png" border="0" usemap="#anamespacekidreader__mod_a7dd96fb9d146b7cf370e4d7d736536f7_cgraph" alt=""/></div>
<map name="namespacekidreader__mod_a7dd96fb9d146b7cf370e4d7d736536f7_cgraph" id="anamespacekidreader__mod_a7dd96fb9d146b7cf370e4d7d736536f7_cgraph">
<area shape="rect" title="Will read the global attributes of the NetCDF KiD model dump and log_log them to debug." alt="" coords="5,5,144,47"/>
<area shape="rect" href="namespacekidreader__mod.html#aaf68e89b47dd29a41d3890be5b6c8dc6" title="Will read a specific global NetCDF attribute." alt="" coords="192,5,360,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9f2bccbc716c31a3601423e6c0cf8cc" title="Will check a NetCDF status and write to log_log error any decoded statuses." alt="" coords="408,5,556,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_a7dd96fb9d146b7cf370e4d7d736536f7_icgraph.png" border="0" usemap="#anamespacekidreader__mod_a7dd96fb9d146b7cf370e4d7d736536f7_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_a7dd96fb9d146b7cf370e4d7d736536f7_icgraph" id="anamespacekidreader__mod_a7dd96fb9d146b7cf370e4d7d736536f7_icgraph">
<area shape="rect" title="Will read the global attributes of the NetCDF KiD model dump and log_log them to debug." alt="" coords="428,5,567,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="a9a8e1c5ed9fe3eeb73f85c224aa10205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a8e1c5ed9fe3eeb73f85c224aa10205">&#9670;&nbsp;</a></span>read_single_variable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::read_single_variable </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>data1d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>data3d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads a single variable out of a NetCDF file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>The NetCDF file id </td></tr>
    <tr><td class="paramname">key</td><td>The variable key (name) to access </td></tr>
    <tr><td class="paramname">data1d</td><td>Optional one dimensional data to read into </td></tr>
    <tr><td class="paramname">data3d</td><td>Optional three dimensional data to read into </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00451">451</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncid</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: key</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: data1d</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: data3d</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">integer</span> :: variable_id</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span> :: sdata</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keyword">call </span>check_status(nf90_inq_varid(ncid, key, variable_id))</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">present</span>(data1d) .and. .not. <span class="keyword">present</span>(data3d)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(data1d)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keyword">call </span>check_status(nf90_get_var(ncid, variable_id, data1d))</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="comment">! 3D will reshape the data to take account of the column-row major C-F transposition</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keyword">allocate</span>(sdata(<span class="keyword">size</span>(data3d,1),<span class="keyword">size</span>(data3d,3), <span class="keyword">size</span>(data3d,2)))</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="keyword">call </span>check_status(nf90_get_var(ncid, variable_id, sdata))</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      data3d(:,:,:)=reshape(sdata(:,:,:),(/<span class="keyword">size</span>(data3d,1),<span class="keyword">size</span>(data3d,2),<span class="keyword">size</span>(data3d,3)/))</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keyword">deallocate</span>(sdata)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_a9a8e1c5ed9fe3eeb73f85c224aa10205_cgraph.png" border="0" usemap="#anamespacekidreader__mod_a9a8e1c5ed9fe3eeb73f85c224aa10205_cgraph" alt=""/></div>
<map name="namespacekidreader__mod_a9a8e1c5ed9fe3eeb73f85c224aa10205_cgraph" id="anamespacekidreader__mod_a9a8e1c5ed9fe3eeb73f85c224aa10205_cgraph">
<area shape="rect" title="Reads a single variable out of a NetCDF file." alt="" coords="5,5,144,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9f2bccbc716c31a3601423e6c0cf8cc" title="Will check a NetCDF status and write to log_log error any decoded statuses." alt="" coords="192,5,340,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_a9a8e1c5ed9fe3eeb73f85c224aa10205_icgraph.png" border="0" usemap="#anamespacekidreader__mod_a9a8e1c5ed9fe3eeb73f85c224aa10205_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_a9a8e1c5ed9fe3eeb73f85c224aa10205_icgraph" id="anamespacekidreader__mod_a9a8e1c5ed9fe3eeb73f85c224aa10205_icgraph">
<area shape="rect" title="Reads a single variable out of a NetCDF file." alt="" coords="615,5,753,47"/>
<area shape="rect" href="namespacekidreader__mod.html#a0aacef0b2cd322378c4ba2b83ecc7b43" title="Reads the variables from the NetCDF KiD model file." alt="" coords="428,5,567,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="aaf68e89b47dd29a41d3890be5b6c8dc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf68e89b47dd29a41d3890be5b6c8dc6">&#9670;&nbsp;</a></span>read_specific_global_attribute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=:) function, allocatable, target kidreader_mod::read_specific_global_attribute </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will read a specific global NetCDF attribute. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>The NetCDF file id </td></tr>
    <tr><td class="paramname">key</td><td>The name (key) of the attribute to read </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>String representation of the attribute value </dd></dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00521">521</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncid</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: key</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordtype">integer</span> :: length</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordtype">character(len=:)</span>,<span class="keywordtype">allocatable</span>,<span class="keywordtype">target</span> :: read_specific_global_attribute</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keyword">call </span>check_status(nf90_inquire_attribute(ncid, nf90_global, key, len = length))</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keyword">allocate</span>(<span class="keywordtype">character(length)</span> :: read_specific_global_attribute)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keyword">call </span>check_status(nf90_get_att(ncid, nf90_global, key, read_specific_global_attribute))</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_aaf68e89b47dd29a41d3890be5b6c8dc6_cgraph.png" border="0" usemap="#anamespacekidreader__mod_aaf68e89b47dd29a41d3890be5b6c8dc6_cgraph" alt=""/></div>
<map name="namespacekidreader__mod_aaf68e89b47dd29a41d3890be5b6c8dc6_cgraph" id="anamespacekidreader__mod_aaf68e89b47dd29a41d3890be5b6c8dc6_cgraph">
<area shape="rect" title="Will read a specific global NetCDF attribute." alt="" coords="5,5,173,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9f2bccbc716c31a3601423e6c0cf8cc" title="Will check a NetCDF status and write to log_log error any decoded statuses." alt="" coords="221,5,369,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_aaf68e89b47dd29a41d3890be5b6c8dc6_icgraph.png" border="0" usemap="#anamespacekidreader__mod_aaf68e89b47dd29a41d3890be5b6c8dc6_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_aaf68e89b47dd29a41d3890be5b6c8dc6_icgraph" id="anamespacekidreader__mod_aaf68e89b47dd29a41d3890be5b6c8dc6_icgraph">
<area shape="rect" title="Will read a specific global NetCDF attribute." alt="" coords="615,5,783,47"/>
<area shape="rect" href="namespacekidreader__mod.html#a7dd96fb9d146b7cf370e4d7d736536f7" title="Will read the global attributes of the NetCDF KiD model dump and log_log them to debug." alt="" coords="428,5,567,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="a0aacef0b2cd322378c4ba2b83ecc7b43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aacef0b2cd322378c4ba2b83ecc7b43">&#9670;&nbsp;</a></span>read_variables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::read_variables </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>time_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z_half_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_half_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>x_half</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>z_half</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads the variables from the NetCDF KiD model file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>The id of the NetCDF file </td></tr>
    <tr><td class="paramname">time_dim</td><td>The number of elements in the time dimension </td></tr>
    <tr><td class="paramname">z_dim</td><td>The number of elements in the z primal grid dimension </td></tr>
    <tr><td class="paramname">z_half_dim</td><td>The number of elements in the z dual grid dimension </td></tr>
    <tr><td class="paramname">x_dim</td><td>The number of elements in the x primal grid dimension </td></tr>
    <tr><td class="paramname">x_half_dim</td><td>The number of elements in the x dual grid dimension </td></tr>
    <tr><td class="paramname">time</td><td>The time data field that is to be read </td></tr>
    <tr><td class="paramname">x</td><td>The points on the primal grid in x dimension </td></tr>
    <tr><td class="paramname">z</td><td>The points on the primal grid z dimension </td></tr>
    <tr><td class="paramname">x_half</td><td>The points on the dual grid x dimension </td></tr>
    <tr><td class="paramname">z_half</td><td>The points on the dual grid z dimension </td></tr>
    <tr><td class="paramname">u</td><td>Velocity field in dimension x to read </td></tr>
    <tr><td class="paramname">w</td><td>Velocity field in dimension z to read </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00404">404</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncid, time_dim, z_dim, z_half_dim, x_dim, x_half_dim</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(inout)</span> :: time, x, z, x_half, z_half</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(inout)</span> :: u, w, v</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keyword">allocate</span>(time(time_dim))</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keyword">allocate</span>(z(z_dim))</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keyword">allocate</span>(x(x_dim))</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keyword">allocate</span>(z_half(z_half_dim))</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keyword">allocate</span>(x_half(x_half_dim))</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">! Due to NetCDF being in C, need to reverse the data order for F2003</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">if</span> (rotate_xy) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keyword">allocate</span>(v(time_dim, z_dim, x_half_dim))</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keyword">allocate</span>(u(time_dim, z_dim, x_half_dim))</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keyword">allocate</span>(w(time_dim, z_half_dim, x_half_dim))</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keyword">call </span>read_single_variable(ncid, time_key, data1d=time)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keyword">call </span>read_single_variable(ncid, z_key, data1d=z)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keyword">call </span>read_single_variable(ncid, z_half_key, data1d=z_half)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keyword">call </span>read_single_variable(ncid, x_key, data1d=x)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keyword">call </span>read_single_variable(ncid, x_half_key, data1d=x_half)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (rotate_xy) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keyword">call </span>read_single_variable(ncid, u_key, data3d=v)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keyword">call </span>read_single_variable(ncid, u_key, data3d=u)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keyword">call </span>read_single_variable(ncid, w_key, data3d=w)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (clone_to_3d) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">if</span> (.not. <span class="keyword">allocated</span>(v)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keyword">allocate</span>(v(time_dim, z_dim, x_half_dim))</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        v=u</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">if</span> (.not. <span class="keyword">allocated</span>(u)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keyword">allocate</span>(u(time_dim, z_dim, x_half_dim))</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        u=v</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_a0aacef0b2cd322378c4ba2b83ecc7b43_cgraph.png" border="0" usemap="#anamespacekidreader__mod_a0aacef0b2cd322378c4ba2b83ecc7b43_cgraph" alt=""/></div>
<map name="namespacekidreader__mod_a0aacef0b2cd322378c4ba2b83ecc7b43_cgraph" id="anamespacekidreader__mod_a0aacef0b2cd322378c4ba2b83ecc7b43_cgraph">
<area shape="rect" title="Reads the variables from the NetCDF KiD model file." alt="" coords="5,5,144,47"/>
<area shape="rect" href="namespacekidreader__mod.html#a9a8e1c5ed9fe3eeb73f85c224aa10205" title="Reads a single variable out of a NetCDF file." alt="" coords="192,5,331,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ae9f2bccbc716c31a3601423e6c0cf8cc" title="Will check a NetCDF status and write to log_log error any decoded statuses." alt="" coords="379,5,527,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_a0aacef0b2cd322378c4ba2b83ecc7b43_icgraph.png" border="0" usemap="#anamespacekidreader__mod_a0aacef0b2cd322378c4ba2b83ecc7b43_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_a0aacef0b2cd322378c4ba2b83ecc7b43_icgraph" id="anamespacekidreader__mod_a0aacef0b2cd322378c4ba2b83ecc7b43_icgraph">
<area shape="rect" title="Reads the variables from the NetCDF KiD model file." alt="" coords="428,5,567,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<a id="ae9124154f06fb20c440ccb2818cf360b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9124154f06fb20c440ccb2818cf360b">&#9670;&nbsp;</a></span>set_up_q_fields()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kidreader_mod::set_up_q_fields </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00106">106</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">integer</span> :: x_size, y_size, z_size, i</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    z_size = current_state%local_grid%size(z_index) + current_state%local_grid%halo_size(z_index) * 2</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    y_size = current_state%local_grid%size(y_index) + current_state%local_grid%halo_size(y_index) * 2</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    x_size = current_state%local_grid%size(x_index) + current_state%local_grid%halo_size(x_index) * 2</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span> (flood_q) current_state%number_q_fields=current_state%number_q_fields+1</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (float_q) current_state%number_q_fields=current_state%number_q_fields+1</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keyword">allocate</span>(current_state%q(current_state%number_q_fields), current_state%zq(current_state%number_q_fields), &amp;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;         current_state%sq(current_state%number_q_fields))</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">do</span> i=1,current_state%number_q_fields</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keyword">call </span>initialise_single_q_field(current_state, i, z_size, y_size, x_size)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span> (flood_q .and. i == 1) current_state%q(i)%data(:,:,:) = 1.</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">if</span> (float_q .and. (.not. flood_q .or. i==2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keyword">call </span>populate_q_tracer(current_state, current_state%q(i))</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_ae9124154f06fb20c440ccb2818cf360b_cgraph.png" border="0" usemap="#anamespacekidreader__mod_ae9124154f06fb20c440ccb2818cf360b_cgraph" alt=""/></div>
<map name="namespacekidreader__mod_ae9124154f06fb20c440ccb2818cf360b_cgraph" id="anamespacekidreader__mod_ae9124154f06fb20c440ccb2818cf360b_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,136,80"/>
<area shape="rect" href="namespacekidreader__mod.html#acfc5e3800867c4f8c3a9bac5df585708" title=" " alt="" coords="185,5,345,47"/>
<area shape="rect" href="namespacekidreader__mod.html#a51ec3363bff81914526d45d469f8f61f" title="Populates the Q tracer field based upon the configuration that has been read in from the simulation f..." alt="" coords="184,71,347,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacekidreader__mod_ae9124154f06fb20c440ccb2818cf360b_icgraph.png" border="0" usemap="#anamespacekidreader__mod_ae9124154f06fb20c440ccb2818cf360b_icgraph" alt=""/></div>
<map name="namespacekidreader__mod_ae9124154f06fb20c440ccb2818cf360b_icgraph" id="anamespacekidreader__mod_ae9124154f06fb20c440ccb2818cf360b_icgraph">
<area shape="rect" title=" " alt="" coords="428,5,559,47"/>
<area shape="rect" href="namespacekidreader__mod.html#af9f9656d6a5514b190a7cbe2d5b1c2b8" title="Initialisation hook which will parse the configuration NetCDF file and set up the model based upon th..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespacekidreader__mod.html#ac25b32ce129dab62a39885672825763e" title="Provides the descriptor back to the caller and is used in component registration." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b8f02ff2f49962431b1c012bf4b8ec9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b8f02ff2f49962431b1c012bf4b8ec9">&#9670;&nbsp;</a></span>clone_to_3d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical kidreader_mod::clone_to_3d = .false.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00031">31</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="a74b5cf252871a0c62849d25775ed6954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74b5cf252871a0c62849d25775ed6954">&#9670;&nbsp;</a></span>configuration_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=string_length) kidreader_mod::configuration_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>NetCDF model file to load. </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00037">37</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">character(len=STRING_LENGTH)</span> :: configuration_file</div>
</div><!-- fragment -->
</div>
</div>
<a id="a47461c9d85666711e2a9b17f7c8b5aa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47461c9d85666711e2a9b17f7c8b5aa1">&#9670;&nbsp;</a></span>domain_multiplication</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer kidreader_mod::domain_multiplication =1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The Q field coordinates configured by the user. </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00032">32</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">integer</span> :: domain_multiplication=1</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e94b0fbf39db55abdf086630dc8038c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e94b0fbf39db55abdf086630dc8038c">&#9670;&nbsp;</a></span>float_q</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical kidreader_mod::float_q = .false.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00031">31</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="a50102511477ac9b68677fd90c2688129"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50102511477ac9b68677fd90c2688129">&#9670;&nbsp;</a></span>flood_q</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical kidreader_mod::flood_q = .false.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00031">31</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">logical</span> :: flood_q = .false., float_q= .false., clone_to_3d = .false., rotate_xy=.false.</div>
</div><!-- fragment -->
</div>
</div>
<a id="a628f29f4ef5b7e7952bfad91193a777c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a628f29f4ef5b7e7952bfad91193a777c">&#9670;&nbsp;</a></span>number_q_coords</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter kidreader_mod::number_q_coords = 100</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of Q field value coords that can be specified. </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00022">22</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: NUMBER_Q_COORDS = 100</div>
</div><!-- fragment -->
</div>
</div>
<a id="a48935b661903548bd9decf9ad242e7d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48935b661903548bd9decf9ad242e7d6">&#9670;&nbsp;</a></span>q_coordinates_value</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(<a class="el" href="namespacekidreader__mod.html#a628f29f4ef5b7e7952bfad91193a777c">number_q_coords</a>), save kidreader_mod::q_coordinates_value</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00035">35</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="a43a608fd43dbebbef5cd4eec7885e584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43a608fd43dbebbef5cd4eec7885e584">&#9670;&nbsp;</a></span>q_coordinates_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(<a class="el" href="namespacekidreader__mod.html#a628f29f4ef5b7e7952bfad91193a777c">number_q_coords</a>), save kidreader_mod::q_coordinates_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00035">35</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(NUMBER_Q_COORDS)</span>, <span class="keywordtype">save</span> :: q_coordinates_x, q_coordinates_y, q_coordinates_z, q_coordinates_value  </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad597a735cf8a1f2d8e748e633d55772f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad597a735cf8a1f2d8e748e633d55772f">&#9670;&nbsp;</a></span>q_coordinates_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(<a class="el" href="namespacekidreader__mod.html#a628f29f4ef5b7e7952bfad91193a777c">number_q_coords</a>), save kidreader_mod::q_coordinates_y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00035">35</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="ac6c438a27c1dc459320efcc6ef505426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6c438a27c1dc459320efcc6ef505426">&#9670;&nbsp;</a></span>q_coordinates_z</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(<a class="el" href="namespacekidreader__mod.html#a628f29f4ef5b7e7952bfad91193a777c">number_q_coords</a>), save kidreader_mod::q_coordinates_z</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00035">35</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="a2e25ea32e1250b0a1bfd8b3ae60548cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e25ea32e1250b0a1bfd8b3ae60548cc">&#9670;&nbsp;</a></span>rotate_xy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical kidreader_mod::rotate_xy =.false.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00031">31</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="ae9b653d49f9483c5b1e9bea1f09afc95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9b653d49f9483c5b1e9bea1f09afc95">&#9670;&nbsp;</a></span>time_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=*), parameter kidreader_mod::time_key = &quot;time&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Corresponding NetCDF data time key. </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00023">23</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> ::  TIME_KEY = <span class="stringliteral">&quot;time&quot;</span>,&amp;     !&lt; Corresponding NetCDF data time key</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;       z_key = <span class="stringliteral">&quot;z&quot;</span>,&amp;           </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;       z_half_key = <span class="stringliteral">&quot;z_half&quot;</span>,&amp; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;       x_key = <span class="stringliteral">&quot;x&quot;</span>,&amp;           </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;       x_half_key = <span class="stringliteral">&quot;x_half&quot;</span>,&amp; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;       u_key=<span class="stringliteral">&quot;u&quot;</span>,&amp;             </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;       w_key=<span class="stringliteral">&quot;w&quot;</span>               </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b4bb65b29fb84ca7b50318b2b3103b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b4bb65b29fb84ca7b50318b2b3103b5">&#9670;&nbsp;</a></span>u_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=*), parameter kidreader_mod::u_key =&quot;u&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Corresponding NetCDF data u flow field key. </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00023">23</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="ac5a69c3e6302647b71bfbbc14b1dce2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5a69c3e6302647b71bfbbc14b1dce2d">&#9670;&nbsp;</a></span>w_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=*), parameter kidreader_mod::w_key =&quot;w&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Corresponding NetCDF data w flow field key. </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00023">23</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="ad4f123b4b4414e624fcf4ecb1f411e52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4f123b4b4414e624fcf4ecb1f411e52">&#9670;&nbsp;</a></span>x_half_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=*), parameter kidreader_mod::x_half_key = &quot;x_half&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Corresponding NetCDF data x half (primal grid) key. </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00023">23</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="a6f5641957cf95d6931eec7fc604c3d70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f5641957cf95d6931eec7fc604c3d70">&#9670;&nbsp;</a></span>x_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=*), parameter kidreader_mod::x_key = &quot;x&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Corresponding NetCDF data x (primal grid) key. </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00023">23</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="a2dbc5a01aaf39abda8fd68cb197500d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dbc5a01aaf39abda8fd68cb197500d8">&#9670;&nbsp;</a></span>z_half_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=*), parameter kidreader_mod::z_half_key = &quot;z_half&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Corresponding NetCDF data z half (dual grid) key. </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00023">23</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
<a id="a34750642752e8457bbc1530cec5017f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34750642752e8457bbc1530cec5017f1">&#9670;&nbsp;</a></span>z_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=*), parameter kidreader_mod::z_key = &quot;z&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Corresponding NetCDF data z (primal grid) key. </p>

<p class="definition">Definition at line <a class="el" href="kidreader_8F90_source.html#l00023">23</a> of file <a class="el" href="kidreader_8F90_source.html">kidreader.F90</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="anamespacelogging__mod_html_ad68309846cd8f9e77edaa6abd02f65a0"><div class="ttname"><a href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">logging_mod::log_error</a></div><div class="ttdeci">integer, parameter, public log_error</div><div class="ttdoc">Only log ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00011">logging.F90:11</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ac7d5c1fcb00d54277580c10556aa78a8"><div class="ttname"><a href="namespacelogging__mod.html#ac7d5c1fcb00d54277580c10556aa78a8">logging_mod::log_info</a></div><div class="ttdeci">integer, parameter, public log_info</div><div class="ttdoc">Log INFO, WARNING and ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00013">logging.F90:13</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ac4f13ac385499c85190cb184030e4f45"><div class="ttname"><a href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">logging_mod::log_log</a></div><div class="ttdeci">subroutine, public log_log(level, message, str)</div><div class="ttdoc">Logs a message at the specified level. If the level is above the current level then the message is ig...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00074">logging.F90:75</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ae0d255e756059bc76b2f4291825e59c9"><div class="ttname"><a href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">logging_mod::log_get_logging_level</a></div><div class="ttdeci">integer function, public log_get_logging_level()</div><div class="ttdoc">Retrieves the current logging level.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00121">logging.F90:122</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_aca1c925af27b4d533d548bfe69a819f3"><div class="ttname"><a href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">logging_mod::log_debug</a></div><div class="ttdeci">integer, parameter, public log_debug</div><div class="ttdoc">Log DEBUG, INFO, WARNING and ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00014">logging.F90:14</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ad95937a250467334622daeb5cff78c20"><div class="ttname"><a href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">logging_mod::log_master_log</a></div><div class="ttdeci">subroutine, public log_master_log(level, message)</div><div class="ttdoc">Will log just from the master process.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00046">logging.F90:47</a></div></div>
<div class="ttc" id="anamespacedatadefn__mod_html_a39b79f8cc843d236d3b47f5c81b64368"><div class="ttname"><a href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">datadefn_mod::default_precision</a></div><div class="ttdeci">integer, parameter, public default_precision</div><div class="ttdoc">MPI communication type which we use for the prognostic and calculation data.</div><div class="ttdef"><b>Definition:</b> <a href="datadefn_8F90_source.html#l00017">datadefn.F90:17</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

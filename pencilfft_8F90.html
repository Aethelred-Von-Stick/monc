<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: components/fftsolver/src/pencilfft.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_14910f9db75326eb6d8a1a611cdada77.html">fftsolver</a></li><li class="navelem"><a class="el" href="dir_8fe8ed439dd02c69f2d0353792115d55.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pencilfft.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="pencilfft_8F90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_fft_mod::pencil_transposition</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes a specific pencil transposition, from one pencil decomposition to another.  <a href="structpencil__fft__mod_1_1pencil__transposition.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacepencil__fft__mod"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html">pencil_fft_mod</a></td></tr>
<tr class="memdesc:namespacepencil__fft__mod"><td class="mdescLeft">&#160;</td><td class="mdescRight">This Pencil FFT performs 3D forward and backwards FFTs using pencil decomposition. It uses FFTW for the actual FFT kernel and this module contains all the data decomposition around this. There is no FFT required in Z, so this performs FFTs in Y and X (in that order forward and reversed backwards.) The data decomposition is the complex aspect, there is the concept of forward and backwards transformations. Forward transformations will go from pencil Z to Y to X and the backwards transformations undo these, so go from X to Y to Z. Note that we use quite a lot of buffer space here, this could be cut down if Y=X dimensions so some optimisation on memory could be done there in that case. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a3a8be214eb145cf54faebb0882867780"><td class="memItemLeft" align="right" valign="top">integer function, dimension(3), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780">pencil_fft_mod::initialise_pencil_fft</a> (current_state, my_y_start, my_x_start)</td></tr>
<tr class="memdesc:a3a8be214eb145cf54faebb0882867780"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the pencil FFT functionality, this will create the transposition structures needed.  <a href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780">More...</a><br /></td></tr>
<tr class="separator:a3a8be214eb145cf54faebb0882867780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66821a0d5916d7197f851168915601da"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a66821a0d5916d7197f851168915601da">pencil_fft_mod::finalise_pencil_fft</a> (monc_communicator)</td></tr>
<tr class="memdesc:a66821a0d5916d7197f851168915601da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleans up allocated buffer memory.  <a href="namespacepencil__fft__mod.html#a66821a0d5916d7197f851168915601da">More...</a><br /></td></tr>
<tr class="separator:a66821a0d5916d7197f851168915601da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b24719dcfb0852d350e2b0ba944b4c3"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3">pencil_fft_mod::perform_forward_3dfft</a> (current_state, source_data, target_data)</td></tr>
<tr class="memdesc:a2b24719dcfb0852d350e2b0ba944b4c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil Note that the source_data here takes no account for the halo, it is up to caller to exclude this. This does no FFT in Z, but transposes to Y, does FFT in Y, then transposes to X and performs an FFT in that dimension. Pencil decomposition is used which has already been set up.  <a href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3">More...</a><br /></td></tr>
<tr class="separator:a2b24719dcfb0852d350e2b0ba944b4c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac660508af65a49c11776c1c09306a27d"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d">pencil_fft_mod::perform_backwards_3dfft</a> (current_state, source_data, target_data)</td></tr>
<tr class="memdesc:ac660508af65a49c11776c1c09306a27d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a backwards 3D FFT and currently results in target data which is the X, Z, Y oriented pencil Note that the source_data here takes no account for the halo, it is up to caller to exclude this. This does no FFT in Z, but transposes to Y, does FFT in Y, then transposes to X and performs an FFT in that dimension. Pencil decomposition is used which has already been set up.  <a href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d">More...</a><br /></td></tr>
<tr class="separator:ac660508af65a49c11776c1c09306a27d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05c54fc0d0ea9e0fc68f507451e41b4a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a05c54fc0d0ea9e0fc68f507451e41b4a">pencil_fft_mod::initialise_buffers</a> ()</td></tr>
<tr class="memdesc:a05c54fc0d0ea9e0fc68f507451e41b4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises memory for the buffers used in the FFT.  <a href="namespacepencil__fft__mod.html#a05c54fc0d0ea9e0fc68f507451e41b4a">More...</a><br /></td></tr>
<tr class="separator:a05c54fc0d0ea9e0fc68f507451e41b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a744b6c045c8620f598f3ebc5bb714611"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611">pencil_fft_mod::initialise_transpositions</a> (current_state, y_distinct_sizes, x_distinct_sizes)</td></tr>
<tr class="memdesc:a744b6c045c8620f598f3ebc5bb714611"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the pencil transpositions, from a pencil in one dimension to that in another.  <a href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611">More...</a><br /></td></tr>
<tr class="separator:a744b6c045c8620f598f3ebc5bb714611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a941fec4c35a74d0702d01b1747604c44"><td class="memItemLeft" align="right" valign="top">type(pencil_transposition) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44">pencil_fft_mod::create_transposition</a> (global_grid, existing_transposition, new_pencil_dim, process_dim_sizes, direction, extended_dimensions)</td></tr>
<tr class="memdesc:a941fec4c35a74d0702d01b1747604c44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a specific pencil transposition description. It is maybe more a decomposition description, but the main complexity comes from the transposition from existing decomposition to new decomposition so therefore it is called transposition. The new pencil decomposition depends not only on the dimension to split on, but also the existing pencil decomposition. The new decomposed dimension (i.e. the existing pencil dimension) * other local dimensions is used as the sending size, receiving though requires knowledge about the data size on the source process so others will send their pencil dimension size to this process.  <a href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44">More...</a><br /></td></tr>
<tr class="separator:a941fec4c35a74d0702d01b1747604c44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a62a605e5f0883c5b602c004057c6e0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a7a62a605e5f0883c5b602c004057c6e0">pencil_fft_mod::transpose_and_forward_fft_in_y</a> (current_state, source_data, buffer, real_buffer)</td></tr>
<tr class="memdesc:a7a62a605e5f0883c5b602c004057c6e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the transposition and forward FFT in the y dimension then converts back to real numbers. The Y size is (n/2+1)*2 due to the complex to real transformation after the FFT.  <a href="namespacepencil__fft__mod.html#a7a62a605e5f0883c5b602c004057c6e0">More...</a><br /></td></tr>
<tr class="separator:a7a62a605e5f0883c5b602c004057c6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ac39a07dabfdc3f4e92d30f132d54b0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a7ac39a07dabfdc3f4e92d30f132d54b0">pencil_fft_mod::transpose_and_backward_fft_in_x</a> (current_state, source_data, buffer, real_buffer)</td></tr>
<tr class="memdesc:a7ac39a07dabfdc3f4e92d30f132d54b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers which are converted to real, so the this real to complex operation is performed first. If n is the logical size of the FFT row, then the input size is n+2, complex number size is n/2+1 and we get n reals out.  <a href="namespacepencil__fft__mod.html#a7ac39a07dabfdc3f4e92d30f132d54b0">More...</a><br /></td></tr>
<tr class="separator:a7ac39a07dabfdc3f4e92d30f132d54b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7220fe79f6726da7415f9a2d21d1c5e4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a7220fe79f6726da7415f9a2d21d1c5e4">pencil_fft_mod::transpose_and_forward_fft_in_x</a> (current_state, buffer1, buffer2, buffer3)</td></tr>
<tr class="memdesc:a7220fe79f6726da7415f9a2d21d1c5e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is converted back into real numbers. The X size is (n/2+1)*2 due to this transformation.  <a href="namespacepencil__fft__mod.html#a7220fe79f6726da7415f9a2d21d1c5e4">More...</a><br /></td></tr>
<tr class="separator:a7220fe79f6726da7415f9a2d21d1c5e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b3bf23fee2dd253f9d48ab8962740a8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a6b3bf23fee2dd253f9d48ab8962740a8">pencil_fft_mod::transpose_and_backward_fft_in_y</a> (current_state, source_data, buffer, real_buffer)</td></tr>
<tr class="memdesc:a6b3bf23fee2dd253f9d48ab8962740a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers which are converted to real, so the this real to complex operation is performed first. If n is the logical size of the FFT row, then the input size is n+2, complex number size is n/2+1 and we get n reals out.  <a href="namespacepencil__fft__mod.html#a6b3bf23fee2dd253f9d48ab8962740a8">More...</a><br /></td></tr>
<tr class="separator:a6b3bf23fee2dd253f9d48ab8962740a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc5c609ef121c225f7c126d72e558971"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971">pencil_fft_mod::transpose_to_pencil</a> (transposition_description, source_dims, communicator, direction, source_data, target_data)</td></tr>
<tr class="memdesc:adc5c609ef121c225f7c126d72e558971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transposes globally to a new pencil decomposition. This goes from the source dimensions a,b,c to b,c,a (forwards) or c,a,b (backwards.) It requires multiple steps, first the local data is transposed to c,b,a regardless of direction. then it is communicated via alltoall, each process then assembles its own b,c,a or c,a,b data via contiguising across blocks as the data layout is nonlinear.  <a href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971">More...</a><br /></td></tr>
<tr class="separator:adc5c609ef121c225f7c126d72e558971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2d228c34a44953affd43f778430c494"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494">pencil_fft_mod::contiguise_data</a> (transposition_description, source_dims, direction, source_real_buffer, target_real_buffer)</td></tr>
<tr class="memdesc:ac2d228c34a44953affd43f778430c494"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source_dims argument. It is not as simple as just swapping the required dimensions, as this is after the mpi alltoall and each block lies after the previous block running sequentially in a.  <a href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494">More...</a><br /></td></tr>
<tr class="separator:ac2d228c34a44953affd43f778430c494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb17647074e35c11160a1dc235fbe155"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#adb17647074e35c11160a1dc235fbe155">pencil_fft_mod::perform_r2c_fft</a> (source_data, transformed_data, row_size, num_rows, plan_id)</td></tr>
<tr class="memdesc:adb17647074e35c11160a1dc235fbe155"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actually performs a forward real to complex FFT.  <a href="namespacepencil__fft__mod.html#adb17647074e35c11160a1dc235fbe155">More...</a><br /></td></tr>
<tr class="separator:adb17647074e35c11160a1dc235fbe155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65c8a51d969493d729ce44cfab439524"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a65c8a51d969493d729ce44cfab439524">pencil_fft_mod::perform_c2r_fft</a> (source_data, transformed_data, row_size, num_rows, plan_id)</td></tr>
<tr class="memdesc:a65c8a51d969493d729ce44cfab439524"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the complex to real (backwards) FFT.  <a href="namespacepencil__fft__mod.html#a65c8a51d969493d729ce44cfab439524">More...</a><br /></td></tr>
<tr class="separator:a65c8a51d969493d729ce44cfab439524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba57cbdad3c09ffb4f614255c0b72e54"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54">pencil_fft_mod::rearrange_data_for_sending</a> (real_source, real_target)</td></tr>
<tr class="memdesc:aba57cbdad3c09ffb4f614255c0b72e54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimension c so to go from one pencil to another we assume here that a is the existing pencil as it is contiguous.  <a href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54">More...</a><br /></td></tr>
<tr class="separator:aba57cbdad3c09ffb4f614255c0b72e54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f32d038392be51850e7bd91467414a3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a6f32d038392be51850e7bd91467414a3">pencil_fft_mod::determine_my_process_sizes_per_dim</a> (existing_pencil_dim, existing_pencil_size, new_pencil_procs_per_dim, global_grid, extended_dimensions, specific_sizes_per_dim)</td></tr>
<tr class="memdesc:a6f32d038392be51850e7bd91467414a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the number of elements to on my process per dimension which either need to be sent to (forwards transformation) or received from (backwards) each target process (in the row or column) This depends on the existing pencil decomposition, as effectively we are breaking that contigulity and decomposing it into n blocks in that dimension now (provided by new_pencil_procs_per_dim)  <a href="namespacepencil__fft__mod.html#a6f32d038392be51850e7bd91467414a3">More...</a><br /></td></tr>
<tr class="separator:a6f32d038392be51850e7bd91467414a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a629892d39047dafdea8d392c86564ba2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a629892d39047dafdea8d392c86564ba2">pencil_fft_mod::determine_offsets_from_size</a> (source_sizes, determined_offsets)</td></tr>
<tr class="memdesc:a629892d39047dafdea8d392c86564ba2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple helper function to deduce send or receive offsets from the sizes.  <a href="namespacepencil__fft__mod.html#a629892d39047dafdea8d392c86564ba2">More...</a><br /></td></tr>
<tr class="separator:a629892d39047dafdea8d392c86564ba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b8596b2ed39fd742a496947d707edc1"><td class="memItemLeft" align="right" valign="top">integer function, dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a6b8596b2ed39fd742a496947d707edc1">pencil_fft_mod::determine_pencil_process_dimensions</a> (new_pencil_dim, existing_pencil_dim, existing_pencil_procs)</td></tr>
<tr class="memdesc:a6b8596b2ed39fd742a496947d707edc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the number of processes in each dimension for the target decomposition. This depends heavily on the existing decomposition, as we basically contiguise our pencil dimension and decompose the existing pencil dimension. The third dimension remains unchanged.  <a href="namespacepencil__fft__mod.html#a6b8596b2ed39fd742a496947d707edc1">More...</a><br /></td></tr>
<tr class="separator:a6b8596b2ed39fd742a496947d707edc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c23491862410177e79c5a26bab9e59"><td class="memItemLeft" align="right" valign="top">integer function, dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a28c23491862410177e79c5a26bab9e59">pencil_fft_mod::determine_my_pencil_location</a> (new_pencil_dim, existing_pencil_dim, existing_locations)</td></tr>
<tr class="memdesc:a28c23491862410177e79c5a26bab9e59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines my location for each dimension in the new pencil decomposition. I.e. which block I am operating on.  <a href="namespacepencil__fft__mod.html#a28c23491862410177e79c5a26bab9e59">More...</a><br /></td></tr>
<tr class="separator:a28c23491862410177e79c5a26bab9e59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf6641c54dffe24a15fe356303321bca"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#acf6641c54dffe24a15fe356303321bca">pencil_fft_mod::concatenate_dimension_sizes</a> (dims, concatenated_dim_sizes)</td></tr>
<tr class="memdesc:acf6641c54dffe24a15fe356303321bca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Concatenates sizes in multiple dimensions for each target process (in a row or column) into a product of that. This represents all the dimension sizes per process.  <a href="namespacepencil__fft__mod.html#acf6641c54dffe24a15fe356303321bca">More...</a><br /></td></tr>
<tr class="separator:acf6641c54dffe24a15fe356303321bca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc2b44a4f769a5cf4a6fda6ca7750cf7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#abc2b44a4f769a5cf4a6fda6ca7750cf7">pencil_fft_mod::determine_matching_process_dimensions</a> (new_pencil_dim, existing_pencil_dim, proc_sizes, my_pencil_size, pencil_processes_per_dim, specific_sizes_per_dim)</td></tr>
<tr class="memdesc:abc2b44a4f769a5cf4a6fda6ca7750cf7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the sizes per dimension on the matching process either to receive from (forward transposition) or send to (backwards transposition) each source process. Not only does this depend on the my pencil sizes, but it also depends on the amount of data that the source process has to send over.  <a href="namespacepencil__fft__mod.html#abc2b44a4f769a5cf4a6fda6ca7750cf7">More...</a><br /></td></tr>
<tr class="separator:abc2b44a4f769a5cf4a6fda6ca7750cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94956e5bfd1d4fce617a255d2085e32f"><td class="memItemLeft" align="right" valign="top">type(pencil_transposition) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a94956e5bfd1d4fce617a255d2085e32f">pencil_fft_mod::create_initial_transposition_description</a> (current_state)</td></tr>
<tr class="memdesc:a94956e5bfd1d4fce617a255d2085e32f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an initial transposition representation of the Z pencil that MONC is normally decomposed in. This is then fed into the create transposition procedure which will generate transpositions to other pencils.  <a href="namespacepencil__fft__mod.html#a94956e5bfd1d4fce617a255d2085e32f">More...</a><br /></td></tr>
<tr class="separator:a94956e5bfd1d4fce617a255d2085e32f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab686537d315d736c53e66af7ee40b89c"><td class="memItemLeft" align="right" valign="top">integer function, dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ab686537d315d736c53e66af7ee40b89c">pencil_fft_mod::determine_pencil_size</a> (new_pencil_dim, pencil_process_layout, my_pencil_location, existing_transposition, global_grid, extended_dimensions)</td></tr>
<tr class="memdesc:ab686537d315d736c53e66af7ee40b89c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deduces the size of my (local) pencil based upon the new decomposition. This depends heavily on the current pencil decomposition, the new pencil dimension is the global size, the existing pencil dimension becomes decomposed based on the number of processes in that dimension. The third dimension remains unchanged.  <a href="namespacepencil__fft__mod.html#ab686537d315d736c53e66af7ee40b89c">More...</a><br /></td></tr>
<tr class="separator:ab686537d315d736c53e66af7ee40b89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97992de3b9a72f89a51c4c2254787a9"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ac97992de3b9a72f89a51c4c2254787a9">pencil_fft_mod::is_extended_dimension</a> (dimension, extended_dimensions)</td></tr>
<tr class="memdesc:ac97992de3b9a72f89a51c4c2254787a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines whether or not the specific dimension is in the list of extended dimensions.  <a href="namespacepencil__fft__mod.html#ac97992de3b9a72f89a51c4c2254787a9">More...</a><br /></td></tr>
<tr class="separator:ac97992de3b9a72f89a51c4c2254787a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533e31e364cd8f9d3c5475322af0047c"><td class="memItemLeft" align="right" valign="top">integer function, dimension(size(process_dim_sizes))&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a533e31e364cd8f9d3c5475322af0047c">pencil_fft_mod::normal_to_extended_process_dim_sizes</a> (process_dim_sizes)</td></tr>
<tr class="memdesc:a533e31e364cd8f9d3c5475322af0047c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms real process dimension sizes into their real after FFT complex-&gt;real transformation. The way this works is that it goes from n to (n/2+1)*2 numbers which is distributed amongst the processes deterministically.  <a href="namespacepencil__fft__mod.html#a533e31e364cd8f9d3c5475322af0047c">More...</a><br /></td></tr>
<tr class="separator:a533e31e364cd8f9d3c5475322af0047c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a172a98dc6a0131ada6f2e1134453c697"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a172a98dc6a0131ada6f2e1134453c697">pencil_fft_mod::convert_complex_to_real</a> (complex_data, real_data)</td></tr>
<tr class="memdesc:a172a98dc6a0131ada6f2e1134453c697"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts complex representation to its real data counterpart and is called after each forward FFT. After a r2c FFT, there are n/2+1 complex numbers - which means that there will be more real numbers in Fourier space than are provided into the forward FFT call (due to the extra +1). Note that the real size n will always be complex size * 2 This always unpacks the complex dimension in the first dimension.  <a href="namespacepencil__fft__mod.html#a172a98dc6a0131ada6f2e1134453c697">More...</a><br /></td></tr>
<tr class="separator:a172a98dc6a0131ada6f2e1134453c697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89aed2affc54e0e4dad9bb13adaad753"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a89aed2affc54e0e4dad9bb13adaad753">pencil_fft_mod::convert_real_to_complex</a> (real_data, complex_data)</td></tr>
<tr class="memdesc:a89aed2affc54e0e4dad9bb13adaad753"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts reals into their complex representation, this is called for backwards FFTs as we need to feed in complex numbers to force FFTW to do a backwards. It is a relatively simple transformation, as n goes into n/2 complex numbers and as this is the result of the <code>convert_complex_to_real</code> procedure, n always divides evenly. This is always applied to the first dimension of the real data.  <a href="namespacepencil__fft__mod.html#a89aed2affc54e0e4dad9bb13adaad753">More...</a><br /></td></tr>
<tr class="separator:a89aed2affc54e0e4dad9bb13adaad753"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae991fe6ad1ed93991cd29272423ff37"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#aae991fe6ad1ed93991cd29272423ff37">pencil_fft_mod::deduce_my_global_start</a> (current_state, dimension)</td></tr>
<tr class="memdesc:aae991fe6ad1ed93991cd29272423ff37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines my global start coordinate in Fourier space. This is required for cos y and cos x calculation which is fed into the tridiagonal solver. After the forward FFTs, each process has ((n/2+1)/p+r) * 2 elements, where p is the number of processes and r is the uneven process remainder (1 or 0 depending on p). Therefore some processes will have t elements, and some t-2 elements to feed into the solver.  <a href="namespacepencil__fft__mod.html#aae991fe6ad1ed93991cd29272423ff37">More...</a><br /></td></tr>
<tr class="separator:aae991fe6ad1ed93991cd29272423ff37"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0639c2d3a94d9e7a061b8e9a2fb9f23a"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a0639c2d3a94d9e7a061b8e9a2fb9f23a">pencil_fft_mod::forward</a> =1</td></tr>
<tr class="separator:a0639c2d3a94d9e7a061b8e9a2fb9f23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04074dcaef59fd9cc159902dd1e3bc6a"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a04074dcaef59fd9cc159902dd1e3bc6a">pencil_fft_mod::backward</a> =2</td></tr>
<tr class="memdesc:a04074dcaef59fd9cc159902dd1e3bc6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transposition directions.  <a href="namespacepencil__fft__mod.html#a04074dcaef59fd9cc159902dd1e3bc6a">More...</a><br /></td></tr>
<tr class="separator:a04074dcaef59fd9cc159902dd1e3bc6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12e23c68dda1426dabee1d47722ea993"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a12e23c68dda1426dabee1d47722ea993">pencil_fft_mod::dim_y_comm</a></td></tr>
<tr class="separator:a12e23c68dda1426dabee1d47722ea993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2848c5b37cc57f18bc74a791e94c9ebc"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a2848c5b37cc57f18bc74a791e94c9ebc">pencil_fft_mod::dim_x_comm</a></td></tr>
<tr class="memdesc:a2848c5b37cc57f18bc74a791e94c9ebc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Communicators for each dimension.  <a href="namespacepencil__fft__mod.html#a2848c5b37cc57f18bc74a791e94c9ebc">More...</a><br /></td></tr>
<tr class="separator:a2848c5b37cc57f18bc74a791e94c9ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9a53e8cdae0bb7244ea20d1b4803987"><td class="memItemLeft" align="right" valign="top">type(pencil_transposition)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ae9a53e8cdae0bb7244ea20d1b4803987">pencil_fft_mod::y_from_z_transposition</a></td></tr>
<tr class="separator:ae9a53e8cdae0bb7244ea20d1b4803987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a039a45ab50044299393c6e1ccf528b74"><td class="memItemLeft" align="right" valign="top">type(pencil_transposition)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a039a45ab50044299393c6e1ccf528b74">pencil_fft_mod::x_from_y_transposition</a></td></tr>
<tr class="separator:a039a45ab50044299393c6e1ccf528b74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21d234327a4e5b29ecca272909947ed5"><td class="memItemLeft" align="right" valign="top">type(pencil_transposition)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a21d234327a4e5b29ecca272909947ed5">pencil_fft_mod::y_from_x_transposition</a></td></tr>
<tr class="separator:a21d234327a4e5b29ecca272909947ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7bba7c375f3cb57c774aabcbf460f82"><td class="memItemLeft" align="right" valign="top">type(pencil_transposition)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ae7bba7c375f3cb57c774aabcbf460f82">pencil_fft_mod::z_from_y_transposition</a></td></tr>
<tr class="separator:ae7bba7c375f3cb57c774aabcbf460f82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a044dec4ad496990fb457b287295955f5"><td class="memItemLeft" align="right" valign="top">type(pencil_transposition)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a044dec4ad496990fb457b287295955f5">pencil_fft_mod::y_from_z_2_transposition</a></td></tr>
<tr class="separator:a044dec4ad496990fb457b287295955f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa3d82db457dfd67f97cc2d1489dcd19"><td class="memItemLeft" align="right" valign="top">type(pencil_transposition)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#afa3d82db457dfd67f97cc2d1489dcd19">pencil_fft_mod::x_from_y_2_transposition</a></td></tr>
<tr class="separator:afa3d82db457dfd67f97cc2d1489dcd19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17fde3b14ed0e4d4701097444ae9edf2"><td class="memItemLeft" align="right" valign="top">type(pencil_transposition)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a17fde3b14ed0e4d4701097444ae9edf2">pencil_fft_mod::y_from_x_2_transposition</a></td></tr>
<tr class="separator:a17fde3b14ed0e4d4701097444ae9edf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9e4fbdfa052ea43283725f7eb635c1"><td class="memItemLeft" align="right" valign="top">type(pencil_transposition)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a1a9e4fbdfa052ea43283725f7eb635c1">pencil_fft_mod::z_from_y_2_transposition</a></td></tr>
<tr class="separator:a1a9e4fbdfa052ea43283725f7eb635c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5bf53cde1d1c29fbeb621803db42483"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ad5bf53cde1d1c29fbeb621803db42483">pencil_fft_mod::real_buffer1</a></td></tr>
<tr class="separator:ad5bf53cde1d1c29fbeb621803db42483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a536917dcdaa54c3236e3701ddee3004c"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a536917dcdaa54c3236e3701ddee3004c">pencil_fft_mod::real_buffer2</a></td></tr>
<tr class="separator:a536917dcdaa54c3236e3701ddee3004c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dd3e7111a5031321b39a79b969f8cfb"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a2dd3e7111a5031321b39a79b969f8cfb">pencil_fft_mod::real_buffer3</a></td></tr>
<tr class="separator:a2dd3e7111a5031321b39a79b969f8cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4de6a68e83c7e83f8ca9bc590867fb5"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ad4de6a68e83c7e83f8ca9bc590867fb5">pencil_fft_mod::fft_in_y_buffer</a></td></tr>
<tr class="separator:ad4de6a68e83c7e83f8ca9bc590867fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe90a836a861536a0fdf3ebb823608bb"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#afe90a836a861536a0fdf3ebb823608bb">pencil_fft_mod::fft_in_x_buffer</a></td></tr>
<tr class="separator:afe90a836a861536a0fdf3ebb823608bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad45550f0e5167714f28c90395efb48e9"><td class="memItemLeft" align="right" valign="top">complex(c_double_complex), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ad45550f0e5167714f28c90395efb48e9">pencil_fft_mod::buffer1</a></td></tr>
<tr class="separator:ad45550f0e5167714f28c90395efb48e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06aecd5ad3ce78e68c9da759680bb5e9"><td class="memItemLeft" align="right" valign="top">complex(c_double_complex), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a06aecd5ad3ce78e68c9da759680bb5e9">pencil_fft_mod::buffer2</a></td></tr>
<tr class="separator:a06aecd5ad3ce78e68c9da759680bb5e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a130795788cf01bcf8dad352d943a77"><td class="memItemLeft" align="right" valign="top">type(c_ptr), dimension(4)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a9a130795788cf01bcf8dad352d943a77">pencil_fft_mod::fftw_plan</a></td></tr>
<tr class="separator:a9a130795788cf01bcf8dad352d943a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac62c5c85cc74923525cfbe657486412e"><td class="memItemLeft" align="right" valign="top">logical, dimension(4)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ac62c5c85cc74923525cfbe657486412e">pencil_fft_mod::fftw_plan_initialised</a> =.false.</td></tr>
<tr class="separator:ac62c5c85cc74923525cfbe657486412e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

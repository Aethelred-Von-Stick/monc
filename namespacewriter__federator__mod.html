<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: writer_federator_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">writer_federator_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This federates over the writing of diagnostic and prognostic data to the file system. It also manages the time manipulation of fields and groups.  
<a href="namespacewriter__federator__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a7b31bb8f9d0fb8c0768252e819b20985"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a7b31bb8f9d0fb8c0768252e819b20985">initialise_writer_federator</a> (io_configuration, diagnostic_generation_frequency, continuation_run)</td></tr>
<tr class="memdesc:a7b31bb8f9d0fb8c0768252e819b20985"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the write federator and configures it based on the user configuration. Also initialises the time manipulations.  <a href="namespacewriter__federator__mod.html#a7b31bb8f9d0fb8c0768252e819b20985">More...</a><br /></td></tr>
<tr class="separator:a7b31bb8f9d0fb8c0768252e819b20985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a350033966b51a20a8a69d092a20ba774"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a350033966b51a20a8a69d092a20ba774">finalise_writer_federator</a> ()</td></tr>
<tr class="memdesc:a350033966b51a20a8a69d092a20ba774"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalises the write federator and the manipulations.  <a href="namespacewriter__federator__mod.html#a350033966b51a20a8a69d092a20ba774">More...</a><br /></td></tr>
<tr class="separator:a350033966b51a20a8a69d092a20ba774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c407f4433b36fa8e9fefda57fc32252"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a5c407f4433b36fa8e9fefda57fc32252">inform_writer_federator_time_point</a> (io_configuration, source, data_id, data_dump)</td></tr>
<tr class="separator:a5c407f4433b36fa8e9fefda57fc32252"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff9121d09086fc4867afe57e0262f4a0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#aff9121d09086fc4867afe57e0262f4a0">inform_writer_federator_fields_present</a> (io_configuration, field_names, diag_field_names_and_roots)</td></tr>
<tr class="memdesc:aff9121d09086fc4867afe57e0262f4a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Informs the writer federator that specific fields are present and should be reflected in the diagnostics output.  <a href="namespacewriter__federator__mod.html#aff9121d09086fc4867afe57e0262f4a0">More...</a><br /></td></tr>
<tr class="separator:aff9121d09086fc4867afe57e0262f4a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10af49e026b9e11d113f702bb7f3113"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#ab10af49e026b9e11d113f702bb7f3113">is_field_used_by_writer_federator</a> (field_name, field_namespace)</td></tr>
<tr class="memdesc:ab10af49e026b9e11d113f702bb7f3113"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines whether a field is used by the writer federator or not.  <a href="namespacewriter__federator__mod.html#ab10af49e026b9e11d113f702bb7f3113">More...</a><br /></td></tr>
<tr class="separator:ab10af49e026b9e11d113f702bb7f3113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6aefade0899178fd2ba9c7c723af5d1"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#ac6aefade0899178fd2ba9c7c723af5d1">is_field_split_on_q</a> (field_name)</td></tr>
<tr class="memdesc:ac6aefade0899178fd2ba9c7c723af5d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines whether a field is split on Q or not.  <a href="namespacewriter__federator__mod.html#ac6aefade0899178fd2ba9c7c723af5d1">More...</a><br /></td></tr>
<tr class="separator:ac6aefade0899178fd2ba9c7c723af5d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c151f31e747242202c9328f70207055"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a0c151f31e747242202c9328f70207055">enable_specific_field_by_name</a> (field_name, diagnostics_mode, expected_here)</td></tr>
<tr class="memdesc:a0c151f31e747242202c9328f70207055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables a specific field by its name, this will locate all the fields with this name and enable them.  <a href="namespacewriter__federator__mod.html#a0c151f31e747242202c9328f70207055">More...</a><br /></td></tr>
<tr class="separator:a0c151f31e747242202c9328f70207055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468cf6121ebcfc23b1389528744d998c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a468cf6121ebcfc23b1389528744d998c">provide_q_field_names_to_writer_federator</a> (q_provided_field_names)</td></tr>
<tr class="memdesc:a468cf6121ebcfc23b1389528744d998c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides the Q field names to the write federator, this is required as on initialisation we don't know what these are and only when MONC register do they inform the IO server of the specifics.  <a href="namespacewriter__federator__mod.html#a468cf6121ebcfc23b1389528744d998c">More...</a><br /></td></tr>
<tr class="separator:a468cf6121ebcfc23b1389528744d998c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7149ce030c6fa05c7789b5e1e10be905"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905">provide_ordered_field_to_writer_federator</a> (io_configuration, field_name, field_namespace, field_values, timestep, time, source)</td></tr>
<tr class="separator:a7149ce030c6fa05c7789b5e1e10be905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b04288042049d5e432068c5923b026d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d">provide_ordered_field_to_writer_federator_real_values</a> (io_configuration, field_name, field_namespace, field_values, timestep, time, source)</td></tr>
<tr class="memdesc:a9b04288042049d5e432068c5923b026d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides fields (either diagnostics or prognostics) to the write federator which will action these as appropriate. This will split Q fields up if appropriate.  <a href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d">More...</a><br /></td></tr>
<tr class="separator:a9b04288042049d5e432068c5923b026d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f57429aef78615f84f59d4f2758747"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#ad5f57429aef78615f84f59d4f2758747">get_size_of_collective_q</a> (io_configuration, field_name, source)</td></tr>
<tr class="memdesc:ad5f57429aef78615f84f59d4f2758747"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the data size for each Q entry of a collective Q field for the specific source MONC that has sent data.  <a href="namespacewriter__federator__mod.html#ad5f57429aef78615f84f59d4f2758747">More...</a><br /></td></tr>
<tr class="separator:ad5f57429aef78615f84f59d4f2758747"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d77a55167cf260497e14e1f86a8e54b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b">provide_ordered_single_field_to_writer_federator</a> (io_configuration, field_name, field_namespace, field_values, timestep, time, source)</td></tr>
<tr class="memdesc:a4d77a55167cf260497e14e1f86a8e54b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides a single ordered field, i.e. Q fields have been split by this point.  <a href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b">More...</a><br /></td></tr>
<tr class="separator:a4d77a55167cf260497e14e1f86a8e54b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac4d8c09e5e6c8566f9548a71339e7b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#acac4d8c09e5e6c8566f9548a71339e7b">write_collective_write_value</a> (result_values, writer_index, contents_index, source, lookup_key)</td></tr>
<tr class="memdesc:acac4d8c09e5e6c8566f9548a71339e7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the collective values, this is held differently to independent values which are written directly - instead here we need to store the values for each MONC hence a specific type is used instead.  <a href="namespacewriter__federator__mod.html#acac4d8c09e5e6c8566f9548a71339e7b">More...</a><br /></td></tr>
<tr class="separator:acac4d8c09e5e6c8566f9548a71339e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a303133afee5100e6a9b0b19ead391dfa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa">determine_if_outstanding_field_can_be_written</a> (io_configuration, writer_entry, specific_field)</td></tr>
<tr class="memdesc:a303133afee5100e6a9b0b19ead391dfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">For a specific field wil determine and handle any outstanding fields writes until an outstanding write can not be performed or the outstanding list is empty.  <a href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa">More...</a><br /></td></tr>
<tr class="separator:a303133afee5100e6a9b0b19ead391dfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3df9fda1cc189c370e8599947191e559"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559">determine_if_field_can_be_written</a> (io_configuration, writer_entry, specific_field, timestep, previous_write_timestep, write_time, previous_write_time, field_written)</td></tr>
<tr class="memdesc:a3df9fda1cc189c370e8599947191e559"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if a file can be written to its overarching write representation. If so then a write is issued, otherwise an outstanding write point is registered which will be checked frequency to do a write later on.  <a href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559">More...</a><br /></td></tr>
<tr class="separator:a3df9fda1cc189c370e8599947191e559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af403ddb2a3d977bfc3f81a6f834488"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488">check_writer_for_trigger</a> (io_configuration, source, data_id, data_dump)</td></tr>
<tr class="memdesc:a1af403ddb2a3d977bfc3f81a6f834488"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks all writer entries for any trigger fires and issues the underlying file storage.  <a href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488">More...</a><br /></td></tr>
<tr class="separator:a1af403ddb2a3d977bfc3f81a6f834488"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a977faf0b0a12f54b8002555e6f791856"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856">check_writer_trigger</a> (io_configuration, writer_entry_index, timestep, time, terminated)</td></tr>
<tr class="memdesc:a977faf0b0a12f54b8002555e6f791856"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks a writer trigger and issues a file creation along with field write if the conditions (time or timestep) are met. This will either create and write to the file or store a pending state if one is already open (required due to NetCDF/HDF5 limitations with thread safety and parallel access.)  <a href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856">More...</a><br /></td></tr>
<tr class="separator:a977faf0b0a12f54b8002555e6f791856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9271347f390a41c78caacc174002d0b4"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4">issue_actual_write</a> (io_configuration, writer_entry, timestep, time, terminated_write)</td></tr>
<tr class="memdesc:a9271347f390a41c78caacc174002d0b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Issues the actual file creation, write of available fields and closure if all completed.  <a href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4">More...</a><br /></td></tr>
<tr class="separator:a9271347f390a41c78caacc174002d0b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6600fa0faed86a8d9f6d22b2903da62"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62">clean_time_points</a> ()</td></tr>
<tr class="memdesc:ab6600fa0faed86a8d9f6d22b2903da62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleans out old timepoints which are no longer going to be of any relavence to the file writing. This ensures that we don't have lots of stale points that need to be processed and searched beyond but are themselves pointless.  <a href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62">More...</a><br /></td></tr>
<tr class="separator:ab6600fa0faed86a8d9f6d22b2903da62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af717d0c9b90eb4744fe7bec75086e25d"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1map__type.html">map_type</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d">extract_applicable_time_points</a> (start_time, end_time)</td></tr>
<tr class="memdesc:af717d0c9b90eb4744fe7bec75086e25d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts the applicable time points from the overall map that lie within a specific range.  <a href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d">More...</a><br /></td></tr>
<tr class="separator:af717d0c9b90eb4744fe7bec75086e25d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4ee4eae0932fe781cc87322c7da4204"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1map__type.html">map_type</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#ac4ee4eae0932fe781cc87322c7da4204">sort_applicable_time_points</a> (unsorted_timepoints)</td></tr>
<tr class="memdesc:ac4ee4eae0932fe781cc87322c7da4204"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sorts the time points based upon their timestep, smallest to largest. Note that this is a bubble sort and as such inefficient, so would be good to change to something else but works OK for now.  <a href="namespacewriter__federator__mod.html#ac4ee4eae0932fe781cc87322c7da4204">More...</a><br /></td></tr>
<tr class="separator:ac4ee4eae0932fe781cc87322c7da4204"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37589f9aced0f51f811ed15c462d33cb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb">close_diagnostics_file</a> (io_configuration, writer_entry, timestep, time)</td></tr>
<tr class="memdesc:a37589f9aced0f51f811ed15c462d33cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (collective operation)  <a href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb">More...</a><br /></td></tr>
<tr class="separator:a37589f9aced0f51f811ed15c462d33cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ec7f85e388c7212a8aa98acefc2b9d0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0">handle_close_diagnostics_globalcallback</a> (io_configuration, values, field_name, timestep)</td></tr>
<tr class="memdesc:a9ec7f85e388c7212a8aa98acefc2b9d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call back for the inter IO reduction which actually does the NetCDF file closing which is a collective (synchronous) operation. Calls out to the NetCDF code to do the call and then checks the list of pending file writes to process any others that are waiting in the queue.  <a href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0">More...</a><br /></td></tr>
<tr class="separator:a9ec7f85e388c7212a8aa98acefc2b9d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e6cf3c74ee165c8ece3735913e75e0a"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a">check_for_and_issue_chain_write</a> (io_configuration, writer_entry)</td></tr>
<tr class="memdesc:a4e6cf3c74ee165c8ece3735913e75e0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will check whether there are any pending writes and if so will issue a chain write for this.  <a href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a">More...</a><br /></td></tr>
<tr class="separator:a4e6cf3c74ee165c8ece3735913e75e0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27f423ed92a9bd09acce659a23e3defa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a27f423ed92a9bd09acce659a23e3defa">register_pending_file_write</a> (writer_entry_index, timestep, time, terminated_write)</td></tr>
<tr class="memdesc:a27f423ed92a9bd09acce659a23e3defa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a pending file write which will be actioned later on.  <a href="namespacewriter__federator__mod.html#a27f423ed92a9bd09acce659a23e3defa">More...</a><br /></td></tr>
<tr class="separator:a27f423ed92a9bd09acce659a23e3defa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9379ee9a358faa87a63d2f2459f202b9"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a9379ee9a358faa87a63d2f2459f202b9">get_next_applicable_writer_entry</a> (field_name, field_namespace, writer_index_point, contents_index_point)</td></tr>
<tr class="memdesc:a9379ee9a358faa87a63d2f2459f202b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the index of the next writer which uses a specific field. If none is found then returns false, otherwise true.  <a href="namespacewriter__federator__mod.html#a9379ee9a358faa87a63d2f2459f202b9">More...</a><br /></td></tr>
<tr class="separator:a9379ee9a358faa87a63d2f2459f202b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a863bc95a6373f8197cc183d39f1d6d12"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a863bc95a6373f8197cc183d39f1d6d12">get_total_number_writer_fields</a> (io_configuration, writer_entry_index)</td></tr>
<tr class="memdesc:a863bc95a6373f8197cc183d39f1d6d12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the total number of fields that make up a writer entry, this is all the fields of the groups that make up this writer and individual fields specified too.  <a href="namespacewriter__federator__mod.html#a863bc95a6373f8197cc183d39f1d6d12">More...</a><br /></td></tr>
<tr class="separator:a863bc95a6373f8197cc183d39f1d6d12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34196607f504b72b30c0d82215402d96"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a34196607f504b72b30c0d82215402d96">get_group_number_of_fields</a> (io_configuration, group_members, num_q_fields, namespace)</td></tr>
<tr class="memdesc:a34196607f504b72b30c0d82215402d96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the number of fields within a group of fields.  <a href="namespacewriter__federator__mod.html#a34196607f504b72b30c0d82215402d96">More...</a><br /></td></tr>
<tr class="separator:a34196607f504b72b30c0d82215402d96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96287a6f24e9217bb315d12e326cdfd9"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a96287a6f24e9217bb315d12e326cdfd9">get_field_number_of_fields</a> (io_configuration, field_name, field_namespace, num_q_fields)</td></tr>
<tr class="memdesc:a96287a6f24e9217bb315d12e326cdfd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the number of fields that make up this field, if it is a Q field then it will be split into many subfields hence it is not a simple 1-1 mapping.  <a href="namespacewriter__federator__mod.html#a96287a6f24e9217bb315d12e326cdfd9">More...</a><br /></td></tr>
<tr class="separator:a96287a6f24e9217bb315d12e326cdfd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4a1b4f58fe72715645615b4f1ee9d8"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#afa4a1b4f58fe72715645615b4f1ee9d8">add_group_of_fields_to_writer_entry</a> (io_configuration, writer_entry_index, facet_index, current_field_index, writer_field_names, duplicate_field_names, diagnostic_generation_frequency)</td></tr>
<tr class="memdesc:afa4a1b4f58fe72715645615b4f1ee9d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a group of fields to a writer entry, groups are expanded out into individual fields, each inherit the properties of the group.  <a href="namespacewriter__federator__mod.html#afa4a1b4f58fe72715645615b4f1ee9d8">More...</a><br /></td></tr>
<tr class="separator:afa4a1b4f58fe72715645615b4f1ee9d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90abda607746ac48c9b1df555c59895c"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a90abda607746ac48c9b1df555c59895c">add_field_to_writer_entry</a> (io_configuration, writer_entry_index, io_config_facet_index, my_facet_index, field_name, field_namespace, writer_field_names, duplicate_field_names, diagnostic_generation_frequency)</td></tr>
<tr class="memdesc:a90abda607746ac48c9b1df555c59895c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a field to the writer entry, this will split the Q fields. However at initialisation we don't know what the Q fields are called, hence place a marker which will be replaced later on.  <a href="namespacewriter__federator__mod.html#a90abda607746ac48c9b1df555c59895c">More...</a><br /></td></tr>
<tr class="separator:a90abda607746ac48c9b1df555c59895c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6664cafdcce9b4b3d0a5815c65af9ac"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#ae6664cafdcce9b4b3d0a5815c65af9ac">add_specific_field_to_writer_entry</a> (io_configuration, writer_entry_index, io_config_facet_index, my_facet_index, field_name, field_namespace, writer_field_names, duplicate_field_names, timestep_frequency, diagnostic_field_configuration, prognostic_field_configuration)</td></tr>
<tr class="memdesc:ae6664cafdcce9b4b3d0a5815c65af9ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a specific field and its information to a writer entry.  <a href="namespacewriter__federator__mod.html#ae6664cafdcce9b4b3d0a5815c65af9ac">More...</a><br /></td></tr>
<tr class="separator:ae6664cafdcce9b4b3d0a5815c65af9ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a989ba90529039516692707b2d6611683"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a989ba90529039516692707b2d6611683">handle_duplicate_field_names</a> (writer_entry, duplicate_field_names)</td></tr>
<tr class="memdesc:a989ba90529039516692707b2d6611683"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks duplicate field names in a writer entry as duplicates so that the NetCDF layer can then deal with this by issuing unique names.  <a href="namespacewriter__federator__mod.html#a989ba90529039516692707b2d6611683">More...</a><br /></td></tr>
<tr class="separator:a989ba90529039516692707b2d6611683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89b6a2402ed4c492470ff392caa11714"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a89b6a2402ed4c492470ff392caa11714">get_index_of_group</a> (io_configuration, group_name)</td></tr>
<tr class="memdesc:a89b6a2402ed4c492470ff392caa11714"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches the IO server configuration for a group with a specific name and returns the index to that group or 0 if no corresponding group is found.  <a href="namespacewriter__federator__mod.html#a89b6a2402ed4c492470ff392caa11714">More...</a><br /></td></tr>
<tr class="separator:a89b6a2402ed4c492470ff392caa11714"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a472ec41d11538e384f05791c3d6037d7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7">determine_collective_type_and_optimise_if_possible</a> (io_configuration, field_to_write_information)</td></tr>
<tr class="memdesc:a472ec41d11538e384f05791c3d6037d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines whether it can optimise a specific collective field. If the field fits into certain limited parameters then it will optimise it. These parameters are very common, hence most fields can be optimised. Basically, it is looking to contiguous blocks of data from different MONCs so that the number of writes to the NetCDF file is limited.  <a href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7">More...</a><br /></td></tr>
<tr class="separator:a472ec41d11538e384f05791c3d6037d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08e836c0ac87a9e09b4c622aaded6ad6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6">initialise_contiguous_data_regions</a> (io_configuration, field_to_write_information)</td></tr>
<tr class="memdesc:a08e836c0ac87a9e09b4c622aaded6ad6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will initialise the collective data regions that form contiguous blocks within the data. This is quite an expensive operation so only done once for each field, but has the potential for very significant performance advantages for the fields that match it.  <a href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6">More...</a><br /></td></tr>
<tr class="separator:a08e836c0ac87a9e09b4c622aaded6ad6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f81ee04b25b784bf928c8bc96d32016"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a9f81ee04b25b784bf928c8bc96d32016">get_common_starts</a> (dim, val, vals, common_starters, num_common)</td></tr>
<tr class="memdesc:a9f81ee04b25b784bf928c8bc96d32016"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the number of common starting points that match a specific input value.  <a href="namespacewriter__federator__mod.html#a9f81ee04b25b784bf928c8bc96d32016">More...</a><br /></td></tr>
<tr class="separator:a9f81ee04b25b784bf928c8bc96d32016"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d56184ae0676c708c4377f01f71310"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310">get_dimension_identifier</a> (dim_name, is_auto_dimension)</td></tr>
<tr class="memdesc:a20d56184ae0676c708c4377f01f71310"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translates a dimension name to its numeric corresponding identifier.  <a href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310">More...</a><br /></td></tr>
<tr class="separator:a20d56184ae0676c708c4377f01f71310"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa54db4af17f9531d20049c38470c41bb"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structwriter__types__mod_1_1writer__type.html">writer_type</a>), dimension(:), allocatable, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#aa54db4af17f9531d20049c38470c41bb">writer_entries</a></td></tr>
<tr class="separator:aa54db4af17f9531d20049c38470c41bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a495ab94021997bb4b9c1f5a982d0b7ca"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a495ab94021997bb4b9c1f5a982d0b7ca">used_field_names</a></td></tr>
<tr class="separator:a495ab94021997bb4b9c1f5a982d0b7ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69cc7dea9613ccebe26d24c7166c3e6f"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a69cc7dea9613ccebe26d24c7166c3e6f">q_field_names</a></td></tr>
<tr class="separator:a69cc7dea9613ccebe26d24c7166c3e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc9b7c46ac699da24da779b9c6c009cd"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#adc9b7c46ac699da24da779b9c6c009cd">time_points</a></td></tr>
<tr class="separator:adc9b7c46ac699da24da779b9c6c009cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52f8619eadb826621b1957fd4daa6b72"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a52f8619eadb826621b1957fd4daa6b72">q_field_splits</a></td></tr>
<tr class="separator:a52f8619eadb826621b1957fd4daa6b72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb3545de2843efed3a4278718c892cbc"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#aeb3545de2843efed3a4278718c892cbc">collective_q_field_dims</a></td></tr>
<tr class="separator:aeb3545de2843efed3a4278718c892cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62ea92c688fb39538620e6ea06fa334f"><td class="memItemLeft" align="right" valign="top">integer, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a62ea92c688fb39538620e6ea06fa334f">time_points_rwlock</a></td></tr>
<tr class="separator:a62ea92c688fb39538620e6ea06fa334f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81785f80135e4042d82537c054b7681f"><td class="memItemLeft" align="right" valign="top">integer, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a81785f80135e4042d82537c054b7681f">collective_contiguous_initialisation_mutex</a></td></tr>
<tr class="separator:a81785f80135e4042d82537c054b7681f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a28ace2d76dc271725853294d7958c2"><td class="memItemLeft" align="right" valign="top">integer, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#a8a28ace2d76dc271725853294d7958c2">currently_writing_mutex</a></td></tr>
<tr class="separator:a8a28ace2d76dc271725853294d7958c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb80206d17d695e7d9faaaa051f1ba6e"><td class="memItemLeft" align="right" valign="top">logical, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewriter__federator__mod.html#aeb80206d17d695e7d9faaaa051f1ba6e">currently_writing</a></td></tr>
<tr class="separator:aeb80206d17d695e7d9faaaa051f1ba6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This federates over the writing of diagnostic and prognostic data to the file system. It also manages the time manipulation of fields and groups. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a90abda607746ac48c9b1df555c59895c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90abda607746ac48c9b1df555c59895c">&#9670;&nbsp;</a></span>add_field_to_writer_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function writer_federator_mod::add_field_to_writer_entry </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>writer_entry_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>io_config_facet_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>my_facet_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_namespace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>writer_field_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>duplicate_field_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diagnostic_generation_frequency</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a field to the writer entry, this will split the Q fields. However at initialisation we don't know what the Q fields are called, hence place a marker which will be replaced later on. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">writer_entry_index</td><td>Index of the writer entry that we are dealing with </td></tr>
    <tr><td class="paramname">io_config_facet_index</td><td>Index of the facet (group) in the IO server configuration </td></tr>
    <tr><td class="paramname">my_facet_index</td><td>The current field index in this internal module representation of the structure </td></tr>
    <tr><td class="paramname">field_name</td><td>The name of the field that we are constructing </td></tr>
    <tr><td class="paramname">writer_field_names</td><td>The field names in the writer (for duplication checking) </td></tr>
    <tr><td class="paramname">duplicate_field_names</td><td>Duplicate field names in the wrier, for duplication checking </td></tr>
    <tr><td class="paramname">diagnostic_generation_frequency</td><td>Generation frequency of the diagnostics </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Location for next field to be written to </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01181">1181</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: writer_entry_index, io_config_facet_index, my_facet_index</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name, field_namespace</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordtype">type</span>(hashset_type), <span class="keywordtype">intent(inout)</span> :: writer_field_names, duplicate_field_names</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordtype">type</span>(hashmap_type), <span class="keywordtype">intent(inout)</span> :: diagnostic_generation_frequency</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordtype">integer</span> :: i, number_q_fields, tot_size</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordtype">type</span>(io_configuration_field_type) :: prognostic_field_configuration</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordtype">type</span>(io_configuration_data_definition_type) :: prognostic_containing_data_defn</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordtype">type</span>(io_configuration_diagnostic_field_type) :: diagnostic_field_configuration</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordtype">type</span>(collective_q_field_representation_type), <span class="keywordtype">pointer</span> :: collective_q_field</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span> (get_diagnostic_field_configuration(io_configuration, field_name, field_namespace, diagnostic_field_configuration)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="keywordflow">if</span> (diagnostic_field_configuration%field_type == array_field_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="keywordflow">if</span> (diagnostic_field_configuration%dim_size_defns(diagnostic_field_configuration%dimensions) .eq. <span class="stringliteral">&quot;qfields&quot;</span>) <span class="keywordflow">then</span>  </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;          number_q_fields=c_get_integer(io_configuration%dimension_sizing, <span class="stringliteral">&quot;qfields&quot;</span>)</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;          <span class="keywordflow">do</span> i=1, number_q_fields</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            <span class="keyword">call </span>add_specific_field_to_writer_entry(io_configuration, writer_entry_index, io_config_facet_index, &amp;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                 my_facet_index+i, trim(field_name)//<span class="stringliteral">&quot;_udef&quot;</span>//trim(conv_to_string(i)), field_namespace, writer_field_names, &amp;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                 duplicate_field_names, c_get_integer(diagnostic_generation_frequency, field_name), diagnostic_field_configuration)</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;          tot_size=1</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;          <span class="keywordflow">do</span> i=1, writer_entries(writer_entry_index)%contents(my_facet_index+number_q_fields)%dimensions</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            tot_size=tot_size*writer_entries(writer_entry_index)%contents(my_facet_index+number_q_fields)%actual_dim_size(i)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;          <span class="keyword">call </span>c_put_integer(q_field_splits, field_name, tot_size)</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;          add_field_to_writer_entry=number_q_fields</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;          <span class="keywordflow">return</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keyword">call </span>add_specific_field_to_writer_entry(io_configuration, writer_entry_index, io_config_facet_index, &amp;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;           my_facet_index+1, field_name, field_namespace, writer_field_names, duplicate_field_names, &amp;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;           c_get_integer(diagnostic_generation_frequency, field_name), diagnostic_field_configuration)</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      add_field_to_writer_entry=1      </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (get_prognostic_field_configuration(io_configuration, field_name, field_namespace, &amp;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;         prognostic_field_configuration, prognostic_containing_data_defn)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">if</span> (prognostic_field_configuration%field_type == array_field_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="keywordflow">if</span> (prognostic_field_configuration%dim_size_defns(prognostic_field_configuration%dimensions) .eq. <span class="stringliteral">&quot;qfields&quot;</span>) <span class="keywordflow">then</span>  </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;          number_q_fields=c_get_integer(io_configuration%dimension_sizing, <span class="stringliteral">&quot;qfields&quot;</span>)</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;          <span class="keywordflow">do</span> i=1, number_q_fields</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            <span class="keyword">call </span>add_specific_field_to_writer_entry(io_configuration, writer_entry_index, io_config_facet_index, &amp;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                 my_facet_index+i, trim(field_name)//<span class="stringliteral">&quot;_udef&quot;</span>//trim(conv_to_string(i)), field_namespace, writer_field_names, &amp;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                 duplicate_field_names, prognostic_containing_data_defn%frequency, &amp;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                 prognostic_field_configuration=prognostic_field_configuration)</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;          <span class="keywordflow">if</span> (prognostic_field_configuration%collective) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;            <span class="keyword">allocate</span>(collective_q_field)</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            <span class="keyword">allocate</span>(collective_q_field%dimensions(&amp;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                 writer_entries(writer_entry_index)%contents(my_facet_index+number_q_fields)%dimensions))</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            <span class="keywordflow">do</span> i=1, writer_entries(writer_entry_index)%contents(my_facet_index+number_q_fields)%dimensions</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;              <span class="keywordflow">if</span> (trim(writer_entries(writer_entry_index)%contents(my_facet_index+number_q_fields)%dim_size_defns(i)) == <span class="stringliteral">&quot;z&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                collective_q_field%dimensions(i)=1</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (trim(writer_entries(writer_entry_index)%contents(my_facet_index+number_q_fields)%dim_size_defns(i)) &amp;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                   == <span class="stringliteral">&quot;y&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                collective_q_field%dimensions(i)=2</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (trim(writer_entries(writer_entry_index)%contents(my_facet_index+number_q_fields)%dim_size_defns(i)) &amp;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                   == <span class="stringliteral">&quot;x&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                collective_q_field%dimensions(i)=3</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            generic=&gt;collective_q_field</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            <span class="keyword">call </span>c_put_generic(collective_q_field_dims, field_name, generic, .false.)</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            tot_size=1</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            <span class="keywordflow">do</span> i=1, writer_entries(writer_entry_index)%contents(my_facet_index+number_q_fields)%dimensions</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;              tot_size=tot_size*writer_entries(writer_entry_index)%contents(my_facet_index+number_q_fields)%actual_dim_size(i)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            <span class="keyword">call </span>c_put_integer(q_field_splits, field_name, tot_size)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;          <span class="keyword">call </span>c_add_string(q_field_names, field_name)</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;          add_field_to_writer_entry=number_q_fields</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;          <span class="keywordflow">return</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="keywordflow">        end if</span>     </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="keyword">call </span>add_specific_field_to_writer_entry(io_configuration, writer_entry_index, io_config_facet_index, &amp;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;           my_facet_index+1, field_name, field_namespace, writer_field_names, duplicate_field_names, &amp;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;           prognostic_containing_data_defn%frequency, prognostic_field_configuration=prognostic_field_configuration)</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      add_field_to_writer_entry=1</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Field &#39;&quot;</span>//trim(field_name)//&amp;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;           <span class="stringliteral">&quot;&#39; configured for file write but can not find this as a prognostic or diagnostic definition&quot;</span>)</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a90abda607746ac48c9b1df555c59895c_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a90abda607746ac48c9b1df555c59895c_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a90abda607746ac48c9b1df555c59895c_cgraph" id="anamespacewriter__federator__mod_a90abda607746ac48c9b1df555c59895c_cgraph">
<area shape="rect" title="Adds a field to the writer entry, this will split the Q fields. However at initialisation we don&#39;t kn..." alt="" coords="5,13,176,54"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ae6664cafdcce9b4b3d0a5815c65af9ac" title="Adds a specific field and its information to a writer entry." alt="" coords="224,5,368,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a90abda607746ac48c9b1df555c59895c_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a90abda607746ac48c9b1df555c59895c_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a90abda607746ac48c9b1df555c59895c_icgraph" id="anamespacewriter__federator__mod_a90abda607746ac48c9b1df555c59895c_icgraph">
<area shape="rect" title="Adds a field to the writer entry, this will split the Q fields. However at initialisation we don&#39;t kn..." alt="" coords="797,46,968,87"/>
<area shape="rect" href="namespacewriter__federator__mod.html#afa4a1b4f58fe72715645615b4f1ee9d8" title="Adds a group of fields to a writer entry, groups are expanded out into individual fields,..." alt="" coords="605,5,749,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7b31bb8f9d0fb8c0768252e819b20985" title="Initialises the write federator and configures it based on the user configuration...." alt="" coords="385,46,557,87"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,53,337,80"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,53,99,80"/>
</map>
</div>

</div>
</div>
<a id="afa4a1b4f58fe72715645615b4f1ee9d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa4a1b4f58fe72715645615b4f1ee9d8">&#9670;&nbsp;</a></span>add_group_of_fields_to_writer_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function writer_federator_mod::add_group_of_fields_to_writer_entry </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>writer_entry_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>facet_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_field_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>writer_field_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>duplicate_field_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diagnostic_generation_frequency</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a group of fields to a writer entry, groups are expanded out into individual fields, each inherit the properties of the group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">writer_entry_index</td><td>Index of the writer entry that we are dealing with </td></tr>
    <tr><td class="paramname">facet_index</td><td>Index of the facet (group) in the IO server configuration </td></tr>
    <tr><td class="paramname">current_field_index</td><td>The current field index in this internal module representation of the structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The next field index to write to </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01142">1142</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: writer_entry_index, facet_index, current_field_index</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordtype">type</span>(hashset_type), <span class="keywordtype">intent(inout)</span> :: writer_field_names, duplicate_field_names</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keywordtype">type</span>(hashmap_type), <span class="keywordtype">intent(inout)</span> :: diagnostic_generation_frequency</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordtype">integer</span> :: group_index</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: field_name</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    add_group_of_fields_to_writer_entry=current_field_index</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    group_index=get_index_of_group(io_configuration, &amp;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;         io_configuration%file_writers(writer_entry_index)%contents(facet_index)%facet_name)</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">if</span> (group_index == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Can not find group &#39;&quot;</span>//&amp;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;           trim(io_configuration%file_writers(writer_entry_index)%contents(facet_index)%facet_name)//<span class="stringliteral">&quot;&#39; in the configuration&quot;</span>)</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    iterator=c_get_iterator(io_configuration%groups(group_index)%members)</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      field_name=c_next_string(iterator)</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      add_group_of_fields_to_writer_entry=add_group_of_fields_to_writer_entry+add_field_to_writer_entry(io_configuration, &amp;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;           writer_entry_index, facet_index, add_group_of_fields_to_writer_entry, field_name, &amp;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;           io_configuration%groups(group_index)%namespace, writer_field_names, duplicate_field_names, &amp;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;           diagnostic_generation_frequency)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_afa4a1b4f58fe72715645615b4f1ee9d8_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_afa4a1b4f58fe72715645615b4f1ee9d8_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_afa4a1b4f58fe72715645615b4f1ee9d8_cgraph" id="anamespacewriter__federator__mod_afa4a1b4f58fe72715645615b4f1ee9d8_cgraph">
<area shape="rect" title="Adds a group of fields to a writer entry, groups are expanded out into individual fields,..." alt="" coords="5,39,149,95"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a90abda607746ac48c9b1df555c59895c" title="Adds a field to the writer entry, this will split the Q fields. However at initialisation we don&#39;t kn..." alt="" coords="197,13,368,54"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a89b6a2402ed4c492470ff392caa11714" title="Searches the IO server configuration for a group with a specific name and returns the index to that g..." alt="" coords="211,78,355,119"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ae6664cafdcce9b4b3d0a5815c65af9ac" title="Adds a specific field and its information to a writer entry." alt="" coords="416,5,560,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_afa4a1b4f58fe72715645615b4f1ee9d8_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_afa4a1b4f58fe72715645615b4f1ee9d8_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_afa4a1b4f58fe72715645615b4f1ee9d8_icgraph" id="anamespacewriter__federator__mod_afa4a1b4f58fe72715645615b4f1ee9d8_icgraph">
<area shape="rect" title="Adds a group of fields to a writer entry, groups are expanded out into individual fields,..." alt="" coords="605,5,749,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7b31bb8f9d0fb8c0768252e819b20985" title="Initialises the write federator and configures it based on the user configuration...." alt="" coords="385,13,557,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="ae6664cafdcce9b4b3d0a5815c65af9ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6664cafdcce9b4b3d0a5815c65af9ac">&#9670;&nbsp;</a></span>add_specific_field_to_writer_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::add_specific_field_to_writer_entry </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>writer_entry_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>io_config_facet_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>my_facet_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_namespace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>writer_field_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>duplicate_field_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep_frequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__diagnostic__field__type.html">io_configuration_diagnostic_field_type</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>diagnostic_field_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__field__type.html">io_configuration_field_type</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>prognostic_field_configuration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a specific field and its information to a writer entry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">writer_entry_index</td><td>Index of the writer entry that we are dealing with </td></tr>
    <tr><td class="paramname">io_config_facet_index</td><td>Index of the facet (group) in the IO server configuration </td></tr>
    <tr><td class="paramname">my_facet_index</td><td>The current field index in this internal module representation of the structure </td></tr>
    <tr><td class="paramname">field_name</td><td>The name of the field that we are constructing </td></tr>
    <tr><td class="paramname">writer_field_names</td><td>The field names in the writer (for duplication checking) </td></tr>
    <tr><td class="paramname">duplicate_field_names</td><td>Duplicate field names in the wrier, for duplication checking </td></tr>
    <tr><td class="paramname">timestep_frequency</td><td>Timestepping frequency </td></tr>
    <tr><td class="paramname">diagnostic_field_configuration</td><td>The diagnostic field configuration (optional) </td></tr>
    <tr><td class="paramname">prognostic_field_configuration</td><td>The prognostic field configuration (optional) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01279">1279</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: writer_entry_index, io_config_facet_index, my_facet_index, timestep_frequency</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name, field_namespace</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordtype">type</span>(hashset_type), <span class="keywordtype">intent(inout)</span> :: writer_field_names, duplicate_field_names</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordtype">type</span>(io_configuration_diagnostic_field_type), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: diagnostic_field_configuration</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordtype">type</span>(io_configuration_field_type), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: prognostic_field_configuration</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%field_name=field_name</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%field_namespace=field_namespace</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keyword">call </span>c_add_string(used_field_names, field_name)</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="keywordflow">if</span> (.not. c_contains(writer_field_names, field_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="keyword">call </span>c_add_string(writer_field_names, writer_entries(writer_entry_index)%contents(my_facet_index)%field_name)</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keyword">call </span>c_add_string(duplicate_field_names, writer_entries(writer_entry_index)%contents(my_facet_index)%field_name)</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">if</span> (io_configuration%file_writers(writer_entry_index)%contents(io_config_facet_index)%time_manipulation_type == &amp;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;         instantaneous_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%time_manipulation=&gt;perform_instantaneous_time_manipulation</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%ready_to_write=&gt;is_instantaneous_time_manipulation_ready_to_write</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (io_configuration%file_writers(writer_entry_index)%contents(io_config_facet_index)%time_manipulation_type == &amp;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;         time_averaged_type) <span class="keywordflow">then</span>        </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%time_manipulation=&gt;perform_timeaveraged_time_manipulation</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%ready_to_write=&gt;is_time_averaged_time_manipulation_ready_to_write</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (io_configuration%file_writers(writer_entry_index)%contents(io_config_facet_index)%time_manipulation_type == &amp;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;         none_type) <span class="keywordflow">then</span>        </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%time_manipulation=&gt;perform_none_time_manipulation</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%ready_to_write=&gt;is_none_time_manipulation_ready_to_write</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%time_manipulation_type=&amp;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;         io_configuration%file_writers(writer_entry_index)%contents(io_config_facet_index)%time_manipulation_type</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%output_frequency=&amp;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;         io_configuration%file_writers(writer_entry_index)%contents(io_config_facet_index)%output_time_frequency</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%previous_write_time=0.0</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%previous_tracked_write_point=0.0   </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%duplicate_field_name=.false.</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%pending_to_write=.false.</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%enabled=.false.</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%expected_here=.true.</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%prognostic_field=.false.</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    writer_entries(writer_entry_index)%contents(my_facet_index)%diagnostic_field=.false.</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(diagnostic_field_configuration)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%timestep_frequency=timestep_frequency</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%dimensions=diagnostic_field_configuration%dimensions</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%data_type=diagnostic_field_configuration%data_type</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%field_type=diagnostic_field_configuration%field_type</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%dim_size_defns=diagnostic_field_configuration%dim_size_defns</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%units=diagnostic_field_configuration%units</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%collective_write=diagnostic_field_configuration%collective</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%collective_initialised=.false.</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%issue_write=.true.</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%diagnostic_field=.true.</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">present</span>(prognostic_field_configuration)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%timestep_frequency=timestep_frequency</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%data_type=prognostic_field_configuration%data_type</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%field_type=prognostic_field_configuration%field_type</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%units=prognostic_field_configuration%units</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%dimensions=prognostic_field_configuration%dimensions</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%collective_write=prognostic_field_configuration%collective</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%collective_initialised=.false.</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      writer_entries(writer_entry_index)%contents(my_facet_index)%prognostic_field=.true.</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      <span class="keywordflow">if</span> (.not. prognostic_field_configuration%collective) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        writer_entries(writer_entry_index)%contents(my_facet_index)%issue_write=io_configuration%my_io_rank==0</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        writer_entries(writer_entry_index)%contents(my_facet_index)%issue_write=.true.</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="keywordflow">if</span> (prognostic_field_configuration%field_type == array_field_type .or. &amp;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;           prognostic_field_configuration%field_type == map_field_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        <span class="keywordflow">if</span> (prognostic_field_configuration%dimensions .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          writer_entries(writer_entry_index)%contents(my_facet_index)%dimensions=prognostic_field_configuration%dimensions</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;          writer_entries(writer_entry_index)%contents(my_facet_index)%dim_size_defns=&amp;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;               prognostic_field_configuration%dim_size_defns</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;The writing prognostic field &#39;&quot;</span>//trim(field_name)//<span class="stringliteral">&quot;&#39; configuration must have dimensions&quot;</span>)</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;A diagnostic or prognostic configuration for the field &#39;&quot;</span>//trim(field_name)//<span class="stringliteral">&quot;&#39; was not found&quot;</span>)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keywordflow">if</span> (writer_entries(writer_entry_index)%contents(my_facet_index)%dimensions .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keywordflow">if</span> (writer_entries(writer_entry_index)%contents(my_facet_index)%dim_size_defns(&amp;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;           writer_entries(writer_entry_index)%contents(my_facet_index)%dimensions) .eq. <span class="stringliteral">&quot;qfields&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        writer_entries(writer_entry_index)%contents(my_facet_index)%dimensions=&amp;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;             writer_entries(writer_entry_index)%contents(my_facet_index)%dimensions-1</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordflow">do</span> i=1, writer_entries(writer_entry_index)%contents(my_facet_index)%dimensions</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        writer_entries(writer_entry_index)%contents(my_facet_index)%actual_dim_size(i)=c_get_integer(&amp;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;             io_configuration%dimension_sizing, writer_entries(writer_entry_index)%contents(my_facet_index)%dim_size_defns(i))</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="keywordflow">      end do</span>      </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="keywordflow">    end if</span>    </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_init(writer_entries(writer_entry_index)%contents(my_facet_index)%values_mutex, -1))</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_ae6664cafdcce9b4b3d0a5815c65af9ac_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_ae6664cafdcce9b4b3d0a5815c65af9ac_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_ae6664cafdcce9b4b3d0a5815c65af9ac_icgraph" id="anamespacewriter__federator__mod_ae6664cafdcce9b4b3d0a5815c65af9ac_icgraph">
<area shape="rect" title="Adds a specific field and its information to a writer entry." alt="" coords="1016,39,1160,95"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a90abda607746ac48c9b1df555c59895c" title="Adds a field to the writer entry, this will split the Q fields. However at initialisation we don&#39;t kn..." alt="" coords="797,46,968,87"/>
<area shape="rect" href="namespacewriter__federator__mod.html#afa4a1b4f58fe72715645615b4f1ee9d8" title="Adds a group of fields to a writer entry, groups are expanded out into individual fields,..." alt="" coords="605,5,749,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7b31bb8f9d0fb8c0768252e819b20985" title="Initialises the write federator and configures it based on the user configuration...." alt="" coords="385,46,557,87"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,53,337,80"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,53,99,80"/>
</map>
</div>

</div>
</div>
<a id="a4e6cf3c74ee165c8ece3735913e75e0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e6cf3c74ee165c8ece3735913e75e0a">&#9670;&nbsp;</a></span>check_for_and_issue_chain_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function writer_federator_mod::check_for_and_issue_chain_write </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structwriter__types__mod_1_1writer__type.html">writer_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>writer_entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will check whether there are any pending writes and if so will issue a chain write for this. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">writer_entry</td><td>The specific writer entry </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether a chain write was issued or not </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00962">962</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordtype">type</span>(writer_type), <span class="keywordtype">intent(inout)</span> :: writer_entry</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(writer_entry%pending_writes_mutex))</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">if</span> (.not. c_is_empty(writer_entry%pending_writes)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      check_for_and_issue_chain_write=.true.</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      generic=&gt;c_pop_generic(writer_entry%pending_writes)    </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entry%pending_writes_mutex))</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="keywordflow">      type is</span> (pending_write_type)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() .ge. <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;Chain to next pending entry ts= &quot;</span>//trim(conv_to_string(generic%timestep)))</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keyword">call </span>issue_actual_write(io_configuration, writer_entry, generic%timestep, &amp;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;             generic%write_time, generic%terminated_write)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keyword">deallocate</span>(generic)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      check_for_and_issue_chain_write=.false.</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entry%pending_writes_mutex))</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a4e6cf3c74ee165c8ece3735913e75e0a_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a4e6cf3c74ee165c8ece3735913e75e0a_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a4e6cf3c74ee165c8ece3735913e75e0a_cgraph" id="anamespacewriter__federator__mod_a4e6cf3c74ee165c8ece3735913e75e0a_cgraph">
<area shape="rect" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="5,532,156,588"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="204,890,348,931"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="1394,1401,1549,1442"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="1617,1607,1760,1633"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="422,551,577,593"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="659,890,819,931"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="1390,1061,1553,1102"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="1390,1738,1553,1779"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="396,2120,603,2176"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="427,1836,571,1892"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="668,2003,811,2045"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="905,195,1049,251"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="1808,1599,1975,1641"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="651,264,828,320"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="905,274,1049,315"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="1145,442,1307,483"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="1145,507,1307,549"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="1143,1079,1309,1121"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="897,1297,1058,1353"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="1141,1145,1311,1186"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="1141,1226,1311,1267"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="894,861,1061,902"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="876,977,1079,1033"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="893,781,1061,837"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="901,1429,1054,1470"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="896,442,1059,483"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="896,507,1059,549"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a5686361108378ecc645e4240ce3c3d35" title="Generates a unique filename based upon the base one specified and the number of completed timesteps." alt="" coords="900,572,1055,628"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="905,651,1049,693"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a0a437b7c2ee1752a8c3ad3ce4797cced" title="Writes the conditional diagnostic variable names into the NetCDF file." alt="" coords="904,1057,1051,1113"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ae456ae2267a1cf3a1763d1cbd59039ab" title="Writes a coordinate variable into the NetCDF file." alt="" coords="900,1137,1055,1193"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a767df50b485665dac93bfdf57897c667" title="Writes out global attributes into the checkpoint." alt="" coords="900,1217,1055,1273"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2d8000c479d36f8c5c0c91aa482c9765" title="Writes out the options_database defining this model run." alt="" coords="896,717,1059,758"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a63ada26600230ff5a6551e3dd04736ce" title="Retrieves the number of timeseries entries for a specific frequency and previous write time...." alt="" coords="1129,876,1323,932"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="1154,1502,1298,1543"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#af49b3618c2fdcf04a2eef4dc5e0a7925" title="For a specific field will retrieve the NetCDF id of the time series dimension most appropriate for th..." alt="" coords="1137,2053,1315,2109"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6da2f8c99dc13a7d24ec60861a2a48aa" title="Given the file state and the output frequency of a field will retrive the appropriate time series dim..." alt="" coords="1373,2184,1569,2240"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#adc0a6752b379a4967ae7260e4487d049" title="Returns the ith key in the options database." alt="" coords="1151,681,1301,722"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a7eeb8b8d74d261f80bb0a64db10b22e2" title="Returns the number of entries in the options database." alt="" coords="1151,746,1301,787"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a2dee7871d510ec8b7e82ff936a59b443" title="Returns the value at index in the database." alt="" coords="1151,811,1301,853"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="894,2119,1061,2161"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="667,2177,812,2233"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9f81ee04b25b784bf928c8bc96d32016" title="Retrieves the number of common starting points that match a specific input value." alt="" coords="905,2185,1049,2226"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="667,1597,811,1638"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="895,1589,1060,1645"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="898,1494,1057,1565"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a605f56b2d81bbaf34377388f9d3f6ec1" title="Writes independent variables to the diagnostics file. This writes the entire variable and works by wr..." alt="" coords="895,1771,1060,1827"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aacc77c78537724e3eac2bfc2537d9a30" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="1127,2235,1325,2277"/>
<area shape="rect" href="namespaceconversions__mod.html#ab7f79ee421227f8486ab403e9d5620e0" title="Converts from a single to double precision real. This applies some rounding to a certain number of de..." alt="" coords="1147,195,1305,237"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ac4ee4eae0932fe781cc87322c7da4204" title="Sorts the time points based upon their timestep, smallest to largest. Note that this is a bubble sort..." alt="" coords="1153,260,1299,316"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a4e6cf3c74ee165c8ece3735913e75e0a_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a4e6cf3c74ee165c8ece3735913e75e0a_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a4e6cf3c74ee165c8ece3735913e75e0a_icgraph" id="anamespacewriter__federator__mod_a4e6cf3c74ee165c8ece3735913e75e0a_icgraph">
<area shape="rect" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3084,199,3235,255"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2859,165,3036,221"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2656,173,2811,214"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2435,159,2608,215"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="2449,238,2593,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1755,107,1905,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2220,159,2387,215"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,81,1699,122"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1961,159,2172,215"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="2231,238,2376,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="1747,238,1913,279"/>
</map>
</div>

</div>
</div>
<a id="a1af403ddb2a3d977bfc3f81a6f834488"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1af403ddb2a3d977bfc3f81a6f834488">&#9670;&nbsp;</a></span>check_writer_for_trigger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public writer_federator_mod::check_writer_for_trigger </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>data_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character, dimension(:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>data_dump</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks all writer entries for any trigger fires and issues the underlying file storage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>Configuration of the IO server </td></tr>
    <tr><td class="paramname">source</td><td>The source PID of the MONC process </td></tr>
    <tr><td class="paramname">data_id</td><td>The ID of the data definition that is represented by the dump </td></tr>
    <tr><td class="paramname">data_dump</td><td>The data we have received from MONC </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00642">642</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: source, data_id</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordtype">character</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(in)</span> :: data_dump</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordtype">integer</span> :: i, timestep</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: time</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordtype">logical</span> :: terminated</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">if</span> (is_field_present(io_configuration, source, data_id, <span class="stringliteral">&quot;timestep&quot;</span>) .and. &amp;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;         is_field_present(io_configuration, source, data_id, <span class="stringliteral">&quot;time&quot;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      timestep=get_scalar_integer_from_monc(io_configuration, source, data_id, data_dump, <span class="stringliteral">&quot;timestep&quot;</span>)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      time=get_scalar_real_from_monc(io_configuration, source, data_id, data_dump, <span class="stringliteral">&quot;time&quot;</span>)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">if</span> (is_field_present(io_configuration, source, data_id, <span class="stringliteral">&quot;terminated&quot;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        terminated=get_scalar_logical_from_monc(io_configuration, source, data_id, data_dump, <span class="stringliteral">&quot;terminated&quot;</span>)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        terminated=.false.</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(writer_entries)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keyword">call </span>check_writer_trigger(io_configuration, i, timestep, real(time, kind=4), terminated)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a1af403ddb2a3d977bfc3f81a6f834488_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a1af403ddb2a3d977bfc3f81a6f834488_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a1af403ddb2a3d977bfc3f81a6f834488_cgraph" id="anamespacewriter__federator__mod_a1af403ddb2a3d977bfc3f81a6f834488_cgraph">
<area shape="rect" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="5,2356,172,2398"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="239,1752,384,1794"/>
<area shape="rect" href="namespacedata__utils__mod.html#a56c7a3c668c3abef4e4d43fea2f73b5b" title="Retrieves a single integer element (scalar) from the data dump." alt="" coords="220,2291,403,2332"/>
<area shape="rect" href="namespacedata__utils__mod.html#a29da67d2bfdfc17765e1105f9295c6be" title="Retrieves a single logical element (scalar) from the data dump." alt="" coords="221,2356,401,2398"/>
<area shape="rect" href="namespacedata__utils__mod.html#ae97bbc021128cf42a987facc1c1e7fee" title="Retreives a scalar real with a corresponding key from the raw data dump." alt="" coords="229,2422,393,2463"/>
<area shape="rect" href="namespacedata__utils__mod.html#ac64f12e860548e106a50f9be09a7bcb8" title=" " alt="" coords="248,2487,375,2528"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="1432,1876,1587,1918"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="1428,631,1591,672"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="1428,378,1591,419"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="469,1719,613,1760"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a27f423ed92a9bd09acce659a23e3defa" title="Registers a pending file write which will be actioned later on." alt="" coords="451,1784,632,1826"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="1639,990,1781,1017"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="1829,983,1996,1024"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="706,2062,861,2103"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="703,1054,863,1095"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="680,246,887,302"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="711,1712,855,1768"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="965,1942,1107,1983"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="1211,2006,1355,2062"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="947,2058,1125,2114"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="1207,2097,1358,2153"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="1211,1942,1355,1983"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="1428,1942,1591,1983"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="1428,1811,1591,1852"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="1199,983,1366,1024"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="955,966,1117,1022"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="1197,1127,1368,1168"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="1197,1058,1368,1099"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="953,1286,1119,1327"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="935,886,1137,942"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="952,806,1120,862"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="959,690,1113,731"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="955,507,1117,548"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="955,572,1117,614"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a5686361108378ecc645e4240ce3c3d35" title="Generates a unique filename based upon the base one specified and the number of completed timesteps." alt="" coords="959,428,1113,484"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="1211,1824,1355,1866"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a0a437b7c2ee1752a8c3ad3ce4797cced" title="Writes the conditional diagnostic variable names into the NetCDF file." alt="" coords="963,1046,1109,1102"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ae456ae2267a1cf3a1763d1cbd59039ab" title="Writes a coordinate variable into the NetCDF file." alt="" coords="959,1126,1113,1182"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a767df50b485665dac93bfdf57897c667" title="Writes out global attributes into the checkpoint." alt="" coords="959,1206,1113,1262"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2d8000c479d36f8c5c0c91aa482c9765" title="Writes out the options_database defining this model run." alt="" coords="955,1403,1117,1444"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a63ada26600230ff5a6551e3dd04736ce" title="Retrieves the number of timeseries entries for a specific frequency and previous write time...." alt="" coords="1185,813,1380,869"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="1211,748,1355,790"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="1199,231,1366,272"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="963,196,1109,252"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="964,1824,1108,1866"/>
<area shape="rect" href="namespaceconversions__mod.html#ab7f79ee421227f8486ab403e9d5620e0" title="Converts from a single to double precision real. This applies some rounding to a certain number of de..." alt="" coords="1430,2086,1589,2127"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ac4ee4eae0932fe781cc87322c7da4204" title="Sorts the time points based upon their timestep, smallest to largest. Note that this is a bubble sort..." alt="" coords="1436,2006,1583,2062"/>
<area shape="rect" href="namespacedata__utils__mod.html#ab248d898201d14574800dd321c8a5dde" title="Retrieves a single integer element (scalar) from the data dump." alt="" coords="474,2291,609,2332"/>
<area shape="rect" href="namespacedata__utils__mod.html#a07f32dc1887f01ab3b818c89dd5e34f7" title="Retrieves a single logical element (scalar) from the data dump." alt="" coords="474,2356,609,2398"/>
<area shape="rect" href="namespacedata__utils__mod.html#a15c2c4edba1f23d89fd83d173b54774d" title="Retreives a scalar real with a corresponding key from the raw data dump." alt="" coords="474,2422,609,2463"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a1af403ddb2a3d977bfc3f81a6f834488_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a1af403ddb2a3d977bfc3f81a6f834488_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a1af403ddb2a3d977bfc3f81a6f834488_icgraph" id="anamespacewriter__federator__mod_a1af403ddb2a3d977bfc3f81a6f834488_icgraph">
<area shape="rect" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="1008,13,1175,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="809,13,960,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,5,761,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,13,536,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="a977faf0b0a12f54b8002555e6f791856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a977faf0b0a12f54b8002555e6f791856">&#9670;&nbsp;</a></span>check_writer_trigger()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::check_writer_trigger </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>writer_entry_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>terminated</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks a writer trigger and issues a file creation along with field write if the conditions (time or timestep) are met. This will either create and write to the file or store a pending state if one is already open (required due to NetCDF/HDF5 limitations with thread safety and parallel access.) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">writer_entry_index</td><td>Index of the writer we are concerned with </td></tr>
    <tr><td class="paramname">timestep</td><td>The corresponding timestep </td></tr>
    <tr><td class="paramname">time</td><td>The corresponding model time </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00674">674</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: writer_entry_index, timestep</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">intent(in)</span> :: time</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: terminated</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="keywordtype">    real</span> :: time_difference</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordtype">logical</span> :: issue_write, issue_terminated_write</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(writer_entries(writer_entry_index)%trigger_and_write_mutex))</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    issue_terminated_write=writer_entries(writer_entry_index)%write_on_terminate .and. terminated</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">if</span> (writer_entries(writer_entry_index)%write_on_model_time) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      time_difference=time-writer_entries(writer_entry_index)%latest_pending_write_time</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      issue_write=time_difference .ge. writer_entries(writer_entry_index)%write_time_frequency      </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="keywordflow">if</span> (writer_entries(writer_entry_index)%write_timestep_frequency .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        issue_write=writer_entries(writer_entry_index)%latest_pending_write_timestep .ne. timestep .and. &amp;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;             mod(timestep, writer_entries(writer_entry_index)%write_timestep_frequency) == 0</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        issue_write=.false.</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      issue_terminated_write=issue_terminated_write .and. &amp;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;           writer_entries(writer_entry_index)%latest_pending_write_timestep .ne. timestep</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">if</span> (issue_write .or. issue_terminated_write) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      writer_entries(writer_entry_index)%latest_pending_write_time=time</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      writer_entries(writer_entry_index)%latest_pending_write_timestep=timestep</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(currently_writing_mutex))    </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordflow">if</span> (currently_writing) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(currently_writing_mutex))</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entries(writer_entry_index)%trigger_and_write_mutex))</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keyword">call </span>register_pending_file_write(writer_entry_index, timestep, time, &amp;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;             writer_entries(writer_entry_index)%write_on_terminate .and. terminated)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        currently_writing=.true.</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(currently_writing_mutex))</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entries(writer_entry_index)%trigger_and_write_mutex))</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keyword">call </span>issue_actual_write(io_configuration, writer_entries(writer_entry_index), timestep, time, &amp;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;             writer_entries(writer_entry_index)%write_on_terminate .and. terminated)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entries(writer_entry_index)%trigger_and_write_mutex))</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a977faf0b0a12f54b8002555e6f791856_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a977faf0b0a12f54b8002555e6f791856_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a977faf0b0a12f54b8002555e6f791856_cgraph" id="anamespacewriter__federator__mod_a977faf0b0a12f54b8002555e6f791856_cgraph">
<area shape="rect" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="5,2310,151,2351"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="1413,635,1567,677"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="1409,1926,1571,1967"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="1409,2245,1571,2286"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="217,854,361,895"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a27f423ed92a9bd09acce659a23e3defa" title="Registers a pending file write which will be actioned later on." alt="" coords="199,2470,380,2511"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="1627,1009,1769,1036"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="1817,1002,1984,1043"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="454,450,609,491"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="691,1149,851,1190"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="428,137,635,193"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="459,1801,603,1857"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="700,1743,843,1785"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="937,253,1081,309"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="683,319,860,375"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="934,173,1085,229"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="937,333,1081,374"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="1175,282,1337,323"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="1175,450,1337,491"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="1173,1105,1339,1146"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="929,1403,1090,1459"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="1171,1345,1341,1386"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="1171,1431,1341,1473"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="926,1562,1093,1603"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="908,1627,1111,1683"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="925,901,1093,957"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="933,837,1086,878"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="928,1221,1091,1262"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="928,1286,1091,1327"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a5686361108378ecc645e4240ce3c3d35" title="Generates a unique filename based upon the base one specified and the number of completed timesteps." alt="" coords="932,1141,1087,1197"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="937,501,1081,542"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a0a437b7c2ee1752a8c3ad3ce4797cced" title="Writes the conditional diagnostic variable names into the NetCDF file." alt="" coords="936,1483,1083,1539"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ae456ae2267a1cf3a1763d1cbd59039ab" title="Writes a coordinate variable into the NetCDF file." alt="" coords="932,1061,1087,1117"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a767df50b485665dac93bfdf57897c667" title="Writes out global attributes into the checkpoint." alt="" coords="932,981,1087,1037"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2d8000c479d36f8c5c0c91aa482c9765" title="Writes out the options_database defining this model run." alt="" coords="928,719,1091,761"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a63ada26600230ff5a6551e3dd04736ce" title="Retrieves the number of timeseries entries for a specific frequency and previous write time...." alt="" coords="1159,1025,1353,1081"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="1184,1614,1328,1655"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#af49b3618c2fdcf04a2eef4dc5e0a7925" title="For a specific field will retrieve the NetCDF id of the time series dimension most appropriate for th..." alt="" coords="1401,895,1579,951"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#adc0a6752b379a4967ae7260e4487d049" title="Returns the ith key in the options database." alt="" coords="1181,719,1331,761"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a7eeb8b8d74d261f80bb0a64db10b22e2" title="Returns the number of entries in the options database." alt="" coords="1181,785,1331,826"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a2dee7871d510ec8b7e82ff936a59b443" title="Returns the value at index in the database." alt="" coords="1181,850,1331,891"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="926,109,1093,150"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="699,72,844,128"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9f81ee04b25b784bf928c8bc96d32016" title="Retrieves the number of common starting points that match a specific input value." alt="" coords="937,43,1081,85"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="699,1809,843,1850"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="927,1757,1092,1813"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="930,1838,1089,1909"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a605f56b2d81bbaf34377388f9d3f6ec1" title="Writes independent variables to the diagnostics file. This writes the entire variable and works by wr..." alt="" coords="927,2035,1092,2091"/>
<area shape="rect" href="namespaceconversions__mod.html#ab7f79ee421227f8486ab403e9d5620e0" title="Converts from a single to double precision real. This applies some rounding to a certain number of de..." alt="" coords="1177,165,1335,206"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ac4ee4eae0932fe781cc87322c7da4204" title="Sorts the time points based upon their timestep, smallest to largest. Note that this is a bubble sort..." alt="" coords="1183,85,1329,141"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a977faf0b0a12f54b8002555e6f791856_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a977faf0b0a12f54b8002555e6f791856_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a977faf0b0a12f54b8002555e6f791856_icgraph" id="anamespacewriter__federator__mod_a977faf0b0a12f54b8002555e6f791856_icgraph">
<area shape="rect" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="1223,13,1368,54"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="1008,13,1175,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="809,13,960,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,5,761,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,13,536,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="ab6600fa0faed86a8d9f6d22b2903da62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6600fa0faed86a8d9f6d22b2903da62">&#9670;&nbsp;</a></span>clean_time_points()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::clean_time_points</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cleans out old timepoints which are no longer going to be of any relavence to the file writing. This ensures that we don't have lots of stale points that need to be processed and searched beyond but are themselves pointless. </p>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00784">784</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="keywordtype">    real</span> :: time_entry</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordtype">type</span>(mapentry_type) :: map_entry</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordtype">type</span>(list_type) :: removed_entries</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordtype">logical</span> :: remove_timepoint</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(time_points_rwlock))</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    iterator=c_get_iterator(time_points)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      map_entry=c_next_mapentry(iterator)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      time_entry=real(c_get_real(map_entry))</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      remove_timepoint=.true.</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(writer_entries)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">if</span> (writer_entries(i)%previous_write_time .le. time_entry) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;          remove_timepoint=.false.</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;          <span class="keywordflow">if</span> (writer_entries(i)%write_on_terminate) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <span class="comment">!print *, &quot;Ignore CTP &quot;, time_entry, writer_entries(i)%previous_write_time</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;          <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">if</span> (remove_timepoint) <span class="keyword">call </span>c_add_string(removed_entries, map_entry%key)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    iterator=c_get_iterator(removed_entries)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keyword">call </span>c_remove(time_points, c_next_string(iterator))</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(time_points_rwlock))</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keyword">call </span>c_free(removed_entries)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_ab6600fa0faed86a8d9f6d22b2903da62_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_ab6600fa0faed86a8d9f6d22b2903da62_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_ab6600fa0faed86a8d9f6d22b2903da62_cgraph" id="anamespacewriter__federator__mod_ab6600fa0faed86a8d9f6d22b2903da62_cgraph">
<area shape="rect" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="5,71,149,112"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="201,5,356,47"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="197,71,360,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="197,136,360,177"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="408,13,551,39"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="599,5,765,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_ab6600fa0faed86a8d9f6d22b2903da62_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_ab6600fa0faed86a8d9f6d22b2903da62_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_ab6600fa0faed86a8d9f6d22b2903da62_icgraph" id="anamespacewriter__federator__mod_ab6600fa0faed86a8d9f6d22b2903da62_icgraph">
<area shape="rect" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="3084,277,3228,318"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2859,269,3036,325"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2656,241,2811,282"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2435,159,2608,215"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="2449,241,2593,282"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1755,107,1905,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2220,159,2387,215"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,81,1699,122"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1961,159,2172,215"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="2228,303,2379,359"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="2231,238,2376,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="1747,238,1913,279"/>
</map>
</div>

</div>
</div>
<a id="a37589f9aced0f51f811ed15c462d33cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37589f9aced0f51f811ed15c462d33cb">&#9670;&nbsp;</a></span>close_diagnostics_file()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::close_diagnostics_file </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structwriter__types__mod_1_1writer__type.html">writer_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>writer_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (collective operation) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">writer_entry</td><td>The writer entry </td></tr>
    <tr><td class="paramname">timestep</td><td>The file write timestep </td></tr>
    <tr><td class="paramname">time</td><td>The file write time </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00880">880</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordtype">type</span>(writer_type), <span class="keywordtype">intent(inout)</span> :: writer_entry</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">intent(in)</span> :: time</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() .ge. <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;Issue close for NetCDF file at timestep &quot;</span>//trim(conv_to_string(timestep)))</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keyword">call </span>perform_global_callback(io_configuration, writer_entry%filename, timestep, handle_close_diagnostics_globalcallback)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a37589f9aced0f51f811ed15c462d33cb_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a37589f9aced0f51f811ed15c462d33cb_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a37589f9aced0f51f811ed15c462d33cb_cgraph" id="anamespacewriter__federator__mod_a37589f9aced0f51f811ed15c462d33cb_cgraph">
<area shape="rect" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="5,1089,160,1130"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="208,1113,385,1169"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="433,1113,584,1169"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="1316,2279,1460,2321"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="632,1055,776,1097"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="1805,1858,1959,1899"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="2028,1088,2171,1115"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="1079,1479,1239,1521"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="1801,419,1963,461"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="1801,567,1963,609"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="824,68,1031,124"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="855,905,999,961"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="1087,1967,1230,2009"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="1316,2355,1460,2411"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="2219,1081,2385,1122"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="1553,1454,1720,1495"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="1307,1248,1469,1304"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="1551,1323,1722,1365"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="1551,1389,1722,1430"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="1305,1327,1471,1369"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="1287,1392,1489,1448"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="1304,1603,1472,1659"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="1311,971,1465,1013"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="1307,1734,1469,1775"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="1555,2209,1718,2250"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="1307,2033,1469,2074"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a5686361108378ecc645e4240ce3c3d35" title="Generates a unique filename based upon the base one specified and the number of completed timesteps." alt="" coords="1311,2097,1465,2153"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="1316,1967,1460,2009"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a0a437b7c2ee1752a8c3ad3ce4797cced" title="Writes the conditional diagnostic variable names into the NetCDF file." alt="" coords="1315,1168,1461,1224"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ae456ae2267a1cf3a1763d1cbd59039ab" title="Writes a coordinate variable into the NetCDF file." alt="" coords="1311,1472,1465,1528"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a767df50b485665dac93bfdf57897c667" title="Writes out global attributes into the checkpoint." alt="" coords="1311,1088,1465,1144"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2d8000c479d36f8c5c0c91aa482c9765" title="Writes out the options_database defining this model run." alt="" coords="1307,1799,1469,1841"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a63ada26600230ff5a6551e3dd04736ce" title="Retrieves the number of timeseries entries for a specific frequency and previous write time...." alt="" coords="1539,1589,1734,1645"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="1565,975,1709,1017"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#af49b3618c2fdcf04a2eef4dc5e0a7925" title="For a specific field will retrieve the NetCDF id of the time series dimension most appropriate for th..." alt="" coords="1548,1040,1725,1096"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6da2f8c99dc13a7d24ec60861a2a48aa" title="Given the file state and the output frequency of a field will retrive the appropriate time series dim..." alt="" coords="1784,844,1980,900"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="1555,2326,1718,2367"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#adc0a6752b379a4967ae7260e4487d049" title="Returns the ith key in the options database." alt="" coords="1562,1799,1711,1841"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a7eeb8b8d74d261f80bb0a64db10b22e2" title="Returns the number of entries in the options database." alt="" coords="1562,1669,1711,1710"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a2dee7871d510ec8b7e82ff936a59b443" title="Returns the value at index in the database." alt="" coords="1562,1734,1711,1775"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="1305,78,1471,119"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="1086,5,1231,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9f81ee04b25b784bf928c8bc96d32016" title="Retrieves the number of common starting points that match a specific input value." alt="" coords="1316,13,1460,54"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="1087,847,1231,889"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="1305,840,1471,896"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="1309,745,1467,815"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a605f56b2d81bbaf34377388f9d3f6ec1" title="Writes independent variables to the diagnostics file. This writes the entire variable and works by wr..." alt="" coords="1305,401,1471,457"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aacc77c78537724e3eac2bfc2537d9a30" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="1537,807,1736,849"/>
<area shape="rect" href="namespaceconversions__mod.html#ab7f79ee421227f8486ab403e9d5620e0" title="Converts from a single to double precision real. This applies some rounding to a certain number of de..." alt="" coords="1557,2443,1716,2485"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ac4ee4eae0932fe781cc87322c7da4204" title="Sorts the time points based upon their timestep, smallest to largest. Note that this is a bubble sort..." alt="" coords="1563,2508,1710,2564"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a37589f9aced0f51f811ed15c462d33cb_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a37589f9aced0f51f811ed15c462d33cb_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a37589f9aced0f51f811ed15c462d33cb_icgraph" id="anamespacewriter__federator__mod_a37589f9aced0f51f811ed15c462d33cb_icgraph">
<area shape="rect" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2656,274,2811,315"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2435,159,2608,215"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="2449,274,2593,315"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1755,107,1905,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2220,159,2387,215"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,139,1699,181"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1961,159,2172,215"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="2228,303,2379,359"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="2231,238,2376,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="1978,335,2155,391"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="1747,238,1913,279"/>
</map>
</div>

</div>
</div>
<a id="a472ec41d11538e384f05791c3d6037d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a472ec41d11538e384f05791c3d6037d7">&#9670;&nbsp;</a></span>determine_collective_type_and_optimise_if_possible()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::determine_collective_type_and_optimise_if_possible </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structwriter__types__mod_1_1writer__field__type.html">writer_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>field_to_write_information</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines whether it can optimise a specific collective field. If the field fits into certain limited parameters then it will optimise it. These parameters are very common, hence most fields can be optimised. Basically, it is looking to contiguous blocks of data from different MONCs so that the number of writes to the NetCDF file is limited. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">field_to_write_information</td><td>Description of the the specific field that we are looking at here </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01423">1423</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordtype">type</span>(writer_field_type), <span class="keywordtype">intent(inout)</span> :: field_to_write_information</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">if</span> (field_to_write_information%dimensions .eq. 3 .and. &amp;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;         get_dimension_identifier(field_to_write_information%dim_size_defns(1)) == <a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a> .and. &amp;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;         get_dimension_identifier(field_to_write_information%dim_size_defns(2)) == <a class="code" href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">y_index</a> .and. &amp;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;         get_dimension_identifier(field_to_write_information%dim_size_defns(3)) == <a class="code" href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">x_index</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      field_to_write_information%collective_contiguous_optimisation=.true.</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      <span class="keyword">call </span>initialise_contiguous_data_regions(io_configuration, field_to_write_information)</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      field_to_write_information%collective_contiguous_optimisation=.false.</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    field_to_write_information%collective_initialised=.true.</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a472ec41d11538e384f05791c3d6037d7_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a472ec41d11538e384f05791c3d6037d7_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a472ec41d11538e384f05791c3d6037d7_cgraph" id="anamespacewriter__federator__mod_a472ec41d11538e384f05791c3d6037d7_cgraph">
<area shape="rect" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="5,31,212,87"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="453,5,620,47"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="260,63,405,119"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9f81ee04b25b784bf928c8bc96d32016" title="Retrieves the number of common starting points that match a specific input value." alt="" coords="465,71,609,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a472ec41d11538e384f05791c3d6037d7_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a472ec41d11538e384f05791c3d6037d7_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a472ec41d11538e384f05791c3d6037d7_icgraph" id="anamespacewriter__federator__mod_a472ec41d11538e384f05791c3d6037d7_icgraph">
<area shape="rect" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="3471,172,3677,228"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="3279,179,3423,221"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3080,107,3231,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="3083,238,3228,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2855,107,3032,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2646,133,2801,174"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2419,125,2592,181"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,101,1897,157"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,144,2371,200"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,130,1699,171"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,144,2156,200"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="2640,238,2807,279"/>
</map>
</div>

</div>
</div>
<a id="a3df9fda1cc189c370e8599947191e559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3df9fda1cc189c370e8599947191e559">&#9670;&nbsp;</a></span>determine_if_field_can_be_written()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::determine_if_field_can_be_written </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structwriter__types__mod_1_1writer__type.html">writer_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>writer_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structwriter__types__mod_1_1writer__field__type.html">writer_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>specific_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>previous_write_timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>write_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>previous_write_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(out), optional&#160;</td>
          <td class="paramname"><em>field_written</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines if a file can be written to its overarching write representation. If so then a write is issued, otherwise an outstanding write point is registered which will be checked frequency to do a write later on. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">specific_field</td><td>The specific field we are checking and going to write if possible </td></tr>
    <tr><td class="paramname">timestep</td><td>The current timestep that we are at for this write </td></tr>
    <tr><td class="paramname">write_time</td><td>The current time that we are at for this write </td></tr>
    <tr><td class="paramname">field_written</td><td>An optional output logical representing whether a write was performed or not </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00573">573</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordtype">type</span>(writer_type), <span class="keywordtype">intent(inout)</span> :: writer_entry</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordtype">type</span>(writer_field_type), <span class="keywordtype">intent(inout)</span> :: specific_field</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep, previous_write_timestep</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">intent(in)</span> :: write_time, previous_write_time</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: field_written</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordtype">    real</span> :: value_to_test, largest_value_found</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordtype">integer</span> :: num_matching</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordtype">logical</span> :: entry_beyond_this_write</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordtype">type</span>(mapentry_type) :: map_entry</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordtype">type</span>(write_field_collective_values_type), <span class="keywordtype">pointer</span> :: multi_monc_entries</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    num_matching=0</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    largest_value_found=0.0</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    entry_beyond_this_write=.false.</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(specific_field%values_mutex))</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">if</span> (.not. c_is_empty(specific_field%values_to_write)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      iterator=c_get_iterator(specific_field%values_to_write)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        map_entry=c_next_mapentry(iterator)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        value_to_test=conv_to_real(map_entry%key)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">if</span> (specific_field%collective_write) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          generic=&gt;c_get_generic(map_entry)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keywordflow">          type is</span>(write_field_collective_values_type)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            multi_monc_entries=&gt;generic</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="keywordflow">          end select</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;          <span class="keywordflow">if</span> (c_size(multi_monc_entries%monc_values) .ne. io_configuration%number_of_moncs) cycle</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordflow">if</span> (value_to_test .gt. write_time) entry_beyond_this_write=.true.</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">if</span> (value_to_test .le. write_time .and. value_to_test .gt. previous_write_time) <span class="keywordflow">then</span>        </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;          num_matching=num_matching+1</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <span class="keywordflow">if</span> (largest_value_found .lt. value_to_test) largest_value_found=value_to_test</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span> (num_matching .gt. 0 .and. (specific_field%ready_to_write(largest_value_found, specific_field%output_frequency, write_time, &amp;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;         specific_field%latest_timestep_values, timestep) .or. entry_beyond_this_write)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordflow">if</span> (.not. specific_field%collective_write .or. .not. specific_field%collective_contiguous_optimisation) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">if</span> (specific_field%issue_write) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          <span class="keyword">call </span>write_variable(io_configuration, specific_field, writer_entry%filename, timestep, write_time)</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        specific_field%previous_write_time=writer_entry%write_time</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      specific_field%pending_to_write=.false.</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(field_written)) field_written=.true.</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() .ge. <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;Setting outstanding field ts=&quot;</span>//conv_to_string(writer_entry%write_timestep)//&amp;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;               <span class="stringliteral">&quot; write time=&quot;</span>//conv_to_string(writer_entry%write_time)//<span class="stringliteral">&quot; prev=&quot;</span>//conv_to_string(previous_write_time)//&amp;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;               <span class="stringliteral">&quot; largest entry=&quot;</span>//conv_to_string(largest_value_found)//<span class="stringliteral">&quot; num matching=&quot;</span>//conv_to_string(num_matching))</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      specific_field%pending_to_write=.true.</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(field_written)) field_written=.false.</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(specific_field%values_mutex))</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a3df9fda1cc189c370e8599947191e559_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a3df9fda1cc189c370e8599947191e559_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a3df9fda1cc189c370e8599947191e559_cgraph" id="anamespacewriter__federator__mod_a3df9fda1cc189c370e8599947191e559_cgraph">
<area shape="rect" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="5,1155,149,1211"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="1096,443,1251,485"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="1303,480,1445,507"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="1092,1105,1255,1146"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="1092,1225,1255,1266"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="198,1630,341,1671"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="197,918,341,959"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="1493,473,1660,514"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="400,189,544,230"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="605,639,771,695"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="393,1091,551,1162"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a605f56b2d81bbaf34377388f9d3f6ec1" title="Writes independent variables to the diagnostics file. This writes the entire variable and works by wr..." alt="" coords="389,911,555,967"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="607,159,769,201"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="607,94,769,135"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="849,741,1016,782"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aacc77c78537724e3eac2bfc2537d9a30" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="833,327,1032,369"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aff299f33f5701bfddd073cd0a06be5f7" title="Retrieves the original size of a specific dimension (which is auto)" alt="" coords="821,393,1044,434"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="861,959,1005,1001"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6da2f8c99dc13a7d24ec60861a2a48aa" title="Given the file state and the output frequency of a field will retrive the appropriate time series dim..." alt="" coords="835,661,1031,717"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="847,1077,1018,1118"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="847,1142,1018,1183"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aaff250f828a91818f15f82b3838701cf" title="Retrieves the next collective descriptor based upon the iterator." alt="" coords="603,1347,773,1403"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aef4805588ccfc47ddd145e9c20e34218" title="Retrieves the next specific monc information item from the iterator." alt="" coords="608,1099,768,1155"/>
<area shape="rect" href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="603,1230,773,1271"/>
<area shape="rect" href="namespacempi__communication__mod.html#aee6d81060fcad11a466f823627234e7c" title="Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation." alt="" coords="839,1310,1026,1351"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a527dfbc289976e0eefcc432bb077040e" title=" " alt="" coords="615,982,761,1023"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a646b3fed89978ea8212eece9494f7c54" title=" " alt="" coords="607,847,769,903"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a3df9fda1cc189c370e8599947191e559_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a3df9fda1cc189c370e8599947191e559_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a3df9fda1cc189c370e8599947191e559_icgraph" id="anamespacewriter__federator__mod_a3df9fda1cc189c370e8599947191e559_icgraph">
<area shape="rect" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="3471,91,3615,147"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2419,85,2592,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="3279,146,3423,187"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,75,1897,131"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,112,2371,168"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,130,1699,171"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,112,2156,168"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3080,107,3231,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="3083,238,3228,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2855,107,3032,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2646,114,2801,155"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="2640,238,2807,279"/>
</map>
</div>

</div>
</div>
<a id="a303133afee5100e6a9b0b19ead391dfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a303133afee5100e6a9b0b19ead391dfa">&#9670;&nbsp;</a></span>determine_if_outstanding_field_can_be_written()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::determine_if_outstanding_field_can_be_written </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structwriter__types__mod_1_1writer__type.html">writer_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>writer_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structwriter__types__mod_1_1writer__field__type.html">writer_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>specific_field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For a specific field wil determine and handle any outstanding fields writes until an outstanding write can not be performed or the outstanding list is empty. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">specific_field</td><td>The specific field that we are concerned with </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00541">541</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordtype">type</span>(writer_type), <span class="keywordtype">intent(inout)</span> :: writer_entry</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordtype">type</span>(writer_field_type), <span class="keywordtype">intent(inout)</span> :: specific_field</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordtype">logical</span> :: field_write_success, do_close_num_fields</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (specific_field%pending_to_write) <span class="keywordflow">then</span>    </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keyword">call </span>determine_if_field_can_be_written(io_configuration, writer_entry, specific_field, writer_entry%write_timestep, &amp;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;           writer_entry%previous_write_timestep, writer_entry%write_time, writer_entry%previous_write_time, field_write_success)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordflow">if</span> (field_write_success) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() .ge. <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;Flushed outstanding field ts=&quot;</span>//conv_to_string(writer_entry%write_timestep)//&amp;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;               <span class="stringliteral">&quot; write time=&quot;</span>//conv_to_string(writer_entry%write_time))</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(writer_entry%num_fields_to_write_mutex))</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        writer_entry%num_fields_to_write=writer_entry%num_fields_to_write-1</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        do_close_num_fields=writer_entry%num_fields_to_write == 0</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entry%num_fields_to_write_mutex))</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">if</span> (do_close_num_fields) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          <span class="keyword">call </span>close_diagnostics_file(io_configuration, writer_entry, writer_entry%write_timestep, writer_entry%write_time)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="keywordflow">        end if</span>    </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a303133afee5100e6a9b0b19ead391dfa_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a303133afee5100e6a9b0b19ead391dfa_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a303133afee5100e6a9b0b19ead391dfa_cgraph" id="anamespacewriter__federator__mod_a303133afee5100e6a9b0b19ead391dfa_cgraph">
<area shape="rect" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="5,513,179,569"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="2233,1061,2388,1102"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="2440,1309,2583,1336"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="227,441,381,482"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="2229,2845,2392,2886"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="2229,2227,2392,2269"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="1077,580,1221,636"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="1301,478,1444,519"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="2631,1302,2797,1343"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="429,368,607,424"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="655,368,805,424"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="1737,217,1881,258"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="853,419,997,461"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="1497,1095,1657,1137"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="1045,296,1252,352"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="1737,281,1881,337"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="1987,1302,2153,1343"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="1729,1523,1890,1579"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="1985,1478,2155,1519"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="1985,1413,2155,1454"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="1726,943,1893,985"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="1708,1008,1911,1064"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="1725,1088,1893,1144"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="1733,1705,1886,1746"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="1728,631,1891,673"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="1989,413,2151,454"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="1728,697,1891,738"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a5686361108378ecc645e4240ce3c3d35" title="Generates a unique filename based upon the base one specified and the number of completed timesteps." alt="" coords="1732,761,1887,817"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="1737,413,1881,454"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a0a437b7c2ee1752a8c3ad3ce4797cced" title="Writes the conditional diagnostic variable names into the NetCDF file." alt="" coords="1736,1168,1883,1224"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ae456ae2267a1cf3a1763d1cbd59039ab" title="Writes a coordinate variable into the NetCDF file." alt="" coords="1732,1248,1887,1304"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a767df50b485665dac93bfdf57897c667" title="Writes out global attributes into the checkpoint." alt="" coords="1732,1379,1887,1435"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2d8000c479d36f8c5c0c91aa482c9765" title="Writes out the options_database defining this model run." alt="" coords="1728,1458,1891,1499"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="1998,1966,2142,2007"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="1989,347,2151,389"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="1493,247,1660,289"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="1300,296,1445,352"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="1301,1974,1445,2015"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="1727,2496,1892,2552"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="1497,2111,1656,2182"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a605f56b2d81bbaf34377388f9d3f6ec1" title="Writes independent variables to the diagnostics file. This writes the entire variable and works by wr..." alt="" coords="1494,1967,1659,2023"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aacc77c78537724e3eac2bfc2537d9a30" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="1971,2533,2169,2574"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aff299f33f5701bfddd073cd0a06be5f7" title="Retrieves the original size of a specific dimension (which is auto)" alt="" coords="1959,2467,2181,2509"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6da2f8c99dc13a7d24ec60861a2a48aa" title="Given the file state and the output frequency of a field will retrive the appropriate time series dim..." alt="" coords="1972,2285,2168,2341"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aaff250f828a91818f15f82b3838701cf" title="Retrieves the next collective descriptor based upon the iterator." alt="" coords="1724,2315,1895,2371"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aef4805588ccfc47ddd145e9c20e34218" title="Retrieves the next specific monc information item from the iterator." alt="" coords="1729,2184,1889,2240"/>
<area shape="rect" href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="1724,1770,1895,1811"/>
<area shape="rect" href="namespacempi__communication__mod.html#aee6d81060fcad11a466f823627234e7c" title="Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation." alt="" coords="1977,1595,2163,1637"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a527dfbc289976e0eefcc432bb077040e" title=" " alt="" coords="1737,1938,1882,1979"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a646b3fed89978ea8212eece9494f7c54" title=" " alt="" coords="1728,2003,1891,2059"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a303133afee5100e6a9b0b19ead391dfa_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a303133afee5100e6a9b0b19ead391dfa_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a303133afee5100e6a9b0b19ead391dfa_icgraph" id="anamespacewriter__federator__mod_a303133afee5100e6a9b0b19ead391dfa_icgraph">
<area shape="rect" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2419,85,2592,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,85,1897,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,117,2371,173"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,63,1699,105"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,173,988,214"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,165,761,221"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,173,536,214"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,180,337,207"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,180,99,207"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,117,2156,173"/>
</map>
</div>

</div>
</div>
<a id="a0c151f31e747242202c9328f70207055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c151f31e747242202c9328f70207055">&#9670;&nbsp;</a></span>enable_specific_field_by_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::enable_specific_field_by_name </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>diagnostics_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>expected_here</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enables a specific field by its name, this will locate all the fields with this name and enable them. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field_name</td><td>The name of the field to enable </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00247">247</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: diagnostics_mode</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: expected_here</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">logical</span> :: continue_search</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">integer</span> :: writer_index, contents_index</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    continue_search=.true.</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    writer_index=1</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    contents_index=0</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (continue_search)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      contents_index=contents_index+1</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      continue_search=get_next_applicable_writer_entry(field_name, writer_index_point=writer_index, &amp;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;           contents_index_point=contents_index)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordflow">if</span> (continue_search) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">if</span> ((writer_entries(writer_index)%contents(contents_index)%diagnostic_field .and. diagnostics_mode) .or. &amp;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;             (writer_entries(writer_index)%contents(contents_index)%prognostic_field .and. .not. diagnostics_mode)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          writer_entries(writer_index)%contents(contents_index)%enabled=.true.</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">present</span>(expected_here)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            writer_entries(writer_index)%contents(contents_index)%expected_here=expected_here</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a0c151f31e747242202c9328f70207055_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a0c151f31e747242202c9328f70207055_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a0c151f31e747242202c9328f70207055_cgraph" id="anamespacewriter__federator__mod_a0c151f31e747242202c9328f70207055_cgraph">
<area shape="rect" title="Enables a specific field by its name, this will locate all the fields with this name and enable them." alt="" coords="5,5,152,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9379ee9a358faa87a63d2f2459f202b9" title="Retrieves the index of the next writer which uses a specific field. If none is found then returns fal..." alt="" coords="200,5,344,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a0c151f31e747242202c9328f70207055_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a0c151f31e747242202c9328f70207055_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a0c151f31e747242202c9328f70207055_icgraph" id="anamespacewriter__federator__mod_a0c151f31e747242202c9328f70207055_icgraph">
<area shape="rect" title="Enables a specific field by its name, this will locate all the fields with this name and enable them." alt="" coords="1385,5,1532,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#aff9121d09086fc4867afe57e0262f4a0" title="Informs the writer federator that specific fields are present and should be reflected in the diagnost..." alt="" coords="1176,5,1337,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a75db617985efd39b9db284a0dc512d34" title="Registers with the writer federator the set of fields (prognostic and diagnostic) that are available,..." alt="" coords="961,5,1128,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="783,13,913,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="584,13,735,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,13,536,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="af717d0c9b90eb4744fe7bec75086e25d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af717d0c9b90eb4744fe7bec75086e25d">&#9670;&nbsp;</a></span>extract_applicable_time_points()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1map__type.html">map_type</a>) function writer_federator_mod::extract_applicable_time_points </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>start_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>end_time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extracts the applicable time points from the overall map that lie within a specific range. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_time</td><td>The start time where values must be greater than </td></tr>
    <tr><td class="paramname">end_time</td><td>The end time where values must be equal or less than </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The sorted (based on timestep) list of MONC communication time points that correspond to this </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00822">822</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">intent(in)</span> :: start_time, end_time</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="keywordtype">    real</span> :: time_entry</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordtype">type</span>(mapentry_type) :: map_entry</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(time_points_rwlock))</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    iterator=c_get_iterator(time_points)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      map_entry=c_next_mapentry(iterator)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      time_entry=real(c_get_real(map_entry))</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keywordflow">if</span> (time_entry .gt. start_time .and. time_entry .le. end_time) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keyword">call </span>c_put_real(extract_applicable_time_points, map_entry%key, conv_single_real_to_double(time_entry))</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(time_points_rwlock))</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    extract_applicable_time_points=sort_applicable_time_points(extract_applicable_time_points)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_af717d0c9b90eb4744fe7bec75086e25d_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_af717d0c9b90eb4744fe7bec75086e25d_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_af717d0c9b90eb4744fe7bec75086e25d_cgraph" id="anamespacewriter__federator__mod_af717d0c9b90eb4744fe7bec75086e25d_cgraph">
<area shape="rect" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="5,129,149,185"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="201,5,356,47"/>
<area shape="rect" href="namespaceconversions__mod.html#ab7f79ee421227f8486ab403e9d5620e0" title="Converts from a single to double precision real. This applies some rounding to a certain number of de..." alt="" coords="199,71,358,112"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="197,136,360,177"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="197,201,360,243"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ac4ee4eae0932fe781cc87322c7da4204" title="Sorts the time points based upon their timestep, smallest to largest. Note that this is a bubble sort..." alt="" coords="205,266,352,322"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="408,13,551,39"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="599,5,765,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_af717d0c9b90eb4744fe7bec75086e25d_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_af717d0c9b90eb4744fe7bec75086e25d_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_af717d0c9b90eb4744fe7bec75086e25d_icgraph" id="anamespacewriter__federator__mod_af717d0c9b90eb4744fe7bec75086e25d_icgraph">
<area shape="rect" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="3471,172,3615,228"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="3279,179,3423,221"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3080,107,3231,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="3083,238,3228,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2855,107,3032,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2646,133,2801,174"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2419,125,2592,181"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,101,1897,157"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,144,2371,200"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,130,1699,171"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,144,2156,200"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="2640,238,2807,279"/>
</map>
</div>

</div>
</div>
<a id="a350033966b51a20a8a69d092a20ba774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a350033966b51a20a8a69d092a20ba774">&#9670;&nbsp;</a></span>finalise_writer_federator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public writer_federator_mod::finalise_writer_federator</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalises the write federator and the manipulations. </p>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00122">122</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_destroy(time_points_rwlock))</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_destroy(collective_contiguous_initialisation_mutex))</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_destroy(currently_writing_mutex))    </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">call </span>finalise_time_averaged_manipulation()</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keyword">call </span>finalise_instantaneous_manipulation()</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">call </span>finalise_netcdf_filetype()</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a350033966b51a20a8a69d092a20ba774_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a350033966b51a20a8a69d092a20ba774_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a350033966b51a20a8a69d092a20ba774_cgraph" id="anamespacewriter__federator__mod_a350033966b51a20a8a69d092a20ba774_cgraph">
<area shape="rect" title="Finalises the write federator and the manipulations." alt="" coords="5,159,171,200"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="483,158,637,199"/>
<area shape="rect" href="namespaceinstantaneous__time__manipulation__mod.html#a9e6df294e2e60b5d2640511b434bd8d0" title="Finalises the instantaneous time manipulation." alt="" coords="229,38,420,94"/>
<area shape="rect" href="namespaceforthread__mod.html#a34912c5c002de467e6b116d65d917881" title=" " alt="" coords="479,46,641,87"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a4267425ddfb057cab9dc7c4d08087669" title="Finalises the NetCDF writing functionality." alt="" coords="253,118,397,174"/>
<area shape="rect" href="namespaceforthread__mod.html#a1ba0d6ac9839191688aeea507ae27ec8" title=" " alt="" coords="479,256,641,298"/>
<area shape="rect" href="namespacetimeaveraged__time__manipulation__mod.html#a7bedad25705d7708391ee9c4c1551b7a" title="Finalises the reduction action, waiting for all outstanding requests and then freeing data." alt="" coords="219,249,431,305"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="689,165,832,192"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="880,158,1047,199"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a350033966b51a20a8a69d092a20ba774_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a350033966b51a20a8a69d092a20ba774_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a350033966b51a20a8a69d092a20ba774_icgraph" id="anamespacewriter__federator__mod_a350033966b51a20a8a69d092a20ba774_icgraph">
<area shape="rect" title="Finalises the write federator and the manipulations." alt="" coords="385,5,551,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="a9f81ee04b25b784bf928c8bc96d32016"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f81ee04b25b784bf928c8bc96d32016">&#9670;&nbsp;</a></span>get_common_starts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::get_common_starts </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>common_starters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>num_common</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the number of common starting points that match a specific input value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dim</td><td>The dimension we are searching in </td></tr>
    <tr><td class="paramname">val</td><td>The value that we are looking to match against </td></tr>
    <tr><td class="paramname">vals</td><td>All the other dimensions information to search against </td></tr>
    <tr><td class="paramname">common_starters</td><td>The common starting point locations </td></tr>
    <tr><td class="paramname">num_common</td><td>The number of common starting points identified </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01549">1549</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: dim, val</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(in)</span> :: vals</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span> :: common_starters</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: num_common</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    num_common=0</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(vals, 2)</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="keywordflow">if</span> (vals(dim, i) == val) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        num_common=num_common+1</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        common_starters(num_common)=i</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a9f81ee04b25b784bf928c8bc96d32016_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a9f81ee04b25b784bf928c8bc96d32016_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a9f81ee04b25b784bf928c8bc96d32016_icgraph" id="anamespacewriter__federator__mod_a9f81ee04b25b784bf928c8bc96d32016_icgraph">
<area shape="rect" title="Retrieves the number of common starting points that match a specific input value." alt="" coords="3919,179,4063,221"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="3725,172,3871,228"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="3471,172,3677,228"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="3279,179,3423,221"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3080,107,3231,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="3083,238,3228,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2855,107,3032,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2646,133,2801,174"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2419,125,2592,181"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,101,1897,157"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,144,2371,200"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,130,1699,171"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,144,2156,200"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="2640,238,2807,279"/>
</map>
</div>

</div>
</div>
<a id="a20d56184ae0676c708c4377f01f71310"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20d56184ae0676c708c4377f01f71310">&#9670;&nbsp;</a></span>get_dimension_identifier()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function writer_federator_mod::get_dimension_identifier </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>dim_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(out), optional&#160;</td>
          <td class="paramname"><em>is_auto_dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Translates a dimension name to its numeric corresponding identifier. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dim_name</td><td>The name of the dimension to look up </td></tr>
    <tr><td class="paramname">is_auto_dimension</td><td>Optional parameter determining whether dimension is auto or not </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Corresponding identifier </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01570">1570</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: dim_name</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: is_auto_dimension</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; </div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordtype">integer</span> :: dash_idx</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keywordtype">logical</span> :: is_modified_size</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160; </div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    dash_idx=index(dim_name, <span class="stringliteral">&quot;_&quot;</span>)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    dash_idx=dash_idx-1</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    is_modified_size=dash_idx .ne. -1</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordflow">if</span> (.not. is_modified_size) dash_idx=len_trim(dim_name)</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">if</span> (dim_name(:dash_idx) .eq. <span class="stringliteral">&quot;z&quot;</span> .or. dim_name(:dash_idx) .eq. <span class="stringliteral">&quot;zn&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      get_dimension_identifier=<a class="code" href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">z_index</a></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim_name(:dash_idx) .eq. <span class="stringliteral">&quot;y&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      get_dimension_identifier=<a class="code" href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">y_index</a></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim_name(:dash_idx) .eq. <span class="stringliteral">&quot;x&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      get_dimension_identifier=<a class="code" href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">x_index</a></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      get_dimension_identifier=-1</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_auto_dimension)) is_auto_dimension=is_modified_size</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a20d56184ae0676c708c4377f01f71310_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a20d56184ae0676c708c4377f01f71310_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a20d56184ae0676c708c4377f01f71310_icgraph" id="anamespacewriter__federator__mod_a20d56184ae0676c708c4377f01f71310_icgraph">
<area shape="rect" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="3919,179,4085,221"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="3471,172,3677,228"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="3725,204,3871,260"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="3279,179,3423,221"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3080,107,3231,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="3083,238,3228,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2855,107,3032,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2646,133,2801,174"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2419,125,2592,181"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,101,1897,157"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,144,2371,200"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,130,1699,171"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,144,2156,200"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="2640,238,2807,279"/>
</map>
</div>

</div>
</div>
<a id="a96287a6f24e9217bb315d12e326cdfd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96287a6f24e9217bb315d12e326cdfd9">&#9670;&nbsp;</a></span>get_field_number_of_fields()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function writer_federator_mod::get_field_number_of_fields </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=string_length), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=string_length), intent(in)&#160;</td>
          <td class="paramname"><em>field_namespace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>num_q_fields</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the number of fields that make up this field, if it is a Q field then it will be split into many subfields hence it is not a simple 1-1 mapping. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">field_name</td><td>The name of the field </td></tr>
    <tr><td class="paramname">num_q_fields</td><td>The number of Q fields </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of fields that make up this field </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01106">1106</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span>, <span class="keywordtype">intent(in)</span> :: field_name, field_namespace</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: num_q_fields</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordtype">type</span>(io_configuration_field_type) :: prognostic_field_configuration</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordtype">type</span>(io_configuration_data_definition_type) :: prognostic_containing_data_defn</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordtype">type</span>(io_configuration_diagnostic_field_type) :: diagnostic_field_configuration</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">if</span> (get_diagnostic_field_configuration(io_configuration, field_name, field_namespace, diagnostic_field_configuration)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordflow">if</span> (diagnostic_field_configuration%field_type == array_field_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <span class="keywordflow">if</span> (diagnostic_field_configuration%dim_size_defns(diagnostic_field_configuration%dimensions) .eq. <span class="stringliteral">&quot;qfields&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;          get_field_number_of_fields=num_q_fields</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;          <span class="keywordflow">return</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      get_field_number_of_fields=1</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (get_prognostic_field_configuration(io_configuration, field_name, field_namespace, &amp;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;         prognostic_field_configuration, prognostic_containing_data_defn)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="keywordflow">if</span> (prognostic_field_configuration%field_type == array_field_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordflow">if</span> (prognostic_field_configuration%dim_size_defns(prognostic_field_configuration%dimensions) .eq. <span class="stringliteral">&quot;qfields&quot;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;          get_field_number_of_fields=num_q_fields</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;          <span class="keywordflow">return</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        get_field_number_of_fields=1</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a96287a6f24e9217bb315d12e326cdfd9_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a96287a6f24e9217bb315d12e326cdfd9_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a96287a6f24e9217bb315d12e326cdfd9_icgraph" id="anamespacewriter__federator__mod_a96287a6f24e9217bb315d12e326cdfd9_icgraph">
<area shape="rect" title="Retrieves the number of fields that make up this field, if it is a Q field then it will be split into..." alt="" coords="1021,39,1165,95"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a34196607f504b72b30c0d82215402d96" title="Retrieves the number of fields within a group of fields." alt="" coords="820,5,973,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a863bc95a6373f8197cc183d39f1d6d12" title="Determines the total number of fields that make up a writer entry, this is all the fields of the grou..." alt="" coords="605,39,772,95"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7b31bb8f9d0fb8c0768252e819b20985" title="Initialises the write federator and configures it based on the user configuration...." alt="" coords="385,46,557,87"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,53,337,80"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,53,99,80"/>
</map>
</div>

</div>
</div>
<a id="a34196607f504b72b30c0d82215402d96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34196607f504b72b30c0d82215402d96">&#9670;&nbsp;</a></span>get_group_number_of_fields()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function writer_federator_mod::get_group_number_of_fields </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1list__type.html">list_type</a>)&#160;</td>
          <td class="paramname"><em>group_members</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>num_q_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=string_length), intent(in)&#160;</td>
          <td class="paramname"><em>namespace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the number of fields within a group of fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">group_members</td><td>The members of the group </td></tr>
    <tr><td class="paramname">num_q_fields</td><td>The number of Q fields </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of fields that make up this group </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01082">1082</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordtype">type</span>(list_type) :: group_members</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: num_q_fields</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span>, <span class="keywordtype">intent(in)</span> :: namespace</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: field_name</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    get_group_number_of_fields=0</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    iterator=c_get_iterator(group_members)</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      field_name=c_next_string(iterator)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      get_group_number_of_fields=get_group_number_of_fields+get_field_number_of_fields(io_configuration, field_name, namespace, &amp;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;           num_q_fields)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a34196607f504b72b30c0d82215402d96_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a34196607f504b72b30c0d82215402d96_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a34196607f504b72b30c0d82215402d96_cgraph" id="anamespacewriter__federator__mod_a34196607f504b72b30c0d82215402d96_cgraph">
<area shape="rect" title="Retrieves the number of fields within a group of fields." alt="" coords="5,5,159,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a96287a6f24e9217bb315d12e326cdfd9" title="Retrieves the number of fields that make up this field, if it is a Q field then it will be split into..." alt="" coords="207,5,351,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a34196607f504b72b30c0d82215402d96_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a34196607f504b72b30c0d82215402d96_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a34196607f504b72b30c0d82215402d96_icgraph" id="anamespacewriter__federator__mod_a34196607f504b72b30c0d82215402d96_icgraph">
<area shape="rect" title="Retrieves the number of fields within a group of fields." alt="" coords="820,5,973,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a863bc95a6373f8197cc183d39f1d6d12" title="Determines the total number of fields that make up a writer entry, this is all the fields of the grou..." alt="" coords="605,5,772,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7b31bb8f9d0fb8c0768252e819b20985" title="Initialises the write federator and configures it based on the user configuration...." alt="" coords="385,13,557,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="a89b6a2402ed4c492470ff392caa11714"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89b6a2402ed4c492470ff392caa11714">&#9670;&nbsp;</a></span>get_index_of_group()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function writer_federator_mod::get_index_of_group </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>group_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Searches the IO server configuration for a group with a specific name and returns the index to that group or 0 if no corresponding group is found. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">group_name</td><td>The group name to look up </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The index to this group or 0 if no group is found </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01402">1402</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: group_name</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordtype">integer</span> :: i, entries</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160; </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    entries=io_configuration%number_of_groups</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">do</span> i=1, entries</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keywordflow">if</span> (io_configuration%groups(i)%name == group_name) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        get_index_of_group=i</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    get_index_of_group=0</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a89b6a2402ed4c492470ff392caa11714_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a89b6a2402ed4c492470ff392caa11714_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a89b6a2402ed4c492470ff392caa11714_icgraph" id="anamespacewriter__federator__mod_a89b6a2402ed4c492470ff392caa11714_icgraph">
<area shape="rect" title="Searches the IO server configuration for a group with a specific name and returns the index to that g..." alt="" coords="820,53,964,94"/>
<area shape="rect" href="namespacewriter__federator__mod.html#afa4a1b4f58fe72715645615b4f1ee9d8" title="Adds a group of fields to a writer entry, groups are expanded out into individual fields,..." alt="" coords="617,5,761,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a863bc95a6373f8197cc183d39f1d6d12" title="Determines the total number of fields that make up a writer entry, this is all the fields of the grou..." alt="" coords="605,85,772,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7b31bb8f9d0fb8c0768252e819b20985" title="Initialises the write federator and configures it based on the user configuration...." alt="" coords="385,53,557,94"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,60,337,87"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,60,99,87"/>
</map>
</div>

</div>
</div>
<a id="a9379ee9a358faa87a63d2f2459f202b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9379ee9a358faa87a63d2f2459f202b9">&#9670;&nbsp;</a></span>get_next_applicable_writer_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function writer_federator_mod::get_next_applicable_writer_entry </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>field_namespace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>writer_index_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>contents_index_point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the index of the next writer which uses a specific field. If none is found then returns false, otherwise true. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field_name</td><td>The field name to search for </td></tr>
    <tr><td class="paramname">writer_start_point</td><td>The index that we start searching from </td></tr>
    <tr><td class="paramname">result_writer</td><td>The index of the (next) writer that requires this field is written in here </td></tr>
    <tr><td class="paramname">result_contents</td><td>The index of the contents in the next writer that corresponds to this field </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether or not a next entry has been found </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01017">1017</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: field_namespace</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: writer_index_point, contents_index_point</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordtype">integer</span> :: i, j</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">if</span> (writer_index_point .le. <span class="keyword">size</span>(writer_entries)) <span class="keywordflow">then</span>    </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="keywordflow">do</span> i=writer_index_point, <span class="keyword">size</span>(writer_entries)</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="keywordflow">if</span> (contents_index_point .le. <span class="keyword">size</span>(writer_entries(i)%contents)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;          <span class="keywordflow">do</span> j=contents_index_point, <span class="keyword">size</span>(writer_entries(i)%contents)           </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keywordflow">if</span> (writer_entries(i)%contents(j)%field_name==field_name) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;              <span class="keywordflow">if</span> (<span class="keyword">present</span>(field_namespace)) <span class="keywordflow">then</span>                </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                <span class="keywordflow">if</span> (writer_entries(i)%contents(j)%field_namespace .ne. field_namespace) cycle</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;              writer_index_point=i</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;              contents_index_point=j</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;              get_next_applicable_writer_entry=.true.</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;              <span class="keywordflow">return</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        contents_index_point=1</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    get_next_applicable_writer_entry=.false.</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a9379ee9a358faa87a63d2f2459f202b9_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a9379ee9a358faa87a63d2f2459f202b9_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a9379ee9a358faa87a63d2f2459f202b9_icgraph" id="anamespacewriter__federator__mod_a9379ee9a358faa87a63d2f2459f202b9_icgraph">
<area shape="rect" title="Retrieves the index of the next writer which uses a specific field. If none is found then returns fal..." alt="" coords="2435,151,2579,207"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a0c151f31e747242202c9328f70207055" title="Enables a specific field by its name, this will locate all the fields with this name and enable them." alt="" coords="2230,5,2377,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab10af49e026b9e11d113f702bb7f3113" title="Determines whether a field is used by the writer federator or not." alt="" coords="1749,151,1911,207"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1755,249,1905,305"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2220,267,2387,323"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a468cf6121ebcfc23b1389528744d998c" title="Provides the Q field names to the write federator, this is required as on initialisation we don&#39;t kno..." alt="" coords="2223,85,2383,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#aff9121d09086fc4867afe57e0262f4a0" title="Informs the writer federator that specific fields are present and should be reflected in the diagnost..." alt="" coords="1986,8,2147,64"/>
<area shape="rect" href="namespaceio__server__mod.html#a75db617985efd39b9db284a0dc512d34" title="Registers with the writer federator the set of fields (prognostic and diagnostic) that are available,..." alt="" coords="1747,13,1913,69"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="1536,86,1667,127"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="597,86,748,127"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,122,536,163"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,129,337,156"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,129,99,156"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,151,1247,207"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,158,988,199"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,151,761,207"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,227,1699,269"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,231,1456,287"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,231,1240,287"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,311,1257,367"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,311,1016,367"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1961,267,2172,323"/>
<area shape="rect" href="namespaceio__server__mod.html#aefce42fc11a68cb3783f1eb0f2c18610" title="Retrieves MONC information data, this is sent by MONC (and received) regardless, but only actioned if..." alt="" coords="1985,91,2149,133"/>
</map>
</div>

</div>
</div>
<a id="ad5f57429aef78615f84f59d4f2758747"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5f57429aef78615f84f59d4f2758747">&#9670;&nbsp;</a></span>get_size_of_collective_q()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function writer_federator_mod::get_size_of_collective_q </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the data size for each Q entry of a collective Q field for the specific source MONC that has sent data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">field_name</td><td>The field name to write (if appropriate) </td></tr>
    <tr><td class="paramname">source</td><td>MONC source for the communicated fields </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size (elements) per Q split field </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00410">410</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: source</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">integer</span> :: i, monc_index</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    get_size_of_collective_q=1</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    monc_index=get_monc_location(io_configuration, source)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    generic=&gt;c_get_generic(collective_q_field_dims, field_name)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordflow">      type is</span>(collective_q_field_representation_type)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(generic%dimensions)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;          get_size_of_collective_q=&amp;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;               get_size_of_collective_q*io_configuration%registered_moncs(monc_index)%local_dim_sizes(generic%dimensions(i))</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="keywordflow">        end do</span>        </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keywordflow">    end select</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_ad5f57429aef78615f84f59d4f2758747_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_ad5f57429aef78615f84f59d4f2758747_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_ad5f57429aef78615f84f59d4f2758747_cgraph" id="anamespacewriter__federator__mod_ad5f57429aef78615f84f59d4f2758747_cgraph">
<area shape="rect" title="Retrieves the data size for each Q entry of a collective Q field for the specific source MONC that ha..." alt="" coords="5,5,176,47"/>
<area shape="rect" href="namespaceconfiguration__parser__mod.html#ae5be635b15f2c5670d91275e34c74105" title="A helper function to get the location of a MONC&#39;s configuration in the IO data structure." alt="" coords="224,5,393,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_ad5f57429aef78615f84f59d4f2758747_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_ad5f57429aef78615f84f59d4f2758747_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_ad5f57429aef78615f84f59d4f2758747_icgraph" id="anamespacewriter__federator__mod_ad5f57429aef78615f84f59d4f2758747_icgraph">
<area shape="rect" title="Retrieves the data size for each Q entry of a collective Q field for the specific source MONC that ha..." alt="" coords="2204,93,2375,134"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,85,2156,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,85,1897,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,63,1699,105"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,173,988,214"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,165,761,221"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,173,536,214"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,180,337,207"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,180,99,207"/>
</map>
</div>

</div>
</div>
<a id="a863bc95a6373f8197cc183d39f1d6d12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a863bc95a6373f8197cc183d39f1d6d12">&#9670;&nbsp;</a></span>get_total_number_writer_fields()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function writer_federator_mod::get_total_number_writer_fields </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>writer_entry_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines the total number of fields that make up a writer entry, this is all the fields of the groups that make up this writer and individual fields specified too. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">writer_entry_index</td><td>The index of the writer that we are inquiring about </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The total number of fields that make up this writer </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01050">1050</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: writer_entry_index</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordtype">integer</span> :: i, number_contents, group_index, number_q_fields</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    get_total_number_writer_fields=0</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    number_q_fields=c_get_integer(io_configuration%dimension_sizing, <span class="stringliteral">&quot;qfields&quot;</span>)</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    number_contents=io_configuration%file_writers(writer_entry_index)%number_of_contents</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordflow">do</span> i=1, number_contents</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="keywordflow">if</span> (io_configuration%file_writers(writer_entry_index)%contents(i)%facet_type == group_type) <span class="keywordflow">then</span>          </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        group_index=get_index_of_group(io_configuration, &amp;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;             io_configuration%file_writers(writer_entry_index)%contents(i)%facet_name)</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="keywordflow">if</span> (group_index == 0) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Can not find group &#39;&quot;</span>//trim(&amp;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;             io_configuration%file_writers(writer_entry_index)%contents(i)%facet_name)//<span class="stringliteral">&quot;&#39;&quot;</span>)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        get_total_number_writer_fields=get_total_number_writer_fields+&amp;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;             get_group_number_of_fields(io_configuration, io_configuration%groups(group_index)%members, number_q_fields, &amp;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;             io_configuration%groups(group_index)%namespace)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (io_configuration%file_writers(writer_entry_index)%contents(i)%facet_type == field_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="comment">! NSE</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        get_total_number_writer_fields=get_total_number_writer_fields+get_field_number_of_fields(io_configuration, &amp;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;             io_configuration%file_writers(writer_entry_index)%contents(i)%facet_name, <span class="stringliteral">&quot;&quot;</span>, number_q_fields)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a863bc95a6373f8197cc183d39f1d6d12_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a863bc95a6373f8197cc183d39f1d6d12_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a863bc95a6373f8197cc183d39f1d6d12_cgraph" id="anamespacewriter__federator__mod_a863bc95a6373f8197cc183d39f1d6d12_cgraph">
<area shape="rect" title="Determines the total number of fields that make up a writer entry, this is all the fields of the grou..." alt="" coords="5,37,172,93"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a96287a6f24e9217bb315d12e326cdfd9" title="Retrieves the number of fields that make up this field, if it is a Q field then it will be split into..." alt="" coords="421,5,565,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a34196607f504b72b30c0d82215402d96" title="Retrieves the number of fields within a group of fields." alt="" coords="220,37,373,93"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a89b6a2402ed4c492470ff392caa11714" title="Searches the IO server configuration for a group with a specific name and returns the index to that g..." alt="" coords="225,117,369,158"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a863bc95a6373f8197cc183d39f1d6d12_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a863bc95a6373f8197cc183d39f1d6d12_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a863bc95a6373f8197cc183d39f1d6d12_icgraph" id="anamespacewriter__federator__mod_a863bc95a6373f8197cc183d39f1d6d12_icgraph">
<area shape="rect" title="Determines the total number of fields that make up a writer entry, this is all the fields of the grou..." alt="" coords="605,5,772,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7b31bb8f9d0fb8c0768252e819b20985" title="Initialises the write federator and configures it based on the user configuration...." alt="" coords="385,13,557,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="a9ec7f85e388c7212a8aa98acefc2b9d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ec7f85e388c7212a8aa98acefc2b9d0">&#9670;&nbsp;</a></span>handle_close_diagnostics_globalcallback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::handle_close_diagnostics_globalcallback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(default_precision), dimension(:)&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=string_length)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>timestep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Call back for the inter IO reduction which actually does the NetCDF file closing which is a collective (synchronous) operation. Calls out to the NetCDF code to do the call and then checks the list of pending file writes to process any others that are waiting in the queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">values</td><td>The inter IO resulting values, we don't care about these </td></tr>
    <tr><td class="paramname">field_name</td><td>The field name that is being communicated </td></tr>
    <tr><td class="paramname">timestep</td><td>The write timestep </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00899">899</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="keywordtype">    real</span>(DEFAULT_PRECISION), <span class="keywordtype">dimension(:)</span> :: values</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: field_name</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordtype">integer</span> :: timestep</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordtype">type</span>(writer_type), <span class="keywordtype">pointer</span> :: writer_entry</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordtype">logical</span> :: terminated, done_chain_run</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    writer_entry=&gt;get_writer_entry_from_netcdf(field_name, timestep, terminated)    </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(writer_entry%contents)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="keywordflow">if</span> (writer_entry%contents(i)%enabled .and. writer_entry%contents(i)%collective_write .and. &amp;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;           writer_entry%contents(i)%collective_contiguous_optimisation) <span class="keywordflow">then</span>        </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(writer_entry%contents(i)%values_mutex))</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keyword">call </span>write_variable(io_configuration, writer_entry%contents(i), writer_entry%filename, timestep, writer_entry%write_time)</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        writer_entry%contents(i)%previous_write_time=writer_entry%write_time</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entry%contents(i)%values_mutex))</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    writer_entry%previous_write_time=writer_entry%write_time</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    writer_entry%previous_write_timestep=writer_entry%write_timestep</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    writer_entry%defined_write_time=writer_entry%defined_write_time+writer_entry%write_time_frequency</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keyword">call </span>clean_time_points()</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">if</span> (writer_entry%contains_io_status_dump) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="keywordflow">if</span> (.not. terminated) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">do</span> <span class="keywordflow">while</span> (.not. is_io_server_state_writer_ready(timestep))</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(time_points_rwlock))</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keyword">call </span>store_io_server_state(io_configuration, writer_entries, time_points, writer_entry, timestep)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(time_points_rwlock))</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keyword">call </span>close_netcdf_file(io_configuration, field_name, timestep)</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    done_chain_run=.false.</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(writer_entries)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="keywordflow">if</span> (writer_entries(i)%filename .ne. writer_entry%filename) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        done_chain_run=check_for_and_issue_chain_write(io_configuration, writer_entries(i))</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="keywordflow">if</span> (done_chain_run) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">if</span> (.not. done_chain_run) done_chain_run=check_for_and_issue_chain_write(io_configuration, writer_entry)</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span> (.not. done_chain_run) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(currently_writing_mutex))</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      currently_writing=.false.</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(currently_writing_mutex))</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() .ge. <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;No more pending entries to chain to at ts= &quot;</span>//trim(conv_to_string(timestep)))</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a9ec7f85e388c7212a8aa98acefc2b9d0_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a9ec7f85e388c7212a8aa98acefc2b9d0_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a9ec7f85e388c7212a8aa98acefc2b9d0_cgraph" id="anamespacewriter__federator__mod_a9ec7f85e388c7212a8aa98acefc2b9d0_cgraph">
<area shape="rect" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="5,595,183,651"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="231,595,381,651"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="1113,421,1257,462"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="429,602,573,644"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="1602,1354,1757,1396"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="1825,1252,1968,1279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="647,2281,802,2322"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="876,1344,1036,1385"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="1598,780,1761,821"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="1598,920,1761,961"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="621,2202,828,2258"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="653,304,797,360"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="885,152,1027,193"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="1113,330,1257,386"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="2016,1245,2183,1286"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="1351,1605,1517,1646"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="1105,1496,1266,1552"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="1349,1474,1519,1516"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="1349,1540,1519,1581"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="1102,1061,1269,1102"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="1084,1627,1287,1683"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="1101,1787,1269,1843"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="1109,1866,1262,1908"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="1104,1126,1267,1168"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="1353,565,1515,606"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="1104,1192,1267,1233"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a5686361108378ecc645e4240ce3c3d35" title="Generates a unique filename based upon the base one specified and the number of completed timesteps." alt="" coords="1108,1256,1263,1312"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="1113,565,1257,606"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a0a437b7c2ee1752a8c3ad3ce4797cced" title="Writes the conditional diagnostic variable names into the NetCDF file." alt="" coords="1112,1336,1259,1392"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ae456ae2267a1cf3a1763d1cbd59039ab" title="Writes a coordinate variable into the NetCDF file." alt="" coords="1108,1416,1263,1472"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a767df50b485665dac93bfdf57897c667" title="Writes out global attributes into the checkpoint." alt="" coords="1108,1707,1263,1763"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2d8000c479d36f8c5c0c91aa482c9765" title="Writes out the options_database defining this model run." alt="" coords="1104,1984,1267,2025"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a63ada26600230ff5a6551e3dd04736ce" title="Retrieves the number of timeseries entries for a specific frequency and previous write time...." alt="" coords="1337,1774,1531,1830"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="1362,1306,1506,1348"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#af49b3618c2fdcf04a2eef4dc5e0a7925" title="For a specific field will retrieve the NetCDF id of the time series dimension most appropriate for th..." alt="" coords="1345,2202,1523,2258"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6da2f8c99dc13a7d24ec60861a2a48aa" title="Given the file state and the output frequency of a field will retrive the appropriate time series dim..." alt="" coords="1581,1419,1777,1475"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="1353,500,1515,541"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#adc0a6752b379a4967ae7260e4487d049" title="Returns the ith key in the options database." alt="" coords="1359,1853,1509,1894"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a7eeb8b8d74d261f80bb0a64db10b22e2" title="Returns the number of entries in the options database." alt="" coords="1359,1918,1509,1960"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a2dee7871d510ec8b7e82ff936a59b443" title="Returns the value at index in the database." alt="" coords="1359,1984,1509,2025"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="1102,2274,1269,2316"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="883,2202,1029,2258"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9f81ee04b25b784bf928c8bc96d32016" title="Retrieves the number of common starting points that match a specific input value." alt="" coords="1113,2209,1257,2250"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="884,565,1028,606"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="1103,834,1268,890"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="1106,914,1265,985"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a605f56b2d81bbaf34377388f9d3f6ec1" title="Writes independent variables to the diagnostics file. This writes the entire variable and works by wr..." alt="" coords="1103,486,1268,542"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aacc77c78537724e3eac2bfc2537d9a30" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="1335,936,1533,977"/>
<area shape="rect" href="namespaceconversions__mod.html#ab7f79ee421227f8486ab403e9d5620e0" title="Converts from a single to double precision real. This applies some rounding to a certain number of de..." alt="" coords="1355,253,1513,294"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ac4ee4eae0932fe781cc87322c7da4204" title="Sorts the time points based upon their timestep, smallest to largest. Note that this is a bubble sort..." alt="" coords="1361,318,1507,374"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a9ec7f85e388c7212a8aa98acefc2b9d0_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a9ec7f85e388c7212a8aa98acefc2b9d0_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a9ec7f85e388c7212a8aa98acefc2b9d0_icgraph" id="anamespacewriter__federator__mod_a9ec7f85e388c7212a8aa98acefc2b9d0_icgraph">
<area shape="rect" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2859,269,3036,325"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2656,241,2811,282"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2435,159,2608,215"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="2449,241,2593,282"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1755,107,1905,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2220,159,2387,215"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,81,1699,122"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1961,159,2172,215"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="2228,303,2379,359"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="2231,238,2376,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="1747,238,1913,279"/>
</map>
</div>

</div>
</div>
<a id="a989ba90529039516692707b2d6611683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a989ba90529039516692707b2d6611683">&#9670;&nbsp;</a></span>handle_duplicate_field_names()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::handle_duplicate_field_names </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structwriter__types__mod_1_1writer__type.html">writer_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>writer_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>duplicate_field_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marks duplicate field names in a writer entry as duplicates so that the NetCDF layer can then deal with this by issuing unique names. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">writer_entry</td><td>The writer state </td></tr>
    <tr><td class="paramname">duplicate_field_names</td><td>A hashset of duplicate field names which are marked </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01384">1384</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordtype">type</span>(writer_type), <span class="keywordtype">intent(inout)</span> :: writer_entry</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordtype">type</span>(hashset_type), <span class="keywordtype">intent(inout)</span> :: duplicate_field_names</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(writer_entry%contents)</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      <span class="keywordflow">if</span> (c_contains(duplicate_field_names, writer_entry%contents(i)%field_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        writer_entry%contents(i)%duplicate_field_name=.true.</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a989ba90529039516692707b2d6611683_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a989ba90529039516692707b2d6611683_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a989ba90529039516692707b2d6611683_icgraph" id="anamespacewriter__federator__mod_a989ba90529039516692707b2d6611683_icgraph">
<area shape="rect" title="Marks duplicate field names in a writer entry as duplicates so that the NetCDF layer can then deal wi..." alt="" coords="605,5,807,47"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7b31bb8f9d0fb8c0768252e819b20985" title="Initialises the write federator and configures it based on the user configuration...." alt="" coords="385,5,557,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="aff9121d09086fc4867afe57e0262f4a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff9121d09086fc4867afe57e0262f4a0">&#9670;&nbsp;</a></span>inform_writer_federator_fields_present()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public writer_federator_mod::inform_writer_federator_fields_present </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>field_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>diag_field_names_and_roots</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Informs the writer federator that specific fields are present and should be reflected in the diagnostics output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field_names</td><td>The set of field names that are present </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00161">161</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">type</span>(hashset_type), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: field_names</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">type</span>(hashmap_type), <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: diag_field_names_and_roots</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: specific_name</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">integer</span> :: i, number_q_fields, expected_io</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">logical</span> :: field_found, expected_here, diagnostics_mode</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    iterator=c_get_iterator(used_field_names)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    expected_io=-1</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      specific_name=c_next_string(iterator)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(field_names)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        field_found=c_contains(field_names, specific_name)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        diagnostics_mode=.false.</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">present</span>(diag_field_names_and_roots)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        field_found=c_contains(diag_field_names_and_roots, specific_name)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span> (field_found) expected_io=c_get_integer(diag_field_names_and_roots, specific_name)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        diagnostics_mode=.true.</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        field_found=.false.</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">if</span> (field_found) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        expected_here=expected_io == -1 .or. expected_io == io_configuration%my_io_rank</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keyword">call </span>enable_specific_field_by_name(specific_name, diagnostics_mode, expected_here)      </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    iterator=c_get_iterator(q_field_names)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      specific_name=c_next_string(iterator)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(field_names)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        field_found=c_contains(field_names, specific_name)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        diagnostics_mode=.false.</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">present</span>(diag_field_names_and_roots)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        field_found=c_contains(diag_field_names_and_roots, specific_name)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">if</span> (field_found) expected_io=c_get_integer(diag_field_names_and_roots, specific_name)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        diagnostics_mode=.true.</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        field_found=.false.</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span> (field_found) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        expected_here=expected_io == -1 .or. expected_io == io_configuration%my_io_rank</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        number_q_fields=c_get_integer(io_configuration%dimension_sizing, <span class="stringliteral">&quot;qfields&quot;</span>)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">do</span> i=1, number_q_fields</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          <span class="keywordflow">if</span> (c_size(io_configuration%q_field_names) .ge. i) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keyword">call </span>enable_specific_field_by_name(trim(specific_name)//<span class="stringliteral">&quot;_&quot;</span>//trim(c_get_string(io_configuration%q_field_names, i)), &amp;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                 diagnostics_mode, expected_here)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="keyword">call </span>enable_specific_field_by_name(trim(specific_name)//<span class="stringliteral">&quot;_udef&quot;</span>//trim(conv_to_string(i)), &amp;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                 diagnostics_mode, expected_here)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_aff9121d09086fc4867afe57e0262f4a0_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_aff9121d09086fc4867afe57e0262f4a0_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_aff9121d09086fc4867afe57e0262f4a0_cgraph" id="anamespacewriter__federator__mod_aff9121d09086fc4867afe57e0262f4a0_cgraph">
<area shape="rect" title="Informs the writer federator that specific fields are present and should be reflected in the diagnost..." alt="" coords="5,5,167,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a0c151f31e747242202c9328f70207055" title="Enables a specific field by its name, this will locate all the fields with this name and enable them." alt="" coords="215,5,361,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9379ee9a358faa87a63d2f2459f202b9" title="Retrieves the index of the next writer which uses a specific field. If none is found then returns fal..." alt="" coords="409,5,553,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_aff9121d09086fc4867afe57e0262f4a0_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_aff9121d09086fc4867afe57e0262f4a0_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_aff9121d09086fc4867afe57e0262f4a0_icgraph" id="anamespacewriter__federator__mod_aff9121d09086fc4867afe57e0262f4a0_icgraph">
<area shape="rect" title="Informs the writer federator that specific fields are present and should be reflected in the diagnost..." alt="" coords="1176,5,1337,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a75db617985efd39b9db284a0dc512d34" title="Registers with the writer federator the set of fields (prognostic and diagnostic) that are available,..." alt="" coords="961,5,1128,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="783,13,913,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="584,13,735,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,13,536,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="a5c407f4433b36fa8e9fefda57fc32252"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c407f4433b36fa8e9fefda57fc32252">&#9670;&nbsp;</a></span>inform_writer_federator_time_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public writer_federator_mod::inform_writer_federator_time_point </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>data_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character, dimension(:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>data_dump</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00131">131</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: source, data_id</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">character</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(in)</span> :: data_dump</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: time</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">integer</span> :: timestep</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: timestep_key</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (is_field_present(io_configuration, source, data_id, <span class="stringliteral">&quot;time&quot;</span>) .and. &amp;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;         is_field_present(io_configuration, source, data_id, <span class="stringliteral">&quot;timestep&quot;</span>)) <span class="keywordflow">then</span>      </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      time=get_scalar_real_from_monc(io_configuration, source, data_id, data_dump, <span class="stringliteral">&quot;time&quot;</span>)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      timestep=get_scalar_integer_from_monc(io_configuration, source, data_id, data_dump, <span class="stringliteral">&quot;timestep&quot;</span>)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      timestep_key=conv_to_string(timestep)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_rdlock(time_points_rwlock))</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">if</span> (.not. c_contains(time_points, timestep_key)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(time_points_rwlock))</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keyword">call </span>check_thread_status(forthread_rwlock_wrlock(time_points_rwlock))</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span> (.not. c_contains(time_points, timestep_key)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="keyword">call </span>c_put_real(time_points, timestep_key, time)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordflow">        end if</span>        </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_rwlock_unlock(time_points_rwlock))      </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a5c407f4433b36fa8e9fefda57fc32252_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a5c407f4433b36fa8e9fefda57fc32252_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a5c407f4433b36fa8e9fefda57fc32252_cgraph" id="anamespacewriter__federator__mod_a5c407f4433b36fa8e9fefda57fc32252_cgraph">
<area shape="rect" title=" " alt="" coords="5,194,167,250"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="229,5,383,47"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="225,71,387,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="225,136,387,177"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="225,201,387,243"/>
<area shape="rect" href="namespacedata__utils__mod.html#a56c7a3c668c3abef4e4d43fea2f73b5b" title="Retrieves a single integer element (scalar) from the data dump." alt="" coords="215,267,397,308"/>
<area shape="rect" href="namespacedata__utils__mod.html#ae97bbc021128cf42a987facc1c1e7fee" title="Retreives a scalar real with a corresponding key from the raw data dump." alt="" coords="224,332,388,373"/>
<area shape="rect" href="namespacedata__utils__mod.html#ac64f12e860548e106a50f9be09a7bcb8" title=" " alt="" coords="243,397,369,439"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="445,13,588,39"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="636,5,803,47"/>
<area shape="rect" href="namespacedata__utils__mod.html#ab248d898201d14574800dd321c8a5dde" title="Retrieves a single integer element (scalar) from the data dump." alt="" coords="449,267,584,308"/>
<area shape="rect" href="namespacedata__utils__mod.html#a15c2c4edba1f23d89fd83d173b54774d" title="Retreives a scalar real with a corresponding key from the raw data dump." alt="" coords="449,332,584,373"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a5c407f4433b36fa8e9fefda57fc32252_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a5c407f4433b36fa8e9fefda57fc32252_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a5c407f4433b36fa8e9fefda57fc32252_icgraph" id="anamespacewriter__federator__mod_a5c407f4433b36fa8e9fefda57fc32252_icgraph">
<area shape="rect" title=" " alt="" coords="1008,5,1169,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="809,13,960,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,5,761,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,13,536,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="a08e836c0ac87a9e09b4c622aaded6ad6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08e836c0ac87a9e09b4c622aaded6ad6">&#9670;&nbsp;</a></span>initialise_contiguous_data_regions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::initialise_contiguous_data_regions </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structwriter__types__mod_1_1writer__field__type.html">writer_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>field_to_write_information</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will initialise the collective data regions that form contiguous blocks within the data. This is quite an expensive operation so only done once for each field, but has the potential for very significant performance advantages for the fields that match it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">field_to_write_information</td><td>The specific field that is being looked at and identified for contiguous data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l01444">1444</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordtype">type</span>(writer_field_type), <span class="keywordtype">intent(inout)</span> :: field_to_write_information</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="keywordtype">integer</span> :: start(field_to_write_information%dimensions, io_configuration%number_of_moncs), &amp;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;         count(field_to_write_information%dimensions, io_configuration%number_of_moncs), &amp;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;         common_starters(io_configuration%number_of_moncs), num_common, num_current_contents, active_dim, other_dim, &amp;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;         j, k, i, dim_identifier, number_distinct_writes, start_blocks(io_configuration%number_of_moncs), ierr, &amp;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;         count_blocks(io_configuration%number_of_moncs), current_contents(io_configuration%number_of_moncs), &amp;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;         monc_write_start_offset_per_dim(field_to_write_information%dimensions,io_configuration%number_of_moncs)</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="keywordtype">logical</span> :: processed(io_configuration%number_of_moncs)</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="keywordtype">type</span>(write_field_collective_descriptor_type), <span class="keywordtype">pointer</span> :: collective_descriptor</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordtype">type</span>(write_field_collective_monc_info_type), <span class="keywordtype">pointer</span> :: specific_monc_collective</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic  </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    processed=.false.</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    number_distinct_writes=0</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keywordflow">do</span> j=1, io_configuration%number_of_moncs</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <span class="keywordflow">do</span> k=1, field_to_write_information%dimensions</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        dim_identifier=get_dimension_identifier(field_to_write_information%dim_size_defns(k))</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        start(k, j)=io_configuration%registered_moncs(j)%local_dim_starts(dim_identifier)</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        count(k, j)=io_configuration%registered_moncs(j)%local_dim_sizes(dim_identifier)</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">do</span> j=1, io_configuration%number_of_moncs</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <span class="keywordflow">if</span> (.not. processed(j)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <span class="keyword">call </span>get_common_starts(<a class="code" href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">y_index</a>, start(<a class="code" href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">y_index</a>, j), start, common_starters, num_common)</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="keywordflow">if</span> (num_common == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;          <span class="keyword">call </span>get_common_starts(<a class="code" href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">x_index</a>, start(<a class="code" href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">x_index</a>, j), start, common_starters, num_common)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          <span class="keywordflow">if</span> (num_common .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            active_dim=<a class="code" href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">x_index</a></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            other_dim=<a class="code" href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">y_index</a></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          active_dim=<a class="code" href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">y_index</a></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          other_dim=<a class="code" href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">x_index</a></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          number_distinct_writes=number_distinct_writes+1</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;          <span class="keyword">allocate</span>(collective_descriptor)</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;          <span class="keyword">allocate</span>(collective_descriptor%absolute_start(field_to_write_information%dimensions), &amp;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;               collective_descriptor%count(field_to_write_information%dimensions))</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          start_blocks(number_distinct_writes)=start(other_dim, j)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;          count_blocks(number_distinct_writes)=count(other_dim, j)</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;          num_current_contents=1</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;          current_contents(num_current_contents)=j</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;          processed(j)=.true.</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;          <span class="keywordflow">if</span> (num_common .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            <span class="keywordflow">do</span> k=1, num_common</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;              <span class="keywordflow">do</span> i=1, num_common</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                <span class="keywordflow">if</span> (.not. processed(common_starters(i)) .and. count(active_dim, j) == count(active_dim, i)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                  <span class="keywordflow">if</span> (start(other_dim, common_starters(i)) .lt. start_blocks(number_distinct_writes) .and. &amp;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                       start(other_dim, common_starters(i)) + count(other_dim, common_starters(i)) &amp;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                       == start_blocks(number_distinct_writes)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                    start_blocks(number_distinct_writes)=start(other_dim, common_starters(i))</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                    count_blocks(number_distinct_writes)=count_blocks(number_distinct_writes)+count(other_dim, common_starters(i))</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                    processed(common_starters(i))=.true.                    </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                    num_current_contents=num_current_contents+1</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                    current_contents(num_current_contents)=common_starters(i)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (start(other_dim, common_starters(i)) .gt. start_blocks(number_distinct_writes) .and. &amp;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                       start_blocks(number_distinct_writes) + count_blocks(number_distinct_writes) &amp;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                       == start(other_dim, common_starters(i))) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                    count_blocks(number_distinct_writes)=count_blocks(number_distinct_writes)+count(other_dim, common_starters(i))</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                    processed(common_starters(i))=.true.                    </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                    num_current_contents=num_current_contents+1</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                    current_contents(num_current_contents)=common_starters(i)</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="keywordflow">                  end if</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="keywordflow">              end do</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;          collective_descriptor%absolute_start=start(:,j)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;          collective_descriptor%count=count(:,j)</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;          collective_descriptor%absolute_start(other_dim)=start_blocks(number_distinct_writes)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;          collective_descriptor%count(other_dim)=count_blocks(number_distinct_writes)</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;          collective_descriptor%split_dim=other_dim</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;          <span class="keywordflow">if</span> (num_current_contents .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            <span class="keywordflow">do</span> k=1, num_current_contents</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;              <span class="keyword">allocate</span>(specific_monc_collective)                          </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;              specific_monc_collective%relative_dimension_start=(start(other_dim,current_contents(k))-&amp;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                   start_blocks(number_distinct_writes)) + 1              </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;              specific_monc_collective%counts=count(:, current_contents(k))</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;              specific_monc_collective%monc_location=current_contents(k)</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;              specific_monc_collective%monc_source=io_configuration%registered_moncs(current_contents(k))%source_id</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;              generic=&gt;specific_monc_collective</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;              <span class="keyword">call </span>c_add_generic(collective_descriptor%specific_monc_info, generic, .false.)</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;          generic=&gt;collective_descriptor</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;          <span class="keyword">call </span>c_add_generic(field_to_write_information%collective_descriptors, generic, .false.)</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keyword">call </span>mpi_iallreduce(number_distinct_writes, field_to_write_information%max_num_collective_writes, 1, mpi_int, mpi_max, &amp;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;         io_configuration%io_communicator, field_to_write_information%max_num_collective_writes_request_handle, ierr)</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="keyword">call </span>unlock_mpi()</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a08e836c0ac87a9e09b4c622aaded6ad6_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a08e836c0ac87a9e09b4c622aaded6ad6_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a08e836c0ac87a9e09b4c622aaded6ad6_cgraph" id="anamespacewriter__federator__mod_a08e836c0ac87a9e09b4c622aaded6ad6_cgraph">
<area shape="rect" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="5,31,151,87"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9f81ee04b25b784bf928c8bc96d32016" title="Retrieves the number of common starting points that match a specific input value." alt="" coords="210,5,354,47"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="199,71,365,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a08e836c0ac87a9e09b4c622aaded6ad6_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a08e836c0ac87a9e09b4c622aaded6ad6_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a08e836c0ac87a9e09b4c622aaded6ad6_icgraph" id="anamespacewriter__federator__mod_a08e836c0ac87a9e09b4c622aaded6ad6_icgraph">
<area shape="rect" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="3725,172,3871,228"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="3471,172,3677,228"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="3279,179,3423,221"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3080,107,3231,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="3083,238,3228,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2855,107,3032,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2646,133,2801,174"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2419,125,2592,181"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,101,1897,157"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,144,2371,200"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,130,1699,171"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,144,2156,200"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="2640,238,2807,279"/>
</map>
</div>

</div>
</div>
<a id="a7b31bb8f9d0fb8c0768252e819b20985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b31bb8f9d0fb8c0768252e819b20985">&#9670;&nbsp;</a></span>initialise_writer_federator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public writer_federator_mod::initialise_writer_federator </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diagnostic_generation_frequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>continuation_run</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises the write federator and configures it based on the user configuration. Also initialises the time manipulations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00057">57</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">type</span>(hashmap_type), <span class="keywordtype">intent(inout)</span> :: diagnostic_generation_frequency</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: continuation_run</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">integer</span> :: i, j, number_contents, current_field_index</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">type</span>(hashset_type) :: writer_field_names, duplicate_field_names</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_rwlock_init(time_points_rwlock, -1))</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_init(collective_contiguous_initialisation_mutex, -1))</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_init(currently_writing_mutex, -1))    </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    currently_writing=.false.</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">call </span>init_time_averaged_manipulation()</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">call </span>init_instantaneous_manipulation()</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">call </span>initialise_netcdf_filetype()</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keyword">allocate</span>(writer_entries(io_configuration%number_of_writers))    </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">do</span> i=1, io_configuration%number_of_writers</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      current_field_index=0</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      number_contents=io_configuration%file_writers(i)%number_of_contents</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keyword">allocate</span>(writer_entries(i)%contents(get_total_number_writer_fields(io_configuration, i)))</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      writer_entries(i)%filename=io_configuration%file_writers(i)%file_name</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      writer_entries(i)%title=io_configuration%file_writers(i)%title</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      writer_entries(i)%write_on_terminate=io_configuration%file_writers(i)%write_on_terminate</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      writer_entries(i)%include_in_io_state_write=io_configuration%file_writers(i)%include_in_io_state_write</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_init(writer_entries(i)%trigger_and_write_mutex, -1))</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_init(writer_entries(i)%num_fields_to_write_mutex, -1))</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keyword">call </span>check_thread_status(forthread_mutex_init(writer_entries(i)%pending_writes_mutex, -1))</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      writer_entries(i)%write_on_model_time=io_configuration%file_writers(i)%write_on_model_time</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">if</span> (writer_entries(i)%write_on_model_time) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        writer_entries(i)%write_timestep_frequency=0</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        writer_entries(i)%write_time_frequency=io_configuration%file_writers(i)%write_time_frequency</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        writer_entries(i)%write_time_frequency=0</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        writer_entries(i)%write_timestep_frequency=io_configuration%file_writers(i)%write_timestep_frequency</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      writer_entries(i)%previous_write_time=0</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      writer_entries(i)%defined_write_time=io_configuration%file_writers(i)%write_time_frequency</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      writer_entries(i)%latest_pending_write_time=0</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      writer_entries(i)%latest_pending_write_timestep=0      </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      writer_entries(i)%contains_io_status_dump=.false.</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">do</span> j=1, number_contents</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span> (io_configuration%file_writers(i)%contents(j)%facet_type == group_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          current_field_index=add_group_of_fields_to_writer_entry(io_configuration, i, j, current_field_index, &amp;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;               writer_field_names, duplicate_field_names, diagnostic_generation_frequency)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (io_configuration%file_writers(i)%contents(j)%facet_type == field_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;          current_field_index=current_field_index+add_field_to_writer_entry(io_configuration, &amp;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;           i, j, current_field_index, io_configuration%file_writers(i)%contents(j)%facet_name, <span class="stringliteral">&quot;&quot;</span>, writer_field_names, &amp;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;           duplicate_field_names, diagnostic_generation_frequency)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (io_configuration%file_writers(i)%contents(j)%facet_type == io_state_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          writer_entries(i)%contains_io_status_dump=.true.</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">if</span> (.not. c_is_empty(duplicate_field_names)) <span class="keyword">call </span>handle_duplicate_field_names(writer_entries(i), duplicate_field_names)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keyword">call </span>c_free(writer_field_names)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keyword">call </span>c_free(duplicate_field_names)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (continuation_run) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keyword">call </span>reactivate_writer_federator_state(io_configuration, writer_entries, time_points)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a7b31bb8f9d0fb8c0768252e819b20985_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a7b31bb8f9d0fb8c0768252e819b20985_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a7b31bb8f9d0fb8c0768252e819b20985_cgraph" id="anamespacewriter__federator__mod_a7b31bb8f9d0fb8c0768252e819b20985_cgraph">
<area shape="rect" title="Initialises the write federator and configures it based on the user configuration...." alt="" coords="5,356,177,397"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a90abda607746ac48c9b1df555c59895c" title="Adds a field to the writer entry, this will split the Q fields. However at initialisation we don&#39;t kn..." alt="" coords="557,16,727,57"/>
<area shape="rect" href="namespacewriter__federator__mod.html#afa4a1b4f58fe72715645615b4f1ee9d8" title="Adds a group of fields to a writer entry, groups are expanded out into individual fields,..." alt="" coords="278,72,422,128"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="565,442,719,484"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="561,290,723,332"/>
<area shape="rect" href="namespaceforthread__mod.html#a84f66d5153e8adc21918d4b4d627087f" title=" " alt="" coords="561,508,723,549"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a863bc95a6373f8197cc183d39f1d6d12" title="Determines the total number of fields that make up a writer entry, this is all the fields of the grou..." alt="" coords="267,152,433,208"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a989ba90529039516692707b2d6611683" title="Marks duplicate field names in a writer entry as duplicates so that the NetCDF layer can then deal wi..." alt="" coords="249,414,451,456"/>
<area shape="rect" href="namespaceinstantaneous__time__manipulation__mod.html#a7e4bb0c6062e585c823fba1f7bce6cb9" title="Initialises the instantaneous time manipulation." alt="" coords="255,283,445,339"/>
<area shape="rect" href="namespacetimeaveraged__time__manipulation__mod.html#a80db7d5206be0e06f1d048ae816630aa" title="Initialises the reduction action." alt="" coords="225,558,475,600"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a8fb7c121572aa0805eb6938e83eb37d8" title="Initialises the NetCDF writing functionality." alt="" coords="275,479,425,535"/>
<area shape="rect" href="namespaceio__server__state__reader__mod.html#a21bc5840c3287e6dcbbb29f4480bbdde" title="Reactivates the writer federator and everything beneath it (i.e. just not the writer field manager...." alt="" coords="272,711,428,767"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ae6664cafdcce9b4b3d0a5815c65af9ac" title="Adds a specific field and its information to a writer entry." alt="" coords="863,8,1007,64"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a89b6a2402ed4c492470ff392caa11714" title="Searches the IO server configuration for a group with a specific name and returns the index to that g..." alt="" coords="570,85,714,126"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="1144,568,1287,595"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="1383,561,1550,602"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a96287a6f24e9217bb315d12e326cdfd9" title="Retrieves the number of fields that make up this field, if it is a Q field then it will be split into..." alt="" coords="863,175,1007,231"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a34196607f504b72b30c0d82215402d96" title="Retrieves the number of fields within a group of fields." alt="" coords="565,208,719,264"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="851,532,1018,573"/>
<area shape="rect" href="namespaceio__server__state__reader__mod.html#ae6fa2d9320b51df852a8091efe4eaeab" title="Retrieves some IO server serialised bytes which will make up the state of a specific facet...." alt="" coords="523,625,761,666"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#af2aeb42c9fdb961702216042b0330088" title="Retrieves a string value from the database that matches the provided key." alt="" coords="567,849,717,890"/>
<area shape="rect" href="namespaceio__server__state__reader__mod.html#a2fd344d14e8cfe309b319213650c0b8c" title="Will restart the instantaneous manipulation state from the checkpoint file." alt="" coords="549,690,735,746"/>
<area shape="rect" href="namespaceio__server__state__reader__mod.html#a629f60c48b74a642c82f54b10226201e" title="Will restart the time averaged manipulation state from the checkpoint file." alt="" coords="551,770,733,826"/>
<area shape="rect" href="namespaceio__server__state__reader__mod.html#a6f8d354060b4c24f27e7e10f0e64b8c5" title="Restarts the writer state timepoints held in the writer federator." alt="" coords="556,948,728,1004"/>
<area shape="rect" href="namespacewriter__types__mod.html#a433965efb35f6d750e5365c1257057bb" title="Unserialises some byte data into the writer in order to recreate the state of the writer." alt="" coords="546,1057,738,1098"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a13bbeb6272c82308e3d4a42f7c36c862" title="Determines whether a specific options key exists in the database or not, if it doesn&#39;t then this resu..." alt="" coords="860,910,1009,966"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#ab4f16a670bed755586806647da3cfa8d" title="Gets a key corresponding to the correct options key and index combination." alt="" coords="856,845,1013,886"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a4b187d310f786ed3c207a3060e09b156" title="Determines whether a specific key is in the database." alt="" coords="1141,917,1290,958"/>
<area shape="rect" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20" title="Will log just from the master process." alt="" coords="840,728,1029,755"/>
<area shape="rect" href="namespaceinstantaneous__time__manipulation__mod.html#a05f91c0341154b1a62fc61d5afe0e2a1" title="Unpacks some serialised byte data to initialise this manipulator to some previous state." alt="" coords="833,648,1036,704"/>
<area shape="rect" href="namespacetimeaveraged__time__manipulation__mod.html#a35f58180460226c8d79501df2076eaa9" title="Unserialises some byte data to initialise the state from some previous version." alt="" coords="809,780,1060,821"/>
<area shape="rect" href="namespacetimeaveraged__time__manipulation__mod.html#a3d50d634cdf0a28d0ed7651e3a025416" title="Will create a specific time averaged completed value based upon the provided serialised data." alt="" coords="1108,772,1323,828"/>
<area shape="rect" href="namespacedata__utils__mod.html#a3b50dff5f8dae4a3bc361d1dce5f7711" title="Unpacks a double precision scalar real from some byte data, this is a very simple unpack routine wrap..." alt="" coords="833,1054,1036,1096"/>
<area shape="rect" href="namespacedata__utils__mod.html#ab3602147fea5dd8f50911c7f4c93ff76" title="Unpacks a scalar integer from some byte data, this is a very simple unpack routine wrapping the trans..." alt="" coords="835,989,1034,1030"/>
<area shape="rect" href="namespacewriter__types__mod.html#a7b5b6fc49221508341b7c744284b2d4c" title="Unserialises byte data into a writer field type." alt="" coords="839,1120,1031,1161"/>
<area shape="rect" href="namespacewriter__types__mod.html#a9c6f0c0e7d2ea3c758c6df1041d175a8" title="Unserialsies collective values contained in some data." alt="" coords="1119,1090,1311,1132"/>
<area shape="rect" href="namespacewriter__types__mod.html#a536a4c1352bbc1d7a21aedec40ba4f8e" title="Unserialises some byte data into data values." alt="" coords="1371,1120,1563,1161"/>
<area shape="rect" href="namespacewriter__types__mod.html#a0c1e3ad6ff464304020f0be57e7e7df0" title="Inflates some byte data into a string map." alt="" coords="1611,1120,1803,1161"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a7b31bb8f9d0fb8c0768252e819b20985_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a7b31bb8f9d0fb8c0768252e819b20985_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a7b31bb8f9d0fb8c0768252e819b20985_icgraph" id="anamespacewriter__federator__mod_a7b31bb8f9d0fb8c0768252e819b20985_icgraph">
<area shape="rect" title="Initialises the write federator and configures it based on the user configuration...." alt="" coords="385,5,557,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="ac6aefade0899178fd2ba9c7c723af5d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6aefade0899178fd2ba9c7c723af5d1">&#9670;&nbsp;</a></span>is_field_split_on_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public writer_federator_mod::is_field_split_on_q </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines whether a field is split on Q or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field_name</td><td>The field name to check whether it is being used or not </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether this field is used or not (and then further split to be constituient parts of Q) </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00239">239</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    is_field_split_on_q=c_contains(q_field_names, field_name)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_ac6aefade0899178fd2ba9c7c723af5d1_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_ac6aefade0899178fd2ba9c7c723af5d1_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_ac6aefade0899178fd2ba9c7c723af5d1_icgraph" id="anamespacewriter__federator__mod_ac6aefade0899178fd2ba9c7c723af5d1_icgraph">
<area shape="rect" title="Determines whether a field is split on Q or not." alt="" coords="1229,13,1373,54"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1008,5,1181,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="809,13,960,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,5,761,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,13,536,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="ab10af49e026b9e11d113f702bb7f3113"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab10af49e026b9e11d113f702bb7f3113">&#9670;&nbsp;</a></span>is_field_used_by_writer_federator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public writer_federator_mod::is_field_used_by_writer_federator </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_namespace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines whether a field is used by the writer federator or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field_name</td><td>The field name to check whether it is being used or not </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether this field is used or not </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00222">222</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name, field_namespace</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">integer</span> :: writer_index, contents_index</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    writer_index=1</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    contents_index=1</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (c_contains(used_field_names, field_name)) <span class="keywordflow">then</span>      </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      is_field_used_by_writer_federator=get_next_applicable_writer_entry(field_name, field_namespace, writer_index, contents_index)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      is_field_used_by_writer_federator=.false.</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_ab10af49e026b9e11d113f702bb7f3113_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_ab10af49e026b9e11d113f702bb7f3113_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_ab10af49e026b9e11d113f702bb7f3113_cgraph" id="anamespacewriter__federator__mod_ab10af49e026b9e11d113f702bb7f3113_cgraph">
<area shape="rect" title="Determines whether a field is used by the writer federator or not." alt="" coords="5,5,168,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9379ee9a358faa87a63d2f2459f202b9" title="Retrieves the index of the next writer which uses a specific field. If none is found then returns fal..." alt="" coords="216,5,360,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_ab10af49e026b9e11d113f702bb7f3113_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_ab10af49e026b9e11d113f702bb7f3113_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_ab10af49e026b9e11d113f702bb7f3113_icgraph" id="anamespacewriter__federator__mod_ab10af49e026b9e11d113f702bb7f3113_icgraph">
<area shape="rect" title="Determines whether a field is used by the writer federator or not." alt="" coords="1229,5,1392,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1008,5,1181,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="809,13,960,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,5,761,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,13,536,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="a9271347f390a41c78caacc174002d0b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9271347f390a41c78caacc174002d0b4">&#9670;&nbsp;</a></span>issue_actual_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public writer_federator_mod::issue_actual_write </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structwriter__types__mod_1_1writer__type.html">writer_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>writer_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>terminated_write</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Issues the actual file creation, write of available fields and closure if all completed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">writer_entry_index</td><td>Index of the writer we are concerned with </td></tr>
    <tr><td class="paramname">timestep</td><td>The corresponding timestep </td></tr>
    <tr><td class="paramname">time</td><td>The corresponding model time </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00728">728</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">type</span>(writer_type), <span class="keywordtype">intent(inout)</span> :: writer_entry</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">intent(in)</span> :: time</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: terminated_write</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordtype">integer</span> :: i, j, total_outstanding, num_written, total_flds</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordtype">logical</span> :: field_written</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordtype">type</span>(map_type) :: applicable_time_points</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(collective_contiguous_initialisation_mutex))</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(writer_entry%contents)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="keywordflow">if</span> (writer_entry%contents(i)%enabled .and. writer_entry%contents(i)%collective_write) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">if</span> (.not. writer_entry%contents(i)%collective_initialised) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          <span class="keyword">call </span>determine_collective_type_and_optimise_if_possible(io_configuration, writer_entry%contents(i))</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(collective_contiguous_initialisation_mutex))</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    writer_entry%write_time=time</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    writer_entry%write_timestep=timestep</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    applicable_time_points=extract_applicable_time_points(writer_entry%previous_write_time, time)    </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keyword">call </span>define_netcdf_file(io_configuration, writer_entry, timestep, time, applicable_time_points, terminated_write)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keyword">call </span>c_free(applicable_time_points)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    total_outstanding=0</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    total_flds=0</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    num_written=0</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(writer_entry%num_fields_to_write_mutex))</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">do</span> j=1, <span class="keyword">size</span>(writer_entry%contents)  </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="keywordflow">if</span> (writer_entry%contents(j)%enabled .and. writer_entry%contents(j)%expected_here) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        total_flds=total_flds+1</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keyword">call </span>determine_if_field_can_be_written(io_configuration, writer_entry, writer_entry%contents(j), timestep, &amp;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;             writer_entry%previous_write_timestep, time, writer_entry%contents(j)%previous_write_time, field_written)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">if</span> (.not. field_written) <span class="keywordflow">then</span>          </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;          total_outstanding=total_outstanding+1</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;          num_written=num_written+1</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    writer_entry%num_fields_to_write=total_outstanding</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entry%num_fields_to_write_mutex))</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() .ge. <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;Started write for NetCDF file, timestep= &quot;</span>//trim(conv_to_string(timestep))&amp;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;           //<span class="stringliteral">&quot; total=&quot;</span>//trim(conv_to_string(total_flds))//<span class="stringliteral">&quot; written=&quot;</span>//trim(conv_to_string(num_written))//&amp;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;           <span class="stringliteral">&quot; outstanding=&quot;</span>//trim(conv_to_string(total_outstanding)))</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">if</span> (total_outstanding == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keyword">call </span>close_diagnostics_file(io_configuration, writer_entry, timestep, time)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a9271347f390a41c78caacc174002d0b4_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a9271347f390a41c78caacc174002d0b4_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a9271347f390a41c78caacc174002d0b4_cgraph" id="anamespacewriter__federator__mod_a9271347f390a41c78caacc174002d0b4_cgraph">
<area shape="rect" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="5,1845,149,1886"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="1195,1735,1350,1777"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="1419,801,1561,828"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="223,1933,378,1974"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="461,1277,621,1318"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="1191,519,1354,561"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="1191,365,1354,406"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="197,2089,404,2145"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="229,572,373,628"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="469,1845,612,1886"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="707,2288,851,2344"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="1609,794,1776,835"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="452,1955,629,2011"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="703,2027,854,2083"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="707,1962,851,2003"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="946,2021,1109,2062"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="946,1903,1109,1945"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="944,1298,1111,1339"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="698,1269,859,1325"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="942,1233,1113,1274"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="942,1167,1113,1209"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="695,1349,862,1390"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="677,900,880,956"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="695,1545,863,1601"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="702,703,855,745"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="697,1059,860,1101"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="697,1125,860,1166"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a5686361108378ecc645e4240ce3c3d35" title="Generates a unique filename based upon the base one specified and the number of completed timesteps." alt="" coords="701,1189,856,1245"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="707,1845,851,1886"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a0a437b7c2ee1752a8c3ad3ce4797cced" title="Writes the conditional diagnostic variable names into the NetCDF file." alt="" coords="705,820,852,876"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ae456ae2267a1cf3a1763d1cbd59039ab" title="Writes a coordinate variable into the NetCDF file." alt="" coords="701,1465,856,1521"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a767df50b485665dac93bfdf57897c667" title="Writes out global attributes into the checkpoint." alt="" coords="701,980,856,1036"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2d8000c479d36f8c5c0c91aa482c9765" title="Writes out the options_database defining this model run." alt="" coords="697,1677,860,1718"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a63ada26600230ff5a6551e3dd04736ce" title="Retrieves the number of timeseries entries for a specific frequency and previous write time...." alt="" coords="930,1467,1125,1523"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="955,870,1099,911"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#af49b3618c2fdcf04a2eef4dc5e0a7925" title="For a specific field will retrieve the NetCDF id of the time series dimension most appropriate for th..." alt="" coords="939,935,1116,991"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6da2f8c99dc13a7d24ec60861a2a48aa" title="Given the file state and the output frequency of a field will retrive the appropriate time series dim..." alt="" coords="1175,804,1371,860"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#adc0a6752b379a4967ae7260e4487d049" title="Returns the ith key in the options database." alt="" coords="953,1546,1102,1587"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a7eeb8b8d74d261f80bb0a64db10b22e2" title="Returns the number of entries in the options database." alt="" coords="953,1611,1102,1653"/>
<area shape="rect" href="namespaceoptionsdatabase__mod.html#a2dee7871d510ec8b7e82ff936a59b443" title="Returns the value at index in the database." alt="" coords="953,1677,1102,1718"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a20d56184ae0676c708c4377f01f71310" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="695,2106,862,2147"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a08e836c0ac87a9e09b4c622aaded6ad6" title="Will initialise the collective data regions that form contiguous blocks within the data...." alt="" coords="468,2155,613,2211"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9f81ee04b25b784bf928c8bc96d32016" title="Retrieves the number of common starting points that match a specific input value." alt="" coords="707,2171,851,2213"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="469,579,613,621"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="696,528,861,584"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="699,609,858,679"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a605f56b2d81bbaf34377388f9d3f6ec1" title="Writes independent variables to the diagnostics file. This writes the entire variable and works by wr..." alt="" coords="696,347,861,403"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aacc77c78537724e3eac2bfc2537d9a30" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="928,499,1127,541"/>
<area shape="rect" href="namespaceconversions__mod.html#ab7f79ee421227f8486ab403e9d5620e0" title="Converts from a single to double precision real. This applies some rounding to a certain number of de..." alt="" coords="948,2339,1107,2381"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ac4ee4eae0932fe781cc87322c7da4204" title="Sorts the time points based upon their timestep, smallest to largest. Note that this is a bubble sort..." alt="" coords="954,2404,1101,2460"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a9271347f390a41c78caacc174002d0b4_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a9271347f390a41c78caacc174002d0b4_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a9271347f390a41c78caacc174002d0b4_icgraph" id="anamespacewriter__federator__mod_a9271347f390a41c78caacc174002d0b4_icgraph">
<area shape="rect" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="3279,179,3423,221"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3080,107,3231,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="3083,238,3228,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2855,107,3032,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2646,133,2801,174"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2419,125,2592,181"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,101,1897,157"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,144,2371,200"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,130,1699,171"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,144,2156,200"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="2640,238,2807,279"/>
</map>
</div>

</div>
</div>
<a id="a7149ce030c6fa05c7789b5e1e10be905"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7149ce030c6fa05c7789b5e1e10be905">&#9670;&nbsp;</a></span>provide_ordered_field_to_writer_federator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public writer_federator_mod::provide_ordered_field_to_writer_federator </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_namespace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1data__values__type.html">data_values_type</a>), target&#160;</td>
          <td class="paramname"><em>field_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00311">311</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name, field_namespace</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep, source</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">target</span> :: field_values</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span> :: time</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordtype">integer</span> :: writer_index, contents_index</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordtype">logical</span> :: continue_search</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">pointer</span> :: result_values</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordtype">type</span>(hashmap_type) :: typed_result_values</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (field_values%data_type == double_data_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keyword">call </span>provide_ordered_field_to_writer_federator_real_values(io_configuration, field_name, field_namespace, &amp;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;           field_values%values, timestep, time, source)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (field_values%data_type == string_data_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      continue_search=.true.</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      writer_index=1</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      contents_index=0</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keyword">allocate</span>(result_values, source=field_values)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      generic=&gt;result_values</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">if</span> (c_contains(used_field_names, field_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">do</span> <span class="keywordflow">while</span> (continue_search)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;          contents_index=contents_index+1</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          continue_search=get_next_applicable_writer_entry(field_name, field_namespace, writer_index, contents_index)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          <span class="keywordflow">if</span> (continue_search) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">if</span> (.not. writer_entries(writer_index)%contents(contents_index)%enabled) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#a10e28447dd10ef9f92d205bc98fb26d3">log_warn</a>, <span class="stringliteral">&quot;Received data for previously un-enabled field &#39;&quot;</span>//&amp;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                   writer_entries(writer_index)%contents(contents_index)%field_name//<span class="stringliteral">&quot;&#39;&quot;</span>)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            writer_entries(writer_index)%contents(contents_index)%enabled=.true.          </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            writer_entries(writer_index)%contents(contents_index)%latest_timestep_values=timestep</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() .ge. <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;[WRITE FED VALUE STORE] Storing value for field &quot;</span>//trim(field_name)//<span class="stringliteral">&quot; ts=&quot;</span>//&amp;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                   trim(conv_to_string(timestep))// <span class="stringliteral">&quot; t=&quot;</span>//trim(conv_to_string(time)))</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(writer_entries(writer_index)%contents(contents_index)%values_mutex))           </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keyword">call </span>c_put_generic(writer_entries(writer_index)%contents(contents_index)%values_to_write, conv_to_string(time), &amp;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                 generic, .false.)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entries(writer_index)%contents(contents_index)%values_mutex))</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">if</span> (writer_entries(writer_index)%contents(contents_index)%pending_to_write) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;              <span class="keyword">call </span>determine_if_outstanding_field_can_be_written(io_configuration, writer_entries(writer_index), &amp;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                   writer_entries(writer_index)%contents(contents_index))</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a7149ce030c6fa05c7789b5e1e10be905_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a7149ce030c6fa05c7789b5e1e10be905_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a7149ce030c6fa05c7789b5e1e10be905_cgraph" id="anamespacewriter__federator__mod_a7149ce030c6fa05c7789b5e1e10be905_cgraph">
<area shape="rect" title=" " alt="" coords="5,359,156,415"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="2924,2550,3079,2591"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="3131,1137,3273,1164"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="690,1357,863,1413"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="2920,542,3083,583"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="2920,1311,3083,1353"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="1994,1407,2137,1449"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9379ee9a358faa87a63d2f2459f202b9" title="Retrieves the index of the next writer which uses a specific field. If none is found then returns fal..." alt="" coords="705,296,849,352"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="204,460,415,516"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="3321,1130,3488,1171"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="920,1565,1075,1606"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="1770,651,1914,707"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="1123,1623,1300,1679"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="1348,1623,1499,1679"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="2428,2801,2572,2842"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="1547,1597,1691,1638"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="2188,2118,2348,2159"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="1739,1589,1945,1645"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="2428,2721,2572,2777"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="2677,2041,2844,2082"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="2419,2075,2581,2131"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="2675,1858,2846,1899"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="2675,1975,2846,2017"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="2417,2154,2583,2195"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="2399,1915,2601,1971"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="2416,1995,2584,2051"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="2423,1850,2577,1891"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="2419,2423,2581,2465"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="2679,2634,2842,2675"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="2419,2489,2581,2530"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="2428,2657,2572,2698"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="2689,1573,2833,1614"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="2679,2699,2842,2741"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="1993,1238,2137,1279"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="2417,1021,2583,1077"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="2189,1223,2347,1294"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a605f56b2d81bbaf34377388f9d3f6ec1" title="Writes independent variables to the diagnostics file. This writes the entire variable and works by wr..." alt="" coords="2185,1384,2351,1440"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aacc77c78537724e3eac2bfc2537d9a30" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="2661,854,2860,895"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aff299f33f5701bfddd073cd0a06be5f7" title="Retrieves the original size of a specific dimension (which is auto)" alt="" coords="2649,919,2872,961"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6da2f8c99dc13a7d24ec60861a2a48aa" title="Given the file state and the output frequency of a field will retrive the appropriate time series dim..." alt="" coords="2663,1087,2859,1143"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aaff250f828a91818f15f82b3838701cf" title="Retrieves the next collective descriptor based upon the iterator." alt="" coords="2415,752,2585,808"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aef4805588ccfc47ddd145e9c20e34218" title="Retrieves the next specific monc information item from the iterator." alt="" coords="2420,1101,2580,1157"/>
<area shape="rect" href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="2415,1581,2585,1622"/>
<area shape="rect" href="namespacempi__communication__mod.html#aee6d81060fcad11a466f823627234e7c" title="Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation." alt="" coords="2667,1741,2854,1782"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a527dfbc289976e0eefcc432bb077040e" title=" " alt="" coords="2427,1515,2573,1557"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a646b3fed89978ea8212eece9494f7c54" title=" " alt="" coords="2419,1384,2581,1440"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ad5f57429aef78615f84f59d4f2758747" title="Retrieves the data size for each Q entry of a collective Q field for the specific source MONC that ha..." alt="" coords="463,949,633,990"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="465,513,631,569"/>
<area shape="rect" href="namespaceconfiguration__parser__mod.html#ae5be635b15f2c5670d91275e34c74105" title="A helper function to get the location of a MONC&#39;s configuration in the IO data structure." alt="" coords="692,2793,861,2834"/>
<area shape="rect" href="namespacewriter__federator__mod.html#acac4d8c09e5e6c8566f9548a71339e7b" title="Writes the collective values, this is held differently to independent values which are written direct..." alt="" coords="681,630,872,671"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a7149ce030c6fa05c7789b5e1e10be905_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a7149ce030c6fa05c7789b5e1e10be905_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a7149ce030c6fa05c7789b5e1e10be905_icgraph" id="anamespacewriter__federator__mod_a7149ce030c6fa05c7789b5e1e10be905_icgraph">
<area shape="rect" title=" " alt="" coords="1747,85,1897,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,63,1699,105"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,173,988,214"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,165,761,221"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,173,536,214"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,180,337,207"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,180,99,207"/>
</map>
</div>

</div>
</div>
<a id="a9b04288042049d5e432068c5923b026d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b04288042049d5e432068c5923b026d">&#9670;&nbsp;</a></span>provide_ordered_field_to_writer_federator_real_values()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::provide_ordered_field_to_writer_federator_real_values </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_namespace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>field_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Provides fields (either diagnostics or prognostics) to the write federator which will action these as appropriate. This will split Q fields up if appropriate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">field_name</td><td>The field name to write (if appropriate) </td></tr>
    <tr><td class="paramname">field_values</td><td>The field values to write (if appropriate) </td></tr>
    <tr><td class="paramname">timestep</td><td>Corresponding MONC timestep </td></tr>
    <tr><td class="paramname">time</td><td>Corresponding MONC model time </td></tr>
    <tr><td class="paramname">source</td><td>Optional MONC source for the communicated fields </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00371">371</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name, field_namespace</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep, source</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: field_values</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span> :: time</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordtype">integer</span> :: individual_size, index</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (c_contains(used_field_names, field_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keyword">call </span>provide_ordered_single_field_to_writer_federator(io_configuration, field_name, field_namespace, field_values, &amp;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;           timestep, time, source)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c_contains(q_field_names, field_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">if</span> (c_contains(q_field_splits, field_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        individual_size=c_get_integer(q_field_splits, field_name)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (source .gt. -1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        individual_size=get_size_of_collective_q(io_configuration, field_name, source)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#a10e28447dd10ef9f92d205bc98fb26d3">log_warn</a>, <span class="stringliteral">&quot;Can not find Q split field in Q field names or collective field names with source, ignoring&quot;</span>)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      iterator=c_get_iterator(io_configuration%q_field_names)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      index=1</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keyword">call </span>provide_ordered_single_field_to_writer_federator(io_configuration, &amp;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;             trim(field_name)//<span class="stringliteral">&quot;_&quot;</span>//trim(c_next_string(iterator)), field_namespace, field_values(index:index+individual_size-1), &amp;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;             timestep, time, source)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        index=index+individual_size</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a9b04288042049d5e432068c5923b026d_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a9b04288042049d5e432068c5923b026d_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a9b04288042049d5e432068c5923b026d_cgraph" id="anamespacewriter__federator__mod_a9b04288042049d5e432068c5923b026d_cgraph">
<area shape="rect" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="5,57,216,113"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ad5f57429aef78615f84f59d4f2758747" title="Retrieves the data size for each Q entry of a collective Q field for the specific source MONC that ha..." alt="" coords="264,5,435,47"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="2932,1565,3075,1591"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="266,349,433,405"/>
<area shape="rect" href="namespaceconfiguration__parser__mod.html#ae5be635b15f2c5670d91275e34c74105" title="A helper function to get the location of a MONC&#39;s configuration in the IO data structure." alt="" coords="493,5,663,47"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="3123,1557,3289,1599"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="2725,2427,2880,2468"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="491,1678,665,1734"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="2721,1107,2884,1148"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="2721,545,2884,587"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="1795,2651,1938,2692"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9379ee9a358faa87a63d2f2459f202b9" title="Retrieves the index of the next writer which uses a specific field. If none is found then returns fal..." alt="" coords="506,277,650,333"/>
<area shape="rect" href="namespacewriter__federator__mod.html#acac4d8c09e5e6c8566f9548a71339e7b" title="Writes the collective values, this is held differently to independent values which are written direct..." alt="" coords="483,356,673,397"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="721,2140,876,2181"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="1571,1262,1715,1318"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="924,2198,1101,2254"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="1149,2198,1300,2254"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="2229,3016,2373,3057"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="1348,2140,1492,2181"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="1989,2140,2149,2181"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="1540,2487,1747,2543"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="2229,2937,2373,2993"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="2479,2016,2645,2057"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="2221,2173,2382,2229"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="2477,1951,2647,1992"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="2477,1833,2647,1875"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="2218,1897,2385,1939"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="2200,1962,2403,2018"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="2217,2093,2385,2149"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="2225,1780,2378,1821"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="2220,2485,2383,2527"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="2481,2892,2643,2933"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="2220,2603,2383,2644"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a5686361108378ecc645e4240ce3c3d35" title="Generates a unique filename based upon the base one specified and the number of completed timesteps." alt="" coords="2224,2354,2379,2410"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="2229,2872,2373,2913"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="2490,1397,2634,1439"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="2481,3009,2643,3051"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="1795,1269,1939,1311"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="2219,1050,2384,1106"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="1990,1167,2149,1237"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a605f56b2d81bbaf34377388f9d3f6ec1" title="Writes independent variables to the diagnostics file. This writes the entire variable and works by wr..." alt="" coords="1987,1262,2152,1318"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aacc77c78537724e3eac2bfc2537d9a30" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="2463,832,2661,873"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aff299f33f5701bfddd073cd0a06be5f7" title="Retrieves the original size of a specific dimension (which is auto)" alt="" coords="2451,897,2673,939"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6da2f8c99dc13a7d24ec60861a2a48aa" title="Given the file state and the output frequency of a field will retrive the appropriate time series dim..." alt="" coords="2464,962,2660,1018"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aaff250f828a91818f15f82b3838701cf" title="Retrieves the next collective descriptor based upon the iterator." alt="" coords="2216,730,2387,786"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aef4805588ccfc47ddd145e9c20e34218" title="Retrieves the next specific monc information item from the iterator." alt="" coords="2221,810,2381,866"/>
<area shape="rect" href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="2216,1663,2387,1704"/>
<area shape="rect" href="namespacempi__communication__mod.html#aee6d81060fcad11a466f823627234e7c" title="Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation." alt="" coords="2469,1768,2655,1809"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a527dfbc289976e0eefcc432bb077040e" title=" " alt="" coords="2229,1495,2374,1536"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a646b3fed89978ea8212eece9494f7c54" title=" " alt="" coords="2220,1211,2383,1267"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a9b04288042049d5e432068c5923b026d_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a9b04288042049d5e432068c5923b026d_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a9b04288042049d5e432068c5923b026d_icgraph" id="anamespacewriter__federator__mod_a9b04288042049d5e432068c5923b026d_icgraph">
<area shape="rect" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,85,2156,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,85,1897,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,63,1699,105"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,173,988,214"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,165,761,221"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,173,536,214"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,180,337,207"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,180,99,207"/>
</map>
</div>

</div>
</div>
<a id="a4d77a55167cf260497e14e1f86a8e54b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d77a55167cf260497e14e1f86a8e54b">&#9670;&nbsp;</a></span>provide_ordered_single_field_to_writer_federator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::provide_ordered_single_field_to_writer_federator </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__type.html">io_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>io_configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_namespace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>field_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Provides a single ordered field, i.e. Q fields have been split by this point. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>The IO server configuration </td></tr>
    <tr><td class="paramname">field_name</td><td>The field name to write (if appropriate) </td></tr>
    <tr><td class="paramname">field_values</td><td>The field values to write (if appropriate) </td></tr>
    <tr><td class="paramname">timestep</td><td>Corresponding MONC timestep </td></tr>
    <tr><td class="paramname">time</td><td>Corresponding MONC model time </td></tr>
    <tr><td class="paramname">source</td><td>Optional MONC source for the communicated fields </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00437">437</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordtype">type</span>(io_configuration_type), <span class="keywordtype">intent(inout)</span> :: io_configuration</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name, field_namespace</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: timestep, source</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: field_values</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span> :: time</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">integer</span> :: writer_index, contents_index</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordtype">logical</span> :: continue_search</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">pointer</span> :: result_values</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordtype">type</span>(hashmap_type) :: typed_result_values</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    continue_search=.true.</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    writer_index=1</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    contents_index=0</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (c_contains(used_field_names, field_name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (continue_search)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        contents_index=contents_index+1</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        continue_search=get_next_applicable_writer_entry(field_name, field_namespace, writer_index, contents_index)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">if</span> (continue_search) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          <span class="keywordflow">if</span> (.not. writer_entries(writer_index)%contents(contents_index)%enabled) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#a10e28447dd10ef9f92d205bc98fb26d3">log_warn</a>, <span class="stringliteral">&quot;Received data for previously un-enabled field &#39;&quot;</span>//&amp;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                 writer_entries(writer_index)%contents(contents_index)%field_name//<span class="stringliteral">&quot;&#39;&quot;</span>)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keywordflow">          end if</span>          </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          writer_entries(writer_index)%contents(contents_index)%enabled=.true.</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          <span class="keywordflow">if</span> (.not. c_contains(typed_result_values, conv_to_string(&amp;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;               writer_entries(writer_index)%contents(contents_index)%time_manipulation_type))) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keyword">allocate</span>(result_values)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keywordflow">if</span> (writer_entries(writer_index)%contents(contents_index)%collective_write .and. source .gt. -1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;              result_values=writer_entries(writer_index)%contents(contents_index)%time_manipulation(field_values, &amp;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                   writer_entries(writer_index)%contents(contents_index)%output_frequency, &amp;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                   trim(field_name)//<span class="stringliteral">&quot;#&quot;</span>//conv_to_string(source), timestep, time)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;              result_values=writer_entries(writer_index)%contents(contents_index)%time_manipulation(field_values, &amp;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                   writer_entries(writer_index)%contents(contents_index)%output_frequency, &amp;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                   field_name, timestep, time)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            generic=&gt;result_values</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keyword">call </span>c_put_generic(typed_result_values, conv_to_string(&amp;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                 writer_entries(writer_index)%contents(contents_index)%time_manipulation_type), generic, .false.)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            result_values=&gt;get_data_value_by_field_name(typed_result_values, conv_to_string(&amp;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                 writer_entries(writer_index)%contents(contents_index)%time_manipulation_type))            </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(result_values%values)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            writer_entries(writer_index)%contents(contents_index)%latest_timestep_values=timestep</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() .ge. <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;              <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;[WRITE FED VALUE STORE] Storing value for field &quot;</span>//trim(field_name)//<span class="stringliteral">&quot; ts=&quot;</span>//&amp;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                   trim(conv_to_string(timestep))// <span class="stringliteral">&quot; t=&quot;</span>//trim(conv_to_string(time)))</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(writer_entries(writer_index)%contents(contents_index)%values_mutex))</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordflow">if</span> (writer_entries(writer_index)%contents(contents_index)%collective_write .and.  source .gt. -1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;              <span class="keyword">call </span>write_collective_write_value(result_values, writer_index, contents_index, source, conv_to_string(time))</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;              <span class="keyword">call </span>c_put_generic(writer_entries(writer_index)%contents(contents_index)%values_to_write, conv_to_string(time), &amp;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                   generic, .false.)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entries(writer_index)%contents(contents_index)%values_mutex))</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordflow">if</span> (writer_entries(writer_index)%contents(contents_index)%pending_to_write) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;              <span class="keyword">call </span>determine_if_outstanding_field_can_be_written(io_configuration, writer_entries(writer_index), &amp;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                   writer_entries(writer_index)%contents(contents_index))</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keywordflow">            end if</span>                        </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keyword">call </span>c_free(typed_result_values)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a4d77a55167cf260497e14e1f86a8e54b_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a4d77a55167cf260497e14e1f86a8e54b_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a4d77a55167cf260497e14e1f86a8e54b_cgraph" id="anamespacewriter__federator__mod_a4d77a55167cf260497e14e1f86a8e54b_cgraph">
<area shape="rect" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="5,1073,172,1129"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="2463,2534,2617,2575"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="2669,1061,2812,1088"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="229,1019,402,1075"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="2459,517,2621,558"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="2459,1069,2621,1110"/>
<area shape="rect" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9" title="Retrieves the current logging level." alt="" coords="1533,1163,1675,1205"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9379ee9a358faa87a63d2f2459f202b9" title="Retrieves the index of the next writer which uses a specific field. If none is found then returns fal..." alt="" coords="243,3173,387,3229"/>
<area shape="rect" href="namespacewriter__federator__mod.html#acac4d8c09e5e6c8566f9548a71339e7b" title="Writes the collective values, this is held differently to independent values which are written direct..." alt="" coords="220,3253,411,3294"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="2860,1054,3027,1095"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="459,1261,613,1302"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="1309,989,1453,1045"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="661,1319,839,1375"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="887,1319,1037,1375"/>
<area shape="rect" href="namespacewriter__federator__mod.html#ab6600fa0faed86a8d9f6d22b2903da62" title="Cleans out old timepoints which are no longer going to be of any relavence to the file writing...." alt="" coords="1967,2905,2111,2946"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="1085,1294,1229,1335"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="1727,1999,1887,2041"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a472ec41d11538e384f05791c3d6037d7" title="Determines whether it can optimise a specific collective field. If the field fits into certain limite..." alt="" coords="1277,1221,1484,1277"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="1967,2825,2111,2881"/>
<area shape="rect" href="namespacenetcdf__misc__mod.html#a159f13789af0cecc704b47fde431b241" title="Will check a NetCDF status and write to log_log error any decoded statuses. Can be used to decode whe..." alt="" coords="2216,1887,2383,1929"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="1958,1648,2119,1704"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="2214,1757,2385,1798"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="2214,1822,2385,1863"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="1955,1887,2122,1929"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="1937,2032,2140,2088"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="1955,1952,2123,2008"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="1962,1531,2115,1573"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="1957,2475,2120,2517"/>
<area shape="rect" href="namespaceforthread__mod.html#a846b04ba75a5d5f20d8d38a7cab93da1" title=" " alt="" coords="2218,2738,2381,2779"/>
<area shape="rect" href="namespaceforthread__mod.html#ab60b7d18e1d948f6b63c6cb893fad182" title=" " alt="" coords="1957,2643,2120,2685"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a5686361108378ecc645e4240ce3c3d35" title="Generates a unique filename based upon the base one specified and the number of completed timesteps." alt="" coords="1961,2344,2116,2400"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#acb05fbdc64a670792cd9cec7f238951d" title="Retrieves a file state based upon its timestep or null if none is found." alt="" coords="1967,2761,2111,2802"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a0a437b7c2ee1752a8c3ad3ce4797cced" title="Writes the conditional diagnostic variable names into the NetCDF file." alt="" coords="1965,1808,2112,1864"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ae456ae2267a1cf3a1763d1cbd59039ab" title="Writes a coordinate variable into the NetCDF file." alt="" coords="1961,1728,2116,1784"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a767df50b485665dac93bfdf57897c667" title="Writes out global attributes into the checkpoint." alt="" coords="1961,2163,2116,2219"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a41e86c7b84afdea863ca626a2599bf1d" title="Retrieves the field key, corresponding to the field name in the NetCDF file and what we store against..." alt="" coords="2227,1471,2371,1513"/>
<area shape="rect" href="namespaceforthread__mod.html#ace3f16636de24b1fc62de549d67476dc" title=" " alt="" coords="2218,2803,2381,2845"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="1532,1021,1676,1062"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="1956,935,2121,991"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="1727,1006,1886,1077"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a605f56b2d81bbaf34377388f9d3f6ec1" title="Writes independent variables to the diagnostics file. This writes the entire variable and works by wr..." alt="" coords="1724,1167,1889,1223"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aacc77c78537724e3eac2bfc2537d9a30" title="Translates a dimension name to its numeric corresponding identifier." alt="" coords="2200,803,2399,845"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aff299f33f5701bfddd073cd0a06be5f7" title="Retrieves the original size of a specific dimension (which is auto)" alt="" coords="2188,869,2411,910"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6da2f8c99dc13a7d24ec60861a2a48aa" title="Given the file state and the output frequency of a field will retrive the appropriate time series dim..." alt="" coords="2201,1137,2397,1193"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aaff250f828a91818f15f82b3838701cf" title="Retrieves the next collective descriptor based upon the iterator." alt="" coords="1953,731,2124,787"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#aef4805588ccfc47ddd145e9c20e34218" title="Retrieves the next specific monc information item from the iterator." alt="" coords="1959,651,2119,707"/>
<area shape="rect" href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="1953,1363,2124,1405"/>
<area shape="rect" href="namespacempi__communication__mod.html#aee6d81060fcad11a466f823627234e7c" title="Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation." alt="" coords="2206,1639,2393,1681"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a527dfbc289976e0eefcc432bb077040e" title=" " alt="" coords="1966,1298,2111,1339"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a646b3fed89978ea8212eece9494f7c54" title=" " alt="" coords="1957,1167,2120,1223"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a4d77a55167cf260497e14e1f86a8e54b_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a4d77a55167cf260497e14e1f86a8e54b_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a4d77a55167cf260497e14e1f86a8e54b_icgraph" id="anamespacewriter__federator__mod_a4d77a55167cf260497e14e1f86a8e54b_icgraph">
<area shape="rect" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,85,2371,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,85,2156,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,85,1897,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,63,1699,105"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,173,988,214"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,165,761,221"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,173,536,214"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,180,337,207"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,180,99,207"/>
</map>
</div>

</div>
</div>
<a id="a468cf6121ebcfc23b1389528744d998c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a468cf6121ebcfc23b1389528744d998c">&#9670;&nbsp;</a></span>provide_q_field_names_to_writer_federator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public writer_federator_mod::provide_q_field_names_to_writer_federator </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1list__type.html">list_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>q_provided_field_names</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provides the Q field names to the write federator, this is required as on initialisation we don't know what these are and only when MONC register do they inform the IO server of the specifics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q_field_names</td><td>An ordered list of Q field names </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00277">277</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">type</span>(list_type), <span class="keywordtype">intent(inout)</span> :: q_provided_field_names</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator, q_field_iterator</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">logical</span> :: continue_search</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">integer</span> :: writer_index, contents_index, i</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: search_field, field_name, specific_name</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    iterator=c_get_iterator(q_field_names)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      specific_name=c_next_string(iterator)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      q_field_iterator=c_get_iterator(q_provided_field_names)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      i=1</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(q_field_iterator))</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        search_field=trim(specific_name)//<span class="stringliteral">&quot;_udef&quot;</span>//trim(conv_to_string(i))</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        field_name=trim(specific_name)//<span class="stringliteral">&quot;_&quot;</span>//trim(c_next_string(q_field_iterator))        </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        continue_search=.true.</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        writer_index=1</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        contents_index=0</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">do</span> <span class="keywordflow">while</span> (continue_search)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          contents_index=contents_index+1</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          continue_search=get_next_applicable_writer_entry(search_field, writer_index_point=writer_index, &amp;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;               contents_index_point=contents_index)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          <span class="keywordflow">if</span> (continue_search) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            writer_entries(writer_index)%contents(contents_index)%field_name=field_name</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        i=i+1</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keyword">call </span>c_add_string(used_field_names, field_name)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keyword">call </span>c_remove(used_field_names, search_field)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keywordflow">      end do</span>     </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a468cf6121ebcfc23b1389528744d998c_cgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a468cf6121ebcfc23b1389528744d998c_cgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a468cf6121ebcfc23b1389528744d998c_cgraph" id="anamespacewriter__federator__mod_a468cf6121ebcfc23b1389528744d998c_cgraph">
<area shape="rect" title="Provides the Q field names to the write federator, this is required as on initialisation we don&#39;t kno..." alt="" coords="5,5,165,61"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9379ee9a358faa87a63d2f2459f202b9" title="Retrieves the index of the next writer which uses a specific field. If none is found then returns fal..." alt="" coords="213,5,357,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a468cf6121ebcfc23b1389528744d998c_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a468cf6121ebcfc23b1389528744d998c_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a468cf6121ebcfc23b1389528744d998c_icgraph" id="anamespacewriter__federator__mod_a468cf6121ebcfc23b1389528744d998c_icgraph">
<area shape="rect" title="Provides the Q field names to the write federator, this is required as on initialisation we don&#39;t kno..." alt="" coords="1173,5,1333,61"/>
<area shape="rect" href="namespaceio__server__mod.html#aefce42fc11a68cb3783f1eb0f2c18610" title="Retrieves MONC information data, this is sent by MONC (and received) regardless, but only actioned if..." alt="" coords="961,13,1125,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="783,13,913,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="584,13,735,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,13,536,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="a27f423ed92a9bd09acce659a23e3defa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27f423ed92a9bd09acce659a23e3defa">&#9670;&nbsp;</a></span>register_pending_file_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::register_pending_file_write </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>writer_entry_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>terminated_write</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Registers a pending file write which will be actioned later on. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">writer_entry_index</td><td>Index of the writer entry </td></tr>
    <tr><td class="paramname">timestep</td><td>The timestep that the pending write represents </td></tr>
    <tr><td class="paramname">time</td><td>The time of the pending write </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00992">992</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: writer_entry_index, timestep</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="keywordtype">    real</span>, <span class="keywordtype">intent(in)</span> :: time</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: terminated_write</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordtype">type</span>(pending_write_type), <span class="keywordtype">pointer</span> :: pending_write</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keyword">allocate</span>(pending_write)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    pending_write%write_time=time</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    pending_write%timestep=timestep</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    pending_write%terminated_write=terminated_write</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    generic=&gt;pending_write</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(writer_entries(writer_entry_index)%pending_writes_mutex))</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keyword">call </span>c_push_generic(writer_entries(writer_entry_index)%pending_writes, generic, .false.)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(writer_entries(writer_entry_index)%pending_writes_mutex))</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_a27f423ed92a9bd09acce659a23e3defa_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_a27f423ed92a9bd09acce659a23e3defa_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_a27f423ed92a9bd09acce659a23e3defa_icgraph" id="anamespacewriter__federator__mod_a27f423ed92a9bd09acce659a23e3defa_icgraph">
<area shape="rect" title="Registers a pending file write which will be actioned later on." alt="" coords="1416,13,1597,54"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="1223,13,1368,54"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="1008,13,1175,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="809,13,960,54"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,5,761,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,13,536,54"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,20,337,47"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,20,99,47"/>
</map>
</div>

</div>
</div>
<a id="ac4ee4eae0932fe781cc87322c7da4204"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4ee4eae0932fe781cc87322c7da4204">&#9670;&nbsp;</a></span>sort_applicable_time_points()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1map__type.html">map_type</a>) function writer_federator_mod::sort_applicable_time_points </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1map__type.html">map_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>unsorted_timepoints</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sorts the time points based upon their timestep, smallest to largest. Note that this is a bubble sort and as such inefficient, so would be good to change to something else but works OK for now. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">unsorted_timepoints</td><td>The unsorted timepoints, which is changed by destroying the map </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The sorted version of the input map based upon timestep </dd></dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00846">846</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordtype">type</span>(map_type), <span class="keywordtype">intent(inout)</span> :: unsorted_timepoints</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordtype">integer</span> :: i, entries, specific_ts, smallest_ts</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordtype">character(len=STRING_LENGTH)</span> :: smallest_key</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: rvalue</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordtype">type</span>(iterator_type) :: iterator</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordtype">type</span>(mapentry_type) :: map_entry</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    entries=c_size(unsorted_timepoints)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">do</span> i=1, entries</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      smallest_key=<span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      iterator=c_get_iterator(unsorted_timepoints)</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (c_has_next(iterator))</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        map_entry=c_next_mapentry(iterator)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        specific_ts=conv_to_integer(map_entry%key)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keywordflow">if</span> (len_trim(smallest_key) == 0 .or. smallest_ts .gt. specific_ts) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          smallest_ts=specific_ts</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          smallest_key=map_entry%key</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          rvalue=c_get_real(map_entry)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keywordflow">        end if</span>        </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keyword">call </span>c_put_real(sort_applicable_time_points, smallest_key, rvalue)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keyword">call </span>c_remove(unsorted_timepoints, smallest_key)</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keyword">call </span>c_free(unsorted_timepoints)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_ac4ee4eae0932fe781cc87322c7da4204_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_ac4ee4eae0932fe781cc87322c7da4204_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_ac4ee4eae0932fe781cc87322c7da4204_icgraph" id="anamespacewriter__federator__mod_ac4ee4eae0932fe781cc87322c7da4204_icgraph">
<area shape="rect" title="Sorts the time points based upon their timestep, smallest to largest. Note that this is a bubble sort..." alt="" coords="3663,172,3809,228"/>
<area shape="rect" href="namespacewriter__federator__mod.html#af717d0c9b90eb4744fe7bec75086e25d" title="Extracts the applicable time points from the overall map that lie within a specific range." alt="" coords="3471,172,3615,228"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="3279,179,3423,221"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3080,107,3231,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="3083,238,3228,279"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2855,107,3032,163"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2646,133,2801,174"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2419,125,2592,181"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,101,1897,157"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,144,2371,200"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,130,1699,171"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,205,988,246"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,197,761,253"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,205,536,246"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,212,337,239"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,212,99,239"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,144,2156,200"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="2640,238,2807,279"/>
</map>
</div>

</div>
</div>
<a id="acac4d8c09e5e6c8566f9548a71339e7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acac4d8c09e5e6c8566f9548a71339e7b">&#9670;&nbsp;</a></span>write_collective_write_value()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writer_federator_mod::write_collective_write_value </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1data__values__type.html">data_values_type</a>), pointer&#160;</td>
          <td class="paramname"><em>result_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>writer_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>contents_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>lookup_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes the collective values, this is held differently to independent values which are written directly - instead here we need to store the values for each MONC hence a specific type is used instead. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">result_values</td><td>The data values to store </td></tr>
    <tr><td class="paramname">writer_index</td><td>The file writer index </td></tr>
    <tr><td class="paramname">contents_index</td><td>The contents index </td></tr>
    <tr><td class="paramname">source</td><td>The MONC process id </td></tr>
    <tr><td class="paramname">lookup_key</td><td>The values lookup key </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00515">515</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: writer_index, contents_index, source</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordtype">type</span>(data_values_type), <span class="keywordtype">pointer</span> :: result_values</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: lookup_key</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: generic</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordtype">type</span>(write_field_collective_values_type), <span class="keywordtype">pointer</span> :: stored_monc_values</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">if</span> (c_contains(writer_entries(writer_index)%contents(contents_index)%values_to_write, lookup_key)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      generic=&gt;c_get_generic(writer_entries(writer_index)%contents(contents_index)%values_to_write, lookup_key)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">select type</span>(generic)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keywordflow">        type is</span>(write_field_collective_values_type)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;          stored_monc_values=&gt;generic</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keywordflow">      end select</span>      </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keyword">allocate</span>(stored_monc_values)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      generic=&gt;stored_monc_values</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keyword">call </span>c_put_generic(writer_entries(writer_index)%contents(contents_index)%values_to_write, lookup_key, generic, .false.)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    generic=&gt;result_values</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keyword">call </span>c_put_generic(stored_monc_values%monc_values, conv_to_string(source), generic, .false.)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewriter__federator__mod_acac4d8c09e5e6c8566f9548a71339e7b_icgraph.png" border="0" usemap="#anamespacewriter__federator__mod_acac4d8c09e5e6c8566f9548a71339e7b_icgraph" alt=""/></div>
<map name="namespacewriter__federator__mod_acac4d8c09e5e6c8566f9548a71339e7b_icgraph" id="anamespacewriter__federator__mod_acac4d8c09e5e6c8566f9548a71339e7b_icgraph">
<area shape="rect" title="Writes the collective values, this is held differently to independent values which are written direct..." alt="" coords="2419,93,2609,134"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,85,2371,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,85,2156,141"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,85,1897,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,63,1699,105"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,85,1456,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,5,1240,61"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,85,1257,141"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,165,1247,221"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,85,1016,141"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,173,988,214"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,165,761,221"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,173,536,214"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,180,337,207"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,180,99,207"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a81785f80135e4042d82537c054b7681f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81785f80135e4042d82537c054b7681f">&#9670;&nbsp;</a></span>collective_contiguous_initialisation_mutex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, volatile writer_federator_mod::collective_contiguous_initialisation_mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00047">47</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>

</div>
</div>
<a id="aeb3545de2843efed3a4278718c892cbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb3545de2843efed3a4278718c892cbc">&#9670;&nbsp;</a></span>collective_q_field_dims</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), volatile writer_federator_mod::collective_q_field_dims</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00045">45</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>

</div>
</div>
<a id="aeb80206d17d695e7d9faaaa051f1ba6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb80206d17d695e7d9faaaa051f1ba6e">&#9670;&nbsp;</a></span>currently_writing</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical, volatile writer_federator_mod::currently_writing</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00048">48</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">volatile</span> :: currently_writing</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a28ace2d76dc271725853294d7958c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a28ace2d76dc271725853294d7958c2">&#9670;&nbsp;</a></span>currently_writing_mutex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, volatile writer_federator_mod::currently_writing_mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00047">47</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>

</div>
</div>
<a id="a69cc7dea9613ccebe26d24c7166c3e6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69cc7dea9613ccebe26d24c7166c3e6f">&#9670;&nbsp;</a></span>q_field_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), volatile writer_federator_mod::q_field_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00044">44</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>

</div>
</div>
<a id="a52f8619eadb826621b1957fd4daa6b72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52f8619eadb826621b1957fd4daa6b72">&#9670;&nbsp;</a></span>q_field_splits</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), volatile writer_federator_mod::q_field_splits</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00045">45</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>

</div>
</div>
<a id="adc9b7c46ac699da24da779b9c6c009cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc9b7c46ac699da24da779b9c6c009cd">&#9670;&nbsp;</a></span>time_points</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashmap__type.html">hashmap_type</a>), volatile writer_federator_mod::time_points</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00045">45</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">type</span>(hashmap_type), <span class="keywordtype">volatile</span> :: time_points, q_field_splits, collective_q_field_dims</div>
</div><!-- fragment -->
</div>
</div>
<a id="a62ea92c688fb39538620e6ea06fa334f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62ea92c688fb39538620e6ea06fa334f">&#9670;&nbsp;</a></span>time_points_rwlock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, volatile writer_federator_mod::time_points_rwlock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00047">47</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">volatile</span> :: time_points_rwlock, collective_contiguous_initialisation_mutex, currently_writing_mutex</div>
</div><!-- fragment -->
</div>
</div>
<a id="a495ab94021997bb4b9c1f5a982d0b7ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a495ab94021997bb4b9c1f5a982d0b7ca">&#9670;&nbsp;</a></span>used_field_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcollections__mod_1_1hashset__type.html">hashset_type</a>), volatile writer_federator_mod::used_field_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00044">44</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">type</span>(hashset_type), <span class="keywordtype">volatile</span> :: used_field_names, q_field_names</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa54db4af17f9531d20049c38470c41bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa54db4af17f9531d20049c38470c41bb">&#9670;&nbsp;</a></span>writer_entries</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structwriter__types__mod_1_1writer__type.html">writer_type</a>), dimension(:), allocatable, volatile writer_federator_mod::writer_entries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="writer__federator_8F90_source.html#l00043">43</a> of file <a class="el" href="writer__federator_8F90_source.html">writer_federator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">type</span>(writer_type), <span class="keywordtype">volatile</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: writer_entries</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="anamespacelogging__mod_html_ad68309846cd8f9e77edaa6abd02f65a0"><div class="ttname"><a href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">logging_mod::log_error</a></div><div class="ttdeci">integer, parameter, public log_error</div><div class="ttdoc">Only log ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00011">logging.F90:11</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_a10e28447dd10ef9f92d205bc98fb26d3"><div class="ttname"><a href="namespacelogging__mod.html#a10e28447dd10ef9f92d205bc98fb26d3">logging_mod::log_warn</a></div><div class="ttdeci">integer, parameter, public log_warn</div><div class="ttdoc">Log WARNING and ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00012">logging.F90:12</a></div></div>
<div class="ttc" id="anamespacegrids__mod_html_ab478bbfee0dae6b2e13f3a5eb85be214"><div class="ttname"><a href="namespacegrids__mod.html#ab478bbfee0dae6b2e13f3a5eb85be214">grids_mod::x_index</a></div><div class="ttdeci">integer, parameter, public x_index</div><div class="ttdef"><b>Definition:</b> <a href="grids_8F90_source.html#l00014">grids.F90:14</a></div></div>
<div class="ttc" id="anamespacegrids__mod_html_aa0e3f2f5767ed33c4b47a761c2af171a"><div class="ttname"><a href="namespacegrids__mod.html#aa0e3f2f5767ed33c4b47a761c2af171a">grids_mod::y_index</a></div><div class="ttdeci">integer, parameter, public y_index</div><div class="ttdef"><b>Definition:</b> <a href="grids_8F90_source.html#l00014">grids.F90:14</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ac4f13ac385499c85190cb184030e4f45"><div class="ttname"><a href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">logging_mod::log_log</a></div><div class="ttdeci">subroutine, public log_log(level, message, str)</div><div class="ttdoc">Logs a message at the specified level. If the level is above the current level then the message is ig...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00074">logging.F90:75</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ae0d255e756059bc76b2f4291825e59c9"><div class="ttname"><a href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">logging_mod::log_get_logging_level</a></div><div class="ttdeci">integer function, public log_get_logging_level()</div><div class="ttdoc">Retrieves the current logging level.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00121">logging.F90:122</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_aca1c925af27b4d533d548bfe69a819f3"><div class="ttname"><a href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">logging_mod::log_debug</a></div><div class="ttdeci">integer, parameter, public log_debug</div><div class="ttdoc">Log DEBUG, INFO, WARNING and ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00014">logging.F90:14</a></div></div>
<div class="ttc" id="anamespacegrids__mod_html_aa1eee0ed41ef0446ae1a6155b78a2239"><div class="ttname"><a href="namespacegrids__mod.html#aa1eee0ed41ef0446ae1a6155b78a2239">grids_mod::z_index</a></div><div class="ttdeci">integer, parameter, public z_index</div><div class="ttdoc">Grid index parameters.</div><div class="ttdef"><b>Definition:</b> <a href="grids_8F90_source.html#l00014">grids.F90:14</a></div></div>
<div class="ttc" id="anamespacedatadefn__mod_html_a39b79f8cc843d236d3b47f5c81b64368"><div class="ttname"><a href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">datadefn_mod::default_precision</a></div><div class="ttdeci">integer, parameter, public default_precision</div><div class="ttdoc">MPI communication type which we use for the prognostic and calculation data.</div><div class="ttdef"><b>Definition:</b> <a href="datadefn_8F90_source.html#l00017">datadefn.F90:17</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

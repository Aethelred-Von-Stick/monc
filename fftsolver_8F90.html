<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: components/fftsolver/src/fftsolver.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_14910f9db75326eb6d8a1a611cdada77.html">fftsolver</a></li><li class="navelem"><a class="el" href="dir_8fe8ed439dd02c69f2d0353792115d55.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">fftsolver.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="fftsolver_8F90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacefftsolver__mod"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html">fftsolver_mod</a></td></tr>
<tr class="memdesc:namespacefftsolver__mod"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pressure solver which uses a tridiagonal algorithm operating on the pressure terms in Fourier space. It uses the pencil FFT module for 3D FFTs in pencil decomposition. These use FFTW for the actual FFT kernel. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ad219c2d25fc8a8f9353c00f610f37c4b"><td class="memItemLeft" align="right" valign="top">type(component_descriptor_type) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#ad219c2d25fc8a8f9353c00f610f37c4b">fftsolver_mod::fftsolver_get_descriptor</a> ()</td></tr>
<tr class="memdesc:ad219c2d25fc8a8f9353c00f610f37c4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Descriptor of this component for registration.  <a href="namespacefftsolver__mod.html#ad219c2d25fc8a8f9353c00f610f37c4b">More...</a><br /></td></tr>
<tr class="separator:ad219c2d25fc8a8f9353c00f610f37c4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a2b2b221d8792a61e274193534e03bc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a9a2b2b221d8792a61e274193534e03bc">fftsolver_mod::initialisation_callback</a> (current_state)</td></tr>
<tr class="memdesc:a9a2b2b221d8792a61e274193534e03bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This initialisation callback sets up the pencil fft module, allocates data for the fourier space pressure term (might be different size than p) and populates cos x and y.  <a href="namespacefftsolver__mod.html#a9a2b2b221d8792a61e274193534e03bc">More...</a><br /></td></tr>
<tr class="separator:a9a2b2b221d8792a61e274193534e03bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82fe1bd4173b841df2bc7651cefdf4bc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a82fe1bd4173b841df2bc7651cefdf4bc">fftsolver_mod::timestep_callback</a> (current_state)</td></tr>
<tr class="memdesc:a82fe1bd4173b841df2bc7651cefdf4bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestep call back, which will transform to Fourier space, do a tridiagonal solve and then back into time space.  <a href="namespacefftsolver__mod.html#a82fe1bd4173b841df2bc7651cefdf4bc">More...</a><br /></td></tr>
<tr class="separator:a82fe1bd4173b841df2bc7651cefdf4bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdf834d62478f5f7799afdc2847fa587"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#acdf834d62478f5f7799afdc2847fa587">fftsolver_mod::finalisation_callback</a> (current_state)</td></tr>
<tr class="memdesc:acdf834d62478f5f7799afdc2847fa587"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called at MONC finalisation, will call to the pencil fft module to clean itself up and free the pressure term.  <a href="namespacefftsolver__mod.html#acdf834d62478f5f7799afdc2847fa587">More...</a><br /></td></tr>
<tr class="separator:acdf834d62478f5f7799afdc2847fa587"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9a3338a53b29902a27e102983877e94"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#ab9a3338a53b29902a27e102983877e94">fftsolver_mod::complete_psrce_calculation</a> (current_state, y_halo_size, x_halo_size)</td></tr>
<tr class="memdesc:ab9a3338a53b29902a27e102983877e94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Completes the psrce calculation by waiting on all outstanding psrce communications to complete and then combine the received values with the P field for U and V.  <a href="namespacefftsolver__mod.html#ab9a3338a53b29902a27e102983877e94">More...</a><br /></td></tr>
<tr class="separator:ab9a3338a53b29902a27e102983877e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1adca201d5138e9e750fcd7865f6f3e3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a1adca201d5138e9e750fcd7865f6f3e3">fftsolver_mod::tridiagonal_solver</a> (current_state, pressure_term, fourier_space_sizes)</td></tr>
<tr class="memdesc:a1adca201d5138e9e750fcd7865f6f3e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The tridiagonal solver which runs in Fourier space on the pressure terms. Note that because we are going from n reals to n/2+1 complex numbers (and into their reals for this solver) then there might be more data in the pressure term than in p. Therefore use the space sizes which are provided as an argument to this procedure rather than the current state local grid dimensions.  <a href="namespacefftsolver__mod.html#a1adca201d5138e9e750fcd7865f6f3e3">More...</a><br /></td></tr>
<tr class="separator:a1adca201d5138e9e750fcd7865f6f3e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fbc281dc1b4670abbc9713417550bc3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a9fbc281dc1b4670abbc9713417550bc3">fftsolver_mod::copy_p_to_halo_buffer</a> (current_state, neighbour_description, dim, source_index, pid_location, current_page, source_data)</td></tr>
<tr class="memdesc:a9fbc281dc1b4670abbc9713417550bc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the p field data to halo buffers for a specific process in a dimension and halo cell.  <a href="namespacefftsolver__mod.html#a9fbc281dc1b4670abbc9713417550bc3">More...</a><br /></td></tr>
<tr class="separator:a9fbc281dc1b4670abbc9713417550bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b8c3b67d6b172f278aa26f2d5c299c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a50b8c3b67d6b172f278aa26f2d5c299c">fftsolver_mod::copy_halo_buffer_to_p</a> (current_state, neighbour_description, dim, target_index, neighbour_location, current_page, source_data)</td></tr>
<tr class="separator:a50b8c3b67d6b172f278aa26f2d5c299c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ec4b150d4fefc0abd637fe94ce88673"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a9ec4b150d4fefc0abd637fe94ce88673">fftsolver_mod::perform_local_data_copy_for_p</a> (current_state, halo_depth, involve_corners, source_data)</td></tr>
<tr class="memdesc:a9ec4b150d4fefc0abd637fe94ce88673"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does local data copying for P variable halo swap.  <a href="namespacefftsolver__mod.html#a9ec4b150d4fefc0abd637fe94ce88673">More...</a><br /></td></tr>
<tr class="separator:a9ec4b150d4fefc0abd637fe94ce88673"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a93d5691a1baf056c9c68e43a9b658fb7"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a93d5691a1baf056c9c68e43a9b658fb7">fftsolver_mod::cos_x</a></td></tr>
<tr class="separator:a93d5691a1baf056c9c68e43a9b658fb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98154ec2380d2cf1b11926c42f67c1b8"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a98154ec2380d2cf1b11926c42f67c1b8">fftsolver_mod::cos_y</a></td></tr>
<tr class="separator:a98154ec2380d2cf1b11926c42f67c1b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adca03d66144dedfce4256f9dfd28483e"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#adca03d66144dedfce4256f9dfd28483e">fftsolver_mod::pi</a></td></tr>
<tr class="separator:adca03d66144dedfce4256f9dfd28483e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68ad171760478fa0e820addd0bacaa8a"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a68ad171760478fa0e820addd0bacaa8a">fftsolver_mod::pt</a></td></tr>
<tr class="separator:a68ad171760478fa0e820addd0bacaa8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e465fdc8e3066e3ab7e21bc2db80518"><td class="memItemLeft" align="right" valign="top">integer, dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a6e465fdc8e3066e3ab7e21bc2db80518">fftsolver_mod::fourier_space_sizes</a></td></tr>
<tr class="separator:a6e465fdc8e3066e3ab7e21bc2db80518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03eb2dbfcf954511ed750458c5c79680"><td class="memItemLeft" align="right" valign="top">type(halo_communication_type), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefftsolver__mod.html#a03eb2dbfcf954511ed750458c5c79680">fftsolver_mod::halo_swap_state</a></td></tr>
<tr class="separator:a03eb2dbfcf954511ed750458c5c79680"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

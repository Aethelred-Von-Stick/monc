<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: haloswapper_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">haloswapper_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Performs halo swapping. In the parallel case this is between neighbouring processes and in the serial case it still needs to wrap the halos around for the boundary conditions. This module determines the policy of halo swapping (i.e. the fields to communicate) and the halo communication module is used to provide the actual mechanism.  
<a href="namespacehaloswapper__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a72490f0cc37d570074c2306898e71002"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structmonc__component__mod_1_1component__descriptor__type.html">component_descriptor_type</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002">haloswapper_get_descriptor</a> ()</td></tr>
<tr class="memdesc:a72490f0cc37d570074c2306898e71002"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides a description of this component for the core to register.  <a href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002">More...</a><br /></td></tr>
<tr class="separator:a72490f0cc37d570074c2306898e71002"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20dba6765095019c8a311f237d399332"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#a20dba6765095019c8a311f237d399332">initialisation_callback</a> (current_state)</td></tr>
<tr class="memdesc:a20dba6765095019c8a311f237d399332"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation callback hook which will set up the halo swapping state and cache some precalculated data for fast(er) halo swapping at each timestep.  <a href="namespacehaloswapper__mod.html#a20dba6765095019c8a311f237d399332">More...</a><br /></td></tr>
<tr class="separator:a20dba6765095019c8a311f237d399332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fc41ef4805ce22bc046be80aa3cf04a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#a7fc41ef4805ce22bc046be80aa3cf04a">timestep_callback</a> (current_state)</td></tr>
<tr class="memdesc:a7fc41ef4805ce22bc046be80aa3cf04a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestep callback hook which performs the halo swapping for each prognostic field.  <a href="namespacehaloswapper__mod.html#a7fc41ef4805ce22bc046be80aa3cf04a">More...</a><br /></td></tr>
<tr class="separator:a7fc41ef4805ce22bc046be80aa3cf04a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a794242b5be8c350749afa9d837191c12"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#a794242b5be8c350749afa9d837191c12">finalisation_callback</a> (current_state)</td></tr>
<tr class="memdesc:a794242b5be8c350749afa9d837191c12"><td class="mdescLeft">&#160;</td><td class="mdescRight">The finalisation callback hook which will clean up and free the memory associated with the halo swapping.  <a href="namespacehaloswapper__mod.html#a794242b5be8c350749afa9d837191c12">More...</a><br /></td></tr>
<tr class="separator:a794242b5be8c350749afa9d837191c12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea46ae8a52ec0206d24cd4c5aa492a95"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#aea46ae8a52ec0206d24cd4c5aa492a95">copy_halo_buffer_to_corners</a> (current_state, neighbour_description, corner_loc, x_target_index, y_target_index, neighbour_location, current_page, source_data)</td></tr>
<tr class="memdesc:aea46ae8a52ec0206d24cd4c5aa492a95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the halo buffer to halo location in a corner for a halo cell/column and corner location. The copies are performed for each prognostic field.  <a href="namespacehaloswapper__mod.html#aea46ae8a52ec0206d24cd4c5aa492a95">More...</a><br /></td></tr>
<tr class="separator:aea46ae8a52ec0206d24cd4c5aa492a95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afec0137b34ecd74e7d07be2a504aaaa5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#afec0137b34ecd74e7d07be2a504aaaa5">copy_halo_buffer_to_field</a> (current_state, neighbour_description, dim, target_index, neighbour_location, current_page, source_data)</td></tr>
<tr class="memdesc:afec0137b34ecd74e7d07be2a504aaaa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the halo buffer to halo location in a field for a specific dimension and halo cell/column. The copies are performed for each prognostic field.  <a href="namespacehaloswapper__mod.html#afec0137b34ecd74e7d07be2a504aaaa5">More...</a><br /></td></tr>
<tr class="separator:afec0137b34ecd74e7d07be2a504aaaa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3006cc5431fe9b1ce1032e0cfa8e53a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#aa3006cc5431fe9b1ce1032e0cfa8e53a">copy_fields_to_halo_buffer</a> (current_state, neighbour_description, dim, source_index, pid_location, current_page, source_data)</td></tr>
<tr class="memdesc:aa3006cc5431fe9b1ce1032e0cfa8e53a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the prognostic field data to halo buffers for a specific process in a dimension and halo cell.  <a href="namespacehaloswapper__mod.html#aa3006cc5431fe9b1ce1032e0cfa8e53a">More...</a><br /></td></tr>
<tr class="separator:aa3006cc5431fe9b1ce1032e0cfa8e53a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ee10e5097ea1212d606e64b4de47b0c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#a2ee10e5097ea1212d606e64b4de47b0c">copy_corners_to_halo_buffer</a> (current_state, neighbour_description, corner_loc, x_source_index, y_source_index, pid_location, current_page, source_data)</td></tr>
<tr class="memdesc:a2ee10e5097ea1212d606e64b4de47b0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the prognostic corner field data to halo buffers for a specific process in a dimension and halo cell.  <a href="namespacehaloswapper__mod.html#a2ee10e5097ea1212d606e64b4de47b0c">More...</a><br /></td></tr>
<tr class="separator:a2ee10e5097ea1212d606e64b4de47b0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a273d7bb8195fe3a3025a27d1d5a51338"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#a273d7bb8195fe3a3025a27d1d5a51338">get_fields_per_halo_cell</a> (current_state)</td></tr>
<tr class="memdesc:a273d7bb8195fe3a3025a27d1d5a51338"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deduces the number of fields per halo cell. This depends upon what fields are active in the model.  <a href="namespacehaloswapper__mod.html#a273d7bb8195fe3a3025a27d1d5a51338">More...</a><br /></td></tr>
<tr class="separator:a273d7bb8195fe3a3025a27d1d5a51338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab85ff953dbb24e3fec451de9ec066e7d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#ab85ff953dbb24e3fec451de9ec066e7d">display_debugging_info_if_needed</a> (neighbour_counts, included_fields, rank)</td></tr>
<tr class="memdesc:ab85ff953dbb24e3fec451de9ec066e7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Displays some debugging information about who is sending what if that <a class="el" href="namespacelogging__mod.html" title="Logging utility.">logging_mod</a> level is selected.  <a href="namespacehaloswapper__mod.html#ab85ff953dbb24e3fec451de9ec066e7d">More...</a><br /></td></tr>
<tr class="separator:ab85ff953dbb24e3fec451de9ec066e7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a574e9edafcbcfb75368b24553b73dc24"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#a574e9edafcbcfb75368b24553b73dc24">perform_local_data_copy_for_all_prognostics</a> (current_state, halo_depth, involve_corners, source_data)</td></tr>
<tr class="memdesc:a574e9edafcbcfb75368b24553b73dc24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will do any local copying of data required for the boundary conditions. I.e. if all columns in a slice are on a process then it will copy in the y dimension.  <a href="namespacehaloswapper__mod.html#a574e9edafcbcfb75368b24553b73dc24">More...</a><br /></td></tr>
<tr class="separator:a574e9edafcbcfb75368b24553b73dc24"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4fa9945542be498a51bd3787a231fa5a"><td class="memItemLeft" align="right" valign="top">logical, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#a4fa9945542be498a51bd3787a231fa5a">first_call</a> = .true.</td></tr>
<tr class="separator:a4fa9945542be498a51bd3787a231fa5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9554c31d5f88b5e44ef40bbff5184e85"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcommunication__types__mod_1_1halo__communication__type.html">halo_communication_type</a>), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehaloswapper__mod.html#a9554c31d5f88b5e44ef40bbff5184e85">halo_swap_state</a></td></tr>
<tr class="separator:a9554c31d5f88b5e44ef40bbff5184e85"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Performs halo swapping. In the parallel case this is between neighbouring processes and in the serial case it still needs to wrap the halos around for the boundary conditions. This module determines the policy of halo swapping (i.e. the fields to communicate) and the halo communication module is used to provide the actual mechanism. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a2ee10e5097ea1212d606e64b4de47b0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ee10e5097ea1212d606e64b4de47b0c">&#9670;&nbsp;</a></span>copy_corners_to_halo_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine haloswapper_mod::copy_corners_to_halo_buffer </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1neighbour__description__type.html">neighbour_description_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>neighbour_description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>corner_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_source_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>y_source_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>pid_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>current_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1field__data__wrapper__type.html">field_data_wrapper_type</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>source_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copies the prognostic corner field data to halo buffers for a specific process in a dimension and halo cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">neighbour_descriptions</td><td>Description of the neighbour halo swapping status </td></tr>
    <tr><td class="paramname">corner_loc</td><td>Location of the corner </td></tr>
    <tr><td class="paramname">x_source_index</td><td>The X source index of the dimension we are reading from in the prognostic field </td></tr>
    <tr><td class="paramname">y_source_index</td><td>The Y source index of the dimension we are reading from in the prognostic field </td></tr>
    <tr><td class="paramname">pid_location</td><td>Location of the neighbouring process in the local stored data structures </td></tr>
    <tr><td class="paramname">current_page</td><td>The current (next) buffer page to copy into </td></tr>
    <tr><td class="paramname">source_data</td><td>Optional source data which is read from into send buffers and written into by receieve buffers </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00307">307</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: corner_loc, pid_location, x_source_index, y_source_index</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: current_page(:)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">type</span>(neighbour_description_type), <span class="keywordtype">intent(inout)</span> :: neighbour_description</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordtype">type</span>(field_data_wrapper_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: source_data</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">integer</span> :: page_bookmark, i</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    page_bookmark = current_page(pid_location)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">#ifdef U_ACTIVE</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_corner_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;         neighbour_description%send_corner_buffer,&amp;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;         current_state%u%data, corner_loc, x_source_index, y_source_index, page_bookmark)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">call </span>copy_corner_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;         neighbour_description%send_corner_buffer, &amp;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         current_state%zu%data, corner_loc, x_source_index, y_source_index, page_bookmark)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_corner_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;         neighbour_description%send_corner_buffer, &amp;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;         current_state%v%data, corner_loc, x_source_index, y_source_index, page_bookmark)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">call </span>copy_corner_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;         neighbour_description%send_corner_buffer, &amp;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;         current_state%zv%data, corner_loc, x_source_index, y_source_index, page_bookmark)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W_ACTIVE</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_corner_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;         neighbour_description%send_corner_buffer, &amp;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;         current_state%w%data, corner_loc, x_source_index, y_source_index, page_bookmark)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keyword">call </span>copy_corner_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;         neighbour_description%send_corner_buffer, &amp;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         current_state%zw%data, corner_loc, x_source_index, y_source_index, page_bookmark)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keyword">call </span>copy_corner_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;           neighbour_description%send_corner_buffer,&amp;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;           current_state%th%data,  corner_loc, x_source_index, y_source_index, page_bookmark)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keyword">call </span>copy_corner_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;           neighbour_description%send_corner_buffer, &amp;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;           current_state%zth%data, corner_loc, x_source_index, y_source_index, page_bookmark)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">do</span> i=1,current_state%number_q_fields</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">if</span> (current_state%q(i)%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keyword">call </span>copy_corner_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;             neighbour_description%send_corner_buffer, &amp;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;             current_state%q(i)%data, corner_loc, x_source_index, y_source_index, page_bookmark)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keyword">call </span>copy_corner_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;             neighbour_description%send_corner_buffer, &amp;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;             current_state%zq(i)%data, corner_loc, x_source_index, y_source_index, page_bookmark)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        page_bookmark=page_bookmark+1        </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    current_page(pid_location)=page_bookmark</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_a2ee10e5097ea1212d606e64b4de47b0c_icgraph.png" border="0" usemap="#anamespacehaloswapper__mod_a2ee10e5097ea1212d606e64b4de47b0c_icgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_a2ee10e5097ea1212d606e64b4de47b0c_icgraph" id="anamespacehaloswapper__mod_a2ee10e5097ea1212d606e64b4de47b0c_icgraph">
<area shape="rect" title="Copies the prognostic corner field data to halo buffers for a specific process in a dimension and hal..." alt="" coords="491,5,651,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a7fc41ef4805ce22bc046be80aa3cf04a" title="Timestep callback hook which performs the halo swapping for each prognostic field." alt="" coords="260,5,443,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002" title="Provides a description of this component for the core to register." alt="" coords="5,5,212,47"/>
</map>
</div>

</div>
</div>
<a id="aa3006cc5431fe9b1ce1032e0cfa8e53a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3006cc5431fe9b1ce1032e0cfa8e53a">&#9670;&nbsp;</a></span>copy_fields_to_halo_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine haloswapper_mod::copy_fields_to_halo_buffer </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1neighbour__description__type.html">neighbour_description_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>neighbour_description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>pid_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>current_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1field__data__wrapper__type.html">field_data_wrapper_type</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>source_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copies the prognostic field data to halo buffers for a specific process in a dimension and halo cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">neighbour_descriptions</td><td>Description of the neighbour halo swapping status </td></tr>
    <tr><td class="paramname">dim</td><td>Dimension to copy from </td></tr>
    <tr><td class="paramname">source_index</td><td>The source index of the dimension we are reading from in the prognostic field </td></tr>
    <tr><td class="paramname">pid_location</td><td>Location of the neighbouring process in the local stored data structures </td></tr>
    <tr><td class="paramname">current_page</td><td>The current (next) buffer page to copy into </td></tr>
    <tr><td class="paramname">source_data</td><td>Optional source data which is read from into send buffers and written into by receieve buffers </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00231">231</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: dim, pid_location, source_index</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: current_page(:)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">type</span>(neighbour_description_type), <span class="keywordtype">intent(inout)</span> :: neighbour_description</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">type</span>(field_data_wrapper_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: source_data</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">integer</span> :: page_bookmark, i</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    page_bookmark = current_page(pid_location)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#ifdef U_ACTIVE</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, neighbour_description%send_halo_buffer,&amp;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         current_state%u%data, dim, source_index, page_bookmark)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    page_bookmark = page_bookmark + 1</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, neighbour_description%send_halo_buffer, &amp;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         current_state%zu%data, dim, source_index, page_bookmark)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    page_bookmark = page_bookmark + 1</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, neighbour_description%send_halo_buffer, &amp;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;         current_state%v%data, dim, source_index, page_bookmark)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    page_bookmark = page_bookmark + 1</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, neighbour_description%send_halo_buffer, &amp;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;         current_state%zv%data,  dim, source_index, page_bookmark)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    page_bookmark = page_bookmark + 1</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W_ACTIVE</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, neighbour_description%send_halo_buffer, &amp;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;         current_state%w%data, dim, source_index, page_bookmark)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    page_bookmark = page_bookmark+1</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, neighbour_description%send_halo_buffer, &amp;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         current_state%zw%data,  dim, source_index, page_bookmark)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    page_bookmark = page_bookmark+1</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;       <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            neighbour_description%send_halo_buffer, current_state%th%data,  dim, source_index,&amp;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            page_bookmark)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      page_bookmark = page_bookmark+1</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;           neighbour_description%send_halo_buffer, current_state%zth%data, dim, source_index, &amp;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;           page_bookmark)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      page_bookmark = page_bookmark+1</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">do</span> i = 1,current_state%number_q_fields</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;       <span class="keywordflow">if</span> (current_state%q(i)%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;               neighbour_description%send_halo_buffer, current_state%q(i)%data, dim, &amp;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;               source_index, page_bookmark)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          page_bookmark = page_bookmark + 1</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keyword">call </span>copy_field_to_buffer(current_state%local_grid, &amp;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;             neighbour_description%send_halo_buffer, &amp;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;             current_state%zq(i)%data, dim, source_index, page_bookmark)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        page_bookmark = page_bookmark + 1        </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    current_page(pid_location) = page_bookmark</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_aa3006cc5431fe9b1ce1032e0cfa8e53a_icgraph.png" border="0" usemap="#anamespacehaloswapper__mod_aa3006cc5431fe9b1ce1032e0cfa8e53a_icgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_aa3006cc5431fe9b1ce1032e0cfa8e53a_icgraph" id="anamespacehaloswapper__mod_aa3006cc5431fe9b1ce1032e0cfa8e53a_icgraph">
<area shape="rect" title="Copies the prognostic field data to halo buffers for a specific process in a dimension and halo cell." alt="" coords="491,5,651,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a7fc41ef4805ce22bc046be80aa3cf04a" title="Timestep callback hook which performs the halo swapping for each prognostic field." alt="" coords="260,5,443,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002" title="Provides a description of this component for the core to register." alt="" coords="5,5,212,47"/>
</map>
</div>

</div>
</div>
<a id="aea46ae8a52ec0206d24cd4c5aa492a95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea46ae8a52ec0206d24cd4c5aa492a95">&#9670;&nbsp;</a></span>copy_halo_buffer_to_corners()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine haloswapper_mod::copy_halo_buffer_to_corners </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1neighbour__description__type.html">neighbour_description_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>neighbour_description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>corner_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_target_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>y_target_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>neighbour_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>current_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1field__data__wrapper__type.html">field_data_wrapper_type</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>source_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copies the halo buffer to halo location in a corner for a halo cell/column and corner location. The copies are performed for each prognostic field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">neighbour_description</td><td>The halo swapping description of the neighbour we are accessing the buffer of </td></tr>
    <tr><td class="paramname">corner_loc</td><td>The location of the corner </td></tr>
    <tr><td class="paramname">x_target_index</td><td>The target index for the x dimension we are receiving for </td></tr>
    <tr><td class="paramname">y_target_index</td><td>The target index for the y dimension we are receiving for </td></tr>
    <tr><td class="paramname">neighbour_location</td><td>The location in the local neighbour data stores of this neighbour </td></tr>
    <tr><td class="paramname">current_page</td><td>The current, next, halo swap page to read from (all previous have been read and copied already) </td></tr>
    <tr><td class="paramname">source_data</td><td>Optional source data which is read from into send buffers and written into by receieve buffers </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00096">96</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: corner_loc, x_target_index, y_target_index, neighbour_location</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: current_page(:)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">type</span>(neighbour_description_type), <span class="keywordtype">intent(inout)</span> :: neighbour_description</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">type</span>(field_data_wrapper_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: source_data</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">integer</span> :: page_bookmark, i</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    page_bookmark = current_page(neighbour_location)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#ifdef U_ACTIVE</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_buffer_to_corner(current_state%local_grid, neighbour_description%recv_corner_buffer,&amp;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;         current_state%u%data, corner_loc, x_target_index, y_target_index, page_bookmark)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">call </span>copy_buffer_to_corner(current_state%local_grid, neighbour_description%recv_corner_buffer, &amp;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;         current_state%zu%data, corner_loc, x_target_index, y_target_index, page_bookmark)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_buffer_to_corner(current_state%local_grid, neighbour_description%recv_corner_buffer, &amp;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;         current_state%v%data, corner_loc, x_target_index, y_target_index, page_bookmark)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">call </span>copy_buffer_to_corner(current_state%local_grid, neighbour_description%recv_corner_buffer, &amp;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;         current_state%zv%data, corner_loc, x_target_index, y_target_index, page_bookmark)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W_ACTIVE</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_buffer_to_corner(current_state%local_grid, neighbour_description%recv_corner_buffer, &amp;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;         current_state%w%data, corner_loc, x_target_index, y_target_index, page_bookmark)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">call </span>copy_buffer_to_corner(current_state%local_grid, neighbour_description%recv_corner_buffer, &amp;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;         current_state%zw%data, corner_loc, x_target_index, y_target_index, page_bookmark)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keyword">call </span>copy_buffer_to_corner(current_state%local_grid, neighbour_description%recv_corner_buffer, &amp;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;           current_state%th%data, corner_loc, x_target_index, y_target_index, page_bookmark)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keyword">call </span>copy_buffer_to_corner(current_state%local_grid, neighbour_description%recv_corner_buffer, &amp;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;           current_state%zth%data, corner_loc, x_target_index, y_target_index, page_bookmark)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">do</span> i=1,current_state%number_q_fields</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">if</span> (current_state%q(i)%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keyword">call </span>copy_buffer_to_corner(current_state%local_grid, neighbour_description%recv_corner_buffer, &amp;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;             current_state%q(i)%data, corner_loc, x_target_index, y_target_index, page_bookmark)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        page_bookmark=page_bookmark + 1</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keyword">call </span>copy_buffer_to_corner(current_state%local_grid, neighbour_description%recv_corner_buffer, &amp;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;             current_state%zq(i)%data, corner_loc, x_target_index, y_target_index, page_bookmark)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        page_bookmark=page_bookmark + 1        </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    current_page(neighbour_location)=page_bookmark</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_aea46ae8a52ec0206d24cd4c5aa492a95_icgraph.png" border="0" usemap="#anamespacehaloswapper__mod_aea46ae8a52ec0206d24cd4c5aa492a95_icgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_aea46ae8a52ec0206d24cd4c5aa492a95_icgraph" id="anamespacehaloswapper__mod_aea46ae8a52ec0206d24cd4c5aa492a95_icgraph">
<area shape="rect" title="Copies the halo buffer to halo location in a corner for a halo cell/column and corner location...." alt="" coords="491,5,651,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a7fc41ef4805ce22bc046be80aa3cf04a" title="Timestep callback hook which performs the halo swapping for each prognostic field." alt="" coords="260,5,443,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002" title="Provides a description of this component for the core to register." alt="" coords="5,5,212,47"/>
</map>
</div>

</div>
</div>
<a id="afec0137b34ecd74e7d07be2a504aaaa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afec0137b34ecd74e7d07be2a504aaaa5">&#9670;&nbsp;</a></span>copy_halo_buffer_to_field()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine haloswapper_mod::copy_halo_buffer_to_field </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1neighbour__description__type.html">neighbour_description_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>neighbour_description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>target_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>neighbour_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>current_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1field__data__wrapper__type.html">field_data_wrapper_type</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>source_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copies the halo buffer to halo location in a field for a specific dimension and halo cell/column. The copies are performed for each prognostic field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">neighbour_description</td><td>The halo swapping description of the neighbour we are accessing the buffer of </td></tr>
    <tr><td class="paramname">dim</td><td>The dimension we receive for </td></tr>
    <tr><td class="paramname">target_index</td><td>The target index for the dimension we are receiving for </td></tr>
    <tr><td class="paramname">neighbour_location</td><td>The location in the local neighbour data stores of this neighbour </td></tr>
    <tr><td class="paramname">current_page</td><td>The current, next, halo swap page to read from (all previous have been read and copied already) </td></tr>
    <tr><td class="paramname">source_data</td><td>Optional source data which is read from into send buffers and written into by receieve buffers </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00164">164</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: dim, target_index, neighbour_location</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: current_page(:)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">type</span>(neighbour_description_type), <span class="keywordtype">intent(inout)</span> :: neighbour_description</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">type</span>(field_data_wrapper_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: source_data</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">integer</span> :: page_bookmark, i</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    page_bookmark = current_page(neighbour_location)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#ifdef U_ACTIVE</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, &amp;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;         current_state%u%data,  dim, target_index, page_bookmark)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, &amp;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;         current_state%zu%data, dim, target_index, page_bookmark)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, &amp;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;         current_state%v%data, dim, target_index, page_bookmark)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, &amp;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;         current_state%zv%data, dim, target_index, page_bookmark)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W_ACTIVE</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, &amp;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;         current_state%w%data, dim, target_index, page_bookmark)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, &amp;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;         current_state%zw%data, dim, target_index, page_bookmark)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;       <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, &amp;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            current_state%th%data, dim, target_index, page_bookmark)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;       page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;       <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, &amp;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            current_state%zth%data, dim, target_index, page_bookmark)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;       page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">do</span> i=1,current_state%number_q_fields</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;       <span class="keywordflow">if</span> (current_state%q(i)%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, &amp;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;               current_state%q(i)%data, dim, target_index, page_bookmark)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          page_bookmark=page_bookmark+1</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          <span class="keyword">call </span>copy_buffer_to_field(current_state%local_grid, neighbour_description%recv_halo_buffer, &amp;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;               current_state%zq(i)%data, dim, target_index, page_bookmark)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          page_bookmark=page_bookmark+1        </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordflow">       end if</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    current_page(neighbour_location)=page_bookmark</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_afec0137b34ecd74e7d07be2a504aaaa5_icgraph.png" border="0" usemap="#anamespacehaloswapper__mod_afec0137b34ecd74e7d07be2a504aaaa5_icgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_afec0137b34ecd74e7d07be2a504aaaa5_icgraph" id="anamespacehaloswapper__mod_afec0137b34ecd74e7d07be2a504aaaa5_icgraph">
<area shape="rect" title="Copies the halo buffer to halo location in a field for a specific dimension and halo cell/column...." alt="" coords="491,5,651,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a7fc41ef4805ce22bc046be80aa3cf04a" title="Timestep callback hook which performs the halo swapping for each prognostic field." alt="" coords="260,5,443,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002" title="Provides a description of this component for the core to register." alt="" coords="5,5,212,47"/>
</map>
</div>

</div>
</div>
<a id="ab85ff953dbb24e3fec451de9ec066e7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab85ff953dbb24e3fec451de9ec066e7d">&#9670;&nbsp;</a></span>display_debugging_info_if_needed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine haloswapper_mod::display_debugging_info_if_needed </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>neighbour_counts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>included_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>rank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Displays some debugging information about who is sending what if that <a class="el" href="namespacelogging__mod.html" title="Logging utility.">logging_mod</a> level is selected. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">neighbour_counts</td><td>Number of neighbours that I have </td></tr>
    <tr><td class="paramname">included_fields</td><td>Number of prognostic fields that we include in this halo swap </td></tr>
    <tr><td class="paramname">rank</td><td>My current rank </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00407">407</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: neighbour_counts, rank, included_fields</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span> (.not. first_call .or. <a class="code" href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">log_get_logging_level</a>() .lt. <a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">log_debug</a>, <span class="stringliteral">&quot;Rank &quot;</span>//trim(conv_to_string(rank))//<span class="stringliteral">&quot;: &quot;</span>//trim(conv_to_string(neighbour_counts))//&amp;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;         <span class="stringliteral">&quot; neighbours per timestep over &quot;</span>//trim(conv_to_string(included_fields))//<span class="stringliteral">&quot; fields&quot;</span>)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    first_call = .false.</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_ab85ff953dbb24e3fec451de9ec066e7d_icgraph.png" border="0" usemap="#anamespacehaloswapper__mod_ab85ff953dbb24e3fec451de9ec066e7d_icgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_ab85ff953dbb24e3fec451de9ec066e7d_icgraph" id="anamespacehaloswapper__mod_ab85ff953dbb24e3fec451de9ec066e7d_icgraph">
<area shape="rect" title="Displays some debugging information about who is sending what if that logging_mod level is selected." alt="" coords="491,5,669,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a7fc41ef4805ce22bc046be80aa3cf04a" title="Timestep callback hook which performs the halo swapping for each prognostic field." alt="" coords="260,5,443,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002" title="Provides a description of this component for the core to register." alt="" coords="5,5,212,47"/>
</map>
</div>

</div>
</div>
<a id="a794242b5be8c350749afa9d837191c12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a794242b5be8c350749afa9d837191c12">&#9670;&nbsp;</a></span>finalisation_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine haloswapper_mod::finalisation_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The finalisation callback hook which will clean up and free the memory associated with the halo swapping. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00076">76</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">call </span>finalise_halo_communication(halo_swap_state)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_a794242b5be8c350749afa9d837191c12_icgraph.png" border="0" usemap="#anamespacehaloswapper__mod_a794242b5be8c350749afa9d837191c12_icgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_a794242b5be8c350749afa9d837191c12_icgraph" id="anamespacehaloswapper__mod_a794242b5be8c350749afa9d837191c12_icgraph">
<area shape="rect" title="The finalisation callback hook which will clean up and free the memory associated with the halo swapp..." alt="" coords="260,5,455,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002" title="Provides a description of this component for the core to register." alt="" coords="5,5,212,47"/>
</map>
</div>

</div>
</div>
<a id="a273d7bb8195fe3a3025a27d1d5a51338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a273d7bb8195fe3a3025a27d1d5a51338">&#9670;&nbsp;</a></span>get_fields_per_halo_cell()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function haloswapper_mod::get_fields_per_halo_cell </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deduces the number of fields per halo cell. This depends upon what fields are active in the model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00377">377</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    get_fields_per_halo_cell=0</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">#ifdef U_ACTIVE</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor"></span>    get_fields_per_halo_cell=get_fields_per_halo_cell+2</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor"></span>    get_fields_per_halo_cell=get_fields_per_halo_cell+2</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W_ACTIVE</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor"></span>    get_fields_per_halo_cell=get_fields_per_halo_cell+2</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      get_fields_per_halo_cell=get_fields_per_halo_cell+2</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordflow">    end if</span>    </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">do</span> i=1,current_state%number_q_fields</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="keywordflow">if</span> (current_state%q(i)%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        get_fields_per_halo_cell=get_fields_per_halo_cell+2</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_a273d7bb8195fe3a3025a27d1d5a51338_icgraph.png" border="0" usemap="#anamespacehaloswapper__mod_a273d7bb8195fe3a3025a27d1d5a51338_icgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_a273d7bb8195fe3a3025a27d1d5a51338_icgraph" id="anamespacehaloswapper__mod_a273d7bb8195fe3a3025a27d1d5a51338_icgraph">
<area shape="rect" title="Deduces the number of fields per halo cell. This depends upon what fields are active in the model." alt="" coords="509,5,660,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a20dba6765095019c8a311f237d399332" title="Initialisation callback hook which will set up the halo swapping state and cache some precalculated d..." alt="" coords="260,5,461,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002" title="Provides a description of this component for the core to register." alt="" coords="5,5,212,47"/>
</map>
</div>

</div>
</div>
<a id="a72490f0cc37d570074c2306898e71002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72490f0cc37d570074c2306898e71002">&#9670;&nbsp;</a></span>haloswapper_get_descriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structmonc__component__mod_1_1component__descriptor__type.html">component_descriptor_type</a>) function, public haloswapper_mod::haloswapper_get_descriptor</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provides a description of this component for the core to register. </p>
<dl class="section return"><dt>Returns</dt><dd>The descriptor containing registration information for this component </dd></dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00036">36</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    haloswapper_get_descriptor%name=<span class="stringliteral">&quot;halo_swapper&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    haloswapper_get_descriptor%version=0.1</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    haloswapper_get_descriptor%initialisation=&gt;initialisation_callback</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    haloswapper_get_descriptor%timestep=&gt;timestep_callback</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    haloswapper_get_descriptor%finalisation=&gt;finalisation_callback</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_a72490f0cc37d570074c2306898e71002_cgraph.png" border="0" usemap="#anamespacehaloswapper__mod_a72490f0cc37d570074c2306898e71002_cgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_a72490f0cc37d570074c2306898e71002_cgraph" id="anamespacehaloswapper__mod_a72490f0cc37d570074c2306898e71002_cgraph">
<area shape="rect" title="Provides a description of this component for the core to register." alt="" coords="5,71,212,112"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a794242b5be8c350749afa9d837191c12" title="The finalisation callback hook which will clean up and free the memory associated with the halo swapp..." alt="" coords="263,5,458,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a20dba6765095019c8a311f237d399332" title="Initialisation callback hook which will set up the halo swapping state and cache some precalculated d..." alt="" coords="260,71,461,112"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a7fc41ef4805ce22bc046be80aa3cf04a" title="Timestep callback hook which performs the halo swapping for each prognostic field." alt="" coords="269,201,452,243"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a273d7bb8195fe3a3025a27d1d5a51338" title="Deduces the number of fields per halo cell. This depends upon what fields are active in the model." alt="" coords="523,5,674,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a2ee10e5097ea1212d606e64b4de47b0c" title="Copies the prognostic corner field data to halo buffers for a specific process in a dimension and hal..." alt="" coords="519,71,679,112"/>
<area shape="rect" href="namespacehaloswapper__mod.html#aa3006cc5431fe9b1ce1032e0cfa8e53a" title="Copies the prognostic field data to halo buffers for a specific process in a dimension and halo cell." alt="" coords="519,136,679,177"/>
<area shape="rect" href="namespacehaloswapper__mod.html#aea46ae8a52ec0206d24cd4c5aa492a95" title="Copies the halo buffer to halo location in a corner for a halo cell/column and corner location...." alt="" coords="519,201,679,243"/>
<area shape="rect" href="namespacehaloswapper__mod.html#afec0137b34ecd74e7d07be2a504aaaa5" title="Copies the halo buffer to halo location in a field for a specific dimension and halo cell/column...." alt="" coords="519,267,679,308"/>
<area shape="rect" href="namespacehaloswapper__mod.html#ab85ff953dbb24e3fec451de9ec066e7d" title="Displays some debugging information about who is sending what if that logging_mod level is selected." alt="" coords="509,332,688,373"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a574e9edafcbcfb75368b24553b73dc24" title="Will do any local copying of data required for the boundary conditions. I.e. if all columns in a slic..." alt="" coords="510,397,687,453"/>
</map>
</div>

</div>
</div>
<a id="a20dba6765095019c8a311f237d399332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20dba6765095019c8a311f237d399332">&#9670;&nbsp;</a></span>initialisation_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine haloswapper_mod::initialisation_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialisation callback hook which will set up the halo swapping state and cache some precalculated data for fast(er) halo swapping at each timestep. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00047">47</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">integer</span> :: halo_depth</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">! get halo_depth and pass it to the halo_swapping routines</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    halo_depth = options_get_integer(current_state%options_database, <span class="stringliteral">&quot;halo_depth&quot;</span>)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">call </span>init_halo_communication(current_state, get_fields_per_halo_cell, halo_swap_state, &amp;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;         halo_depth, .true.)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_a20dba6765095019c8a311f237d399332_cgraph.png" border="0" usemap="#anamespacehaloswapper__mod_a20dba6765095019c8a311f237d399332_cgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_a20dba6765095019c8a311f237d399332_cgraph" id="anamespacehaloswapper__mod_a20dba6765095019c8a311f237d399332_cgraph">
<area shape="rect" title="Initialisation callback hook which will set up the halo swapping state and cache some precalculated d..." alt="" coords="5,5,207,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a273d7bb8195fe3a3025a27d1d5a51338" title="Deduces the number of fields per halo cell. This depends upon what fields are active in the model." alt="" coords="255,5,405,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_a20dba6765095019c8a311f237d399332_icgraph.png" border="0" usemap="#anamespacehaloswapper__mod_a20dba6765095019c8a311f237d399332_icgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_a20dba6765095019c8a311f237d399332_icgraph" id="anamespacehaloswapper__mod_a20dba6765095019c8a311f237d399332_icgraph">
<area shape="rect" title="Initialisation callback hook which will set up the halo swapping state and cache some precalculated d..." alt="" coords="260,5,461,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002" title="Provides a description of this component for the core to register." alt="" coords="5,5,212,47"/>
</map>
</div>

</div>
</div>
<a id="a574e9edafcbcfb75368b24553b73dc24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a574e9edafcbcfb75368b24553b73dc24">&#9670;&nbsp;</a></span>perform_local_data_copy_for_all_prognostics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine haloswapper_mod::perform_local_data_copy_for_all_prognostics </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>halo_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>involve_corners</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcommunication__types__mod_1_1field__data__wrapper__type.html">field_data_wrapper_type</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>source_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will do any local copying of data required for the boundary conditions. I.e. if all columns in a slice are on a process then it will copy in the y dimension. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model <a class="el" href="namespacestate__mod.html" title="The model state which represents the current state of a run.">state_mod</a> </td></tr>
    <tr><td class="paramname">copy_counts</td><td>Number of local copies performed </td></tr>
    <tr><td class="paramname">source_data</td><td>Optional source data which is read from into send buffers and written into by receieve buffers </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00422">422</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: halo_depth</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: involve_corners</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">type</span>(field_data_wrapper_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: source_data</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">#ifdef U_ACTIVE</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%u%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;         current_state%parallel%my_rank, halo_depth, involve_corners)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%zu%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;         current_state%parallel%my_rank, halo_depth, involve_corners)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor">#endif    </span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%v%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         current_state%parallel%my_rank, halo_depth, involve_corners)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%zv%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;         current_state%parallel%my_rank, halo_depth, involve_corners)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W_ACTIVE</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%w%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;         current_state%parallel%my_rank, halo_depth, involve_corners)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%zw%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;         current_state%parallel%my_rank, halo_depth, involve_corners)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%th%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;           current_state%parallel%my_rank, halo_depth, involve_corners)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%zth%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;           current_state%parallel%my_rank, halo_depth, involve_corners)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">do</span> i=1,current_state%number_q_fields</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordflow">if</span> (current_state%q(i)%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%q(i)%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;             current_state%parallel%my_rank, halo_depth, involve_corners)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keyword">call </span>perform_local_data_copy_for_field(current_state%zq(i)%data, current_state%local_grid, &amp;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;             current_state%parallel%my_rank, halo_depth, involve_corners)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_a574e9edafcbcfb75368b24553b73dc24_icgraph.png" border="0" usemap="#anamespacehaloswapper__mod_a574e9edafcbcfb75368b24553b73dc24_icgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_a574e9edafcbcfb75368b24553b73dc24_icgraph" id="anamespacehaloswapper__mod_a574e9edafcbcfb75368b24553b73dc24_icgraph">
<area shape="rect" title="Will do any local copying of data required for the boundary conditions. I.e. if all columns in a slic..." alt="" coords="491,5,668,61"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a7fc41ef4805ce22bc046be80aa3cf04a" title="Timestep callback hook which performs the halo swapping for each prognostic field." alt="" coords="260,13,443,54"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002" title="Provides a description of this component for the core to register." alt="" coords="5,13,212,54"/>
</map>
</div>

</div>
</div>
<a id="a7fc41ef4805ce22bc046be80aa3cf04a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fc41ef4805ce22bc046be80aa3cf04a">&#9670;&nbsp;</a></span>timestep_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine haloswapper_mod::timestep_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Timestep callback hook which performs the halo swapping for each prognostic field. </p>
<p>In parallel this is performed with MPI communication calls and wrapping around. In serial still need to wrap data around </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model <a class="el" href="namespacestate__mod.html" title="The model state which represents the current state of a run.">state_mod</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00062">62</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">call </span>blocking_halo_swap(current_state, halo_swap_state, copy_fields_to_halo_buffer, &amp;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         perform_local_data_copy_for_all_prognostics, copy_halo_buffer_to_field, &amp;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;         copy_corners_to_halo_buffer, copy_halo_buffer_to_corners)    </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">call </span>display_debugging_info_if_needed(halo_swap_state%number_distinct_neighbours, &amp;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;         halo_swap_state%fields_per_cell, current_state%parallel%my_rank)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_a7fc41ef4805ce22bc046be80aa3cf04a_cgraph.png" border="0" usemap="#anamespacehaloswapper__mod_a7fc41ef4805ce22bc046be80aa3cf04a_cgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_a7fc41ef4805ce22bc046be80aa3cf04a_cgraph" id="anamespacehaloswapper__mod_a7fc41ef4805ce22bc046be80aa3cf04a_cgraph">
<area shape="rect" title="Timestep callback hook which performs the halo swapping for each prognostic field." alt="" coords="5,169,188,211"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a2ee10e5097ea1212d606e64b4de47b0c" title="Copies the prognostic corner field data to halo buffers for a specific process in a dimension and hal..." alt="" coords="245,5,405,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#aa3006cc5431fe9b1ce1032e0cfa8e53a" title="Copies the prognostic field data to halo buffers for a specific process in a dimension and halo cell." alt="" coords="245,71,405,112"/>
<area shape="rect" href="namespacehaloswapper__mod.html#aea46ae8a52ec0206d24cd4c5aa492a95" title="Copies the halo buffer to halo location in a corner for a halo cell/column and corner location...." alt="" coords="245,136,405,177"/>
<area shape="rect" href="namespacehaloswapper__mod.html#afec0137b34ecd74e7d07be2a504aaaa5" title="Copies the halo buffer to halo location in a field for a specific dimension and halo cell/column...." alt="" coords="245,201,405,243"/>
<area shape="rect" href="namespacehaloswapper__mod.html#ab85ff953dbb24e3fec451de9ec066e7d" title="Displays some debugging information about who is sending what if that logging_mod level is selected." alt="" coords="236,267,415,308"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a574e9edafcbcfb75368b24553b73dc24" title="Will do any local copying of data required for the boundary conditions. I.e. if all columns in a slic..." alt="" coords="237,331,414,387"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacehaloswapper__mod_a7fc41ef4805ce22bc046be80aa3cf04a_icgraph.png" border="0" usemap="#anamespacehaloswapper__mod_a7fc41ef4805ce22bc046be80aa3cf04a_icgraph" alt=""/></div>
<map name="namespacehaloswapper__mod_a7fc41ef4805ce22bc046be80aa3cf04a_icgraph" id="anamespacehaloswapper__mod_a7fc41ef4805ce22bc046be80aa3cf04a_icgraph">
<area shape="rect" title="Timestep callback hook which performs the halo swapping for each prognostic field." alt="" coords="260,5,443,47"/>
<area shape="rect" href="namespacehaloswapper__mod.html#a72490f0cc37d570074c2306898e71002" title="Provides a description of this component for the core to register." alt="" coords="5,5,212,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4fa9945542be498a51bd3787a231fa5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fa9945542be498a51bd3787a231fa5a">&#9670;&nbsp;</a></span>first_call</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical, private haloswapper_mod::first_call = .true.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00027">27</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">private</span> :: first_call = .true. </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9554c31d5f88b5e44ef40bbff5184e85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9554c31d5f88b5e44ef40bbff5184e85">&#9670;&nbsp;</a></span>halo_swap_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcommunication__types__mod_1_1halo__communication__type.html">halo_communication_type</a>), save haloswapper_mod::halo_swap_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="haloswapper_8F90_source.html#l00028">28</a> of file <a class="el" href="haloswapper_8F90_source.html">haloswapper.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">type</span>(halo_communication_type), <span class="keywordtype">save</span> :: halo_swap_state</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="anamespacelogging__mod_html_ac4f13ac385499c85190cb184030e4f45"><div class="ttname"><a href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">logging_mod::log_log</a></div><div class="ttdeci">subroutine, public log_log(level, message, str)</div><div class="ttdoc">Logs a message at the specified level. If the level is above the current level then the message is ig...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00074">logging.F90:75</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ae0d255e756059bc76b2f4291825e59c9"><div class="ttname"><a href="namespacelogging__mod.html#ae0d255e756059bc76b2f4291825e59c9">logging_mod::log_get_logging_level</a></div><div class="ttdeci">integer function, public log_get_logging_level()</div><div class="ttdoc">Retrieves the current logging level.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00121">logging.F90:122</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_aca1c925af27b4d533d548bfe69a819f3"><div class="ttname"><a href="namespacelogging__mod.html#aca1c925af27b4d533d548bfe69a819f3">logging_mod::log_debug</a></div><div class="ttdeci">integer, parameter, public log_debug</div><div class="ttdoc">Log DEBUG, INFO, WARNING and ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00014">logging.F90:14</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

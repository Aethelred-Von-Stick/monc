<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: pencil_fft_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pencil_fft_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This Pencil FFT performs 3D forward and backwards FFTs using pencil decomposition. It uses FFTW for the actual FFT kernel and this module contains all the data decomposition around this. There is no FFT required in Z, so this performs FFTs in Y and X (in that order forward and reversed backwards.) The data decomposition is the complex aspect, there is the concept of forward and backwards transformations. Forward transformations will go from pencil Z to Y to X and the backwards transformations undo these, so go from X to Y to Z. Note that we use quite a lot of buffer space here, this could be cut down if Y=X dimensions so some optimisation on memory could be done there in that case.  
<a href="namespacepencil__fft__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes a specific pencil transposition, from one pencil decomposition to another.  <a href="structpencil__fft__mod_1_1pencil__transposition.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a3a8be214eb145cf54faebb0882867780"><td class="memItemLeft" align="right" valign="top">integer function, dimension(3), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780">initialise_pencil_fft</a> (current_state, my_y_start, my_x_start)</td></tr>
<tr class="memdesc:a3a8be214eb145cf54faebb0882867780"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the pencil FFT functionality, this will create the transposition structures needed.  <a href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780">More...</a><br /></td></tr>
<tr class="separator:a3a8be214eb145cf54faebb0882867780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66821a0d5916d7197f851168915601da"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a66821a0d5916d7197f851168915601da">finalise_pencil_fft</a> (monc_communicator)</td></tr>
<tr class="memdesc:a66821a0d5916d7197f851168915601da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleans up allocated buffer memory.  <a href="namespacepencil__fft__mod.html#a66821a0d5916d7197f851168915601da">More...</a><br /></td></tr>
<tr class="separator:a66821a0d5916d7197f851168915601da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b24719dcfb0852d350e2b0ba944b4c3"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3">perform_forward_3dfft</a> (current_state, source_data, target_data)</td></tr>
<tr class="memdesc:a2b24719dcfb0852d350e2b0ba944b4c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil Note that the source_data here takes no account for the halo, it is up to caller to exclude this. This does no FFT in Z, but transposes to Y, does FFT in Y, then transposes to X and performs an FFT in that dimension. Pencil decomposition is used which has already been set up.  <a href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3">More...</a><br /></td></tr>
<tr class="separator:a2b24719dcfb0852d350e2b0ba944b4c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac660508af65a49c11776c1c09306a27d"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d">perform_backwards_3dfft</a> (current_state, source_data, target_data)</td></tr>
<tr class="memdesc:ac660508af65a49c11776c1c09306a27d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a backwards 3D FFT and currently results in target data which is the X, Z, Y oriented pencil Note that the source_data here takes no account for the halo, it is up to caller to exclude this. This does no FFT in Z, but transposes to Y, does FFT in Y, then transposes to X and performs an FFT in that dimension. Pencil decomposition is used which has already been set up.  <a href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d">More...</a><br /></td></tr>
<tr class="separator:ac660508af65a49c11776c1c09306a27d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05c54fc0d0ea9e0fc68f507451e41b4a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a05c54fc0d0ea9e0fc68f507451e41b4a">initialise_buffers</a> ()</td></tr>
<tr class="memdesc:a05c54fc0d0ea9e0fc68f507451e41b4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises memory for the buffers used in the FFT.  <a href="namespacepencil__fft__mod.html#a05c54fc0d0ea9e0fc68f507451e41b4a">More...</a><br /></td></tr>
<tr class="separator:a05c54fc0d0ea9e0fc68f507451e41b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a744b6c045c8620f598f3ebc5bb714611"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611">initialise_transpositions</a> (current_state, y_distinct_sizes, x_distinct_sizes)</td></tr>
<tr class="memdesc:a744b6c045c8620f598f3ebc5bb714611"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the pencil transpositions, from a pencil in one dimension to that in another.  <a href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611">More...</a><br /></td></tr>
<tr class="separator:a744b6c045c8620f598f3ebc5bb714611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a941fec4c35a74d0702d01b1747604c44"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44">create_transposition</a> (global_grid, existing_transposition, new_pencil_dim, process_dim_sizes, direction, extended_dimensions)</td></tr>
<tr class="memdesc:a941fec4c35a74d0702d01b1747604c44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a specific pencil transposition description. It is maybe more a decomposition description, but the main complexity comes from the transposition from existing decomposition to new decomposition so therefore it is called transposition. The new pencil decomposition depends not only on the dimension to split on, but also the existing pencil decomposition. The new decomposed dimension (i.e. the existing pencil dimension) * other local dimensions is used as the sending size, receiving though requires knowledge about the data size on the source process so others will send their pencil dimension size to this process.  <a href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44">More...</a><br /></td></tr>
<tr class="separator:a941fec4c35a74d0702d01b1747604c44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a62a605e5f0883c5b602c004057c6e0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a7a62a605e5f0883c5b602c004057c6e0">transpose_and_forward_fft_in_y</a> (current_state, source_data, buffer, real_buffer)</td></tr>
<tr class="memdesc:a7a62a605e5f0883c5b602c004057c6e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the transposition and forward FFT in the y dimension then converts back to real numbers. The Y size is (n/2+1)*2 due to the complex to real transformation after the FFT.  <a href="namespacepencil__fft__mod.html#a7a62a605e5f0883c5b602c004057c6e0">More...</a><br /></td></tr>
<tr class="separator:a7a62a605e5f0883c5b602c004057c6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ac39a07dabfdc3f4e92d30f132d54b0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a7ac39a07dabfdc3f4e92d30f132d54b0">transpose_and_backward_fft_in_x</a> (current_state, source_data, buffer, real_buffer)</td></tr>
<tr class="memdesc:a7ac39a07dabfdc3f4e92d30f132d54b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers which are converted to real, so the this real to complex operation is performed first. If n is the logical size of the FFT row, then the input size is n+2, complex number size is n/2+1 and we get n reals out.  <a href="namespacepencil__fft__mod.html#a7ac39a07dabfdc3f4e92d30f132d54b0">More...</a><br /></td></tr>
<tr class="separator:a7ac39a07dabfdc3f4e92d30f132d54b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7220fe79f6726da7415f9a2d21d1c5e4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a7220fe79f6726da7415f9a2d21d1c5e4">transpose_and_forward_fft_in_x</a> (current_state, <a class="el" href="namespacepencil__fft__mod.html#ad45550f0e5167714f28c90395efb48e9">buffer1</a>, <a class="el" href="namespacepencil__fft__mod.html#a06aecd5ad3ce78e68c9da759680bb5e9">buffer2</a>, buffer3)</td></tr>
<tr class="memdesc:a7220fe79f6726da7415f9a2d21d1c5e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is converted back into real numbers. The X size is (n/2+1)*2 due to this transformation.  <a href="namespacepencil__fft__mod.html#a7220fe79f6726da7415f9a2d21d1c5e4">More...</a><br /></td></tr>
<tr class="separator:a7220fe79f6726da7415f9a2d21d1c5e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b3bf23fee2dd253f9d48ab8962740a8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a6b3bf23fee2dd253f9d48ab8962740a8">transpose_and_backward_fft_in_y</a> (current_state, source_data, buffer, real_buffer)</td></tr>
<tr class="memdesc:a6b3bf23fee2dd253f9d48ab8962740a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers which are converted to real, so the this real to complex operation is performed first. If n is the logical size of the FFT row, then the input size is n+2, complex number size is n/2+1 and we get n reals out.  <a href="namespacepencil__fft__mod.html#a6b3bf23fee2dd253f9d48ab8962740a8">More...</a><br /></td></tr>
<tr class="separator:a6b3bf23fee2dd253f9d48ab8962740a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc5c609ef121c225f7c126d72e558971"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971">transpose_to_pencil</a> (transposition_description, source_dims, communicator, direction, source_data, target_data)</td></tr>
<tr class="memdesc:adc5c609ef121c225f7c126d72e558971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transposes globally to a new pencil decomposition. This goes from the source dimensions a,b,c to b,c,a (forwards) or c,a,b (backwards.) It requires multiple steps, first the local data is transposed to c,b,a regardless of direction. then it is communicated via alltoall, each process then assembles its own b,c,a or c,a,b data via contiguising across blocks as the data layout is nonlinear.  <a href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971">More...</a><br /></td></tr>
<tr class="separator:adc5c609ef121c225f7c126d72e558971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2d228c34a44953affd43f778430c494"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494">contiguise_data</a> (transposition_description, source_dims, direction, source_real_buffer, target_real_buffer)</td></tr>
<tr class="memdesc:ac2d228c34a44953affd43f778430c494"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source_dims argument. It is not as simple as just swapping the required dimensions, as this is after the mpi alltoall and each block lies after the previous block running sequentially in a.  <a href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494">More...</a><br /></td></tr>
<tr class="separator:ac2d228c34a44953affd43f778430c494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb17647074e35c11160a1dc235fbe155"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#adb17647074e35c11160a1dc235fbe155">perform_r2c_fft</a> (source_data, transformed_data, row_size, num_rows, plan_id)</td></tr>
<tr class="memdesc:adb17647074e35c11160a1dc235fbe155"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actually performs a forward real to complex FFT.  <a href="namespacepencil__fft__mod.html#adb17647074e35c11160a1dc235fbe155">More...</a><br /></td></tr>
<tr class="separator:adb17647074e35c11160a1dc235fbe155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65c8a51d969493d729ce44cfab439524"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a65c8a51d969493d729ce44cfab439524">perform_c2r_fft</a> (source_data, transformed_data, row_size, num_rows, plan_id)</td></tr>
<tr class="memdesc:a65c8a51d969493d729ce44cfab439524"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the complex to real (backwards) FFT.  <a href="namespacepencil__fft__mod.html#a65c8a51d969493d729ce44cfab439524">More...</a><br /></td></tr>
<tr class="separator:a65c8a51d969493d729ce44cfab439524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba57cbdad3c09ffb4f614255c0b72e54"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54">rearrange_data_for_sending</a> (real_source, real_target)</td></tr>
<tr class="memdesc:aba57cbdad3c09ffb4f614255c0b72e54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimension c so to go from one pencil to another we assume here that a is the existing pencil as it is contiguous.  <a href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54">More...</a><br /></td></tr>
<tr class="separator:aba57cbdad3c09ffb4f614255c0b72e54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f32d038392be51850e7bd91467414a3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a6f32d038392be51850e7bd91467414a3">determine_my_process_sizes_per_dim</a> (existing_pencil_dim, existing_pencil_size, new_pencil_procs_per_dim, global_grid, extended_dimensions, specific_sizes_per_dim)</td></tr>
<tr class="memdesc:a6f32d038392be51850e7bd91467414a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the number of elements to on my process per dimension which either need to be sent to (forwards transformation) or received from (backwards) each target process (in the row or column) This depends on the existing pencil decomposition, as effectively we are breaking that contigulity and decomposing it into n blocks in that dimension now (provided by new_pencil_procs_per_dim)  <a href="namespacepencil__fft__mod.html#a6f32d038392be51850e7bd91467414a3">More...</a><br /></td></tr>
<tr class="separator:a6f32d038392be51850e7bd91467414a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a629892d39047dafdea8d392c86564ba2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a629892d39047dafdea8d392c86564ba2">determine_offsets_from_size</a> (source_sizes, determined_offsets)</td></tr>
<tr class="memdesc:a629892d39047dafdea8d392c86564ba2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple helper function to deduce send or receive offsets from the sizes.  <a href="namespacepencil__fft__mod.html#a629892d39047dafdea8d392c86564ba2">More...</a><br /></td></tr>
<tr class="separator:a629892d39047dafdea8d392c86564ba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b8596b2ed39fd742a496947d707edc1"><td class="memItemLeft" align="right" valign="top">integer function, dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a6b8596b2ed39fd742a496947d707edc1">determine_pencil_process_dimensions</a> (new_pencil_dim, existing_pencil_dim, existing_pencil_procs)</td></tr>
<tr class="memdesc:a6b8596b2ed39fd742a496947d707edc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the number of processes in each dimension for the target decomposition. This depends heavily on the existing decomposition, as we basically contiguise our pencil dimension and decompose the existing pencil dimension. The third dimension remains unchanged.  <a href="namespacepencil__fft__mod.html#a6b8596b2ed39fd742a496947d707edc1">More...</a><br /></td></tr>
<tr class="separator:a6b8596b2ed39fd742a496947d707edc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c23491862410177e79c5a26bab9e59"><td class="memItemLeft" align="right" valign="top">integer function, dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a28c23491862410177e79c5a26bab9e59">determine_my_pencil_location</a> (new_pencil_dim, existing_pencil_dim, existing_locations)</td></tr>
<tr class="memdesc:a28c23491862410177e79c5a26bab9e59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines my location for each dimension in the new pencil decomposition. I.e. which block I am operating on.  <a href="namespacepencil__fft__mod.html#a28c23491862410177e79c5a26bab9e59">More...</a><br /></td></tr>
<tr class="separator:a28c23491862410177e79c5a26bab9e59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf6641c54dffe24a15fe356303321bca"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#acf6641c54dffe24a15fe356303321bca">concatenate_dimension_sizes</a> (dims, concatenated_dim_sizes)</td></tr>
<tr class="memdesc:acf6641c54dffe24a15fe356303321bca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Concatenates sizes in multiple dimensions for each target process (in a row or column) into a product of that. This represents all the dimension sizes per process.  <a href="namespacepencil__fft__mod.html#acf6641c54dffe24a15fe356303321bca">More...</a><br /></td></tr>
<tr class="separator:acf6641c54dffe24a15fe356303321bca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc2b44a4f769a5cf4a6fda6ca7750cf7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#abc2b44a4f769a5cf4a6fda6ca7750cf7">determine_matching_process_dimensions</a> (new_pencil_dim, existing_pencil_dim, proc_sizes, my_pencil_size, pencil_processes_per_dim, specific_sizes_per_dim)</td></tr>
<tr class="memdesc:abc2b44a4f769a5cf4a6fda6ca7750cf7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the sizes per dimension on the matching process either to receive from (forward transposition) or send to (backwards transposition) each source process. Not only does this depend on the my pencil sizes, but it also depends on the amount of data that the source process has to send over.  <a href="namespacepencil__fft__mod.html#abc2b44a4f769a5cf4a6fda6ca7750cf7">More...</a><br /></td></tr>
<tr class="separator:abc2b44a4f769a5cf4a6fda6ca7750cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94956e5bfd1d4fce617a255d2085e32f"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a94956e5bfd1d4fce617a255d2085e32f">create_initial_transposition_description</a> (current_state)</td></tr>
<tr class="memdesc:a94956e5bfd1d4fce617a255d2085e32f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an initial transposition representation of the Z pencil that MONC is normally decomposed in. This is then fed into the create transposition procedure which will generate transpositions to other pencils.  <a href="namespacepencil__fft__mod.html#a94956e5bfd1d4fce617a255d2085e32f">More...</a><br /></td></tr>
<tr class="separator:a94956e5bfd1d4fce617a255d2085e32f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab686537d315d736c53e66af7ee40b89c"><td class="memItemLeft" align="right" valign="top">integer function, dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ab686537d315d736c53e66af7ee40b89c">determine_pencil_size</a> (new_pencil_dim, pencil_process_layout, my_pencil_location, existing_transposition, global_grid, extended_dimensions)</td></tr>
<tr class="memdesc:ab686537d315d736c53e66af7ee40b89c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deduces the size of my (local) pencil based upon the new decomposition. This depends heavily on the current pencil decomposition, the new pencil dimension is the global size, the existing pencil dimension becomes decomposed based on the number of processes in that dimension. The third dimension remains unchanged.  <a href="namespacepencil__fft__mod.html#ab686537d315d736c53e66af7ee40b89c">More...</a><br /></td></tr>
<tr class="separator:ab686537d315d736c53e66af7ee40b89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97992de3b9a72f89a51c4c2254787a9"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ac97992de3b9a72f89a51c4c2254787a9">is_extended_dimension</a> (dimension, extended_dimensions)</td></tr>
<tr class="memdesc:ac97992de3b9a72f89a51c4c2254787a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines whether or not the specific dimension is in the list of extended dimensions.  <a href="namespacepencil__fft__mod.html#ac97992de3b9a72f89a51c4c2254787a9">More...</a><br /></td></tr>
<tr class="separator:ac97992de3b9a72f89a51c4c2254787a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533e31e364cd8f9d3c5475322af0047c"><td class="memItemLeft" align="right" valign="top">integer function, dimension(size(process_dim_sizes))&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a533e31e364cd8f9d3c5475322af0047c">normal_to_extended_process_dim_sizes</a> (process_dim_sizes)</td></tr>
<tr class="memdesc:a533e31e364cd8f9d3c5475322af0047c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms real process dimension sizes into their real after FFT complex-&gt;real transformation. The way this works is that it goes from n to (n/2+1)*2 numbers which is distributed amongst the processes deterministically.  <a href="namespacepencil__fft__mod.html#a533e31e364cd8f9d3c5475322af0047c">More...</a><br /></td></tr>
<tr class="separator:a533e31e364cd8f9d3c5475322af0047c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a172a98dc6a0131ada6f2e1134453c697"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a172a98dc6a0131ada6f2e1134453c697">convert_complex_to_real</a> (complex_data, real_data)</td></tr>
<tr class="memdesc:a172a98dc6a0131ada6f2e1134453c697"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts complex representation to its real data counterpart and is called after each forward FFT. After a r2c FFT, there are n/2+1 complex numbers - which means that there will be more real numbers in Fourier space than are provided into the forward FFT call (due to the extra +1). Note that the real size n will always be complex size * 2 This always unpacks the complex dimension in the first dimension.  <a href="namespacepencil__fft__mod.html#a172a98dc6a0131ada6f2e1134453c697">More...</a><br /></td></tr>
<tr class="separator:a172a98dc6a0131ada6f2e1134453c697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89aed2affc54e0e4dad9bb13adaad753"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a89aed2affc54e0e4dad9bb13adaad753">convert_real_to_complex</a> (real_data, complex_data)</td></tr>
<tr class="memdesc:a89aed2affc54e0e4dad9bb13adaad753"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts reals into their complex representation, this is called for backwards FFTs as we need to feed in complex numbers to force FFTW to do a backwards. It is a relatively simple transformation, as n goes into n/2 complex numbers and as this is the result of the <code>convert_complex_to_real</code> procedure, n always divides evenly. This is always applied to the first dimension of the real data.  <a href="namespacepencil__fft__mod.html#a89aed2affc54e0e4dad9bb13adaad753">More...</a><br /></td></tr>
<tr class="separator:a89aed2affc54e0e4dad9bb13adaad753"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae991fe6ad1ed93991cd29272423ff37"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#aae991fe6ad1ed93991cd29272423ff37">deduce_my_global_start</a> (current_state, dimension)</td></tr>
<tr class="memdesc:aae991fe6ad1ed93991cd29272423ff37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines my global start coordinate in Fourier space. This is required for cos y and cos x calculation which is fed into the tridiagonal solver. After the forward FFTs, each process has ((n/2+1)/p+r) * 2 elements, where p is the number of processes and r is the uneven process remainder (1 or 0 depending on p). Therefore some processes will have t elements, and some t-2 elements to feed into the solver.  <a href="namespacepencil__fft__mod.html#aae991fe6ad1ed93991cd29272423ff37">More...</a><br /></td></tr>
<tr class="separator:aae991fe6ad1ed93991cd29272423ff37"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0639c2d3a94d9e7a061b8e9a2fb9f23a"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a0639c2d3a94d9e7a061b8e9a2fb9f23a">forward</a> =1</td></tr>
<tr class="separator:a0639c2d3a94d9e7a061b8e9a2fb9f23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04074dcaef59fd9cc159902dd1e3bc6a"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a04074dcaef59fd9cc159902dd1e3bc6a">backward</a> =2</td></tr>
<tr class="memdesc:a04074dcaef59fd9cc159902dd1e3bc6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transposition directions.  <a href="namespacepencil__fft__mod.html#a04074dcaef59fd9cc159902dd1e3bc6a">More...</a><br /></td></tr>
<tr class="separator:a04074dcaef59fd9cc159902dd1e3bc6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12e23c68dda1426dabee1d47722ea993"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a12e23c68dda1426dabee1d47722ea993">dim_y_comm</a></td></tr>
<tr class="separator:a12e23c68dda1426dabee1d47722ea993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2848c5b37cc57f18bc74a791e94c9ebc"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a2848c5b37cc57f18bc74a791e94c9ebc">dim_x_comm</a></td></tr>
<tr class="memdesc:a2848c5b37cc57f18bc74a791e94c9ebc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Communicators for each dimension.  <a href="namespacepencil__fft__mod.html#a2848c5b37cc57f18bc74a791e94c9ebc">More...</a><br /></td></tr>
<tr class="separator:a2848c5b37cc57f18bc74a791e94c9ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9a53e8cdae0bb7244ea20d1b4803987"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ae9a53e8cdae0bb7244ea20d1b4803987">y_from_z_transposition</a></td></tr>
<tr class="separator:ae9a53e8cdae0bb7244ea20d1b4803987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a039a45ab50044299393c6e1ccf528b74"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a039a45ab50044299393c6e1ccf528b74">x_from_y_transposition</a></td></tr>
<tr class="separator:a039a45ab50044299393c6e1ccf528b74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21d234327a4e5b29ecca272909947ed5"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a21d234327a4e5b29ecca272909947ed5">y_from_x_transposition</a></td></tr>
<tr class="separator:a21d234327a4e5b29ecca272909947ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7bba7c375f3cb57c774aabcbf460f82"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ae7bba7c375f3cb57c774aabcbf460f82">z_from_y_transposition</a></td></tr>
<tr class="separator:ae7bba7c375f3cb57c774aabcbf460f82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a044dec4ad496990fb457b287295955f5"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a044dec4ad496990fb457b287295955f5">y_from_z_2_transposition</a></td></tr>
<tr class="separator:a044dec4ad496990fb457b287295955f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa3d82db457dfd67f97cc2d1489dcd19"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#afa3d82db457dfd67f97cc2d1489dcd19">x_from_y_2_transposition</a></td></tr>
<tr class="separator:afa3d82db457dfd67f97cc2d1489dcd19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17fde3b14ed0e4d4701097444ae9edf2"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a17fde3b14ed0e4d4701097444ae9edf2">y_from_x_2_transposition</a></td></tr>
<tr class="separator:a17fde3b14ed0e4d4701097444ae9edf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9e4fbdfa052ea43283725f7eb635c1"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a1a9e4fbdfa052ea43283725f7eb635c1">z_from_y_2_transposition</a></td></tr>
<tr class="separator:a1a9e4fbdfa052ea43283725f7eb635c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5bf53cde1d1c29fbeb621803db42483"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ad5bf53cde1d1c29fbeb621803db42483">real_buffer1</a></td></tr>
<tr class="separator:ad5bf53cde1d1c29fbeb621803db42483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a536917dcdaa54c3236e3701ddee3004c"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a536917dcdaa54c3236e3701ddee3004c">real_buffer2</a></td></tr>
<tr class="separator:a536917dcdaa54c3236e3701ddee3004c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dd3e7111a5031321b39a79b969f8cfb"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a2dd3e7111a5031321b39a79b969f8cfb">real_buffer3</a></td></tr>
<tr class="separator:a2dd3e7111a5031321b39a79b969f8cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4de6a68e83c7e83f8ca9bc590867fb5"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ad4de6a68e83c7e83f8ca9bc590867fb5">fft_in_y_buffer</a></td></tr>
<tr class="separator:ad4de6a68e83c7e83f8ca9bc590867fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe90a836a861536a0fdf3ebb823608bb"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#afe90a836a861536a0fdf3ebb823608bb">fft_in_x_buffer</a></td></tr>
<tr class="separator:afe90a836a861536a0fdf3ebb823608bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad45550f0e5167714f28c90395efb48e9"><td class="memItemLeft" align="right" valign="top">complex(c_double_complex), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ad45550f0e5167714f28c90395efb48e9">buffer1</a></td></tr>
<tr class="separator:ad45550f0e5167714f28c90395efb48e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06aecd5ad3ce78e68c9da759680bb5e9"><td class="memItemLeft" align="right" valign="top">complex(c_double_complex), dimension(:,:,:), pointer, contiguous&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a06aecd5ad3ce78e68c9da759680bb5e9">buffer2</a></td></tr>
<tr class="separator:a06aecd5ad3ce78e68c9da759680bb5e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a130795788cf01bcf8dad352d943a77"><td class="memItemLeft" align="right" valign="top">type(c_ptr), dimension(4)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#a9a130795788cf01bcf8dad352d943a77">fftw_plan</a></td></tr>
<tr class="separator:a9a130795788cf01bcf8dad352d943a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac62c5c85cc74923525cfbe657486412e"><td class="memItemLeft" align="right" valign="top">logical, dimension(4)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepencil__fft__mod.html#ac62c5c85cc74923525cfbe657486412e">fftw_plan_initialised</a> =.false.</td></tr>
<tr class="separator:ac62c5c85cc74923525cfbe657486412e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This Pencil FFT performs 3D forward and backwards FFTs using pencil decomposition. It uses FFTW for the actual FFT kernel and this module contains all the data decomposition around this. There is no FFT required in Z, so this performs FFTs in Y and X (in that order forward and reversed backwards.) The data decomposition is the complex aspect, there is the concept of forward and backwards transformations. Forward transformations will go from pencil Z to Y to X and the backwards transformations undo these, so go from X to Y to Z. Note that we use quite a lot of buffer space here, this could be cut down if Y=X dimensions so some optimisation on memory could be done there in that case. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="acf6641c54dffe24a15fe356303321bca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf6641c54dffe24a15fe356303321bca">&#9670;&nbsp;</a></span>concatenate_dimension_sizes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::concatenate_dimension_sizes </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>concatenated_dim_sizes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Concatenates sizes in multiple dimensions for each target process (in a row or column) into a product of that. This represents all the dimension sizes per process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dims</td><td>The sizes, per dimension and per process that we will fold into target process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00573">573</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(in)</span> :: dims</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: concatenated_dim_sizes</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">do</span> i=1,<span class="keyword">size</span>(dims, 2)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      concatenated_dim_sizes(i)=product(dims(:,i))</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_acf6641c54dffe24a15fe356303321bca_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_acf6641c54dffe24a15fe356303321bca_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_acf6641c54dffe24a15fe356303321bca_icgraph" id="anamespacepencil__fft__mod_acf6641c54dffe24a15fe356303321bca_icgraph">
<area shape="rect" title="Concatenates sizes in multiple dimensions for each target process (in a row or column) into a product..." alt="" coords="615,5,797,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="419,5,567,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="ac2d228c34a44953affd43f778430c494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2d228c34a44953affd43f778430c494">&#9670;&nbsp;</a></span>contiguise_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::contiguise_data </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>), intent(in)&#160;</td>
          <td class="paramname"><em>transposition_description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>source_dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>source_real_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>target_real_buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source_dims argument. It is not as simple as just swapping the required dimensions, as this is after the mpi alltoall and each block lies after the previous block running sequentially in a. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">transposition_description</td><td>Transposition descriptor </td></tr>
    <tr><td class="paramname">source_dims</td><td>Representation a,b,c of source data, will contiguise to b,a,c </td></tr>
    <tr><td class="paramname">direction</td><td>Whether we wish to contiguise forwards or backwards </td></tr>
    <tr><td class="paramname">source_real_buffer</td><td>Source real data to transform </td></tr>
    <tr><td class="paramname">target_real_buffer</td><td>Target real data which is the result of the operation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00389">389</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: source_dims(3), direction</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordtype">type</span>(pencil_transposition), <span class="keywordtype">intent(in)</span> :: transposition_description</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: source_real_buffer</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(out)</span> :: target_real_buffer</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordtype">integer</span> :: number_blocks, i, j, k, n, index_prefix, index_prefix_dim, block_offset, source_index</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    number_blocks=<span class="keyword">size</span>(transposition_description%recv_sizes)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    index_prefix=0</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    block_offset=0</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    index_prefix_dim=merge(2,1, direction == forward)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">do</span> i=1,number_blocks</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">if</span> (i .ge. 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        index_prefix=index_prefix+transposition_description%recv_dims(source_dims(index_prefix_dim), i-1)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        block_offset=block_offset+transposition_description%recv_sizes(i-1)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="comment">!Transformation is either cba -&gt; bca (forward) or cab (backwards)       </span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordflow">do</span> j=1, transposition_description%recv_dims(source_dims(3), i) <span class="comment">! a</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">do</span> k=1, transposition_description%recv_dims(source_dims(1), i) <span class="comment">! c</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          <span class="keywordflow">do</span> n=1, transposition_description%recv_dims(source_dims(2), i) <span class="comment">! b</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            source_index=block_offset+(j-1)* transposition_description%recv_dims(source_dims(1), i)* &amp;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                 transposition_description%recv_dims(source_dims(2), i)+ (n-1)* &amp;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                 transposition_description%recv_dims(source_dims(1), i)+k            </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="keywordflow">if</span> (direction == forward) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;              target_real_buffer(index_prefix+n, k, j)=source_real_buffer(source_index) <span class="comment">! bca</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;              target_real_buffer(index_prefix+k, j, n)=source_real_buffer(source_index) <span class="comment">! cab</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordflow">      end do</span>      </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_ac2d228c34a44953affd43f778430c494_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_ac2d228c34a44953affd43f778430c494_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_ac2d228c34a44953affd43f778430c494_icgraph" id="anamespacepencil__fft__mod_ac2d228c34a44953affd43f778430c494_icgraph">
<area shape="rect" title="Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source..." alt="" coords="644,137,847,163"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971" title="Transposes globally to a new pencil decomposition. This goes from the source dimensions a,..." alt="" coords="427,129,596,171"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d" title="Performs a backwards 3D FFT and currently results in target data which is the X, Z,..." alt="" coords="5,35,161,76"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3" title="Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil N..." alt="" coords="5,217,161,259"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7ac39a07dabfdc3f4e92d30f132d54b0" title="Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers whi..." alt="" coords="209,35,379,76"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6b3bf23fee2dd253f9d48ab8962740a8" title="Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers whi..." alt="" coords="209,100,379,141"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7220fe79f6726da7415f9a2d21d1c5e4" title="Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is con..." alt="" coords="209,217,379,259"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7a62a605e5f0883c5b602c004057c6e0" title="Performs the transposition and forward FFT in the y dimension then converts back to real numbers...." alt="" coords="209,283,379,324"/>
</map>
</div>

</div>
</div>
<a id="a172a98dc6a0131ada6f2e1134453c697"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a172a98dc6a0131ada6f2e1134453c697">&#9670;&nbsp;</a></span>convert_complex_to_real()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::convert_complex_to_real </td>
          <td>(</td>
          <td class="paramtype">complex(c_double_complex), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>complex_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>real_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Converts complex representation to its real data counterpart and is called after each forward FFT. After a r2c FFT, there are n/2+1 complex numbers - which means that there will be more real numbers in Fourier space than are provided into the forward FFT call (due to the extra +1). Note that the real size n will always be complex size * 2 This always unpacks the complex dimension in the first dimension. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">complex_data</td><td>Complex data in Z,Y,X orientation to be unpacked into its real representation </td></tr>
    <tr><td class="paramname">real_data</td><td>The real representation is written into here </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00704">704</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordtype">complex(C_DOUBLE_COMPLEX)</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(in)</span> :: complex_data</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(out)</span> :: real_data</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordtype">integer</span> :: i, j, k</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">do</span> i=1,<span class="keyword">size</span>(real_data,3)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keywordflow">do</span> j=1,<span class="keyword">size</span>(real_data,2)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keywordflow">do</span> k=1,<span class="keyword">size</span>(real_data,1),2</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;          real_data(k,j,i)=real(real(complex_data((k+1)/2,j,i)), kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;          real_data(k+1,j,i)=real(aimag(complex_data((k+1)/2,j,i)), kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a172a98dc6a0131ada6f2e1134453c697_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a172a98dc6a0131ada6f2e1134453c697_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a172a98dc6a0131ada6f2e1134453c697_icgraph" id="anamespacepencil__fft__mod_a172a98dc6a0131ada6f2e1134453c697_icgraph">
<area shape="rect" title="Converts complex representation to its real data counterpart and is called after each forward FFT...." alt="" coords="427,39,581,80"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7220fe79f6726da7415f9a2d21d1c5e4" title="Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is con..." alt="" coords="209,5,379,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7a62a605e5f0883c5b602c004057c6e0" title="Performs the transposition and forward FFT in the y dimension then converts back to real numbers...." alt="" coords="209,71,379,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3" title="Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil N..." alt="" coords="5,39,161,80"/>
</map>
</div>

</div>
</div>
<a id="a89aed2affc54e0e4dad9bb13adaad753"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89aed2affc54e0e4dad9bb13adaad753">&#9670;&nbsp;</a></span>convert_real_to_complex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::convert_real_to_complex </td>
          <td>(</td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>real_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(c_double_complex), dimension(:,:,:), intent(out), pointer, contiguous&#160;</td>
          <td class="paramname"><em>complex_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Converts reals into their complex representation, this is called for backwards FFTs as we need to feed in complex numbers to force FFTW to do a backwards. It is a relatively simple transformation, as n goes into n/2 complex numbers and as this is the result of the <code>convert_complex_to_real</code> procedure, n always divides evenly. This is always applied to the first dimension of the real data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">real_data</td><td>The source real data to pack into the complex data, it is oriented Z,Y,X </td></tr>
    <tr><td class="paramname">complex_data</td><td>Target complex data which the real data is packaged into </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00726">726</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(in)</span> :: real_data</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordtype">complex(C_DOUBLE_COMPLEX)</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(out)</span> :: complex_data</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">integer</span> :: i, j, k</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    complex_data=cmplx(0.0d0, 0.0d0, kind=c_double_complex)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">do</span> i=1,<span class="keyword">size</span>(real_data,3)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordflow">do</span> j=1,<span class="keyword">size</span>(real_data,2)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordflow">do</span> k=1,<span class="keyword">size</span>(real_data,1),2</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;          complex_data((k+1)/2,j,i)=cmplx(real_data(k,j,i), real_data(k+1,j,i), kind=c_double_complex)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a89aed2affc54e0e4dad9bb13adaad753_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a89aed2affc54e0e4dad9bb13adaad753_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a89aed2affc54e0e4dad9bb13adaad753_icgraph" id="anamespacepencil__fft__mod_a89aed2affc54e0e4dad9bb13adaad753_icgraph">
<area shape="rect" title="Converts reals into their complex representation, this is called for backwards FFTs as we need to fee..." alt="" coords="427,39,581,80"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7ac39a07dabfdc3f4e92d30f132d54b0" title="Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers whi..." alt="" coords="209,5,379,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6b3bf23fee2dd253f9d48ab8962740a8" title="Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers whi..." alt="" coords="209,71,379,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d" title="Performs a backwards 3D FFT and currently results in target data which is the X, Z,..." alt="" coords="5,39,161,80"/>
</map>
</div>

</div>
</div>
<a id="a94956e5bfd1d4fce617a255d2085e32f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94956e5bfd1d4fce617a255d2085e32f">&#9670;&nbsp;</a></span>create_initial_transposition_description()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) function pencil_fft_mod::create_initial_transposition_description </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates an initial transposition representation of the Z pencil that MONC is normally decomposed in. This is then fed into the create transposition procedure which will generate transpositions to other pencils. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00613">613</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    create_initial_transposition_description%dim=z_index</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    create_initial_transposition_description%process_decomposition_layout=current_state%parallel%dim_sizes</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    create_initial_transposition_description%my_process_location=current_state%parallel%my_coords</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    create_initial_transposition_description%my_pencil_size=current_state%local_grid%size</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a94956e5bfd1d4fce617a255d2085e32f_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a94956e5bfd1d4fce617a255d2085e32f_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a94956e5bfd1d4fce617a255d2085e32f_icgraph" id="anamespacepencil__fft__mod_a94956e5bfd1d4fce617a255d2085e32f_icgraph">
<area shape="rect" title="Creates an initial transposition representation of the Z pencil that MONC is normally decomposed in...." alt="" coords="419,5,567,61"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,13,371,54"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,13,164,54"/>
</map>
</div>

</div>
</div>
<a id="a941fec4c35a74d0702d01b1747604c44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a941fec4c35a74d0702d01b1747604c44">&#9670;&nbsp;</a></span>create_transposition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) function pencil_fft_mod::create_transposition </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structgrids__mod_1_1global__grid__type.html">global_grid_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>global_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>), intent(in)&#160;</td>
          <td class="paramname"><em>existing_transposition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>new_pencil_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>process_dim_sizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>extended_dimensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a specific pencil transposition description. It is maybe more a decomposition description, but the main complexity comes from the transposition from existing decomposition to new decomposition so therefore it is called transposition. The new pencil decomposition depends not only on the dimension to split on, but also the existing pencil decomposition. The new decomposed dimension (i.e. the existing pencil dimension) * other local dimensions is used as the sending size, receiving though requires knowledge about the data size on the source process so others will send their pencil dimension size to this process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_pencil_dim</td><td>The dimension to use as the new pencil decomposition </td></tr>
    <tr><td class="paramname">existing_pencil_dim</td><td>The dimension used in the current decomposition </td></tr>
    <tr><td class="paramname">existing_pencil_process_layout</td><td>Number of processes per dimension for the current decomposition </td></tr>
    <tr><td class="paramname">existing_my_location</td><td>The current processes block location per dimension for the current decomposition </td></tr>
    <tr><td class="paramname">existing_pencil_size</td><td>Pencil size per dimension for the current decomposition </td></tr>
    <tr><td class="paramname">process_dim_sizes</td><td>Sizes of the pencil dimension from other processes that is used to calculate receive count </td></tr>
    <tr><td class="paramname">direction</td><td>Whether we are transposing forwards or backwards, backwards is just an inverse </td></tr>
    <tr><td class="paramname">extended_dimensions</td><td>The dimensions that this process extends from n to (n/2+1)*2 (i.e. result of fft complex-&gt;real) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00215">215</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">type</span>(global_grid_type), <span class="keywordtype">intent(inout)</span> :: global_grid</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">type</span>(pencil_transposition), <span class="keywordtype">intent(in)</span> :: existing_transposition</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: process_dim_sizes</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: new_pencil_dim, direction, extended_dimensions(:)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    create_transposition%process_decomposition_layout=determine_pencil_process_dimensions(&amp;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         new_pencil_dim, existing_transposition%dim, existing_transposition%process_decomposition_layout)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    create_transposition%my_process_location=determine_my_pencil_location(new_pencil_dim, &amp;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;         existing_transposition%dim, existing_transposition%my_process_location)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    create_transposition%my_pencil_size=determine_pencil_size(new_pencil_dim, create_transposition%process_decomposition_layout,&amp;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;         create_transposition%my_process_location, existing_transposition, global_grid, extended_dimensions)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keyword">allocate</span>(create_transposition%send_dims(3, create_transposition%process_decomposition_layout(existing_transposition%dim)), &amp;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;           create_transposition%recv_dims(3, create_transposition%process_decomposition_layout(existing_transposition%dim)))</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (direction == forward) <span class="keywordflow">then</span>            </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keyword">call </span>determine_my_process_sizes_per_dim(existing_transposition%dim, &amp;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;           existing_transposition%my_pencil_size, create_transposition%process_decomposition_layout, &amp;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;           global_grid, extended_dimensions, create_transposition%send_dims)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keyword">call </span>determine_matching_process_dimensions(new_pencil_dim, existing_transposition%dim, process_dim_sizes, &amp;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;           create_transposition%my_pencil_size, create_transposition%process_decomposition_layout, create_transposition%recv_dims)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keyword">call </span>determine_my_process_sizes_per_dim(new_pencil_dim, create_transposition%my_pencil_size, &amp;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;           existing_transposition%process_decomposition_layout, global_grid, extended_dimensions, create_transposition%recv_dims)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keyword">call </span>determine_matching_process_dimensions(existing_transposition%dim, new_pencil_dim, process_dim_sizes, &amp;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;           existing_transposition%my_pencil_size, existing_transposition%process_decomposition_layout, &amp;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;           create_transposition%send_dims)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keyword">allocate</span>(create_transposition%send_sizes(<span class="keyword">size</span>(create_transposition%send_dims, 2)), &amp;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         create_transposition%send_offsets(<span class="keyword">size</span>(create_transposition%send_sizes)), &amp;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         create_transposition%recv_sizes(<span class="keyword">size</span>(create_transposition%recv_dims, 2)), &amp;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;         create_transposition%recv_offsets(<span class="keyword">size</span>(create_transposition%recv_sizes)))</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keyword">call </span>concatenate_dimension_sizes(create_transposition%send_dims, create_transposition%send_sizes)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keyword">call </span>determine_offsets_from_size(create_transposition%send_sizes, create_transposition%send_offsets)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">call </span>concatenate_dimension_sizes(create_transposition%recv_dims, create_transposition%recv_sizes)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">call </span>determine_offsets_from_size(create_transposition%recv_sizes, create_transposition%recv_offsets)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    create_transposition%dim=new_pencil_dim</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a941fec4c35a74d0702d01b1747604c44_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a941fec4c35a74d0702d01b1747604c44_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a941fec4c35a74d0702d01b1747604c44_cgraph" id="anamespacepencil__fft__mod_a941fec4c35a74d0702d01b1747604c44_cgraph">
<area shape="rect" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="5,201,153,243"/>
<area shape="rect" href="namespacepencil__fft__mod.html#acf6641c54dffe24a15fe356303321bca" title="Concatenates sizes in multiple dimensions for each target process (in a row or column) into a product..." alt="" coords="214,5,397,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#abc2b44a4f769a5cf4a6fda6ca7750cf7" title="Determines the sizes per dimension on the matching process either to receive from (forward transposit..." alt="" coords="201,71,409,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a28c23491862410177e79c5a26bab9e59" title="Determines my location for each dimension in the new pencil decomposition. I.e. which block I am oper..." alt="" coords="221,136,390,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6f32d038392be51850e7bd91467414a3" title="Determines the number of elements to on my process per dimension which either need to be sent to (for..." alt="" coords="211,201,400,243"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a629892d39047dafdea8d392c86564ba2" title="Simple helper function to deduce send or receive offsets from the sizes." alt="" coords="221,267,390,308"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6b8596b2ed39fd742a496947d707edc1" title="Determines the number of processes in each dimension for the target decomposition...." alt="" coords="211,332,400,373"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ab686537d315d736c53e66af7ee40b89c" title="Deduces the size of my (local) pencil based upon the new decomposition. This depends heavily on the c..." alt="" coords="221,397,390,439"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac97992de3b9a72f89a51c4c2254787a9" title="Determines whether or not the specific dimension is in the list of extended dimensions." alt="" coords="457,300,604,341"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a941fec4c35a74d0702d01b1747604c44_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a941fec4c35a74d0702d01b1747604c44_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a941fec4c35a74d0702d01b1747604c44_icgraph" id="anamespacepencil__fft__mod_a941fec4c35a74d0702d01b1747604c44_icgraph">
<area shape="rect" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="419,5,567,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="aae991fe6ad1ed93991cd29272423ff37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae991fe6ad1ed93991cd29272423ff37">&#9670;&nbsp;</a></span>deduce_my_global_start()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function pencil_fft_mod::deduce_my_global_start </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines my global start coordinate in Fourier space. This is required for cos y and cos x calculation which is fed into the tridiagonal solver. After the forward FFTs, each process has ((n/2+1)/p+r) * 2 elements, where p is the number of processes and r is the uneven process remainder (1 or 0 depending on p). Therefore some processes will have t elements, and some t-2 elements to feed into the solver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">dimension</td><td>The dimension that we are calculating this for (Y or X) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>My global start in Fourier space </dd></dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00751">751</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: dimension</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordtype">integer</span> complex_size, distributed_size, remainder, larger_nums, smaller_nums</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    complex_size=(current_state%global_grid%size(dimension)/2+1)*2</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    distributed_size=complex_size / current_state%parallel%dim_sizes(dimension)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    remainder=complex_size - distributed_size * current_state%parallel%dim_sizes(dimension) </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    larger_nums=min(remainder, current_state%parallel%my_coords(dimension))</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    smaller_nums=current_state%parallel%my_coords(dimension)-remainder</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    deduce_my_global_start=((distributed_size+1)*larger_nums + merge(distributed_size*smaller_nums, 0, smaller_nums .gt. 0)) + 1</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_aae991fe6ad1ed93991cd29272423ff37_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_aae991fe6ad1ed93991cd29272423ff37_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_aae991fe6ad1ed93991cd29272423ff37_icgraph" id="anamespacepencil__fft__mod_aae991fe6ad1ed93991cd29272423ff37_icgraph">
<area shape="rect" title="Determines my global start coordinate in Fourier space. This is required for cos y and cos x calculat..." alt="" coords="212,5,367,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="abc2b44a4f769a5cf4a6fda6ca7750cf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc2b44a4f769a5cf4a6fda6ca7750cf7">&#9670;&nbsp;</a></span>determine_matching_process_dimensions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::determine_matching_process_dimensions </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>new_pencil_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>existing_pencil_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>proc_sizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>my_pencil_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>pencil_processes_per_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>specific_sizes_per_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines the sizes per dimension on the matching process either to receive from (forward transposition) or send to (backwards transposition) each source process. Not only does this depend on the my pencil sizes, but it also depends on the amount of data that the source process has to send over. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_pencil_dim</td><td>The dimension for the new pencil decomposition </td></tr>
    <tr><td class="paramname">existing_pencil_dim</td><td>Dimension for the existing pencil decomposition </td></tr>
    <tr><td class="paramname">proc_sizes</td><td>Size of dimension on the source processes (index in array corresponds to source PID) </td></tr>
    <tr><td class="paramname">my_pencil_size</td><td>My (new) pencil size per dimension </td></tr>
    <tr><td class="paramname">pencil_processes_per_dim</td><td>The process layout per dimension </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00592">592</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: new_pencil_dim, existing_pencil_dim, proc_sizes(:), my_pencil_size(:), pencil_processes_per_dim(:)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(inout)</span> :: specific_sizes_per_dim</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">integer</span> :: i, j</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">do</span> i=1,pencil_processes_per_dim(existing_pencil_dim)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">do</span> j=1,3</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">if</span> (j==new_pencil_dim) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          specific_sizes_per_dim(j, i)=proc_sizes(i)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          specific_sizes_per_dim(j, i)=my_pencil_size(j)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordflow">      end do</span>      </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_abc2b44a4f769a5cf4a6fda6ca7750cf7_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_abc2b44a4f769a5cf4a6fda6ca7750cf7_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_abc2b44a4f769a5cf4a6fda6ca7750cf7_icgraph" id="anamespacepencil__fft__mod_abc2b44a4f769a5cf4a6fda6ca7750cf7_icgraph">
<area shape="rect" title="Determines the sizes per dimension on the matching process either to receive from (forward transposit..." alt="" coords="615,5,823,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="419,5,567,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="a28c23491862410177e79c5a26bab9e59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28c23491862410177e79c5a26bab9e59">&#9670;&nbsp;</a></span>determine_my_pencil_location()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function, dimension(3) pencil_fft_mod::determine_my_pencil_location </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>new_pencil_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>existing_pencil_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>existing_locations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines my location for each dimension in the new pencil decomposition. I.e. which block I am operating on. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_pencil_dim</td><td>New pencil decomposition dimension </td></tr>
    <tr><td class="paramname">existing_pencil_dim</td><td>Current pencil dimension </td></tr>
    <tr><td class="paramname">existing_locations</td><td>Location for the current decomposition </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00553">553</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: new_pencil_dim, existing_pencil_dim, existing_locations(3)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">integer</span> :: determine_my_pencil_location(3)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">do</span> i=1,3</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordflow">if</span> (i == new_pencil_dim) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        determine_my_pencil_location(i)=1</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == existing_pencil_dim) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        determine_my_pencil_location(i)=existing_locations(new_pencil_dim)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        determine_my_pencil_location(i)=existing_locations(i)</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a28c23491862410177e79c5a26bab9e59_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a28c23491862410177e79c5a26bab9e59_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a28c23491862410177e79c5a26bab9e59_icgraph" id="anamespacepencil__fft__mod_a28c23491862410177e79c5a26bab9e59_icgraph">
<area shape="rect" title="Determines my location for each dimension in the new pencil decomposition. I.e. which block I am oper..." alt="" coords="615,5,784,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="419,5,567,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="a6f32d038392be51850e7bd91467414a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f32d038392be51850e7bd91467414a3">&#9670;&nbsp;</a></span>determine_my_process_sizes_per_dim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::determine_my_process_sizes_per_dim </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>existing_pencil_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>existing_pencil_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>new_pencil_procs_per_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrids__mod_1_1global__grid__type.html">global_grid_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>global_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>extended_dimensions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>specific_sizes_per_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines the number of elements to on my process per dimension which either need to be sent to (forwards transformation) or received from (backwards) each target process (in the row or column) This depends on the existing pencil decomposition, as effectively we are breaking that contigulity and decomposing it into n blocks in that dimension now (provided by new_pencil_procs_per_dim) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">existing_pencil_dim</td><td>The pencil dimension that we are transforming from </td></tr>
    <tr><td class="paramname">existing_pencil_size</td><td>Existing pencil decomposition sizes per dimension </td></tr>
    <tr><td class="paramname">new_pencil_procs_per_dim</td><td>For the target decomposition the number of processes per dimension </td></tr>
    <tr><td class="paramname">global_grid</td><td>Description of the global grid which we use for sizing information </td></tr>
    <tr><td class="paramname">extended_dimensions</td><td>List of dimensions where we extend from n to n+2 (i.e. result of FFT complex-&gt; real transformation) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00488">488</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: existing_pencil_dim, existing_pencil_size(:), new_pencil_procs_per_dim(:), extended_dimensions(:)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordtype">type</span>(global_grid_type), <span class="keywordtype">intent(inout)</span> :: global_grid</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(inout)</span> :: specific_sizes_per_dim</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordtype">integer</span> :: i, split_size, split_remainder, j, s</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">do</span> i=1,3</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordflow">if</span> (i == existing_pencil_dim) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        s=global_grid%size(i)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordflow">if</span> (is_extended_dimension(i, extended_dimensions)) s=s+2</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        split_size = s / new_pencil_procs_per_dim(i)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        split_remainder = s - split_size * new_pencil_procs_per_dim(i)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">do</span> j=1,new_pencil_procs_per_dim(existing_pencil_dim)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;          specific_sizes_per_dim(i,j)=merge(split_size+1, split_size, j .le. split_remainder)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="keywordflow">        end do</span>        </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        specific_sizes_per_dim(i,:) = existing_pencil_size(i)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a6f32d038392be51850e7bd91467414a3_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a6f32d038392be51850e7bd91467414a3_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a6f32d038392be51850e7bd91467414a3_cgraph" id="anamespacepencil__fft__mod_a6f32d038392be51850e7bd91467414a3_cgraph">
<area shape="rect" title="Determines the number of elements to on my process per dimension which either need to be sent to (for..." alt="" coords="5,5,195,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac97992de3b9a72f89a51c4c2254787a9" title="Determines whether or not the specific dimension is in the list of extended dimensions." alt="" coords="243,5,389,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a6f32d038392be51850e7bd91467414a3_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a6f32d038392be51850e7bd91467414a3_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a6f32d038392be51850e7bd91467414a3_icgraph" id="anamespacepencil__fft__mod_a6f32d038392be51850e7bd91467414a3_icgraph">
<area shape="rect" title="Determines the number of elements to on my process per dimension which either need to be sent to (for..." alt="" coords="615,5,804,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="419,5,567,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="a629892d39047dafdea8d392c86564ba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a629892d39047dafdea8d392c86564ba2">&#9670;&nbsp;</a></span>determine_offsets_from_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::determine_offsets_from_size </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>source_sizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>determined_offsets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Simple helper function to deduce send or receive offsets from the sizes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source_sizes</td><td>Sizes that we are using to build the offsets </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00513">513</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: source_sizes(:)</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: determined_offsets</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    determined_offsets(1)=0</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">do</span> i=2,<span class="keyword">size</span>(source_sizes)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      determined_offsets(i)=determined_offsets(i-1)+source_sizes(i-1)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a629892d39047dafdea8d392c86564ba2_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a629892d39047dafdea8d392c86564ba2_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a629892d39047dafdea8d392c86564ba2_icgraph" id="anamespacepencil__fft__mod_a629892d39047dafdea8d392c86564ba2_icgraph">
<area shape="rect" title="Simple helper function to deduce send or receive offsets from the sizes." alt="" coords="615,5,784,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="419,5,567,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="a6b8596b2ed39fd742a496947d707edc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b8596b2ed39fd742a496947d707edc1">&#9670;&nbsp;</a></span>determine_pencil_process_dimensions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function, dimension(3) pencil_fft_mod::determine_pencil_process_dimensions </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>new_pencil_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>existing_pencil_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>existing_pencil_procs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines the number of processes in each dimension for the target decomposition. This depends heavily on the existing decomposition, as we basically contiguise our pencil dimension and decompose the existing pencil dimension. The third dimension remains unchanged. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_pencil_dim</td><td>New pencil dimension </td></tr>
    <tr><td class="paramname">existing_pencil_dim</td><td>Current decomposition pencil dimension </td></tr>
    <tr><td class="paramname">existing_pencil_procs</td><td>Current decomposition process layout </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00531">531</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: new_pencil_dim, existing_pencil_dim, existing_pencil_procs(3)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordtype">integer</span> :: determine_pencil_process_dimensions(3)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">do</span> i=1,3</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">if</span> (i == new_pencil_dim) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        determine_pencil_process_dimensions(i)=1</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == existing_pencil_dim) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        determine_pencil_process_dimensions(i)=existing_pencil_procs(new_pencil_dim)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        determine_pencil_process_dimensions(i)=existing_pencil_procs(i)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a6b8596b2ed39fd742a496947d707edc1_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a6b8596b2ed39fd742a496947d707edc1_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a6b8596b2ed39fd742a496947d707edc1_icgraph" id="anamespacepencil__fft__mod_a6b8596b2ed39fd742a496947d707edc1_icgraph">
<area shape="rect" title="Determines the number of processes in each dimension for the target decomposition...." alt="" coords="615,5,804,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="419,5,567,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="ab686537d315d736c53e66af7ee40b89c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab686537d315d736c53e66af7ee40b89c">&#9670;&nbsp;</a></span>determine_pencil_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function, dimension(3) pencil_fft_mod::determine_pencil_size </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>new_pencil_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>pencil_process_layout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>my_pencil_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>), intent(in)&#160;</td>
          <td class="paramname"><em>existing_transposition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrids__mod_1_1global__grid__type.html">global_grid_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>global_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>extended_dimensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deduces the size of my (local) pencil based upon the new decomposition. This depends heavily on the current pencil decomposition, the new pencil dimension is the global size, the existing pencil dimension becomes decomposed based on the number of processes in that dimension. The third dimension remains unchanged. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_pencil_dim</td><td>Dimension for the new pencil decomposition </td></tr>
    <tr><td class="paramname">pencil_process_layout</td><td>The processes per dimension layout for the new decomposition </td></tr>
    <tr><td class="paramname">my_pencil_location</td><td>My location in the block layout </td></tr>
    <tr><td class="paramname">existing_pencil_dim</td><td>Current decomposition dimension </td></tr>
    <tr><td class="paramname">existing_pencil_size</td><td>Current decomposition sizes </td></tr>
    <tr><td class="paramname">global_grid</td><td>Description of the global grid which we use for sizing information </td></tr>
    <tr><td class="paramname">extended_dimensions</td><td>List of dimensions where we extend from n to n+2 (i.e. result of FFT complex-&gt; real transformation) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00632">632</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">type</span>(pencil_transposition), <span class="keywordtype">intent(in)</span> :: existing_transposition</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: new_pencil_dim, pencil_process_layout(3), my_pencil_location(3), extended_dimensions(:)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordtype">type</span>(global_grid_type), <span class="keywordtype">intent(inout)</span> :: global_grid</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordtype">integer</span> :: determine_pencil_size(3)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordtype">integer</span> :: i, split_size, split_remainder, s</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">do</span> i=1,3</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="keywordflow">if</span> (i == new_pencil_dim) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">if</span> (is_extended_dimension(i, extended_dimensions)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          <span class="comment">! If complex and Y dim then /2+1 for the global size</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          determine_pencil_size(i)=(global_grid%size(new_pencil_dim)/2+1)*2</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          determine_pencil_size(i)=global_grid%size(new_pencil_dim)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == existing_transposition%dim) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        s=global_grid%size(i)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="comment">! If complex and Y dim then use s/2+1 for the size to split</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keywordflow">if</span> (is_extended_dimension(i, extended_dimensions)) s=(s/2+1)*2</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        split_size=s/pencil_process_layout(i)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        split_remainder=s - split_size * pencil_process_layout(i)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        determine_pencil_size(i)=merge(split_size+1, split_size, my_pencil_location(i)+1 .le. split_remainder)        </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keywordflow">else</span>        </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        determine_pencil_size(i)=existing_transposition%my_pencil_size(i)       </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordflow">    end do</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_ab686537d315d736c53e66af7ee40b89c_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_ab686537d315d736c53e66af7ee40b89c_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_ab686537d315d736c53e66af7ee40b89c_cgraph" id="anamespacepencil__fft__mod_ab686537d315d736c53e66af7ee40b89c_cgraph">
<area shape="rect" title="Deduces the size of my (local) pencil based upon the new decomposition. This depends heavily on the c..." alt="" coords="5,5,175,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac97992de3b9a72f89a51c4c2254787a9" title="Determines whether or not the specific dimension is in the list of extended dimensions." alt="" coords="223,5,369,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_ab686537d315d736c53e66af7ee40b89c_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_ab686537d315d736c53e66af7ee40b89c_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_ab686537d315d736c53e66af7ee40b89c_icgraph" id="anamespacepencil__fft__mod_ab686537d315d736c53e66af7ee40b89c_icgraph">
<area shape="rect" title="Deduces the size of my (local) pencil based upon the new decomposition. This depends heavily on the c..." alt="" coords="615,5,784,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="419,5,567,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="a66821a0d5916d7197f851168915601da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66821a0d5916d7197f851168915601da">&#9670;&nbsp;</a></span>finalise_pencil_fft()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public pencil_fft_mod::finalise_pencil_fft </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>monc_communicator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cleans up allocated buffer memory. </p>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00092">92</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: monc_communicator</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">integer</span> :: ierr, i</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">do</span> i=1,<span class="keyword">size</span>(fftw_plan_initialised)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">if</span> (fftw_plan_initialised(i)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keyword">call </span>fftw_destroy_plan(fftw_plan(i))</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keywordflow">    end do</span>    </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">if</span> (dim_y_comm .ne. mpi_comm_self .and. dim_y_comm .ne. monc_communicator) <span class="keyword">call </span>mpi_comm_free(dim_y_comm, ierr)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (dim_x_comm .ne. mpi_comm_self .and. dim_x_comm .ne. monc_communicator) <span class="keyword">call </span>mpi_comm_free(dim_x_comm, ierr)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keyword">deallocate</span>(buffer1, buffer2, real_buffer1, real_buffer2, real_buffer3, fft_in_y_buffer , fft_in_x_buffer)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a05c54fc0d0ea9e0fc68f507451e41b4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05c54fc0d0ea9e0fc68f507451e41b4a">&#9670;&nbsp;</a></span>initialise_buffers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::initialise_buffers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialises memory for the buffers used in the FFT. </p>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00152">152</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keyword">allocate</span>(buffer1(y_from_z_transposition%my_pencil_size(y_index)/2+1, y_from_z_transposition%my_pencil_size(x_index), &amp;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;         y_from_z_transposition%my_pencil_size(z_index)), &amp;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;         real_buffer1((y_from_z_transposition%my_pencil_size(y_index)/2+1)*2, y_from_z_transposition%my_pencil_size(x_index), &amp;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;         y_from_z_transposition%my_pencil_size(z_index)), &amp;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;         buffer2(x_from_y_transposition%my_pencil_size(x_index)/2+1, x_from_y_transposition%my_pencil_size(z_index), &amp;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;         x_from_y_transposition%my_pencil_size(y_index)), &amp;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;         real_buffer2((x_from_y_transposition%my_pencil_size(x_index)/2+1)*2, x_from_y_transposition%my_pencil_size(z_index), &amp;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;         x_from_y_transposition%my_pencil_size(y_index)), &amp;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;         fft_in_y_buffer(y_from_z_transposition%my_pencil_size(y_index), y_from_z_transposition%my_pencil_size(x_index), &amp;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;         y_from_z_transposition%my_pencil_size(z_index)), &amp;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;         fft_in_x_buffer(x_from_y_transposition%my_pencil_size(x_index), x_from_y_transposition%my_pencil_size(z_index), &amp;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;         x_from_y_transposition%my_pencil_size(y_index)), &amp;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;         real_buffer3(y_from_x_transposition%my_pencil_size(y_index), y_from_x_transposition%my_pencil_size(x_index), &amp;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;         y_from_x_transposition%my_pencil_size(z_index)))</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a05c54fc0d0ea9e0fc68f507451e41b4a_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a05c54fc0d0ea9e0fc68f507451e41b4a_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a05c54fc0d0ea9e0fc68f507451e41b4a_icgraph" id="anamespacepencil__fft__mod_a05c54fc0d0ea9e0fc68f507451e41b4a_icgraph">
<area shape="rect" title="Initialises memory for the buffers used in the FFT." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="a3a8be214eb145cf54faebb0882867780"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a8be214eb145cf54faebb0882867780">&#9670;&nbsp;</a></span>initialise_pencil_fft()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, dimension(3), public pencil_fft_mod::initialise_pencil_fft </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>my_y_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>my_x_start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises the pencil FFT functionality, this will create the transposition structures needed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">my_y_start</td><td>My global start in fourier space for Y </td></tr>
    <tr><td class="paramname">my_x_start</td><td>My global start in fourier space for X </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Size of local dimensions in fourier space for this process </dd></dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00051">51</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: my_y_start, my_x_start</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">integer</span> :: initialise_pencil_fft(3) </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">integer</span> :: ierr, y_distinct_sizes(current_state%parallel%dim_sizes(Y_INDEX)), &amp;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;         x_distinct_sizes(current_state%parallel%dim_sizes(X_INDEX))</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    my_y_start=deduce_my_global_start(current_state, y_index)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    my_x_start=deduce_my_global_start(current_state, x_index)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (current_state%parallel%dim_sizes(y_index) .gt. 1 .and. current_state%parallel%dim_sizes(x_index) .gt. 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keyword">call </span>mpi_cart_sub(current_state%parallel%neighbour_comm, (/1,0/), dim_y_comm, ierr)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keyword">call </span>mpi_cart_sub(current_state%parallel%neighbour_comm, (/0,1/), dim_x_comm, ierr)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keyword">call </span>mpi_allgather(current_state%local_grid%size(y_index), 1, mpi_int, y_distinct_sizes, 1, mpi_int, dim_y_comm, ierr)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keyword">call </span>mpi_allgather(current_state%local_grid%size(x_index), 1, mpi_int, x_distinct_sizes, 1, mpi_int, dim_x_comm, ierr)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current_state%parallel%dim_sizes(y_index) .gt. 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      dim_y_comm=current_state%parallel%monc_communicator</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      dim_x_comm=mpi_comm_self</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keyword">call </span>mpi_allgather(current_state%local_grid%size(y_index), 1, mpi_int, y_distinct_sizes, 1, mpi_int, dim_y_comm, ierr)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      x_distinct_sizes=current_state%local_grid%size(x_index)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current_state%parallel%dim_sizes(x_index) .gt. 1) <span class="keywordflow">then</span>      </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      dim_y_comm=mpi_comm_self</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      dim_x_comm=current_state%parallel%monc_communicator</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      y_distinct_sizes=current_state%local_grid%size(y_index)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keyword">call </span>mpi_allgather(current_state%local_grid%size(x_index), 1, mpi_int, x_distinct_sizes, 1, mpi_int, dim_x_comm, ierr)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      dim_y_comm=mpi_comm_self</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      dim_x_comm=mpi_comm_self</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      y_distinct_sizes=current_state%local_grid%size(y_index)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      x_distinct_sizes=current_state%local_grid%size(x_index)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keyword">call </span>initialise_transpositions(current_state, y_distinct_sizes, x_distinct_sizes)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">call </span>initialise_buffers()</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    initialise_pencil_fft=z_from_y_transposition%my_pencil_size    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a3a8be214eb145cf54faebb0882867780_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a3a8be214eb145cf54faebb0882867780_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a3a8be214eb145cf54faebb0882867780_cgraph" id="anamespacepencil__fft__mod_a3a8be214eb145cf54faebb0882867780_cgraph">
<area shape="rect" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,136,164,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#aae991fe6ad1ed93991cd29272423ff37" title="Determines my global start coordinate in Fourier space. This is required for cos y and cos x calculat..." alt="" coords="214,71,369,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a05c54fc0d0ea9e0fc68f507451e41b4a" title="Initialises memory for the buffers used in the FFT." alt="" coords="212,136,371,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,201,371,243"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a94956e5bfd1d4fce617a255d2085e32f" title="Creates an initial transposition representation of the Z pencil that MONC is normally decomposed in...." alt="" coords="453,122,601,178"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="453,201,601,243"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a533e31e364cd8f9d3c5475322af0047c" title="Transforms real process dimension sizes into their real after FFT complex&#45;&gt;real transformation...." alt="" coords="419,267,636,308"/>
<area shape="rect" href="namespacepencil__fft__mod.html#acf6641c54dffe24a15fe356303321bca" title="Concatenates sizes in multiple dimensions for each target process (in a row or column) into a product..." alt="" coords="697,5,879,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#abc2b44a4f769a5cf4a6fda6ca7750cf7" title="Determines the sizes per dimension on the matching process either to receive from (forward transposit..." alt="" coords="684,71,892,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a28c23491862410177e79c5a26bab9e59" title="Determines my location for each dimension in the new pencil decomposition. I.e. which block I am oper..." alt="" coords="703,136,873,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6f32d038392be51850e7bd91467414a3" title="Determines the number of elements to on my process per dimension which either need to be sent to (for..." alt="" coords="693,201,883,243"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a629892d39047dafdea8d392c86564ba2" title="Simple helper function to deduce send or receive offsets from the sizes." alt="" coords="703,267,873,308"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6b8596b2ed39fd742a496947d707edc1" title="Determines the number of processes in each dimension for the target decomposition...." alt="" coords="693,332,883,373"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ab686537d315d736c53e66af7ee40b89c" title="Deduces the size of my (local) pencil based upon the new decomposition. This depends heavily on the c..." alt="" coords="703,397,873,439"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac97992de3b9a72f89a51c4c2254787a9" title="Determines whether or not the specific dimension is in the list of extended dimensions." alt="" coords="940,300,1087,341"/>
</map>
</div>

</div>
</div>
<a id="a744b6c045c8620f598f3ebc5bb714611"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a744b6c045c8620f598f3ebc5bb714611">&#9670;&nbsp;</a></span>initialise_transpositions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::initialise_transpositions </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>y_distinct_sizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>x_distinct_sizes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialises the pencil transpositions, from a pencil in one dimension to that in another. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">y_distinct_sizes</td><td>Y sizes per process </td></tr>
    <tr><td class="paramname">x_distinct_sizes</td><td>X sizes per process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00173">173</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: y_distinct_sizes, x_distinct_sizes</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">type</span>(pencil_transposition) :: z_pencil</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    z_pencil=create_initial_transposition_description(current_state)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">! Transpositions</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    y_from_z_transposition=create_transposition(current_state%global_grid, z_pencil, y_index, y_distinct_sizes, &amp;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;         forward, (/ -1 /))   </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    x_from_y_transposition=create_transposition(current_state%global_grid, y_from_z_transposition, x_index, &amp;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;         x_distinct_sizes, forward, (/ y_index /))</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    y_from_x_transposition=create_transposition(current_state%global_grid, x_from_y_transposition, y_index, &amp;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;         normal_to_extended_process_dim_sizes(x_distinct_sizes), backward, (/ y_index, x_index /))    </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    z_from_y_transposition=create_transposition(current_state%global_grid, y_from_x_transposition, z_index, &amp;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;         normal_to_extended_process_dim_sizes(y_distinct_sizes), backward, (/ y_index, x_index /))  </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    y_from_z_2_transposition=create_transposition(current_state%global_grid, z_from_y_transposition, y_index, &amp;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          normal_to_extended_process_dim_sizes(y_distinct_sizes), forward, (/ y_index, x_index /))   </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    x_from_y_2_transposition=create_transposition(current_state%global_grid, y_from_z_2_transposition, x_index, &amp;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          normal_to_extended_process_dim_sizes(x_distinct_sizes), forward, (/ y_index, x_index /))</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    y_from_x_2_transposition=create_transposition(current_state%global_grid, x_from_y_2_transposition, y_index, &amp;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;         x_distinct_sizes, backward, (/ y_index /))</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    z_from_y_2_transposition=create_transposition(current_state%global_grid, y_from_x_2_transposition, z_index, &amp;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          y_distinct_sizes, backward, (/ -1 /))   </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a744b6c045c8620f598f3ebc5bb714611_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a744b6c045c8620f598f3ebc5bb714611_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a744b6c045c8620f598f3ebc5bb714611_cgraph" id="anamespacepencil__fft__mod_a744b6c045c8620f598f3ebc5bb714611_cgraph">
<area shape="rect" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="5,201,164,243"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a94956e5bfd1d4fce617a255d2085e32f" title="Creates an initial transposition representation of the Z pencil that MONC is normally decomposed in...." alt="" coords="247,122,395,178"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="247,201,395,243"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a533e31e364cd8f9d3c5475322af0047c" title="Transforms real process dimension sizes into their real after FFT complex&#45;&gt;real transformation...." alt="" coords="212,267,429,308"/>
<area shape="rect" href="namespacepencil__fft__mod.html#acf6641c54dffe24a15fe356303321bca" title="Concatenates sizes in multiple dimensions for each target process (in a row or column) into a product..." alt="" coords="490,5,673,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#abc2b44a4f769a5cf4a6fda6ca7750cf7" title="Determines the sizes per dimension on the matching process either to receive from (forward transposit..." alt="" coords="477,71,685,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a28c23491862410177e79c5a26bab9e59" title="Determines my location for each dimension in the new pencil decomposition. I.e. which block I am oper..." alt="" coords="497,136,666,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6f32d038392be51850e7bd91467414a3" title="Determines the number of elements to on my process per dimension which either need to be sent to (for..." alt="" coords="487,201,676,243"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a629892d39047dafdea8d392c86564ba2" title="Simple helper function to deduce send or receive offsets from the sizes." alt="" coords="497,267,666,308"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6b8596b2ed39fd742a496947d707edc1" title="Determines the number of processes in each dimension for the target decomposition...." alt="" coords="487,332,676,373"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ab686537d315d736c53e66af7ee40b89c" title="Deduces the size of my (local) pencil based upon the new decomposition. This depends heavily on the c..." alt="" coords="497,397,666,439"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac97992de3b9a72f89a51c4c2254787a9" title="Determines whether or not the specific dimension is in the list of extended dimensions." alt="" coords="733,300,880,341"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a744b6c045c8620f598f3ebc5bb714611_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a744b6c045c8620f598f3ebc5bb714611_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a744b6c045c8620f598f3ebc5bb714611_icgraph" id="anamespacepencil__fft__mod_a744b6c045c8620f598f3ebc5bb714611_icgraph">
<area shape="rect" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="ac97992de3b9a72f89a51c4c2254787a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac97992de3b9a72f89a51c4c2254787a9">&#9670;&nbsp;</a></span>is_extended_dimension()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function pencil_fft_mod::is_extended_dimension </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dimension</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>extended_dimensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines whether or not the specific dimension is in the list of extended dimensions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dimension</td><td>The dimension to test for </td></tr>
    <tr><td class="paramname">extended_dimensions</td><td>Array of dimensions that will be searched </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the dimension is found in the array </dd></dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00667">667</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: dimension, extended_dimensions(:)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">do</span> i=1,<span class="keyword">size</span>(extended_dimensions)</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">if</span> (extended_dimensions(i) == dimension) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        is_extended_dimension=.true.</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    is_extended_dimension=.false.</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_ac97992de3b9a72f89a51c4c2254787a9_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_ac97992de3b9a72f89a51c4c2254787a9_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_ac97992de3b9a72f89a51c4c2254787a9_icgraph" id="anamespacepencil__fft__mod_ac97992de3b9a72f89a51c4c2254787a9_icgraph">
<area shape="rect" title="Determines whether or not the specific dimension is in the list of extended dimensions." alt="" coords="852,39,999,80"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6f32d038392be51850e7bd91467414a3" title="Determines the number of elements to on my process per dimension which either need to be sent to (for..." alt="" coords="615,5,804,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ab686537d315d736c53e66af7ee40b89c" title="Deduces the size of my (local) pencil based upon the new decomposition. This depends heavily on the c..." alt="" coords="625,71,794,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a941fec4c35a74d0702d01b1747604c44" title="Creates a specific pencil transposition description. It is maybe more a decomposition description,..." alt="" coords="419,39,567,80"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,39,371,80"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,39,164,80"/>
</map>
</div>

</div>
</div>
<a id="a533e31e364cd8f9d3c5475322af0047c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a533e31e364cd8f9d3c5475322af0047c">&#9670;&nbsp;</a></span>normal_to_extended_process_dim_sizes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function, dimension(size(process_dim_sizes)) pencil_fft_mod::normal_to_extended_process_dim_sizes </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>process_dim_sizes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transforms real process dimension sizes into their real after FFT complex-&gt;real transformation. The way this works is that it goes from n to (n/2+1)*2 numbers which is distributed amongst the processes deterministically. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">process_dim_sizes</td><td>Real process dimension sizes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The extended process dimension sizes </dd></dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00684">684</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: process_dim_sizes</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(size(process_dim_sizes))</span> :: normal_to_extended_process_dim_sizes</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordtype">integer</span> :: temp_total, split_size, remainder</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    temp_total=(sum(process_dim_sizes) /2 + 1) * 2</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    split_size=temp_total/<span class="keyword">size</span>(process_dim_sizes)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    remainder=temp_total - split_size*<span class="keyword">size</span>(process_dim_sizes)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    normal_to_extended_process_dim_sizes=split_size</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    normal_to_extended_process_dim_sizes(1:remainder)=split_size+1    </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a533e31e364cd8f9d3c5475322af0047c_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a533e31e364cd8f9d3c5475322af0047c_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a533e31e364cd8f9d3c5475322af0047c_icgraph" id="anamespacepencil__fft__mod_a533e31e364cd8f9d3c5475322af0047c_icgraph">
<area shape="rect" title="Transforms real process dimension sizes into their real after FFT complex&#45;&gt;real transformation...." alt="" coords="419,5,636,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a744b6c045c8620f598f3ebc5bb714611" title="Initialises the pencil transpositions, from a pencil in one dimension to that in another." alt="" coords="212,5,371,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a3a8be214eb145cf54faebb0882867780" title="Initialises the pencil FFT functionality, this will create the transposition structures needed." alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
<a id="ac660508af65a49c11776c1c09306a27d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac660508af65a49c11776c1c09306a27d">&#9670;&nbsp;</a></span>perform_backwards_3dfft()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public pencil_fft_mod::perform_backwards_3dfft </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>source_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>target_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a backwards 3D FFT and currently results in target data which is the X, Z, Y oriented pencil Note that the source_data here takes no account for the halo, it is up to caller to exclude this. This does no FFT in Z, but transposes to Y, does FFT in Y, then transposes to X and performs an FFT in that dimension. Pencil decomposition is used which has already been set up. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">source_data</td><td>The source real data to in the frequency domain </td></tr>
    <tr><td class="paramname">target_data</td><td>Time domain complex representation of the frequency domain source </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00137">137</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(in)</span> :: source_data</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(out)</span> :: target_data</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">call </span>transpose_to_pencil(y_from_z_2_transposition, (/z_index, y_index, x_index/), dim_y_comm, forward, &amp;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;       source_data, real_buffer3)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">call </span>transpose_to_pencil(x_from_y_2_transposition, (/y_index, x_index, z_index/), dim_x_comm, forward, &amp;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;       real_buffer3, real_buffer2)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">call </span>transpose_and_backward_fft_in_x(current_state, real_buffer2, buffer2, real_buffer1)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">call </span>transpose_and_backward_fft_in_y(current_state, real_buffer1, buffer1, target_data)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_ac660508af65a49c11776c1c09306a27d_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_ac660508af65a49c11776c1c09306a27d_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_ac660508af65a49c11776c1c09306a27d_cgraph" id="anamespacepencil__fft__mod_ac660508af65a49c11776c1c09306a27d_cgraph">
<area shape="rect" title="Performs a backwards 3D FFT and currently results in target data which is the X, Z,..." alt="" coords="5,77,161,119"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7ac39a07dabfdc3f4e92d30f132d54b0" title="Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers whi..." alt="" coords="209,77,379,119"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971" title="Transposes globally to a new pencil decomposition. This goes from the source dimensions a,..." alt="" coords="427,136,596,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6b3bf23fee2dd253f9d48ab8962740a8" title="Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers whi..." alt="" coords="209,12,379,53"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a89aed2affc54e0e4dad9bb13adaad753" title="Converts reals into their complex representation, this is called for backwards FFTs as we need to fee..." alt="" coords="434,71,589,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a65c8a51d969493d729ce44cfab439524" title="Performs the complex to real (backwards) FFT." alt="" coords="433,5,589,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494" title="Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source..." alt="" coords="644,114,847,141"/>
<area shape="rect" href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54" title="Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimens..." alt="" coords="662,165,829,207"/>
</map>
</div>

</div>
</div>
<a id="a65c8a51d969493d729ce44cfab439524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65c8a51d969493d729ce44cfab439524">&#9670;&nbsp;</a></span>perform_c2r_fft()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::perform_c2r_fft </td>
          <td>(</td>
          <td class="paramtype">complex(c_double_complex), dimension(:,:,:), intent(inout), pointer, contiguous&#160;</td>
          <td class="paramname"><em>source_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(inout), pointer, contiguous&#160;</td>
          <td class="paramname"><em>transformed_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>row_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>num_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>plan_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the complex to real (backwards) FFT. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source_data</td><td>Source (complex) data in the frequency domain </td></tr>
    <tr><td class="paramname">transformed_data</td><td>Resulting real data in the time domain </td></tr>
    <tr><td class="paramname">row_size</td><td>Number of elements for each FFT </td></tr>
    <tr><td class="paramname">num_rows</td><td>The number of FFTs to perform on the next data elements in the source_data </td></tr>
    <tr><td class="paramname">plan_id</td><td>Id number of the plan that tracks whether we need to create it or can reuse the existing one </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00449">449</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordtype">complex(C_DOUBLE_COMPLEX)</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(inout)</span> :: source_data</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(inout)</span> :: transformed_data</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: row_size, num_rows, plan_id   </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (.not. fftw_plan_initialised(plan_id)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="comment">! n is the size of the FFT (in real, not complex-&gt;real coords.) There are row_size/2+1 between entries for the input</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="comment">! (complex) data and row_size between entries for the output data</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      fftw_plan(plan_id) = fftw_plan_many_dft_c2r(1, (/row_size/), num_rows, source_data, (/row_size/2+1/), 1, row_size/2+1, &amp;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;           transformed_data, (/row_size/), 1, row_size, fftw_estimate)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      fftw_plan_initialised(plan_id)=.true.</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keyword">call </span>fftw_execute_dft_c2r(fftw_plan(plan_id), source_data, transformed_data)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a65c8a51d969493d729ce44cfab439524_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a65c8a51d969493d729ce44cfab439524_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a65c8a51d969493d729ce44cfab439524_icgraph" id="anamespacepencil__fft__mod_a65c8a51d969493d729ce44cfab439524_icgraph">
<area shape="rect" title="Performs the complex to real (backwards) FFT." alt="" coords="427,39,583,80"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7ac39a07dabfdc3f4e92d30f132d54b0" title="Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers whi..." alt="" coords="209,5,379,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6b3bf23fee2dd253f9d48ab8962740a8" title="Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers whi..." alt="" coords="209,71,379,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d" title="Performs a backwards 3D FFT and currently results in target data which is the X, Z,..." alt="" coords="5,39,161,80"/>
</map>
</div>

</div>
</div>
<a id="a2b24719dcfb0852d350e2b0ba944b4c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b24719dcfb0852d350e2b0ba944b4c3">&#9670;&nbsp;</a></span>perform_forward_3dfft()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public pencil_fft_mod::perform_forward_3dfft </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>source_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>target_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil Note that the source_data here takes no account for the halo, it is up to caller to exclude this. This does no FFT in Z, but transposes to Y, does FFT in Y, then transposes to X and performs an FFT in that dimension. Pencil decomposition is used which has already been set up. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">source_data</td><td>The source real data to in the time domain </td></tr>
    <tr><td class="paramname">target_data</td><td>Frequency domain real representation of the time domain source which is allocated here </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00114">114</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(inout)</span> :: source_data</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(out)</span> :: target_data</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keyword">call </span>transpose_and_forward_fft_in_y(current_state, source_data, buffer1, real_buffer1)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    real_buffer1=real_buffer1/current_state%global_grid%size(y_index)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">call </span>transpose_and_forward_fft_in_x(current_state, real_buffer1, buffer2, real_buffer2)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    real_buffer2=real_buffer2/current_state%global_grid%size(x_index)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">call </span>transpose_to_pencil(y_from_x_transposition, (/x_index, z_index, y_index/), dim_x_comm, backward, &amp;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;         real_buffer2, real_buffer3)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">call </span>transpose_to_pencil(z_from_y_transposition, (/y_index, x_index, z_index/), dim_y_comm, backward, &amp;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;       real_buffer3, target_data)     </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a2b24719dcfb0852d350e2b0ba944b4c3_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a2b24719dcfb0852d350e2b0ba944b4c3_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a2b24719dcfb0852d350e2b0ba944b4c3_cgraph" id="anamespacepencil__fft__mod_a2b24719dcfb0852d350e2b0ba944b4c3_cgraph">
<area shape="rect" title="Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil N..." alt="" coords="5,77,161,119"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7220fe79f6726da7415f9a2d21d1c5e4" title="Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is con..." alt="" coords="209,77,379,119"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971" title="Transposes globally to a new pencil decomposition. This goes from the source dimensions a,..." alt="" coords="427,136,596,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7a62a605e5f0883c5b602c004057c6e0" title="Performs the transposition and forward FFT in the y dimension then converts back to real numbers...." alt="" coords="209,12,379,53"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a172a98dc6a0131ada6f2e1134453c697" title="Converts complex representation to its real data counterpart and is called after each forward FFT...." alt="" coords="434,71,589,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adb17647074e35c11160a1dc235fbe155" title="Actually performs a forward real to complex FFT." alt="" coords="433,5,589,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494" title="Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source..." alt="" coords="644,114,847,141"/>
<area shape="rect" href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54" title="Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimens..." alt="" coords="662,165,829,207"/>
</map>
</div>

</div>
</div>
<a id="adb17647074e35c11160a1dc235fbe155"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb17647074e35c11160a1dc235fbe155">&#9670;&nbsp;</a></span>perform_r2c_fft()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::perform_r2c_fft </td>
          <td>(</td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(inout), pointer, contiguous&#160;</td>
          <td class="paramname"><em>source_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(c_double_complex), dimension(:,:,:), intent(inout), pointer, contiguous&#160;</td>
          <td class="paramname"><em>transformed_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>row_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>num_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>plan_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Actually performs a forward real to complex FFT. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source_data</td><td>Source (real) data in the time domain </td></tr>
    <tr><td class="paramname">transformed_data</td><td>Resulting complex data in the frequency domain </td></tr>
    <tr><td class="paramname">row_size</td><td>Number of elements for each FFT </td></tr>
    <tr><td class="paramname">num_rows</td><td>The number of FFTs to perform on the next data elements in the source_data </td></tr>
    <tr><td class="paramname">plan_id</td><td>Id number of the plan that tracks whether we need to create it or can reuse the existing one </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00430">430</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(inout)</span> :: source_data</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">complex(C_DOUBLE_COMPLEX)</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(inout)</span> :: transformed_data</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: row_size, num_rows, plan_id</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">if</span> (.not. fftw_plan_initialised(plan_id)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      fftw_plan(plan_id) = fftw_plan_many_dft_r2c(1, (/row_size/), num_rows, source_data, (/row_size/), 1, row_size, &amp;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;           transformed_data, (/row_size/), 1, row_size/2+1, fftw_estimate)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      fftw_plan_initialised(plan_id)=.true.</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keyword">call </span>fftw_execute_dft_r2c(fftw_plan(plan_id), source_data, transformed_data)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_adb17647074e35c11160a1dc235fbe155_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_adb17647074e35c11160a1dc235fbe155_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_adb17647074e35c11160a1dc235fbe155_icgraph" id="anamespacepencil__fft__mod_adb17647074e35c11160a1dc235fbe155_icgraph">
<area shape="rect" title="Actually performs a forward real to complex FFT." alt="" coords="427,39,583,80"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7220fe79f6726da7415f9a2d21d1c5e4" title="Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is con..." alt="" coords="209,5,379,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7a62a605e5f0883c5b602c004057c6e0" title="Performs the transposition and forward FFT in the y dimension then converts back to real numbers...." alt="" coords="209,71,379,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3" title="Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil N..." alt="" coords="5,39,161,80"/>
</map>
</div>

</div>
</div>
<a id="aba57cbdad3c09ffb4f614255c0b72e54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba57cbdad3c09ffb4f614255c0b72e54">&#9670;&nbsp;</a></span>rearrange_data_for_sending()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::rearrange_data_for_sending </td>
          <td>(</td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>real_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>real_target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimension c so to go from one pencil to another we assume here that a is the existing pencil as it is contiguous. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">real_source</td><td>Source data to transpose from </td></tr>
    <tr><td class="paramname">real_target</td><td>Target data to transpose to </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00468">468</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(in)</span> :: real_source</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(out)</span> :: real_target</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(real_source,2)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      real_target(:,i,:)=transpose(real_source(:,i,:))</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keywordflow">    end do</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_aba57cbdad3c09ffb4f614255c0b72e54_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_aba57cbdad3c09ffb4f614255c0b72e54_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_aba57cbdad3c09ffb4f614255c0b72e54_icgraph" id="anamespacepencil__fft__mod_aba57cbdad3c09ffb4f614255c0b72e54_icgraph">
<area shape="rect" title="Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimens..." alt="" coords="644,129,811,171"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971" title="Transposes globally to a new pencil decomposition. This goes from the source dimensions a,..." alt="" coords="427,129,596,171"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d" title="Performs a backwards 3D FFT and currently results in target data which is the X, Z,..." alt="" coords="5,35,161,76"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3" title="Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil N..." alt="" coords="5,217,161,259"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7ac39a07dabfdc3f4e92d30f132d54b0" title="Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers whi..." alt="" coords="209,35,379,76"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6b3bf23fee2dd253f9d48ab8962740a8" title="Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers whi..." alt="" coords="209,100,379,141"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7220fe79f6726da7415f9a2d21d1c5e4" title="Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is con..." alt="" coords="209,217,379,259"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7a62a605e5f0883c5b602c004057c6e0" title="Performs the transposition and forward FFT in the y dimension then converts back to real numbers...." alt="" coords="209,283,379,324"/>
</map>
</div>

</div>
</div>
<a id="a7ac39a07dabfdc3f4e92d30f132d54b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ac39a07dabfdc3f4e92d30f132d54b0">&#9670;&nbsp;</a></span>transpose_and_backward_fft_in_x()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::transpose_and_backward_fft_in_x </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>source_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(c_double_complex), dimension(:,:,:), intent(out), pointer, contiguous&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>real_buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers which are converted to real, so the this real to complex operation is performed first. If n is the logical size of the FFT row, then the input size is n+2, complex number size is n/2+1 and we get n reals out. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">source_data</td><td>Input buffer, X pencil oriented x,z,y </td></tr>
    <tr><td class="paramname">buffer</td><td>Complex buffer which is fed into the FFT </td></tr>
    <tr><td class="paramname">real_buffer</td><td>Output buffer, Y pencil, oriented y,x,z </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00288">288</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(inout)</span> :: source_data</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>,  <span class="keywordtype">intent(out)</span> :: real_buffer</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">complex(C_DOUBLE_COMPLEX)</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(out)</span> :: buffer</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keyword">call </span>convert_real_to_complex(source_data, buffer)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keyword">call </span>perform_c2r_fft(buffer, fft_in_x_buffer, x_from_y_2_transposition%my_pencil_size(x_index)-2, &amp;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;         x_from_y_2_transposition%my_pencil_size(y_index) * x_from_y_2_transposition%my_pencil_size(z_index), 2) </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">! Transpose globally from X pencil to Y pencil</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keyword">call </span>transpose_to_pencil(y_from_x_2_transposition, (/x_index, z_index, y_index/), dim_x_comm, backward, &amp;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;       fft_in_x_buffer, real_buffer)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a7ac39a07dabfdc3f4e92d30f132d54b0_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a7ac39a07dabfdc3f4e92d30f132d54b0_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a7ac39a07dabfdc3f4e92d30f132d54b0_cgraph" id="anamespacepencil__fft__mod_a7ac39a07dabfdc3f4e92d30f132d54b0_cgraph">
<area shape="rect" title="Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers whi..." alt="" coords="5,71,175,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a89aed2affc54e0e4dad9bb13adaad753" title="Converts reals into their complex representation, this is called for backwards FFTs as we need to fee..." alt="" coords="230,5,385,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a65c8a51d969493d729ce44cfab439524" title="Performs the complex to real (backwards) FFT." alt="" coords="229,71,385,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971" title="Transposes globally to a new pencil decomposition. This goes from the source dimensions a,..." alt="" coords="223,136,392,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494" title="Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source..." alt="" coords="440,114,643,141"/>
<area shape="rect" href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54" title="Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimens..." alt="" coords="458,165,625,207"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a7ac39a07dabfdc3f4e92d30f132d54b0_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a7ac39a07dabfdc3f4e92d30f132d54b0_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a7ac39a07dabfdc3f4e92d30f132d54b0_icgraph" id="anamespacepencil__fft__mod_a7ac39a07dabfdc3f4e92d30f132d54b0_icgraph">
<area shape="rect" title="Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers whi..." alt="" coords="209,5,379,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d" title="Performs a backwards 3D FFT and currently results in target data which is the X, Z,..." alt="" coords="5,5,161,47"/>
</map>
</div>

</div>
</div>
<a id="a6b3bf23fee2dd253f9d48ab8962740a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b3bf23fee2dd253f9d48ab8962740a8">&#9670;&nbsp;</a></span>transpose_and_backward_fft_in_y()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::transpose_and_backward_fft_in_y </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>source_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(c_double_complex), dimension(:,:,:), intent(out), pointer, contiguous&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>real_buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers which are converted to real, so the this real to complex operation is performed first. If n is the logical size of the FFT row, then the input size is n+2, complex number size is n/2+1 and we get n reals out. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">source_data</td><td>Input buffer, Y pencil oriented y,x,z </td></tr>
    <tr><td class="paramname">buffer</td><td>Complex buffer which is fed into the FFT </td></tr>
    <tr><td class="paramname">real_buffer</td><td>Output buffer, Z pencil, oriented z,y,x </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00331">331</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(inout)</span> :: source_data</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>,  <span class="keywordtype">intent(out)</span> :: real_buffer</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">complex(C_DOUBLE_COMPLEX)</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(out)</span> :: buffer</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">call </span>convert_real_to_complex(source_data, buffer)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keyword">call </span>perform_c2r_fft(buffer, fft_in_y_buffer,  y_from_x_2_transposition%my_pencil_size(y_index)-2, &amp;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;         y_from_x_2_transposition%my_pencil_size(x_index) * y_from_x_2_transposition%my_pencil_size(z_index), 4)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">! Go from global Y pencil to global Z pencil</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keyword">call </span>transpose_to_pencil(z_from_y_2_transposition, (/y_index, x_index, z_index/), dim_y_comm, backward, &amp;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;       fft_in_y_buffer, real_buffer)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a6b3bf23fee2dd253f9d48ab8962740a8_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a6b3bf23fee2dd253f9d48ab8962740a8_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a6b3bf23fee2dd253f9d48ab8962740a8_cgraph" id="anamespacepencil__fft__mod_a6b3bf23fee2dd253f9d48ab8962740a8_cgraph">
<area shape="rect" title="Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers whi..." alt="" coords="5,71,175,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a89aed2affc54e0e4dad9bb13adaad753" title="Converts reals into their complex representation, this is called for backwards FFTs as we need to fee..." alt="" coords="230,5,385,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a65c8a51d969493d729ce44cfab439524" title="Performs the complex to real (backwards) FFT." alt="" coords="229,71,385,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971" title="Transposes globally to a new pencil decomposition. This goes from the source dimensions a,..." alt="" coords="223,136,392,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494" title="Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source..." alt="" coords="440,114,643,141"/>
<area shape="rect" href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54" title="Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimens..." alt="" coords="458,165,625,207"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a6b3bf23fee2dd253f9d48ab8962740a8_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a6b3bf23fee2dd253f9d48ab8962740a8_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a6b3bf23fee2dd253f9d48ab8962740a8_icgraph" id="anamespacepencil__fft__mod_a6b3bf23fee2dd253f9d48ab8962740a8_icgraph">
<area shape="rect" title="Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers whi..." alt="" coords="209,5,379,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d" title="Performs a backwards 3D FFT and currently results in target data which is the X, Z,..." alt="" coords="5,5,161,47"/>
</map>
</div>

</div>
</div>
<a id="a7220fe79f6726da7415f9a2d21d1c5e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7220fe79f6726da7415f9a2d21d1c5e4">&#9670;&nbsp;</a></span>transpose_and_forward_fft_in_x()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::transpose_and_forward_fft_in_x </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>buffer1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(c_double_complex), dimension(:,:,:), intent(out), pointer, contiguous&#160;</td>
          <td class="paramname"><em>buffer2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>buffer3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is converted back into real numbers. The X size is (n/2+1)*2 due to this transformation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">buffer1</td><td>Input buffer, Y pencil after the Y dimension FFT oriented y,x,z </td></tr>
    <tr><td class="paramname">buffer</td><td>Complex buffer which results from the FFT </td></tr>
    <tr><td class="paramname">buffer2</td><td>Output buffer, X pencil after this X FFT, oriented x,z,y </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00309">309</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">complex(C_DOUBLE_COMPLEX)</span>, <span class="keywordtype">dimension(:,:,:)</span>,  <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(out)</span> :: buffer2</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(inout)</span> :: buffer1, buffer3</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">! Go from global Y pencil to global X pencil</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keyword">call </span>transpose_to_pencil(x_from_y_transposition, (/y_index, x_index, z_index/), dim_x_comm, forward, &amp;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;       buffer1, fft_in_x_buffer)   </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keyword">call </span>perform_r2c_fft(fft_in_x_buffer, buffer2, x_from_y_transposition%my_pencil_size(x_index), &amp;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;         x_from_y_transposition%my_pencil_size(y_index) * x_from_y_transposition%my_pencil_size(z_index), 3)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keyword">call </span>convert_complex_to_real(buffer2, buffer3)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a7220fe79f6726da7415f9a2d21d1c5e4_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a7220fe79f6726da7415f9a2d21d1c5e4_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a7220fe79f6726da7415f9a2d21d1c5e4_cgraph" id="anamespacepencil__fft__mod_a7220fe79f6726da7415f9a2d21d1c5e4_cgraph">
<area shape="rect" title="Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is con..." alt="" coords="5,71,175,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a172a98dc6a0131ada6f2e1134453c697" title="Converts complex representation to its real data counterpart and is called after each forward FFT...." alt="" coords="230,5,385,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adb17647074e35c11160a1dc235fbe155" title="Actually performs a forward real to complex FFT." alt="" coords="229,71,385,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971" title="Transposes globally to a new pencil decomposition. This goes from the source dimensions a,..." alt="" coords="223,136,392,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494" title="Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source..." alt="" coords="440,114,643,141"/>
<area shape="rect" href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54" title="Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimens..." alt="" coords="458,165,625,207"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a7220fe79f6726da7415f9a2d21d1c5e4_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a7220fe79f6726da7415f9a2d21d1c5e4_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a7220fe79f6726da7415f9a2d21d1c5e4_icgraph" id="anamespacepencil__fft__mod_a7220fe79f6726da7415f9a2d21d1c5e4_icgraph">
<area shape="rect" title="Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is con..." alt="" coords="209,5,379,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3" title="Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil N..." alt="" coords="5,5,161,47"/>
</map>
</div>

</div>
</div>
<a id="a7a62a605e5f0883c5b602c004057c6e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a62a605e5f0883c5b602c004057c6e0">&#9670;&nbsp;</a></span>transpose_and_forward_fft_in_y()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::transpose_and_forward_fft_in_y </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>source_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(c_double_complex), dimension(:,:,:), intent(out), pointer, contiguous&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>real_buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the transposition and forward FFT in the y dimension then converts back to real numbers. The Y size is (n/2+1)*2 due to the complex to real transformation after the FFT. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">source_data</td><td>Input buffer, Z pencil oriented z,y,x </td></tr>
    <tr><td class="paramname">buffer</td><td>Complex buffer which the FFT writes into </td></tr>
    <tr><td class="paramname">real_buffer</td><td>Output buffer, Y pencil, oriented y,x,z </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00266">266</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(inout)</span> :: source_data</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>,  <span class="keywordtype">intent(out)</span> :: real_buffer</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordtype">complex(C_DOUBLE_COMPLEX)</span>, <span class="keywordtype">dimension(:,:,:)</span>,  <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(out)</span> :: buffer</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">! Transpose globally from Z pencil to Y pencil</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keyword">call </span>transpose_to_pencil(y_from_z_transposition, (/z_index, y_index, x_index/), dim_y_comm, forward, &amp;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;       source_data, fft_in_y_buffer)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keyword">call </span>perform_r2c_fft(fft_in_y_buffer, buffer, y_from_z_transposition%my_pencil_size(y_index), &amp;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         y_from_z_transposition%my_pencil_size(x_index) * y_from_z_transposition%my_pencil_size(z_index), 1)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">call </span>convert_complex_to_real(buffer, real_buffer)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a7a62a605e5f0883c5b602c004057c6e0_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a7a62a605e5f0883c5b602c004057c6e0_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a7a62a605e5f0883c5b602c004057c6e0_cgraph" id="anamespacepencil__fft__mod_a7a62a605e5f0883c5b602c004057c6e0_cgraph">
<area shape="rect" title="Performs the transposition and forward FFT in the y dimension then converts back to real numbers...." alt="" coords="5,71,175,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a172a98dc6a0131ada6f2e1134453c697" title="Converts complex representation to its real data counterpart and is called after each forward FFT...." alt="" coords="230,5,385,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adb17647074e35c11160a1dc235fbe155" title="Actually performs a forward real to complex FFT." alt="" coords="229,71,385,112"/>
<area shape="rect" href="namespacepencil__fft__mod.html#adc5c609ef121c225f7c126d72e558971" title="Transposes globally to a new pencil decomposition. This goes from the source dimensions a,..." alt="" coords="223,136,392,177"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494" title="Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source..." alt="" coords="440,114,643,141"/>
<area shape="rect" href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54" title="Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimens..." alt="" coords="458,165,625,207"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_a7a62a605e5f0883c5b602c004057c6e0_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_a7a62a605e5f0883c5b602c004057c6e0_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_a7a62a605e5f0883c5b602c004057c6e0_icgraph" id="anamespacepencil__fft__mod_a7a62a605e5f0883c5b602c004057c6e0_icgraph">
<area shape="rect" title="Performs the transposition and forward FFT in the y dimension then converts back to real numbers...." alt="" coords="209,5,379,47"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3" title="Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil N..." alt="" coords="5,5,161,47"/>
</map>
</div>

</div>
</div>
<a id="adc5c609ef121c225f7c126d72e558971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc5c609ef121c225f7c126d72e558971">&#9670;&nbsp;</a></span>transpose_to_pencil()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pencil_fft_mod::transpose_to_pencil </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>), intent(in)&#160;</td>
          <td class="paramname"><em>transposition_description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>source_dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>communicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>source_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>target_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transposes globally to a new pencil decomposition. This goes from the source dimensions a,b,c to b,c,a (forwards) or c,a,b (backwards.) It requires multiple steps, first the local data is transposed to c,b,a regardless of direction. then it is communicated via alltoall, each process then assembles its own b,c,a or c,a,b data via contiguising across blocks as the data layout is nonlinear. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">transposition_description</td><td>Description of the transposition </td></tr>
    <tr><td class="paramname">source_dims</td><td>Dimensions of the current pencil that we wish to transpose from, will go from abc to bca </td></tr>
    <tr><td class="paramname">communicator</td><td>The MPI communicator associated with the group of processes who will swap data </td></tr>
    <tr><td class="paramname">direction</td><td>Whether this is going forwards or backwards, it makes a difference to the data arrangement </td></tr>
    <tr><td class="paramname">source_data</td><td>Source data (abc) </td></tr>
    <tr><td class="paramname">target_data</td><td>Target data (bca) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00357">357</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordtype">type</span>(pencil_transposition), <span class="keywordtype">intent(in)</span> :: transposition_description</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: source_dims(3), communicator, direction</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(in)</span> :: source_data</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">intent(out)</span> :: target_data</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordtype">integer</span> :: ierr</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span> :: real_temp</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: real_temp2</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">allocate</span>(real_temp(<span class="keyword">size</span>(source_data,3), <span class="keyword">size</span>(source_data,2), <span class="keyword">size</span>(source_data,1)), &amp;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;         real_temp2(product(transposition_description%my_pencil_size)+1))</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keyword">call </span>rearrange_data_for_sending(real_source=source_data, real_target=real_temp)    </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keyword">call </span>mpi_alltoallv(real_temp, transposition_description%send_sizes, transposition_description%send_offsets, &amp;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;         precision_type, real_temp2, transposition_description%recv_sizes, transposition_description%recv_offsets, &amp;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         precision_type, communicator, ierr)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keyword">call </span>contiguise_data(transposition_description, (/source_dims(3), source_dims(2), source_dims(1)/), direction, &amp;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;         source_real_buffer=real_temp2, target_real_buffer=target_data)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keyword">deallocate</span>(real_temp, real_temp2)   </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_adc5c609ef121c225f7c126d72e558971_cgraph.png" border="0" usemap="#anamespacepencil__fft__mod_adc5c609ef121c225f7c126d72e558971_cgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_adc5c609ef121c225f7c126d72e558971_cgraph" id="anamespacepencil__fft__mod_adc5c609ef121c225f7c126d72e558971_cgraph">
<area shape="rect" title="Transposes globally to a new pencil decomposition. This goes from the source dimensions a,..." alt="" coords="5,27,175,69"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac2d228c34a44953affd43f778430c494" title="Contiguises from c,b,a to b,c,a (forwards) or c,a,b (backwards) where these are defined by the source..." alt="" coords="223,5,425,32"/>
<area shape="rect" href="namespacepencil__fft__mod.html#aba57cbdad3c09ffb4f614255c0b72e54" title="Rearranges data for sending, transposing a,b,c into c,b,a . This is done as alltoall splits on dimens..." alt="" coords="241,57,407,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacepencil__fft__mod_adc5c609ef121c225f7c126d72e558971_icgraph.png" border="0" usemap="#anamespacepencil__fft__mod_adc5c609ef121c225f7c126d72e558971_icgraph" alt=""/></div>
<map name="namespacepencil__fft__mod_adc5c609ef121c225f7c126d72e558971_icgraph" id="anamespacepencil__fft__mod_adc5c609ef121c225f7c126d72e558971_icgraph">
<area shape="rect" title="Transposes globally to a new pencil decomposition. This goes from the source dimensions a,..." alt="" coords="427,129,596,171"/>
<area shape="rect" href="namespacepencil__fft__mod.html#ac660508af65a49c11776c1c09306a27d" title="Performs a backwards 3D FFT and currently results in target data which is the X, Z,..." alt="" coords="5,35,161,76"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a2b24719dcfb0852d350e2b0ba944b4c3" title="Performs a forward 3D FFT and currently results in target data which is the X, Z, Y oriented pencil N..." alt="" coords="5,217,161,259"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7ac39a07dabfdc3f4e92d30f132d54b0" title="Performs the backwards FFT in X and then transposes to Y pencil. The FFT requires complex numbers whi..." alt="" coords="209,35,379,76"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a6b3bf23fee2dd253f9d48ab8962740a8" title="Performs the backwards FFT in Y and then transposes to Z pencil. The FFT requires complex numbers whi..." alt="" coords="209,100,379,141"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7220fe79f6726da7415f9a2d21d1c5e4" title="Performs the transposition and forward FFT in the x dimension. After the FFT the complex space is con..." alt="" coords="209,217,379,259"/>
<area shape="rect" href="namespacepencil__fft__mod.html#a7a62a605e5f0883c5b602c004057c6e0" title="Performs the transposition and forward FFT in the y dimension then converts back to real numbers...." alt="" coords="209,283,379,324"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a04074dcaef59fd9cc159902dd1e3bc6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04074dcaef59fd9cc159902dd1e3bc6a">&#9670;&nbsp;</a></span>backward</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pencil_fft_mod::backward =2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transposition directions. </p>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00028">28</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="ad45550f0e5167714f28c90395efb48e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad45550f0e5167714f28c90395efb48e9">&#9670;&nbsp;</a></span>buffer1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">complex(c_double_complex), dimension(:,:,:), pointer, contiguous pencil_fft_mod::buffer1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00037">37</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">complex(C_DOUBLE_COMPLEX)</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span> :: buffer1, buffer2</div>
</div><!-- fragment -->
</div>
</div>
<a id="a06aecd5ad3ce78e68c9da759680bb5e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06aecd5ad3ce78e68c9da759680bb5e9">&#9670;&nbsp;</a></span>buffer2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">complex(c_double_complex), dimension(:,:,:), pointer, contiguous pencil_fft_mod::buffer2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00037">37</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="a2848c5b37cc57f18bc74a791e94c9ebc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2848c5b37cc57f18bc74a791e94c9ebc">&#9670;&nbsp;</a></span>dim_x_comm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer pencil_fft_mod::dim_x_comm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Communicators for each dimension. </p>

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00029">29</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="a12e23c68dda1426dabee1d47722ea993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12e23c68dda1426dabee1d47722ea993">&#9670;&nbsp;</a></span>dim_y_comm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer pencil_fft_mod::dim_y_comm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00029">29</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">integer</span> :: dim_y_comm, dim_x_comm</div>
</div><!-- fragment -->
</div>
</div>
<a id="afe90a836a861536a0fdf3ebb823608bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe90a836a861536a0fdf3ebb823608bb">&#9670;&nbsp;</a></span>fft_in_x_buffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), pointer, contiguous pencil_fft_mod::fft_in_x_buffer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00035">35</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="ad4de6a68e83c7e83f8ca9bc590867fb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4de6a68e83c7e83f8ca9bc590867fb5">&#9670;&nbsp;</a></span>fft_in_y_buffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), pointer, contiguous pencil_fft_mod::fft_in_y_buffer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00035">35</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="a9a130795788cf01bcf8dad352d943a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a130795788cf01bcf8dad352d943a77">&#9670;&nbsp;</a></span>fftw_plan</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(c_ptr), dimension(4) pencil_fft_mod::fftw_plan</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00040">40</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">type</span>(C_PTR) :: fftw_plan(4)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac62c5c85cc74923525cfbe657486412e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac62c5c85cc74923525cfbe657486412e">&#9670;&nbsp;</a></span>fftw_plan_initialised</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical, dimension(4) pencil_fft_mod::fftw_plan_initialised =.false.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00041">41</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">logical</span> :: fftw_plan_initialised(4)=.false.</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0639c2d3a94d9e7a061b8e9a2fb9f23a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0639c2d3a94d9e7a061b8e9a2fb9f23a">&#9670;&nbsp;</a></span>forward</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pencil_fft_mod::forward =1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00028">28</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: FORWARD=1, backward=2   </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5bf53cde1d1c29fbeb621803db42483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5bf53cde1d1c29fbeb621803db42483">&#9670;&nbsp;</a></span>real_buffer1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), pointer, contiguous pencil_fft_mod::real_buffer1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00035">35</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keywordtype">  real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">contiguous</span>, <span class="keywordtype">pointer</span> :: real_buffer1, real_buffer2, real_buffer3, &amp;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;       fft_in_y_buffer , fft_in_x_buffer       </div>
</div><!-- fragment -->
</div>
</div>
<a id="a536917dcdaa54c3236e3701ddee3004c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a536917dcdaa54c3236e3701ddee3004c">&#9670;&nbsp;</a></span>real_buffer2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), pointer, contiguous pencil_fft_mod::real_buffer2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00035">35</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="a2dd3e7111a5031321b39a79b969f8cfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dd3e7111a5031321b39a79b969f8cfb">&#9670;&nbsp;</a></span>real_buffer3</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), pointer, contiguous pencil_fft_mod::real_buffer3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00035">35</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="afa3d82db457dfd67f97cc2d1489dcd19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa3d82db457dfd67f97cc2d1489dcd19">&#9670;&nbsp;</a></span>x_from_y_2_transposition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) pencil_fft_mod::x_from_y_2_transposition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00031">31</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="a039a45ab50044299393c6e1ccf528b74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a039a45ab50044299393c6e1ccf528b74">&#9670;&nbsp;</a></span>x_from_y_transposition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) pencil_fft_mod::x_from_y_transposition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00031">31</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="a17fde3b14ed0e4d4701097444ae9edf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17fde3b14ed0e4d4701097444ae9edf2">&#9670;&nbsp;</a></span>y_from_x_2_transposition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) pencil_fft_mod::y_from_x_2_transposition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00031">31</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="a21d234327a4e5b29ecca272909947ed5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21d234327a4e5b29ecca272909947ed5">&#9670;&nbsp;</a></span>y_from_x_transposition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) pencil_fft_mod::y_from_x_transposition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00031">31</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="a044dec4ad496990fb457b287295955f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a044dec4ad496990fb457b287295955f5">&#9670;&nbsp;</a></span>y_from_z_2_transposition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) pencil_fft_mod::y_from_z_2_transposition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00031">31</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="ae9a53e8cdae0bb7244ea20d1b4803987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9a53e8cdae0bb7244ea20d1b4803987">&#9670;&nbsp;</a></span>y_from_z_transposition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) pencil_fft_mod::y_from_z_transposition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00031">31</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">type</span>(pencil_transposition) :: y_from_z_transposition, x_from_y_transposition, y_from_x_transposition, z_from_y_transposition, &amp;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;       y_from_z_2_transposition, x_from_y_2_transposition, y_from_x_2_transposition, z_from_y_2_transposition</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a9e4fbdfa052ea43283725f7eb635c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a9e4fbdfa052ea43283725f7eb635c1">&#9670;&nbsp;</a></span>z_from_y_2_transposition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) pencil_fft_mod::z_from_y_2_transposition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00031">31</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
<a id="ae7bba7c375f3cb57c774aabcbf460f82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7bba7c375f3cb57c774aabcbf460f82">&#9670;&nbsp;</a></span>z_from_y_transposition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structpencil__fft__mod_1_1pencil__transposition.html">pencil_transposition</a>) pencil_fft_mod::z_from_y_transposition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pencilfft_8F90_source.html#l00031">31</a> of file <a class="el" href="pencilfft_8F90_source.html">pencilfft.F90</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="anamespacedatadefn__mod_html_a39b79f8cc843d236d3b47f5c81b64368"><div class="ttname"><a href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">datadefn_mod::default_precision</a></div><div class="ttdeci">integer, parameter, public default_precision</div><div class="ttdoc">MPI communication type which we use for the prognostic and calculation data.</div><div class="ttdef"><b>Definition:</b> <a href="datadefn_8F90_source.html#l00017">datadefn.F90:17</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

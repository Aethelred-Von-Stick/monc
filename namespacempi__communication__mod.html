<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: mpi_communication_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mpi_communication_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Abstraction layer around MPI, this issues and marshals the lower level communication details.  
<a href="namespacempi__communication__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacempi__communication__mod_1_1usleep.html">usleep</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a51ffdc1413aeb89e7f9ea1c8ad5ed24c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#a51ffdc1413aeb89e7f9ea1c8ad5ed24c">initialise_mpi_communication</a> (provided_threading)</td></tr>
<tr class="memdesc:a51ffdc1413aeb89e7f9ea1c8ad5ed24c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises MPI communication.  <a href="namespacempi__communication__mod.html#a51ffdc1413aeb89e7f9ea1c8ad5ed24c">More...</a><br /></td></tr>
<tr class="separator:a51ffdc1413aeb89e7f9ea1c8ad5ed24c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ac4f74cb4daf89481da8df1dabc10d"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d">lock_mpi</a> ()</td></tr>
<tr class="memdesc:a44ac4f74cb4daf89481da8df1dabc10d"><td class="mdescLeft">&#160;</td><td class="mdescRight">If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI.  <a href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d">More...</a><br /></td></tr>
<tr class="separator:a44ac4f74cb4daf89481da8df1dabc10d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad52010c006d90df6c097898ebdf4487"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487">unlock_mpi</a> ()</td></tr>
<tr class="memdesc:aad52010c006d90df6c097898ebdf4487"><td class="mdescLeft">&#160;</td><td class="mdescRight">If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI.  <a href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487">More...</a><br /></td></tr>
<tr class="separator:aad52010c006d90df6c097898ebdf4487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee6d81060fcad11a466f823627234e7c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#aee6d81060fcad11a466f823627234e7c">pause_for_mpi_interleaving</a> ()</td></tr>
<tr class="memdesc:aee6d81060fcad11a466f823627234e7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation.  <a href="namespacempi__communication__mod.html#aee6d81060fcad11a466f823627234e7c">More...</a><br /></td></tr>
<tr class="separator:aee6d81060fcad11a466f823627234e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ed06ee79c19ff1f57a344de48e53806"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806">wait_for_mpi_request</a> (request, status)</td></tr>
<tr class="memdesc:a6ed06ee79c19ff1f57a344de48e53806"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for a specific MPI request to complete, either by managing thread safety and interleaving or just a call to MPI if we are in multiple mode.  <a href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806">More...</a><br /></td></tr>
<tr class="separator:a6ed06ee79c19ff1f57a344de48e53806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a272f44aa1ed340d3e6efd306d075100b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#a272f44aa1ed340d3e6efd306d075100b">waitall_for_mpi_requests</a> (requests, count)</td></tr>
<tr class="memdesc:a272f44aa1ed340d3e6efd306d075100b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for all MPI requests to complete, either by managing thread safety and interleaving or just a call to MPI if we are in multiple mode.  <a href="namespacempi__communication__mod.html#a272f44aa1ed340d3e6efd306d075100b">More...</a><br /></td></tr>
<tr class="separator:a272f44aa1ed340d3e6efd306d075100b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf62d60a03e5dd2a80a15ddd183e2668"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#abf62d60a03e5dd2a80a15ddd183e2668">get_number_io_servers</a> (io_comm)</td></tr>
<tr class="memdesc:abf62d60a03e5dd2a80a15ddd183e2668"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the number of IO servers that are running in total.  <a href="namespacempi__communication__mod.html#abf62d60a03e5dd2a80a15ddd183e2668">More...</a><br /></td></tr>
<tr class="separator:abf62d60a03e5dd2a80a15ddd183e2668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa524bcd4b7d0001d02dc3a324788610c"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#aa524bcd4b7d0001d02dc3a324788610c">get_my_io_rank</a> (io_comm)</td></tr>
<tr class="memdesc:aa524bcd4b7d0001d02dc3a324788610c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves my IO server rank out of the number of IO servers that are running.  <a href="namespacempi__communication__mod.html#aa524bcd4b7d0001d02dc3a324788610c">More...</a><br /></td></tr>
<tr class="separator:aa524bcd4b7d0001d02dc3a324788610c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaec64bef427565b6e469af564d9d32d6"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#aaec64bef427565b6e469af564d9d32d6">register_command_receive</a> ()</td></tr>
<tr class="memdesc:aaec64bef427565b6e469af564d9d32d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a request for receiving a command from any MONC process on the command channel.  <a href="namespacempi__communication__mod.html#aaec64bef427565b6e469af564d9d32d6">More...</a><br /></td></tr>
<tr class="separator:aaec64bef427565b6e469af564d9d32d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9da81a3b60ef8507b3eabdbd19a8f89"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#aa9da81a3b60ef8507b3eabdbd19a8f89">data_receive</a> (mpi_datatype, num_elements, source, dump_data, data_dump_id, description_data)</td></tr>
<tr class="memdesc:aa9da81a3b60ef8507b3eabdbd19a8f89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Awaits some data on the data channel. This is of the type, size from the source provided and can either be written into a byte buffer or integer buffer depending upon the arguments provided.  <a href="namespacempi__communication__mod.html#aa9da81a3b60ef8507b3eabdbd19a8f89">More...</a><br /></td></tr>
<tr class="separator:aa9da81a3b60ef8507b3eabdbd19a8f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7852c937574e58b245148b6d9db923e4"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#a7852c937574e58b245148b6d9db923e4">cancel_requests</a> ()</td></tr>
<tr class="memdesc:a7852c937574e58b245148b6d9db923e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancels all outstanding communication requests.  <a href="namespacempi__communication__mod.html#a7852c937574e58b245148b6d9db923e4">More...</a><br /></td></tr>
<tr class="separator:a7852c937574e58b245148b6d9db923e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d4d49458bbf60e4d6b59b050273d62"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#a56d4d49458bbf60e4d6b59b050273d62">cancel_request</a> (req)</td></tr>
<tr class="memdesc:a56d4d49458bbf60e4d6b59b050273d62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancels a specific communication request.  <a href="namespacempi__communication__mod.html#a56d4d49458bbf60e4d6b59b050273d62">More...</a><br /></td></tr>
<tr class="separator:a56d4d49458bbf60e4d6b59b050273d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ae866733dedd5129dac4361d17e720"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#af9ae866733dedd5129dac4361d17e720">test_for_command</a> (command, source)</td></tr>
<tr class="memdesc:af9ae866733dedd5129dac4361d17e720"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests for a command message based upon the request already registered.  <a href="namespacempi__communication__mod.html#af9ae866733dedd5129dac4361d17e720">More...</a><br /></td></tr>
<tr class="separator:af9ae866733dedd5129dac4361d17e720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e6c15cbcdc2763a82c34491328c4742"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#a4e6c15cbcdc2763a82c34491328c4742">test_for_inter_io</a> (inter_io_communications, number_of_inter_io, io_communicator, command, source, data_buffer)</td></tr>
<tr class="memdesc:a4e6c15cbcdc2763a82c34491328c4742"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests for inter IO server communication.  <a href="namespacempi__communication__mod.html#a4e6c15cbcdc2763a82c34491328c4742">More...</a><br /></td></tr>
<tr class="separator:a4e6c15cbcdc2763a82c34491328c4742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9569a173fd13c6772b5dfc8495c715b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#ae9569a173fd13c6772b5dfc8495c715b">free_mpi_type</a> (the_type)</td></tr>
<tr class="memdesc:ae9569a173fd13c6772b5dfc8495c715b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees an MPI type, used in clean up.  <a href="namespacempi__communication__mod.html#ae9569a173fd13c6772b5dfc8495c715b">More...</a><br /></td></tr>
<tr class="separator:ae9569a173fd13c6772b5dfc8495c715b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ec3fc73dd4cba3a1aa1b09f4d8e0af"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#a94ec3fc73dd4cba3a1aa1b09f4d8e0af">build_mpi_datatype</a> (data_definition, data_size_info, data_size, field_start_locations, field_end_locations, field_dimensions)</td></tr>
<tr class="memdesc:a94ec3fc73dd4cba3a1aa1b09f4d8e0af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds the MPI type that corresponds to the data which will be received from a specific MONC process. Two factors determine the structure and size of this - the XML configuration which has been parsed and also specific details of array sizes sent by each process as part of its registration process.  <a href="namespacempi__communication__mod.html#a94ec3fc73dd4cba3a1aa1b09f4d8e0af">More...</a><br /></td></tr>
<tr class="separator:a94ec3fc73dd4cba3a1aa1b09f4d8e0af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab779fbac010de793120b7d0798a0c253"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#ab779fbac010de793120b7d0798a0c253">ms_wait_between_tests</a> =100</td></tr>
<tr class="memdesc:ab779fbac010de793120b7d0798a0c253"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to the C usleep Linux call which allows us to sleep for a specific number of MS.  <a href="namespacempi__communication__mod.html#ab779fbac010de793120b7d0798a0c253">More...</a><br /></td></tr>
<tr class="separator:ab779fbac010de793120b7d0798a0c253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af185079bd304166f60b964d68a2af985"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#af185079bd304166f60b964d68a2af985">command_buffer</a></td></tr>
<tr class="memdesc:af185079bd304166f60b964d68a2af985"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer used to receive the command data into when it arrives on that channel.  <a href="namespacempi__communication__mod.html#af185079bd304166f60b964d68a2af985">More...</a><br /></td></tr>
<tr class="separator:af185079bd304166f60b964d68a2af985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab32a589b93e30b3ed6046fe824997bac"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#ab32a589b93e30b3ed6046fe824997bac">command_request_handle</a></td></tr>
<tr class="memdesc:ab32a589b93e30b3ed6046fe824997bac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request handle representing the asynchronous P2P command request.  <a href="namespacempi__communication__mod.html#ab32a589b93e30b3ed6046fe824997bac">More...</a><br /></td></tr>
<tr class="separator:ab32a589b93e30b3ed6046fe824997bac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab039946f1a8ec0bb0b848c4efeb71f36"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#ab039946f1a8ec0bb0b848c4efeb71f36">mpi_threading_mode</a></td></tr>
<tr class="separator:ab039946f1a8ec0bb0b848c4efeb71f36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa820840801f1d774cf9ed1f904e2f7bc"><td class="memItemLeft" align="right" valign="top">integer, volatile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#aa820840801f1d774cf9ed1f904e2f7bc">mpi_mutex</a></td></tr>
<tr class="separator:aa820840801f1d774cf9ed1f904e2f7bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27aa961d3f6e32685b89abb7e1128f4c"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempi__communication__mod.html#a27aa961d3f6e32685b89abb7e1128f4c">manage_mpi_thread_safety</a></td></tr>
<tr class="separator:a27aa961d3f6e32685b89abb7e1128f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Abstraction layer around MPI, this issues and marshals the lower level communication details. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a94ec3fc73dd4cba3a1aa1b09f4d8e0af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94ec3fc73dd4cba3a1aa1b09f4d8e0af">&#9670;&nbsp;</a></span>build_mpi_datatype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public mpi_communication_mod::build_mpi_datatype </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__data__definition__type.html">io_configuration_data_definition_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>data_definition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__server__client__mod_1_1data__sizing__description__type.html">data_sizing_description_type</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>data_size_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>data_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1map__type.html">map_type</a>), intent(out)&#160;</td>
          <td class="paramname"><em>field_start_locations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1map__type.html">map_type</a>), intent(out)&#160;</td>
          <td class="paramname"><em>field_end_locations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcollections__mod_1_1map__type.html">map_type</a>), intent(out), optional&#160;</td>
          <td class="paramname"><em>field_dimensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Builds the MPI type that corresponds to the data which will be received from a specific MONC process. Two factors determine the structure and size of this - the XML configuration which has been parsed and also specific details of array sizes sent by each process as part of its registration process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_configuration</td><td>IO server representation of the configuration which contains data structure layout </td></tr>
    <tr><td class="paramname">array_sizes</td><td>Sizes of each data array which has been received from a MONC process when it registeres </td></tr>
    <tr><td class="paramname">data_size</td><td>The data size corresponding to this type is returned (i.e. the buffer size in bytes required to hold it) </td></tr>
    <tr><td class="paramname">field_start_locations</td><td>For the MONC process the start location for each field, keyed on field name </td></tr>
    <tr><td class="paramname">field_end_locations</td><td>For the MONC process the end location for each field, keyed on field name </td></tr>
    <tr><td class="paramname">field_dimensions</td><td>Optional map of dimensions, if provided will store the number of dimensions for each field </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The MPI data type representation </dd></dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00291">291</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">type</span>(io_configuration_data_definition_type), <span class="keywordtype">intent(in)</span> :: data_definition</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">type</span>(data_sizing_description_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: data_size_info</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: data_size</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">type</span>(map_type), <span class="keywordtype">intent(out)</span> :: field_start_locations, field_end_locations</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">type</span>(map_type), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">optional</span> :: field_dimensions</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">integer</span> :: type_extents(5), type_counts, i, j, field_start, data_type, field_array_sizes, &amp;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;         temp_size, prev_data_type, old_types(20), offsets(20), block_counts(20), new_type, current_location, ierr, field_ignores</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">logical</span> :: field_found</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">type</span>(data_sizing_description_type) :: field_size_info</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    type_extents=populate_mpi_type_extents()</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    field_start=1</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    data_type=0</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    type_counts=0</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    field_array_sizes=0</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    field_ignores=0</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    current_location=1</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">do</span> i=1,data_definition%number_of_data_fields</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">if</span> (data_type == 0) <span class="keywordflow">then</span>        </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        prev_data_type=data_type        </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        data_type=data_definition%fields(i)%data_type</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">if</span> (data_type .ne. data_definition%fields(i)%data_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          <span class="comment">! For efficient type packing, combine multiple fields with the same type - therefore when the type changes work the previous one pack</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          <span class="keyword">call </span>append_mpi_datatype(field_start, i-1-field_ignores, field_array_sizes, data_type, &amp;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;               type_extents, prev_data_type, type_counts+1, old_types, offsets, block_counts)          </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          field_start=i</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          field_array_sizes=0</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          field_ignores=0</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          prev_data_type=data_type                   </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          data_type=data_definition%fields(i)%data_type</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          type_counts=type_counts+1</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keyword">call </span>c_put_integer(field_start_locations, data_definition%fields(i)%name, current_location)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">if</span> (data_definition%fields(i)%field_type .eq. array_field_type .or. &amp;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;           data_definition%fields(i)%field_type .eq. map_field_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">! Grab the field info based upon the field name</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        field_found=get_data_description_from_name(data_size_info, data_definition%fields(i)%name, field_size_info)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">if</span> (.not. field_found .or. field_size_info%dimensions == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;          <span class="comment">! If no field info, or the dimension is 0 then this MONC process is not sending that field - check it is optional</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;          <span class="keywordflow">if</span> (.not. data_definition%fields(i)%optional) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Non optional field `&quot;</span>//trim(data_definition%fields(i)%name)//&amp;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                 <span class="stringliteral">&quot;&#39; omitted from MONC IO server registration&quot;</span>)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          field_ignores=field_ignores+1</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          <span class="comment">! If the field is specified then use the size data to assemble the field size and append to current size</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          temp_size=1</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          <span class="keywordflow">do</span> j=1, field_size_info%dimensions</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            temp_size=temp_size*field_size_info%dim_sizes(j)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keywordflow">          end do</span>          </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <span class="keywordflow">if</span> (data_definition%fields(i)%field_type .eq. map_field_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            field_array_sizes=(field_array_sizes+temp_size*string_length*2)-1</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            current_location=current_location+temp_size*string_length*2</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            field_array_sizes=(field_array_sizes+temp_size)-1</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            current_location=current_location+temp_size*type_extents(data_type)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">if</span> (data_definition%fields(i)%optional) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          <span class="keywordflow">if</span> (get_data_description_from_name(data_size_info, data_definition%fields(i)%name)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keywordflow">if</span> (data_type==string_data_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;              field_array_sizes=(field_array_sizes+string_length)-1</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;              current_location=current_location+type_extents(data_type)*string_length</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;              current_location=current_location+type_extents(data_type)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            field_ignores=field_ignores+1</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          <span class="keywordflow">if</span> (data_type==string_data_type) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            field_array_sizes=(field_array_sizes+string_length)-1</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            current_location=current_location+type_extents(data_type)*string_length</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            current_location=current_location+type_extents(data_type)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keyword">call </span>c_put_integer(field_end_locations, data_definition%fields(i)%name, current_location-1)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(field_dimensions)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keyword">call </span>c_put_integer(field_dimensions, data_definition%fields(i)%name, field_size_info%dimensions)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> (field_start .le. i-1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">! If there are outstanding fields to process then we do this here</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keyword">call </span>append_mpi_datatype(field_start, i-1, field_array_sizes, data_type, &amp;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;               type_extents, prev_data_type, type_counts+1, old_types, offsets, block_counts)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      type_counts=type_counts+1</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keyword">call </span>mpi_type_struct(type_counts, block_counts, offsets, old_types, new_type, ierr) </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keyword">call </span>mpi_type_commit(new_type, ierr)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keyword">call </span>unlock_mpi()</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keyword">call </span>mpi_type_size(new_type, data_size, ierr)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    build_mpi_datatype=new_type</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a94ec3fc73dd4cba3a1aa1b09f4d8e0af_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_a94ec3fc73dd4cba3a1aa1b09f4d8e0af_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a94ec3fc73dd4cba3a1aa1b09f4d8e0af_cgraph" id="anamespacempi__communication__mod_a94ec3fc73dd4cba3a1aa1b09f4d8e0af_cgraph">
<area shape="rect" title="Builds the MPI type that corresponds to the data which will be received from a specific MONC process...." alt="" coords="5,179,176,221"/>
<area shape="rect" href="namespaceio__server__client__mod.html#a84bf9d6a41f5f7fea53b4b62c166a77f" title="Appends the MPI datatype details to the block counts, old types and offsets arrays...." alt="" coords="239,13,394,54"/>
<area shape="rect" href="namespaceio__server__client__mod.html#a5c91dd79c12db74da24c9e318d750f02" title="Look up the data description that corresponds to a specific field keyed by its name." alt="" coords="243,77,391,133"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="231,209,402,250"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="668,220,811,247"/>
<area shape="rect" href="namespaceio__server__client__mod.html#ae78f9ba9a1846fdf7a7b873057b06a36" title="Provides the type extents of the types that we are using in construction of the MPI data type...." alt="" coords="224,274,409,315"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="231,339,402,381"/>
<area shape="rect" href="namespaceio__server__client__mod.html#a8d816b12c995d04f289de4f8d03a4d3d" title="Gets the MPI datatype from out internal representation of the field data type (as in the configuratio..." alt="" coords="457,5,620,61"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="461,274,616,315"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="457,209,620,250"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="859,213,1025,254"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="457,339,620,381"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a94ec3fc73dd4cba3a1aa1b09f4d8e0af_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_a94ec3fc73dd4cba3a1aa1b09f4d8e0af_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a94ec3fc73dd4cba3a1aa1b09f4d8e0af_icgraph" id="anamespacempi__communication__mod_a94ec3fc73dd4cba3a1aa1b09f4d8e0af_icgraph">
<area shape="rect" title="Builds the MPI type that corresponds to the data which will be received from a specific MONC process...." alt="" coords="961,5,1132,47"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="783,5,913,47"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="584,5,735,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,5,536,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="a56d4d49458bbf60e4d6b59b050273d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56d4d49458bbf60e4d6b59b050273d62">&#9670;&nbsp;</a></span>cancel_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mpi_communication_mod::cancel_request </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>req</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cancels a specific communication request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">req</td><td>Handle of the request to cancel </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00202">202</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: req</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">integer</span> :: ierr</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (req .ne. mpi_request_null) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">call </span>mpi_cancel(req, ierr)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keyword">call </span>unlock_mpi()</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a56d4d49458bbf60e4d6b59b050273d62_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_a56d4d49458bbf60e4d6b59b050273d62_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a56d4d49458bbf60e4d6b59b050273d62_cgraph" id="anamespacempi__communication__mod_a56d4d49458bbf60e4d6b59b050273d62_cgraph">
<area shape="rect" title="Cancels a specific communication request." alt="" coords="5,72,176,113"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="224,39,395,80"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="224,104,395,145"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="447,71,601,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="443,5,605,47"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="653,78,796,105"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="844,71,1011,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="443,136,605,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a56d4d49458bbf60e4d6b59b050273d62_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_a56d4d49458bbf60e4d6b59b050273d62_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a56d4d49458bbf60e4d6b59b050273d62_icgraph" id="anamespacempi__communication__mod_a56d4d49458bbf60e4d6b59b050273d62_icgraph">
<area shape="rect" title="Cancels a specific communication request." alt="" coords="604,5,775,47"/>
<area shape="rect" href="namespacempi__communication__mod.html#a7852c937574e58b245148b6d9db923e4" title="Cancels all outstanding communication requests." alt="" coords="385,5,556,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="a7852c937574e58b245148b6d9db923e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7852c937574e58b245148b6d9db923e4">&#9670;&nbsp;</a></span>cancel_requests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mpi_communication_mod::cancel_requests</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancels all outstanding communication requests. </p>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00196">196</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">call </span>cancel_request(command_request_handle)</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a7852c937574e58b245148b6d9db923e4_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_a7852c937574e58b245148b6d9db923e4_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a7852c937574e58b245148b6d9db923e4_cgraph" id="anamespacempi__communication__mod_a7852c937574e58b245148b6d9db923e4_cgraph">
<area shape="rect" title="Cancels all outstanding communication requests." alt="" coords="5,72,176,113"/>
<area shape="rect" href="namespacempi__communication__mod.html#a56d4d49458bbf60e4d6b59b050273d62" title="Cancels a specific communication request." alt="" coords="224,72,395,113"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="443,39,613,80"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="443,104,613,145"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="665,71,820,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="661,5,824,47"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="872,78,1015,105"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="1063,71,1229,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="661,136,824,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a7852c937574e58b245148b6d9db923e4_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_a7852c937574e58b245148b6d9db923e4_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a7852c937574e58b245148b6d9db923e4_icgraph" id="anamespacempi__communication__mod_a7852c937574e58b245148b6d9db923e4_icgraph">
<area shape="rect" title="Cancels all outstanding communication requests." alt="" coords="385,5,556,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="aa9da81a3b60ef8507b3eabdbd19a8f89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9da81a3b60ef8507b3eabdbd19a8f89">&#9670;&nbsp;</a></span>data_receive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public mpi_communication_mod::data_receive </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mpi_datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>num_elements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character, dimension(:), intent(inout), optional, allocatable&#160;</td>
          <td class="paramname"><em>dump_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>data_dump_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__server__client__mod_1_1data__sizing__description__type.html">data_sizing_description_type</a>), dimension(:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>description_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Awaits some data on the data channel. This is of the type, size from the source provided and can either be written into a byte buffer or integer buffer depending upon the arguments provided. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mpi_datatype</td><td>The MPI type of the data we are receiving </td></tr>
    <tr><td class="paramname">size</td><td>Number of elements to receive </td></tr>
    <tr><td class="paramname">source</td><td>The PID of the MONC process to receieve this data from </td></tr>
    <tr><td class="paramname">dump_data</td><td>(Optional) byte data buffer, for the data dump </td></tr>
    <tr><td class="paramname">description_data</td><td>(Optional) integer data buffer, for data description </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00165">165</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: mpi_datatype, num_elements, source</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: data_dump_id</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">character</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: dump_data</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">type</span>(data_sizing_description_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: description_data</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">integer</span> :: ierr, request, status(MPI_STATUS_SIZE), recv_count, tag_to_use</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(dump_data)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      tag_to_use=data_tag</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(data_dump_id)) tag_to_use=tag_to_use+data_dump_id</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keyword">call </span>mpi_irecv(dump_data, num_elements, mpi_datatype, source, tag_to_use, mpi_comm_world, request, ierr)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keyword">call </span>unlock_mpi()</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keyword">call </span>wait_for_mpi_request(request, status)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keyword">call </span>mpi_get_count(status, mpi_datatype, recv_count, ierr)      </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keyword">call </span>unlock_mpi()</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      data_receive=recv_count</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">present</span>(description_data)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keyword">call </span>mpi_irecv(description_data, num_elements, mpi_datatype, source, data_tag, mpi_comm_world, request, ierr)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keyword">call </span>unlock_mpi()</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keyword">call </span>wait_for_mpi_request(request, status)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keyword">call </span>mpi_get_count(status, mpi_datatype, recv_count, ierr)      </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keyword">call </span>unlock_mpi()</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      data_receive=recv_count</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_aa9da81a3b60ef8507b3eabdbd19a8f89_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_aa9da81a3b60ef8507b3eabdbd19a8f89_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_aa9da81a3b60ef8507b3eabdbd19a8f89_cgraph" id="anamespacempi__communication__mod_aa9da81a3b60ef8507b3eabdbd19a8f89_cgraph">
<area shape="rect" title="Awaits some data on the data channel. This is of the type, size from the source provided and can eith..." alt="" coords="5,71,176,112"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="451,5,621,47"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="451,136,621,177"/>
<area shape="rect" href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="224,71,395,112"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="681,71,836,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="677,5,840,47"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="888,78,1031,105"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="1079,71,1245,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="677,136,840,177"/>
<area shape="rect" href="namespacempi__communication__mod.html#aee6d81060fcad11a466f823627234e7c" title="Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation." alt="" coords="443,71,629,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_aa9da81a3b60ef8507b3eabdbd19a8f89_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_aa9da81a3b60ef8507b3eabdbd19a8f89_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_aa9da81a3b60ef8507b3eabdbd19a8f89_icgraph" id="anamespacempi__communication__mod_aa9da81a3b60ef8507b3eabdbd19a8f89_icgraph">
<area shape="rect" title="Awaits some data on the data channel. This is of the type, size from the source provided and can eith..." alt="" coords="1220,64,1391,105"/>
<area shape="rect" href="namespaceio__server__mod.html#aefce42fc11a68cb3783f1eb0f2c18610" title="Retrieves MONC information data, this is sent by MONC (and received) regardless, but only actioned if..." alt="" coords="1008,5,1172,47"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="806,43,937,84"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="783,107,960,163"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="584,47,735,88"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,79,536,120"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,86,337,113"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,86,99,113"/>
</map>
</div>

</div>
</div>
<a id="ae9569a173fd13c6772b5dfc8495c715b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9569a173fd13c6772b5dfc8495c715b">&#9670;&nbsp;</a></span>free_mpi_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mpi_communication_mod::free_mpi_type </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>the_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees an MPI type, used in clean up. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">the_type</td><td>The MPI type to free up </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00273">273</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: the_type</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">integer</span> :: ierr</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">call </span>mpi_type_free(the_type, ierr)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_ae9569a173fd13c6772b5dfc8495c715b_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_ae9569a173fd13c6772b5dfc8495c715b_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_ae9569a173fd13c6772b5dfc8495c715b_icgraph" id="anamespacempi__communication__mod_ae9569a173fd13c6772b5dfc8495c715b_icgraph">
<area shape="rect" title="Frees an MPI type, used in clean up." alt="" coords="580,46,751,87"/>
<area shape="rect" href="namespaceio__server__mod.html#a1067b04bf298bdec22d1c55144f3a8d5" title="Frees up the memory associated with individual registered MONCs. This is done at the end for all MONC..." alt="" coords="385,5,532,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,53,337,80"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,53,99,80"/>
</map>
</div>

</div>
</div>
<a id="aa524bcd4b7d0001d02dc3a324788610c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa524bcd4b7d0001d02dc3a324788610c">&#9670;&nbsp;</a></span>get_my_io_rank()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public mpi_communication_mod::get_my_io_rank </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>io_comm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves my IO server rank out of the number of IO servers that are running. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_comm</td><td>The IO server communicator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>My IO server rank </dd></dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00139">139</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: io_comm</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">integer</span> :: number, ierr</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">call </span>mpi_comm_rank(io_comm, number, ierr)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    get_my_io_rank=number</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_aa524bcd4b7d0001d02dc3a324788610c_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_aa524bcd4b7d0001d02dc3a324788610c_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_aa524bcd4b7d0001d02dc3a324788610c_icgraph" id="anamespacempi__communication__mod_aa524bcd4b7d0001d02dc3a324788610c_icgraph">
<area shape="rect" title="Retrieves my IO server rank out of the number of IO servers that are running." alt="" coords="385,5,556,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="abf62d60a03e5dd2a80a15ddd183e2668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf62d60a03e5dd2a80a15ddd183e2668">&#9670;&nbsp;</a></span>get_number_io_servers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public mpi_communication_mod::get_number_io_servers </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>io_comm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the number of IO servers that are running in total. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io_comm</td><td>The IO server communicator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of running IO servers </dd></dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00127">127</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: io_comm</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">integer</span> :: number, ierr</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">call </span>mpi_comm_size(io_comm, number, ierr)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    get_number_io_servers=number</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_abf62d60a03e5dd2a80a15ddd183e2668_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_abf62d60a03e5dd2a80a15ddd183e2668_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_abf62d60a03e5dd2a80a15ddd183e2668_icgraph" id="anamespacempi__communication__mod_abf62d60a03e5dd2a80a15ddd183e2668_icgraph">
<area shape="rect" title="Retrieves the number of IO servers that are running in total." alt="" coords="385,5,556,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="a51ffdc1413aeb89e7f9ea1c8ad5ed24c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51ffdc1413aeb89e7f9ea1c8ad5ed24c">&#9670;&nbsp;</a></span>initialise_mpi_communication()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mpi_communication_mod::initialise_mpi_communication </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>provided_threading</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises MPI communication. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">provided_threading</td><td>The provided threading mode </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00045">45</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: provided_threading</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    mpi_threading_mode=provided_threading</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (mpi_threading_mode .ne. mpi_thread_multiple .and. mpi_threading_mode .ne. mpi_thread_serialized) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;You must run MONC in MPI thread serialized or thread multiple mode for the IO server&quot;</span>)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keywordflow">    end if</span>    </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    manage_mpi_thread_safety=provided_threading == mpi_thread_serialized</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">call </span>check_thread_status(forthread_mutex_init(mpi_mutex, -1))</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a51ffdc1413aeb89e7f9ea1c8ad5ed24c_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_a51ffdc1413aeb89e7f9ea1c8ad5ed24c_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a51ffdc1413aeb89e7f9ea1c8ad5ed24c_cgraph" id="anamespacempi__communication__mod_a51ffdc1413aeb89e7f9ea1c8ad5ed24c_cgraph">
<area shape="rect" title="Initialises MPI communication." alt="" coords="5,71,204,112"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="269,5,424,47"/>
<area shape="rect" href="namespaceforthread__mod.html#ab29785b28c1d6bcf13e844b8d1230846" title=" " alt="" coords="265,71,428,112"/>
<area shape="rect" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20" title="Will log just from the master process." alt="" coords="252,137,441,163"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="489,75,632,102"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="680,68,847,109"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a51ffdc1413aeb89e7f9ea1c8ad5ed24c_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_a51ffdc1413aeb89e7f9ea1c8ad5ed24c_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a51ffdc1413aeb89e7f9ea1c8ad5ed24c_icgraph" id="anamespacempi__communication__mod_a51ffdc1413aeb89e7f9ea1c8ad5ed24c_icgraph">
<area shape="rect" title="Initialises MPI communication." alt="" coords="385,5,584,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="a44ac4f74cb4daf89481da8df1dabc10d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44ac4f74cb4daf89481da8df1dabc10d">&#9670;&nbsp;</a></span>lock_mpi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mpi_communication_mod::lock_mpi</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI. </p>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00057">57</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (manage_mpi_thread_safety) <span class="keyword">call </span>check_thread_status(forthread_mutex_lock(mpi_mutex))</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a44ac4f74cb4daf89481da8df1dabc10d_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_a44ac4f74cb4daf89481da8df1dabc10d_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a44ac4f74cb4daf89481da8df1dabc10d_cgraph" id="anamespacempi__communication__mod_a44ac4f74cb4daf89481da8df1dabc10d_cgraph">
<area shape="rect" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="5,39,176,80"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="228,5,383,47"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="224,71,387,112"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="435,13,577,39"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="625,5,792,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a44ac4f74cb4daf89481da8df1dabc10d_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_a44ac4f74cb4daf89481da8df1dabc10d_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a44ac4f74cb4daf89481da8df1dabc10d_icgraph" id="anamespacempi__communication__mod_a44ac4f74cb4daf89481da8df1dabc10d_icgraph">
<area shape="rect" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="1161,1050,1332,1091"/>
<area shape="rect" href="namespacempi__communication__mod.html#a94ec3fc73dd4cba3a1aa1b09f4d8e0af" title="Builds the MPI type that corresponds to the data which will be received from a specific MONC process...." alt="" coords="453,216,623,258"/>
<area shape="rect" href="namespacempi__communication__mod.html#a56d4d49458bbf60e4d6b59b050273d62" title="Cancels a specific communication request." alt="" coords="927,1050,1097,1091"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a68cd14e8efbb15c0bb5129e82140cdeb" title="Performs a clean of the broadcast progresses that no longer need to be stored." alt="" coords="935,1194,1089,1250"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a9c49585e6986ed7104ecc35a71347e78" title="Performs an inter IO broadcast of data from the root to all other IO servers. Note that this is on th..." alt="" coords="470,1228,606,1284"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2c67fccb16973e19938a1be7119a0f64" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="933,1326,1091,1367"/>
<area shape="rect" href="namespacempi__communication__mod.html#aa9da81a3b60ef8507b3eabdbd19a8f89" title="Awaits some data on the data channel. This is of the type, size from the source provided and can eith..." alt="" coords="685,284,856,326"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="931,1390,1093,1446"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="691,1730,851,1771"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="929,1470,1095,1511"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#a52442fc6df103bdee12c9d95cc9a9a73" title="Defines the dimensions and variables in a NetCDF file that consitute the IO server current state...." alt="" coords="693,561,848,617"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ab90e4b2c185d22faacd6f23c39bd9449" title="Stores the IO server state in the NetCDF file." alt="" coords="445,568,631,610"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="911,1534,1113,1590"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#a0bb9318bbaa968f84db7a18afa572b4a" title="Defines some state storate for a specific facet of the IO server. This creates the directory (locatio..." alt="" coords="922,519,1102,560"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="928,1614,1096,1670"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="935,1694,1089,1735"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#adb8512d99c36d96498328af7e47194cb" title="Handles the case where the local MONC processes have completed their collective operation for a speci..." alt="" coords="923,1114,1101,1170"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#ac10efaf9ebd3eed8dc0ade5f5f503d2b" title="Will determine the size of the package for different facets of the IO server state and kick off non&#45;b..." alt="" coords="931,584,1093,640"/>
<area shape="rect" href="namespacempi__communication__mod.html#aaec64bef427565b6e469af564d9d32d6" title="Registers a request for receiving a command from any MONC process on the command channel." alt="" coords="920,882,1104,923"/>
<area shape="rect" href="namespacempi__communication__mod.html#af9ae866733dedd5129dac4361d17e720" title="Tests for a command message based upon the request already registered." alt="" coords="685,939,856,980"/>
<area shape="rect" href="namespaceio__server__mod.html#af165fa2c9ad4d8d48537ee997432fdaa" title="Sends the data and field descriptions to the MONC process that just registered with the IO server." alt="" coords="213,63,391,104"/>
<area shape="rect" href="namespacempi__communication__mod.html#a4e6c15cbcdc2763a82c34491328c4742" title="Tests for inter IO server communication." alt="" coords="685,1004,856,1046"/>
<area shape="rect" href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="927,402,1097,443"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="691,712,850,783"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#a6f99dece53eb5c51cf1fcbd384ea7d08" title="Packags up and writes the actual IO server state into the NetCDF file. The act of serialisation will ..." alt="" coords="679,644,863,686"/>
<area shape="rect" href="namespacempi__communication__mod.html#a272f44aa1ed340d3e6efd306d075100b" title="Waits for all MPI requests to complete, either by managing thread safety and interleaving or just a c..." alt="" coords="926,158,1098,199"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="688,808,853,864"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a0a437b7c2ee1752a8c3ad3ce4797cced" title="Writes the conditional diagnostic variable names into the NetCDF file." alt="" coords="939,1758,1085,1814"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ae456ae2267a1cf3a1763d1cbd59039ab" title="Writes a coordinate variable into the NetCDF file." alt="" coords="935,1838,1089,1894"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a767df50b485665dac93bfdf57897c667" title="Writes out global attributes into the checkpoint." alt="" coords="935,1918,1089,1974"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a527dfbc289976e0eefcc432bb077040e" title=" " alt="" coords="939,2115,1085,2156"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a646b3fed89978ea8212eece9494f7c54" title=" " alt="" coords="931,2180,1093,2236"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2d8000c479d36f8c5c0c91aa482c9765" title="Writes out the options_database defining this model run." alt="" coords="931,1998,1093,2039"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#af3dc548945ef0bd31291214d13c4355b" title="Writes out the state for a specific facet into the NetCDF file. Note that this uses the ISO C binding..." alt="" coords="925,663,1099,704"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="237,286,367,327"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="7,158,157,199"/>
<area shape="rect" href="namespacempi__communication__mod.html#a7852c937574e58b245148b6d9db923e4" title="Cancels all outstanding communication requests." alt="" coords="453,1047,623,1088"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="207,961,397,988"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#ad2566335f2b2e7bccb878a1d35fb97b4" title="Calls out to do a broadcast progress clean if needed (i.e. every n steps.)" alt="" coords="693,1194,848,1250"/>
<area shape="rect" href="namespaceallreduction__inter__io__mod.html#a467bb14ad72911d3695efc951233470e" title="Internal completion, called after the reduce has completed (on root) and calls out to broadcast." alt="" coords="213,1194,391,1250"/>
<area shape="rect" href="namespaceallreduction__inter__io__mod.html#afb8d154fff5a46e854337bb4f0c2cfd3" title="Performs the all reduction inter IO reduction." alt="" coords="5,1194,159,1250"/>
<area shape="rect" href="namespaceio__server__mod.html#aefce42fc11a68cb3783f1eb0f2c18610" title="Retrieves MONC information data, this is sent by MONC (and received) regardless, but only actioned if..." alt="" coords="456,412,620,454"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="449,281,627,337"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="466,1730,610,1771"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#afbd4c0a62bdef47841ccb4731a0c96e8" title="Actually handles the processing for this data wrt the vertical reduction." alt="" coords="234,1114,370,1170"/>
<area shape="rect" href="namespaceio__server__mod.html#ada1b8581f80d696dc8aa636405c73aea" title="Awaits a command or shutdown from MONC processes and other IO servers." alt="" coords="466,954,610,995"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a7d635793eb07832a7420bf579526cdca" title="Checks all the reduction progresses and will remove any that have completed. This is designed to be c..." alt="" coords="690,401,851,457"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a93d313cfba0ead9d2d97ef6c094edbab" title="Finalises the reduction action, waiting for all outstanding requests and then freeing data." alt="" coords="691,481,851,537"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="466,771,610,812"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a47cb2b35b1ce243fb5044360a9bac4c3" title="Finalises the broadcast inter IO functionality." alt="" coords="689,85,853,141"/>
</map>
</div>

</div>
</div>
<a id="aee6d81060fcad11a466f823627234e7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee6d81060fcad11a466f823627234e7c">&#9670;&nbsp;</a></span>pause_for_mpi_interleaving()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mpi_communication_mod::pause_for_mpi_interleaving</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation. </p>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00067">67</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">call </span>usleep(int(ms_wait_between_tests, c_int32_t))</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_aee6d81060fcad11a466f823627234e7c_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_aee6d81060fcad11a466f823627234e7c_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_aee6d81060fcad11a466f823627234e7c_icgraph" id="anamespacempi__communication__mod_aee6d81060fcad11a466f823627234e7c_icgraph">
<area shape="rect" title="Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation." alt="" coords="4389,382,4576,423"/>
<area shape="rect" href="namespaceio__server__mod.html#ada1b8581f80d696dc8aa636405c73aea" title="Awaits a command or shutdown from MONC processes and other IO servers." alt="" coords="2871,22,3015,63"/>
<area shape="rect" href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="4170,382,4341,423"/>
<area shape="rect" href="namespacempi__communication__mod.html#a272f44aa1ed340d3e6efd306d075100b" title="Waits for all MPI requests to complete, either by managing thread safety and interleaving or just a c..." alt="" coords="4169,646,4341,687"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,200,337,227"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,200,99,227"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a7d635793eb07832a7420bf579526cdca" title="Checks all the reduction progresses and will remove any that have completed. This is designed to be c..." alt="" coords="3949,137,4110,193"/>
<area shape="rect" href="namespacempi__communication__mod.html#aa9da81a3b60ef8507b3eabdbd19a8f89" title="Awaits some data on the data channel. This is of the type, size from the source provided and can eith..." alt="" coords="3944,349,4115,390"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#a52442fc6df103bdee12c9d95cc9a9a73" title="Defines the dimensions and variables in a NetCDF file that consitute the IO server current state...." alt="" coords="3952,479,4107,535"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a93d313cfba0ead9d2d97ef6c094edbab" title="Finalises the reduction action, waiting for all outstanding requests and then freeing data." alt="" coords="3949,559,4109,615"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="3950,235,4109,306"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#a6f99dece53eb5c51cf1fcbd384ea7d08" title="Packags up and writes the actual IO server state into the NetCDF file. The act of serialisation will ..." alt="" coords="3937,414,4121,455"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a8ffab62808c76c7592c04db0b34dc426" title="Checks this action for completion, when all are completed then the IO server can shutdown as this is ..." alt="" coords="3713,137,3875,193"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#ad0bf6811584fdb36107b4d2e1c185d69" title=" " alt="" coords="3720,63,3868,105"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#afbd4c0a62bdef47841ccb4731a0c96e8" title="Actually handles the processing for this data wrt the vertical reduction." alt="" coords="3503,49,3639,105"/>
<area shape="rect" href="namespaceallreduction__inter__io__mod.html#afb8d154fff5a46e854337bb4f0c2cfd3" title="Performs the all reduction inter IO reduction." alt="" coords="3291,43,3444,99"/>
<area shape="rect" href="namespaceglobal__callback__inter__io__mod.html#ad475780629e2db0ae4b68f3e395e418d" title="Performs a global callback." alt="" coords="3080,43,3243,99"/>
<area shape="rect" href="namespaceio__server__mod.html#aefce42fc11a68cb3783f1eb0f2c18610" title="Retrieves MONC information data, this is sent by MONC (and received) regardless, but only actioned if..." alt="" coords="3712,407,3876,449"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="3506,454,3637,495"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,327,761,383"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="3292,454,3443,495"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,334,536,375"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ab90e4b2c185d22faacd6f23c39bd9449" title="Stores the IO server state in the NetCDF file." alt="" coords="3701,525,3887,566"/>
<area shape="rect" href="namespaceallreduction__inter__io__mod.html#adda372f876f04100eb7944557a195b64" title="Finalises the all reduction inter IO functionality." alt="" coords="3699,613,3889,669"/>
<area shape="rect" href="namespaceglobal__callback__inter__io__mod.html#a3c16286b2d9369ad1ada72d9c88684b1" title="Finalises the global callback." alt="" coords="3492,613,3651,669"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="3722,249,3866,290"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="3499,239,3643,295"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2419,160,2592,216"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="3295,246,3439,287"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1747,185,1897,241"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2204,199,2371,255"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1504,215,1699,257"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1305,160,1456,216"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,80,1240,136"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,160,1257,216"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,240,1247,296"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,160,1016,216"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,305,988,346"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1945,199,2156,255"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3086,173,3237,229"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="3089,305,3234,346"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2855,173,3032,229"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2646,181,2801,222"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="2640,305,2807,346"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a47cb2b35b1ce243fb5044360a9bac4c3" title="Finalises the broadcast inter IO functionality." alt="" coords="3947,639,4111,695"/>
</map>
</div>

</div>
</div>
<a id="aaec64bef427565b6e469af564d9d32d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaec64bef427565b6e469af564d9d32d6">&#9670;&nbsp;</a></span>register_command_receive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mpi_communication_mod::register_command_receive</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a request for receiving a command from any MONC process on the command channel. </p>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00149">149</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">integer</span> :: ierr</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keyword">call </span>mpi_irecv(command_buffer, 1, mpi_int, mpi_any_source, command_tag, &amp;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;         mpi_comm_world, command_request_handle, ierr)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keyword">call </span>unlock_mpi()</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_aaec64bef427565b6e469af564d9d32d6_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_aaec64bef427565b6e469af564d9d32d6_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_aaec64bef427565b6e469af564d9d32d6_cgraph" id="anamespacempi__communication__mod_aaec64bef427565b6e469af564d9d32d6_cgraph">
<area shape="rect" title="Registers a request for receiving a command from any MONC process on the command channel." alt="" coords="5,72,189,113"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="237,39,408,80"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="237,104,408,145"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="460,71,615,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="456,5,619,47"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="667,78,809,105"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="857,71,1024,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="456,136,619,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_aaec64bef427565b6e469af564d9d32d6_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_aaec64bef427565b6e469af564d9d32d6_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_aaec64bef427565b6e469af564d9d32d6_icgraph" id="anamespacempi__communication__mod_aaec64bef427565b6e469af564d9d32d6_icgraph">
<area shape="rect" title="Registers a request for receiving a command from any MONC process on the command channel." alt="" coords="796,5,980,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="namespacempi__communication__mod.html#af9ae866733dedd5129dac4361d17e720" title="Tests for a command message based upon the request already registered." alt="" coords="577,35,748,76"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
<area shape="rect" href="namespaceio__server__mod.html#ada1b8581f80d696dc8aa636405c73aea" title="Awaits a command or shutdown from MONC processes and other IO servers." alt="" coords="385,35,529,76"/>
</map>
</div>

</div>
</div>
<a id="af9ae866733dedd5129dac4361d17e720"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ae866733dedd5129dac4361d17e720">&#9670;&nbsp;</a></span>test_for_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public mpi_communication_mod::test_for_command </td>
          <td>(</td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests for a command message based upon the request already registered. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">command</td><td>The command which is received is returned to the caller </td></tr>
    <tr><td class="paramname">source</td><td>The PID of the source MONC process is returned to the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether a message is received or not </dd></dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00218">218</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: command, source</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">integer</span> :: ierr, status(MPI_STATUS_SIZE), complete</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">call </span>mpi_test(command_request_handle, complete, status, ierr)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keyword">call </span>unlock_mpi()</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (complete .eq. 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      command = command_buffer</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      source = status(mpi_source)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keyword">call </span>register_command_receive()</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      test_for_command=.true.</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      test_for_command=.false.</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_af9ae866733dedd5129dac4361d17e720_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_af9ae866733dedd5129dac4361d17e720_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_af9ae866733dedd5129dac4361d17e720_cgraph" id="anamespacempi__communication__mod_af9ae866733dedd5129dac4361d17e720_cgraph">
<area shape="rect" title="Tests for a command message based upon the request already registered." alt="" coords="5,71,176,112"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="456,39,627,80"/>
<area shape="rect" href="namespacempi__communication__mod.html#aaec64bef427565b6e469af564d9d32d6" title="Registers a request for receiving a command from any MONC process on the command channel." alt="" coords="224,71,408,112"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="456,104,627,145"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="679,71,833,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="675,5,837,47"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="885,78,1028,105"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="1076,71,1243,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="675,136,837,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_af9ae866733dedd5129dac4361d17e720_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_af9ae866733dedd5129dac4361d17e720_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_af9ae866733dedd5129dac4361d17e720_icgraph" id="anamespacempi__communication__mod_af9ae866733dedd5129dac4361d17e720_icgraph">
<area shape="rect" title="Tests for a command message based upon the request already registered." alt="" coords="577,5,748,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ada1b8581f80d696dc8aa636405c73aea" title="Awaits a command or shutdown from MONC processes and other IO servers." alt="" coords="385,5,529,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="a4e6c15cbcdc2763a82c34491328c4742"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e6c15cbcdc2763a82c34491328c4742">&#9670;&nbsp;</a></span>test_for_inter_io()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public mpi_communication_mod::test_for_inter_io </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structconfiguration__parser__mod_1_1io__configuration__inter__communication__description.html">io_configuration_inter_communication_description</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>inter_io_communications</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>number_of_inter_io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>io_communicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character, dimension(:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>data_buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests for inter IO server communication. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inter_io_communications</td><td>Data structures representing the possible inter IO communication sources </td></tr>
    <tr><td class="paramname">number_of_inter_io</td><td>Number of inter IO communication descriptions registered </td></tr>
    <tr><td class="paramname">command</td><td>The command which is received is returned to the caller </td></tr>
    <tr><td class="paramname">source</td><td>The source of the inter IO communication, which is set to the index of the inter descriptor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether a message is received or not </dd></dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00243">243</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: number_of_inter_io, io_communicator</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: command, source</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">type</span>(io_configuration_inter_communication_description), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: inter_io_communications</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">character</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(inout)</span> :: data_buffer</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">integer</span> :: i, ierr, status(MPI_STATUS_SIZE), message_size</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">logical</span> :: message_pending</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">do</span> i=1, number_of_inter_io</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keyword">call </span>mpi_iprobe(mpi_any_source, inter_io_communications(i)%message_tag, io_communicator, message_pending, status, ierr)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">if</span> (message_pending) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">call </span>mpi_get_count(status, mpi_byte, message_size, ierr)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keyword">allocate</span>(data_buffer(message_size))</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keyword">call </span>mpi_recv(data_buffer, message_size, mpi_byte, mpi_any_source, inter_io_communications(i)%message_tag, &amp;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;             io_communicator, mpi_status_ignore, ierr)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keyword">call </span>unlock_mpi()</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        command=inter_io_communication</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        source=i</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        test_for_inter_io=.true.</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">call </span>unlock_mpi()</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    test_for_inter_io=.false.</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a4e6c15cbcdc2763a82c34491328c4742_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_a4e6c15cbcdc2763a82c34491328c4742_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a4e6c15cbcdc2763a82c34491328c4742_cgraph" id="anamespacempi__communication__mod_a4e6c15cbcdc2763a82c34491328c4742_cgraph">
<area shape="rect" title="Tests for inter IO server communication." alt="" coords="5,72,176,113"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="224,39,395,80"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="224,104,395,145"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="447,71,601,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="443,5,605,47"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="653,78,796,105"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="844,71,1011,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="443,136,605,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a4e6c15cbcdc2763a82c34491328c4742_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_a4e6c15cbcdc2763a82c34491328c4742_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a4e6c15cbcdc2763a82c34491328c4742_icgraph" id="anamespacempi__communication__mod_a4e6c15cbcdc2763a82c34491328c4742_icgraph">
<area shape="rect" title="Tests for inter IO server communication." alt="" coords="577,5,748,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ada1b8581f80d696dc8aa636405c73aea" title="Awaits a command or shutdown from MONC processes and other IO servers." alt="" coords="385,5,529,47"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,13,337,39"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,13,99,39"/>
</map>
</div>

</div>
</div>
<a id="aad52010c006d90df6c097898ebdf4487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad52010c006d90df6c097898ebdf4487">&#9670;&nbsp;</a></span>unlock_mpi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mpi_communication_mod::unlock_mpi</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI. </p>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00062">62</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (manage_mpi_thread_safety) <span class="keyword">call </span>check_thread_status(forthread_mutex_unlock(mpi_mutex))</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_aad52010c006d90df6c097898ebdf4487_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_aad52010c006d90df6c097898ebdf4487_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_aad52010c006d90df6c097898ebdf4487_cgraph" id="anamespacempi__communication__mod_aad52010c006d90df6c097898ebdf4487_cgraph">
<area shape="rect" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="5,39,176,80"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="228,5,383,47"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="224,71,387,112"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="435,13,577,39"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="625,5,792,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_aad52010c006d90df6c097898ebdf4487_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_aad52010c006d90df6c097898ebdf4487_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_aad52010c006d90df6c097898ebdf4487_icgraph" id="anamespacempi__communication__mod_aad52010c006d90df6c097898ebdf4487_icgraph">
<area shape="rect" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="1161,1050,1332,1091"/>
<area shape="rect" href="namespacempi__communication__mod.html#a94ec3fc73dd4cba3a1aa1b09f4d8e0af" title="Builds the MPI type that corresponds to the data which will be received from a specific MONC process...." alt="" coords="453,216,623,258"/>
<area shape="rect" href="namespacempi__communication__mod.html#a56d4d49458bbf60e4d6b59b050273d62" title="Cancels a specific communication request." alt="" coords="927,1050,1097,1091"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a68cd14e8efbb15c0bb5129e82140cdeb" title="Performs a clean of the broadcast progresses that no longer need to be stored." alt="" coords="935,1194,1089,1250"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a9c49585e6986ed7104ecc35a71347e78" title="Performs an inter IO broadcast of data from the root to all other IO servers. Note that this is on th..." alt="" coords="470,1228,606,1284"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2c67fccb16973e19938a1be7119a0f64" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="933,1326,1091,1367"/>
<area shape="rect" href="namespacempi__communication__mod.html#aa9da81a3b60ef8507b3eabdbd19a8f89" title="Awaits some data on the data channel. This is of the type, size from the source provided and can eith..." alt="" coords="685,284,856,326"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a1ce0c117e268cee4460b6385bc8629c3" title="Defines a coordinate variable in the NetCDF file." alt="" coords="931,1390,1093,1446"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a6c970a34b31a068f500ae6a1235d9906" title="Defines a NetCDF file &#45; which creates it, defines all dimensions and variables. This must be called b..." alt="" coords="691,1730,851,1771"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a9492c076905001a53f8cb3085739d6db" title="Defines spatial dimensions in the diagnostics file." alt="" coords="929,1470,1095,1511"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#a52442fc6df103bdee12c9d95cc9a9a73" title="Defines the dimensions and variables in a NetCDF file that consitute the IO server current state...." alt="" coords="693,561,848,617"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ab90e4b2c185d22faacd6f23c39bd9449" title="Stores the IO server state in the NetCDF file." alt="" coords="445,568,631,610"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#adb0cc64b982ca21514e74a881b1ee30f" title="Defines the options_database variable in the NetCDF file." alt="" coords="911,1534,1113,1590"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#a0bb9318bbaa968f84db7a18afa572b4a" title="Defines some state storate for a specific facet of the IO server. This creates the directory (locatio..." alt="" coords="922,519,1102,560"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a66915aa056fc8a300dbedbc0c7b0c3ca" title="Defines dimensions for all required dimensions. This is usually the number required plus one,..." alt="" coords="928,1614,1096,1670"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a58faae9f572a8860a586d47251df2ab4" title="Defines all variables in the file writer state." alt="" coords="935,1694,1089,1735"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#adb8512d99c36d96498328af7e47194cb" title="Handles the case where the local MONC processes have completed their collective operation for a speci..." alt="" coords="923,1114,1101,1170"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#ac10efaf9ebd3eed8dc0ade5f5f503d2b" title="Will determine the size of the package for different facets of the IO server state and kick off non&#45;b..." alt="" coords="931,584,1093,640"/>
<area shape="rect" href="namespacempi__communication__mod.html#aaec64bef427565b6e469af564d9d32d6" title="Registers a request for receiving a command from any MONC process on the command channel." alt="" coords="920,882,1104,923"/>
<area shape="rect" href="namespacempi__communication__mod.html#af9ae866733dedd5129dac4361d17e720" title="Tests for a command message based upon the request already registered." alt="" coords="685,939,856,980"/>
<area shape="rect" href="namespaceio__server__mod.html#af165fa2c9ad4d8d48537ee997432fdaa" title="Sends the data and field descriptions to the MONC process that just registered with the IO server." alt="" coords="213,63,391,104"/>
<area shape="rect" href="namespacempi__communication__mod.html#a4e6c15cbcdc2763a82c34491328c4742" title="Tests for inter IO server communication." alt="" coords="685,1004,856,1046"/>
<area shape="rect" href="namespacempi__communication__mod.html#a6ed06ee79c19ff1f57a344de48e53806" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="927,402,1097,443"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="691,712,850,783"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#a6f99dece53eb5c51cf1fcbd384ea7d08" title="Packags up and writes the actual IO server state into the NetCDF file. The act of serialisation will ..." alt="" coords="679,644,863,686"/>
<area shape="rect" href="namespacempi__communication__mod.html#a272f44aa1ed340d3e6efd306d075100b" title="Waits for all MPI requests to complete, either by managing thread safety and interleaving or just a c..." alt="" coords="926,158,1098,199"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a10f13979aff7110f8df58356fb4e398d" title="Writes collective variables, where we are working with the values from multiple MONCs and storing the..." alt="" coords="688,808,853,864"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a0a437b7c2ee1752a8c3ad3ce4797cced" title="Writes the conditional diagnostic variable names into the NetCDF file." alt="" coords="939,1758,1085,1814"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ae456ae2267a1cf3a1763d1cbd59039ab" title="Writes a coordinate variable into the NetCDF file." alt="" coords="935,1838,1089,1894"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a767df50b485665dac93bfdf57897c667" title="Writes out global attributes into the checkpoint." alt="" coords="935,1918,1089,1974"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a527dfbc289976e0eefcc432bb077040e" title=" " alt="" coords="939,2115,1085,2156"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a646b3fed89978ea8212eece9494f7c54" title=" " alt="" coords="931,2180,1093,2236"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a2d8000c479d36f8c5c0c91aa482c9765" title="Writes out the options_database defining this model run." alt="" coords="931,1998,1093,2039"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#af3dc548945ef0bd31291214d13c4355b" title="Writes out the state for a specific facet into the NetCDF file. Note that this uses the ISO C binding..." alt="" coords="925,663,1099,704"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="237,286,367,327"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="7,158,157,199"/>
<area shape="rect" href="namespacempi__communication__mod.html#a7852c937574e58b245148b6d9db923e4" title="Cancels all outstanding communication requests." alt="" coords="453,1047,623,1088"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="207,961,397,988"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#ad2566335f2b2e7bccb878a1d35fb97b4" title="Calls out to do a broadcast progress clean if needed (i.e. every n steps.)" alt="" coords="693,1194,848,1250"/>
<area shape="rect" href="namespaceallreduction__inter__io__mod.html#a467bb14ad72911d3695efc951233470e" title="Internal completion, called after the reduce has completed (on root) and calls out to broadcast." alt="" coords="213,1194,391,1250"/>
<area shape="rect" href="namespaceallreduction__inter__io__mod.html#afb8d154fff5a46e854337bb4f0c2cfd3" title="Performs the all reduction inter IO reduction." alt="" coords="5,1194,159,1250"/>
<area shape="rect" href="namespaceio__server__mod.html#aefce42fc11a68cb3783f1eb0f2c18610" title="Retrieves MONC information data, this is sent by MONC (and received) regardless, but only actioned if..." alt="" coords="456,412,620,454"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="449,281,627,337"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="466,1730,610,1771"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#afbd4c0a62bdef47841ccb4731a0c96e8" title="Actually handles the processing for this data wrt the vertical reduction." alt="" coords="234,1114,370,1170"/>
<area shape="rect" href="namespaceio__server__mod.html#ada1b8581f80d696dc8aa636405c73aea" title="Awaits a command or shutdown from MONC processes and other IO servers." alt="" coords="466,954,610,995"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a7d635793eb07832a7420bf579526cdca" title="Checks all the reduction progresses and will remove any that have completed. This is designed to be c..." alt="" coords="690,401,851,457"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a93d313cfba0ead9d2d97ef6c094edbab" title="Finalises the reduction action, waiting for all outstanding requests and then freeing data." alt="" coords="691,481,851,537"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="466,771,610,812"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a47cb2b35b1ce243fb5044360a9bac4c3" title="Finalises the broadcast inter IO functionality." alt="" coords="689,85,853,141"/>
</map>
</div>

</div>
</div>
<a id="a6ed06ee79c19ff1f57a344de48e53806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ed06ee79c19ff1f57a344de48e53806">&#9670;&nbsp;</a></span>wait_for_mpi_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mpi_communication_mod::wait_for_mpi_request </td>
          <td>(</td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(mpi_status_size), intent(inout), optional&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for a specific MPI request to complete, either by managing thread safety and interleaving or just a call to MPI if we are in multiple mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">request</td><td>The MPI request handle </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00074">74</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: request</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">optional</span> :: status(MPI_STATUS_SIZE)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">integer</span> :: ierr, flag</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (manage_mpi_thread_safety) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      flag=0</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (flag .ne. 1)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(status)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;          <span class="keyword">call </span>mpi_test(request, flag, status, ierr)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          <span class="keyword">call </span>mpi_test(request, flag, mpi_status_ignore, ierr)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keyword">call </span>unlock_mpi()      </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">if</span> (flag .ne. 1) <span class="keyword">call </span>pause_for_mpi_interleaving()</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(status)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keyword">call </span>mpi_wait(request, status, ierr)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keyword">call </span>mpi_wait(request, mpi_status_ignore, ierr)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a6ed06ee79c19ff1f57a344de48e53806_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_a6ed06ee79c19ff1f57a344de48e53806_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a6ed06ee79c19ff1f57a344de48e53806_cgraph" id="anamespacempi__communication__mod_a6ed06ee79c19ff1f57a344de48e53806_cgraph">
<area shape="rect" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="5,71,176,112"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="232,5,403,47"/>
<area shape="rect" href="namespacempi__communication__mod.html#aee6d81060fcad11a466f823627234e7c" title="Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation." alt="" coords="224,71,411,112"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="232,136,403,177"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="463,71,617,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="459,5,621,47"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="669,78,812,105"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="860,71,1027,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="459,136,621,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a6ed06ee79c19ff1f57a344de48e53806_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_a6ed06ee79c19ff1f57a344de48e53806_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a6ed06ee79c19ff1f57a344de48e53806_icgraph" id="anamespacempi__communication__mod_a6ed06ee79c19ff1f57a344de48e53806_icgraph">
<area shape="rect" title="Waits for a specific MPI request to complete, either by managing thread safety and interleaving or ju..." alt="" coords="4177,267,4348,309"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a7d635793eb07832a7420bf579526cdca" title="Checks all the reduction progresses and will remove any that have completed. This is designed to be c..." alt="" coords="3957,77,4118,133"/>
<area shape="rect" href="namespacempi__communication__mod.html#aa9da81a3b60ef8507b3eabdbd19a8f89" title="Awaits some data on the data channel. This is of the type, size from the source provided and can eith..." alt="" coords="1305,150,1476,191"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#a52442fc6df103bdee12c9d95cc9a9a73" title="Defines the dimensions and variables in a NetCDF file that consitute the IO server current state...." alt="" coords="3960,304,4115,360"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a93d313cfba0ead9d2d97ef6c094edbab" title="Finalises the reduction action, waiting for all outstanding requests and then freeing data." alt="" coords="3957,448,4117,504"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#abc1e910adcd0ef7c86299b5286fc365f" title="Writes contiguous collective variable blocks into the NetCDF files. These are blocks of data spanning..." alt="" coords="3958,209,4117,279"/>
<area shape="rect" href="namespaceio__server__state__writer__mod.html#a6f99dece53eb5c51cf1fcbd384ea7d08" title="Packags up and writes the actual IO server state into the NetCDF file. The act of serialisation will ..." alt="" coords="3945,383,4129,425"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#a8ffab62808c76c7592c04db0b34dc426" title="Checks this action for completion, when all are completed then the IO server can shutdown as this is ..." alt="" coords="3721,5,3883,61"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#ad0bf6811584fdb36107b4d2e1c185d69" title=" " alt="" coords="3728,85,3876,126"/>
<area shape="rect" href="namespacereduction__inter__io__mod.html#afbd4c0a62bdef47841ccb4731a0c96e8" title="Actually handles the processing for this data wrt the vertical reduction." alt="" coords="3511,77,3647,133"/>
<area shape="rect" href="namespaceallreduction__inter__io__mod.html#afb8d154fff5a46e854337bb4f0c2cfd3" title="Performs the all reduction inter IO reduction." alt="" coords="3299,56,3452,112"/>
<area shape="rect" href="namespaceglobal__callback__inter__io__mod.html#ad475780629e2db0ae4b68f3e395e418d" title="Performs a global callback." alt="" coords="3088,52,3251,108"/>
<area shape="rect" href="namespaceio__server__mod.html#ada1b8581f80d696dc8aa636405c73aea" title="Awaits a command or shutdown from MONC processes and other IO servers." alt="" coords="2665,43,2809,85"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,77,337,104"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,77,99,104"/>
<area shape="rect" href="namespaceio__server__mod.html#aefce42fc11a68cb3783f1eb0f2c18610" title="Retrieves MONC information data, this is sent by MONC (and received) regardless, but only actioned if..." alt="" coords="1079,150,1243,191"/>
<area shape="rect" href="namespaceio__server__mod.html#a5e5c9b6be433b4b2bebbfa01ddf0bec0" title="Initialise the sizing of data definitions from a MONC process. The IO server determines,..." alt="" coords="847,118,978,159"/>
<area shape="rect" href="namespaceio__server__mod.html#a153d99e94dcccfaea63104af86095dce" title="Retrieves the message from MONC off the data channel and throws this to a thread in the thread pool t..." alt="" coords="584,201,761,257"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="597,118,748,159"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="385,118,536,159"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#ab90e4b2c185d22faacd6f23c39bd9449" title="Stores the IO server state in the NetCDF file." alt="" coords="3709,347,3895,389"/>
<area shape="rect" href="namespaceallreduction__inter__io__mod.html#adda372f876f04100eb7944557a195b64" title="Finalises the all reduction inter IO functionality." alt="" coords="3707,448,3897,504"/>
<area shape="rect" href="namespaceglobal__callback__inter__io__mod.html#a3c16286b2d9369ad1ada72d9c88684b1" title="Finalises the global callback." alt="" coords="3500,448,3659,504"/>
<area shape="rect" href="namespacenetcdf__filetype__writer__mod.html#a797c4ff7ba5863cdff2746729ec8e1fc" title="Writes the contents of a variable to the NetCDF file. This also removes the written entries from the ..." alt="" coords="3730,226,3874,267"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a3df9fda1cc189c370e8599947191e559" title="Determines if a file can be written to its overarching write representation. If so then a write is is..." alt="" coords="3507,224,3651,280"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a303133afee5100e6a9b0b19ead391dfa" title="For a specific field wil determine and handle any outstanding fields writes until an outstanding writ..." alt="" coords="2439,280,2612,336"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9271347f390a41c78caacc174002d0b4" title="Issues the actual file creation, write of available fields and closure if all completed." alt="" coords="3303,329,3447,370"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a7149ce030c6fa05c7789b5e1e10be905" title=" " alt="" coords="1767,325,1917,381"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4d77a55167cf260497e14e1f86a8e54b" title="Provides a single ordered field, i.e. Q fields have been split by this point." alt="" coords="2224,329,2391,385"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#abdd6a0f59e9d20b22f8dad6922d86998" title="Processes queued up items for a specific field&#39;s ordering. This will send any available fields to the..." alt="" coords="1524,383,1719,425"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a0edc2294f387e9906c4b106396415b63" title="Provides a field to the write federator (a collective diagnostic or prognostic)" alt="" coords="1315,347,1466,403"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#ae55118a13d09d6d75229e0cc6f748e31" title="Provides a field to the write federator with no source (a none collective diagnostic)" alt="" coords="1081,267,1240,323"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a61030ab70e43ed5b49c6ca3900d9bfb3" title=" " alt="" coords="1064,347,1257,403"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#acfd94b193f4f73b22d6a48314f7fd2e0" title="Data communicated from MONC is provided to this write federator and then included if the configuratio..." alt="" coords="1074,427,1247,483"/>
<area shape="rect" href="namespacewriter__field__manager__mod.html#a7c173bbbc4904ac12141d3ca6c494e38" title=" " alt="" coords="809,347,1016,403"/>
<area shape="rect" href="namespaceio__server__mod.html#a96c2285d5c9b5badb426a0e065abdf4a" title="Handles the command for data download from a specific process. This will allocate the receive buffer ..." alt="" coords="837,434,988,475"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9b04288042049d5e432068c5923b026d" title="Provides fields (either diagnostics or prognostics) to the write federator which will action these as..." alt="" coords="1965,329,2176,385"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a4e6cf3c74ee165c8ece3735913e75e0a" title="Will check whether there are any pending writes and if so will issue a chain write for this." alt="" coords="3094,289,3245,345"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a977faf0b0a12f54b8002555e6f791856" title="Checks a writer trigger and issues a file creation along with field write if the conditions (time or ..." alt="" coords="3097,431,3242,473"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a9ec7f85e388c7212a8aa98acefc2b9d0" title="Call back for the inter IO reduction which actually does the NetCDF file closing which is a collectiv..." alt="" coords="2863,289,3040,345"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a37589f9aced0f51f811ed15c462d33cb" title="Closes the diagnostics file, this is done via a global callback to issue the closes synchronously (co..." alt="" coords="2660,297,2815,338"/>
<area shape="rect" href="namespacewriter__federator__mod.html#a1af403ddb2a3d977bfc3f81a6f834488" title="Checks all writer entries for any trigger fires and issues the underlying file storage." alt="" coords="2442,494,2609,535"/>
</map>
</div>

</div>
</div>
<a id="a272f44aa1ed340d3e6efd306d075100b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a272f44aa1ed340d3e6efd306d075100b">&#9670;&nbsp;</a></span>waitall_for_mpi_requests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mpi_communication_mod::waitall_for_mpi_requests </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>requests</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for all MPI requests to complete, either by managing thread safety and interleaving or just a call to MPI if we are in multiple mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">requests</td><td>The MPI request handles to wait for </td></tr>
    <tr><td class="paramname">count</td><td>The number of request handles to wait for </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00105">105</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: requests</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: count</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">integer</span> :: ierr, flag</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span> (manage_mpi_thread_safety) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      flag=0</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (flag .ne. 1)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">call </span>lock_mpi()</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keyword">call </span>mpi_testall(count, requests, flag, mpi_statuses_ignore, ierr)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keyword">call </span>unlock_mpi()      </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">if</span> (flag .ne. 1) <span class="keyword">call </span>pause_for_mpi_interleaving()</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keyword">call </span>mpi_waitall(count, requests, mpi_statuses_ignore, ierr)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a272f44aa1ed340d3e6efd306d075100b_cgraph.png" border="0" usemap="#anamespacempi__communication__mod_a272f44aa1ed340d3e6efd306d075100b_cgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a272f44aa1ed340d3e6efd306d075100b_cgraph" id="anamespacempi__communication__mod_a272f44aa1ed340d3e6efd306d075100b_cgraph">
<area shape="rect" title="Waits for all MPI requests to complete, either by managing thread safety and interleaving or just a c..." alt="" coords="5,71,177,112"/>
<area shape="rect" href="namespacempi__communication__mod.html#a44ac4f74cb4daf89481da8df1dabc10d" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then locks MPI." alt="" coords="233,5,404,47"/>
<area shape="rect" href="namespacempi__communication__mod.html#aee6d81060fcad11a466f823627234e7c" title="Pauses for a specific number of ms to allow for MPI interleaving, this is to avoid starvation." alt="" coords="225,71,412,112"/>
<area shape="rect" href="namespacempi__communication__mod.html#aad52010c006d90df6c097898ebdf4487" title="If we are explicitly managing MPI thread safety (SERIALIZED mode) then unlocks MPI." alt="" coords="233,136,404,177"/>
<area shape="rect" href="namespacethreadpool__mod.html#a64977cc4d8fab28cdbfabd03b5f28d3a" title="Checks the error status of any thread operation and reports an error if it failed." alt="" coords="464,71,619,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a9101345b87d2c0e18fb020677cf767b9" title=" " alt="" coords="460,5,623,47"/>
<area shape="rect" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45" title="Logs a message at the specified level. If the level is above the current level then the message is ig..." alt="" coords="671,78,813,105"/>
<area shape="rect" href="namespacelogging__mod.html#ac5c3277c18a4c378f0024c555cb5680a" title="Returns the string preamble that applies to the specific logging level." alt="" coords="861,71,1028,112"/>
<area shape="rect" href="namespaceforthread__mod.html#a6068972cad8d59eb6b29c8301d331090" title=" " alt="" coords="460,136,623,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacempi__communication__mod_a272f44aa1ed340d3e6efd306d075100b_icgraph.png" border="0" usemap="#anamespacempi__communication__mod_a272f44aa1ed340d3e6efd306d075100b_icgraph" alt=""/></div>
<map name="namespacempi__communication__mod_a272f44aa1ed340d3e6efd306d075100b_icgraph" id="anamespacempi__communication__mod_a272f44aa1ed340d3e6efd306d075100b_icgraph">
<area shape="rect" title="Waits for all MPI requests to complete, either by managing thread safety and interleaving or just a c..." alt="" coords="836,49,1008,90"/>
<area shape="rect" href="namespacebroadcast__inter__io__mod.html#a47cb2b35b1ce243fb5044360a9bac4c3" title="Finalises the broadcast inter IO functionality." alt="" coords="624,5,788,61"/>
<area shape="rect" href="namespaceio__server__mod.html#a95f289d7a2a91f45be0accb5328cc178" title="Handles registration from some MONC process. The source process sends some data description to this I..." alt="" coords="631,85,781,126"/>
<area shape="rect" href="namespaceallreduction__inter__io__mod.html#adda372f876f04100eb7944557a195b64" title="Finalises the all reduction inter IO functionality." alt="" coords="385,5,576,61"/>
<area shape="rect" href="namespaceglobal__callback__inter__io__mod.html#a3c16286b2d9369ad1ada72d9c88684b1" title="Finalises the global callback." alt="" coords="163,5,321,61"/>
<area shape="rect" href="namespaceio__server__mod.html#ab843eee74fe31492952c1c88304730d7" title="Called to handle a specific command that has been recieved." alt="" coords="405,85,556,126"/>
<area shape="rect" href="namespaceio__server__mod.html#ac818aa1985977c9887acda6315139114" title="Called to start the IO server and once this subroutine returns then it indicates that the IO server h..." alt="" coords="147,92,337,119"/>
<area shape="rect" href="monc__driver_8F90.html#a38fac04eb034f0802b465898f3976e17" title="MONC program entry point which simply calls the main procedure in the MONC module." alt="" coords="5,92,99,119"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af185079bd304166f60b964d68a2af985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af185079bd304166f60b964d68a2af985">&#9670;&nbsp;</a></span>command_buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mpi_communication_mod::command_buffer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Buffer used to receive the command data into when it arrives on that channel. </p>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00032">32</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">integer</span> :: command_buffer,&amp; !&lt; Buffer used to receive the command data into when it arrives on that channel</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;       command_request_handle, &amp; !&lt; Request handle representing the asynchronous P2P command request</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;       mpi_threading_mode</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab32a589b93e30b3ed6046fe824997bac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab32a589b93e30b3ed6046fe824997bac">&#9670;&nbsp;</a></span>command_request_handle</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer mpi_communication_mod::command_request_handle</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Request handle representing the asynchronous P2P command request. </p>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00032">32</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>

</div>
</div>
<a id="a27aa961d3f6e32685b89abb7e1128f4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27aa961d3f6e32685b89abb7e1128f4c">&#9670;&nbsp;</a></span>manage_mpi_thread_safety</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical mpi_communication_mod::manage_mpi_thread_safety</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00036">36</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">logical</span> :: manage_mpi_thread_safety</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa820840801f1d774cf9ed1f904e2f7bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa820840801f1d774cf9ed1f904e2f7bc">&#9670;&nbsp;</a></span>mpi_mutex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, volatile mpi_communication_mod::mpi_mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00035">35</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">volatile</span> :: mpi_mutex</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab039946f1a8ec0bb0b848c4efeb71f36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab039946f1a8ec0bb0b848c4efeb71f36">&#9670;&nbsp;</a></span>mpi_threading_mode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer mpi_communication_mod::mpi_threading_mode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00032">32</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>

</div>
</div>
<a id="ab779fbac010de793120b7d0798a0c253"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab779fbac010de793120b7d0798a0c253">&#9670;&nbsp;</a></span>ms_wait_between_tests</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter mpi_communication_mod::ms_wait_between_tests =100</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Interface to the C usleep Linux call which allows us to sleep for a specific number of MS. </p>

<p class="definition">Definition at line <a class="el" href="mpicommunication_8F90_source.html#l00021">21</a> of file <a class="el" href="mpicommunication_8F90_source.html">mpicommunication.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: MS_WAIT_BETWEEN_TESTS=100</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="anamespacelogging__mod_html_ad68309846cd8f9e77edaa6abd02f65a0"><div class="ttname"><a href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">logging_mod::log_error</a></div><div class="ttdeci">integer, parameter, public log_error</div><div class="ttdoc">Only log ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00011">logging.F90:11</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ac4f13ac385499c85190cb184030e4f45"><div class="ttname"><a href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">logging_mod::log_log</a></div><div class="ttdeci">subroutine, public log_log(level, message, str)</div><div class="ttdoc">Logs a message at the specified level. If the level is above the current level then the message is ig...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00074">logging.F90:75</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ad95937a250467334622daeb5cff78c20"><div class="ttname"><a href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">logging_mod::log_master_log</a></div><div class="ttdeci">subroutine, public log_master_log(level, message)</div><div class="ttdoc">Will log just from the master process.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00046">logging.F90:47</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

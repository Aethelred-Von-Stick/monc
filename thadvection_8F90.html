<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: components/thadvection/src/thadvection.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_3fc319532adbb1a1ec12d48eda03478d.html">thadvection</a></li><li class="navelem"><a class="el" href="dir_16264ad302b8c8837ec63170036e9fc4.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">thadvection.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="thadvection_8F90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacethadvection__mod"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html">thadvection_mod</a></td></tr>
<tr class="memdesc:namespacethadvection__mod"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specific theta advection, which involves the vertical advection of reference state and advection of mean baroclinicity. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa3a66036a48786d8846a242110e96590"><td class="memItemLeft" align="right" valign="top">type(component_descriptor_type) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590">thadvection_mod::thadvection_get_descriptor</a> ()</td></tr>
<tr class="memdesc:aa3a66036a48786d8846a242110e96590"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides a description of this component for the core to register.  <a href="namespacethadvection__mod.html#aa3a66036a48786d8846a242110e96590">More...</a><br /></td></tr>
<tr class="separator:aa3a66036a48786d8846a242110e96590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf88aa826be438abd234748262372cee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#adf88aa826be438abd234748262372cee">thadvection_mod::initialisation_callback</a> (current_state)</td></tr>
<tr class="memdesc:adf88aa826be438abd234748262372cee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation callback to set up the variables and data needed by the component.  <a href="namespacethadvection__mod.html#adf88aa826be438abd234748262372cee">More...</a><br /></td></tr>
<tr class="separator:adf88aa826be438abd234748262372cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a4a9ea2a9012878a1e12ce6188e8191"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a6a4a9ea2a9012878a1e12ce6188e8191">thadvection_mod::finalisation_callback</a> (current_state)</td></tr>
<tr class="separator:a6a4a9ea2a9012878a1e12ce6188e8191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09d1b793a23456817a68ec1c07c1257b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a09d1b793a23456817a68ec1c07c1257b">thadvection_mod::timestep_callback</a> (current_state)</td></tr>
<tr class="memdesc:a09d1b793a23456817a68ec1c07c1257b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestep callback, will call the two separate procedures to do their advection if needed.  <a href="namespacethadvection__mod.html#a09d1b793a23456817a68ec1c07c1257b">More...</a><br /></td></tr>
<tr class="separator:a09d1b793a23456817a68ec1c07c1257b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadad7cf391b176d99be59815af29feb6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#aadad7cf391b176d99be59815af29feb6">thadvection_mod::vertical_advection_of_reference_state</a> (current_state, local_y, local_x)</td></tr>
<tr class="memdesc:aadad7cf391b176d99be59815af29feb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vertical advection of the reference state. It doesn't seem consistent to do the advection in this way if TVD advection of the deviation from the reference state has been selected. Separate vertical advection of the reference state was introduced to improve energy conservation when carrying out idealized gravity wave simulations in a deep, dry isothermal layer, for which the difference in potential temp between top and bottom was of order 100K. In less extreme cases the benefits are unlikely to be significant and with TVD advection energy conservation has been compromised so the best way forward might be to recombine the reference state into l_th.  <a href="namespacethadvection__mod.html#aadad7cf391b176d99be59815af29feb6">More...</a><br /></td></tr>
<tr class="separator:aadad7cf391b176d99be59815af29feb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b19a797f5a9555cf25c4f97a6f53d54"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a7b19a797f5a9555cf25c4f97a6f53d54">thadvection_mod::advection_of_mean_baroclinicity</a> (current_state, local_y, local_x)</td></tr>
<tr class="memdesc:a7b19a797f5a9555cf25c4f97a6f53d54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs advection of the mean baroclinicity if appropriate.  <a href="namespacethadvection__mod.html#a7b19a797f5a9555cf25c4f97a6f53d54">More...</a><br /></td></tr>
<tr class="separator:a7b19a797f5a9555cf25c4f97a6f53d54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af414b9967eb65e448d9d937f84076a6a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#af414b9967eb65e448d9d937f84076a6a">thadvection_mod::save_precomponent_tendencies</a> (current_state, cxn, cyn, txn, tyn)</td></tr>
<tr class="memdesc:af414b9967eb65e448d9d937f84076a6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the 3d tendencies coming into the component.  <a href="namespacethadvection__mod.html#af414b9967eb65e448d9d937f84076a6a">More...</a><br /></td></tr>
<tr class="separator:af414b9967eb65e448d9d937f84076a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca0838c1d444d0a29a1b7ac211ae0ac"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#acca0838c1d444d0a29a1b7ac211ae0ac">thadvection_mod::compute_component_tendencies</a> (current_state, cxn, cyn, txn, tyn)</td></tr>
<tr class="memdesc:acca0838c1d444d0a29a1b7ac211ae0ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computation of component tendencies.  <a href="namespacethadvection__mod.html#acca0838c1d444d0a29a1b7ac211ae0ac">More...</a><br /></td></tr>
<tr class="separator:acca0838c1d444d0a29a1b7ac211ae0ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50aad1af96470f2debcd7a6191c6c110"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a50aad1af96470f2debcd7a6191c6c110">thadvection_mod::field_information_retrieval_callback</a> (current_state, name, field_information)</td></tr>
<tr class="memdesc:a50aad1af96470f2debcd7a6191c6c110"><td class="mdescLeft">&#160;</td><td class="mdescRight">Field information retrieval callback, this returns information for a specific component's published field.  <a href="namespacethadvection__mod.html#a50aad1af96470f2debcd7a6191c6c110">More...</a><br /></td></tr>
<tr class="separator:a50aad1af96470f2debcd7a6191c6c110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a22c4e41063ea55633b24702d7fff4f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a1a22c4e41063ea55633b24702d7fff4f">thadvection_mod::field_value_retrieval_callback</a> (current_state, name, field_value)</td></tr>
<tr class="memdesc:a1a22c4e41063ea55633b24702d7fff4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Field value retrieval callback, this returns the value of a specific published field.  <a href="namespacethadvection__mod.html#a1a22c4e41063ea55633b24702d7fff4f">More...</a><br /></td></tr>
<tr class="separator:a1a22c4e41063ea55633b24702d7fff4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad95878bb451ea6f40760492bab2d3ccc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#ad95878bb451ea6f40760492bab2d3ccc">thadvection_mod::set_published_field_value</a> (field_value, real_1d_field, real_2d_field, real_3d_field)</td></tr>
<tr class="memdesc:ad95878bb451ea6f40760492bab2d3ccc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the published field value from the temporary diagnostic values held by this component.  <a href="namespacethadvection__mod.html#ad95878bb451ea6f40760492bab2d3ccc">More...</a><br /></td></tr>
<tr class="separator:ad95878bb451ea6f40760492bab2d3ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6890b280d0a038bed4334ff74c8b5df3"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a6890b280d0a038bed4334ff74c8b5df3">thadvection_mod::baroclinicity_use_geostrophic_shear</a></td></tr>
<tr class="separator:a6890b280d0a038bed4334ff74c8b5df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c194ec186fb01867184f7783a93f17"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#aa0c194ec186fb01867184f7783a93f17">thadvection_mod::l_advect_mean_baroclinicity</a></td></tr>
<tr class="separator:aa0c194ec186fb01867184f7783a93f17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae567a1be5c97cc52df73ecfddf08b740"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#ae567a1be5c97cc52df73ecfddf08b740">thadvection_mod::fcoriol</a></td></tr>
<tr class="separator:ae567a1be5c97cc52df73ecfddf08b740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d7220f01227627b9d0ce1f70b3ce95"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a40d7220f01227627b9d0ce1f70b3ce95">thadvection_mod::fcoriol_over_g</a></td></tr>
<tr class="separator:a40d7220f01227627b9d0ce1f70b3ce95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bdc24a4de0deeab1e464fe26a811e7b"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a8bdc24a4de0deeab1e464fe26a811e7b">thadvection_mod::rate_change_geostrophic_wind_x</a></td></tr>
<tr class="separator:a8bdc24a4de0deeab1e464fe26a811e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f761e0495b03da85f5c95dba870eb74"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a3f761e0495b03da85f5c95dba870eb74">thadvection_mod::rate_change_geostrophic_wind_y</a></td></tr>
<tr class="separator:a3f761e0495b03da85f5c95dba870eb74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9100518570437cd458a1c0f19fe8671"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#ab9100518570437cd458a1c0f19fe8671">thadvection_mod::multiplicative_factor_x</a></td></tr>
<tr class="separator:ab9100518570437cd458a1c0f19fe8671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a788224a6b535c10c26ee9280cd488ae3"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a788224a6b535c10c26ee9280cd488ae3">thadvection_mod::multiplicative_factor_y</a></td></tr>
<tr class="separator:a788224a6b535c10c26ee9280cd488ae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d17dd15447010be07b7c20e07aa13fb"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a4d17dd15447010be07b7c20e07aa13fb">thadvection_mod::tend_3d_th</a></td></tr>
<tr class="separator:a4d17dd15447010be07b7c20e07aa13fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac45e02b9e66c20e3fdbc3aaec01d7a6a"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#ac45e02b9e66c20e3fdbc3aaec01d7a6a">thadvection_mod::tend_3d_tabs</a></td></tr>
<tr class="separator:ac45e02b9e66c20e3fdbc3aaec01d7a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abccca55f73e9fed3304b036c885ffbb9"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#abccca55f73e9fed3304b036c885ffbb9">thadvection_mod::l_tend_3d_th</a></td></tr>
<tr class="separator:abccca55f73e9fed3304b036c885ffbb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa019cd3b36ae4c3183dfe5658aa23a"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#adaa019cd3b36ae4c3183dfe5658aa23a">thadvection_mod::l_tend_3d_tabs</a></td></tr>
<tr class="separator:adaa019cd3b36ae4c3183dfe5658aa23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86193f4fa3cbfac3121d3222e0beaf6c"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a86193f4fa3cbfac3121d3222e0beaf6c">thadvection_mod::tend_pr_tot_th</a></td></tr>
<tr class="separator:a86193f4fa3cbfac3121d3222e0beaf6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4856c6b8bb3a1ff2244aab0251c7a293"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a4856c6b8bb3a1ff2244aab0251c7a293">thadvection_mod::tend_pr_tot_tabs</a></td></tr>
<tr class="separator:a4856c6b8bb3a1ff2244aab0251c7a293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eab866a95422869e463fcbb2ab80e58"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a9eab866a95422869e463fcbb2ab80e58">thadvection_mod::l_tend_pr_tot_th</a></td></tr>
<tr class="separator:a9eab866a95422869e463fcbb2ab80e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad95bdbfe8b671df6a109a64a452ffbb"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#aad95bdbfe8b671df6a109a64a452ffbb">thadvection_mod::l_tend_pr_tot_tabs</a></td></tr>
<tr class="separator:aad95bdbfe8b671df6a109a64a452ffbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b7521e09ca56f751cbc84e1bd7f7567"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacethadvection__mod.html#a2b7521e09ca56f751cbc84e1bd7f7567">thadvection_mod::diagnostic_generation_frequency</a></td></tr>
<tr class="separator:a2b7521e09ca56f751cbc84e1bd7f7567"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>

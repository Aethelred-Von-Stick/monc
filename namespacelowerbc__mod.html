<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MONC: lowerbc_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MONC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">lowerbc_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This sets the lower boundary conditions for theta and the q variables.  
<a href="namespacelowerbc__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a343916bf8438789e9c1e7d2a0374868d"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structmonc__component__mod_1_1component__descriptor__type.html">component_descriptor_type</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d">lowerbc_get_descriptor</a> ()</td></tr>
<tr class="memdesc:a343916bf8438789e9c1e7d2a0374868d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Descriptor of this component for registration.  <a href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d">More...</a><br /></td></tr>
<tr class="separator:a343916bf8438789e9c1e7d2a0374868d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b0b38f86fb2bc11d7e91d23e9e72ea8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a5b0b38f86fb2bc11d7e91d23e9e72ea8">initialisation_callback</a> (current_state)</td></tr>
<tr class="separator:a5b0b38f86fb2bc11d7e91d23e9e72ea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45038b8627049e5012c6753e42a21bab"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a45038b8627049e5012c6753e42a21bab">finalisation_callback</a> (current_state)</td></tr>
<tr class="separator:a45038b8627049e5012c6753e42a21bab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a083d888e8af68d1137d2a70cf069fa61"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a083d888e8af68d1137d2a70cf069fa61">allocate_applicable_fields</a> (current_state)</td></tr>
<tr class="separator:a083d888e8af68d1137d2a70cf069fa61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9527a3669b5d258f88b3378dd0981aa1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1">timestep_callback</a> (current_state)</td></tr>
<tr class="separator:a9527a3669b5d258f88b3378dd0981aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a936327adbe2f9c869bc068a9c4541c2a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a">compute_lower_boundary_conditions</a> (current_state, current_y_index, current_x_index, zu, zv, zth, th, zq, q)</td></tr>
<tr class="separator:a936327adbe2f9c869bc068a9c4541c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a229cbb79a21eb832c2120efa2ebe9648"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a229cbb79a21eb832c2120efa2ebe9648">register_async_wrapping_recv_requests</a> (current_state)</td></tr>
<tr class="memdesc:a229cbb79a21eb832c2120efa2ebe9648"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers asynchronous wrapping recv requests as needed.  <a href="namespacelowerbc__mod.html#a229cbb79a21eb832c2120efa2ebe9648">More...</a><br /></td></tr>
<tr class="separator:a229cbb79a21eb832c2120efa2ebe9648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad583a541b4fc06d748de229212a2bef9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#ad583a541b4fc06d748de229212a2bef9">complete_async_wrapping</a> (current_state, zth, zq)</td></tr>
<tr class="memdesc:ad583a541b4fc06d748de229212a2bef9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Completes the asynchronous wrapping if required for periodic boundary conditions.  <a href="namespacelowerbc__mod.html#ad583a541b4fc06d748de229212a2bef9">More...</a><br /></td></tr>
<tr class="separator:ad583a541b4fc06d748de229212a2bef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a1838d4210babb8412f95daaf13ceb6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a4a1838d4210babb8412f95daaf13ceb6">package_y_wrapping_send_buffer</a> (current_state, zth, zq, first_y_index, second_y_index)</td></tr>
<tr class="memdesc:a4a1838d4210babb8412f95daaf13ceb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Packages theta and Q fields (if enabled) into the send buffer for Y.  <a href="namespacelowerbc__mod.html#a4a1838d4210babb8412f95daaf13ceb6">More...</a><br /></td></tr>
<tr class="separator:a4a1838d4210babb8412f95daaf13ceb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa60c943e6353850120f27cbce43b9362"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#aa60c943e6353850120f27cbce43b9362">package_x_wrapping_send_buffer</a> (current_state, zth, zq, first_x_index, second_x_index)</td></tr>
<tr class="memdesc:aa60c943e6353850120f27cbce43b9362"><td class="mdescLeft">&#160;</td><td class="mdescRight">Packages theta and Q fields (if enabled) into the send buffer for X.  <a href="namespacelowerbc__mod.html#aa60c943e6353850120f27cbce43b9362">More...</a><br /></td></tr>
<tr class="separator:aa60c943e6353850120f27cbce43b9362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18bf5e755161004bd2c4822469236b8a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a18bf5e755161004bd2c4822469236b8a">unpackage_y_wrapping_recv_buffer</a> (current_state, zth, zq, first_y_index, second_y_index)</td></tr>
<tr class="memdesc:a18bf5e755161004bd2c4822469236b8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for Y.  <a href="namespacelowerbc__mod.html#a18bf5e755161004bd2c4822469236b8a">More...</a><br /></td></tr>
<tr class="separator:a18bf5e755161004bd2c4822469236b8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40ad183f436b44987b0d86222d23767e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a40ad183f436b44987b0d86222d23767e">unpackage_x_wrapping_recv_buffer</a> (current_state, zth, zq, first_x_index, second_x_index)</td></tr>
<tr class="memdesc:a40ad183f436b44987b0d86222d23767e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for X.  <a href="namespacelowerbc__mod.html#a40ad183f436b44987b0d86222d23767e">More...</a><br /></td></tr>
<tr class="separator:a40ad183f436b44987b0d86222d23767e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49dca339dbb94d484fd3a63fec7c768"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#ac49dca339dbb94d484fd3a63fec7c768">handle_convective_fluxes</a> (current_state, current_y_index, current_x_index, horizontal_velocity_at_k2, th, q)</td></tr>
<tr class="separator:ac49dca339dbb94d484fd3a63fec7c768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b00bb0c62bf9b11c7ffca03b7f4c1d3"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a6b00bb0c62bf9b11c7ffca03b7f4c1d3">look</a> (current_state, vel)</td></tr>
<tr class="separator:a6b00bb0c62bf9b11c7ffca03b7f4c1d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08f2b603916c77f427fbad748a1fa9ab"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a08f2b603916c77f427fbad748a1fa9ab">handle_neutral_fluxes</a> (current_state, current_y_index, current_x_index, horizontal_velocity_at_k2, th, q)</td></tr>
<tr class="separator:a08f2b603916c77f427fbad748a1fa9ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21cd44bf71a728dd75c95253ee3a9d41"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a21cd44bf71a728dd75c95253ee3a9d41">handle_stable_fluxes</a> (current_state, current_y_index, current_x_index, horizontal_velocity_at_k2, th, q)</td></tr>
<tr class="separator:a21cd44bf71a728dd75c95253ee3a9d41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1949fccdff268f7bb7d728476f08844d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a1949fccdff268f7bb7d728476f08844d">compute_using_fixed_surface_fluxes</a> (current_state, current_y_index, current_x_index, horizontal_velocity_at_k2, th, q)</td></tr>
<tr class="separator:a1949fccdff268f7bb7d728476f08844d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf0bcbc5026584a7a88fd13973f3a07"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a6bf0bcbc5026584a7a88fd13973f3a07">compute_using_fixed_surface_temperature</a> (current_state, current_y_index, current_x_index, horizontal_velocity_at_k2, zth, th, zq, q)</td></tr>
<tr class="separator:a6bf0bcbc5026584a7a88fd13973f3a07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cf23db09102d82c7b15a2c1aae40c0d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a9cf23db09102d82c7b15a2c1aae40c0d">simple_boundary_values</a> (current_state, current_y_index, current_x_index, th, q)</td></tr>
<tr class="separator:a9cf23db09102d82c7b15a2c1aae40c0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acde8d0932ff3e7ec747211af3e958e5e"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#acde8d0932ff3e7ec747211af3e958e5e">mostbc</a> (current_state, delu, delt, z1, ustrdg, tstrdg)</td></tr>
<tr class="memdesc:acde8d0932ff3e7ec747211af3e958e5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the Monin-Obukhov equations in the case of specified surface values of temperature and mixing ratio,combined into a specified value of virtual temperature. It is a modified version of the subroutine described in Bull and Derbyshire (TDN197) based on the assumption that the similarity functions and roughness lengths for temperature and mixing ratio are the same. In that case, all the original theory can be used if we replace temperature by virtual temperature. The form of the non-dimensionalised wind shear used is 1.0 + BETAM z/L for the stable case and (1.0 - GAMMAM z/L)**1/4 for the unstable case. The form of the non-dimensionalised temperature gradient used is 1.0 + BETAH z/L for the stable case and (1.0 - GAMMAH z/L)**1/2 for the unstable case.  <a href="namespacelowerbc__mod.html#acde8d0932ff3e7ec747211af3e958e5e">More...</a><br /></td></tr>
<tr class="separator:acde8d0932ff3e7ec747211af3e958e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb152571350643368a0a0f745c92c6f9"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#afb152571350643368a0a0f745c92c6f9">solve_monin_obukhov_unstable_case</a> (delu, delt, ellmocon, ustrdg, tstrdg, vertical_grid)</td></tr>
<tr class="separator:afb152571350643368a0a0f745c92c6f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9be31e8991ba29fe4cbe8e5628098494"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a9be31e8991ba29fe4cbe8e5628098494">solve_monin_obukhov_stable_case</a> (delu, delt, zlogm, cmbc, ustrdg, tstrdg)</td></tr>
<tr class="separator:a9be31e8991ba29fe4cbe8e5628098494"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a42cf0a4c6111355a878b4aed084d0f59"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a42cf0a4c6111355a878b4aed084d0f59">convergence_success</a> =1</td></tr>
<tr class="separator:a42cf0a4c6111355a878b4aed084d0f59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0198362b96cac12d1c02725771052b9"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#af0198362b96cac12d1c02725771052b9">convergence_richardson_too_large</a> =2</td></tr>
<tr class="separator:af0198362b96cac12d1c02725771052b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d8f3161ac289a1ce512a34cd1df8a71"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a7d8f3161ac289a1ce512a34cd1df8a71">convergence_failure</a> =3</td></tr>
<tr class="separator:a7d8f3161ac289a1ce512a34cd1df8a71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad674491162046b0d800e0db40a4d15c0"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#ad674491162046b0d800e0db40a4d15c0">smth</a> = 0.05_DEFAULT_PRECISION</td></tr>
<tr class="separator:ad674491162046b0d800e0db40a4d15c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9c6ba03c9259bd57376fbd31bc9cb92"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#ab9c6ba03c9259bd57376fbd31bc9cb92">tolm</a> =1.0E-4_DEFAULT_PRECISION</td></tr>
<tr class="separator:ab9c6ba03c9259bd57376fbd31bc9cb92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e06f5e9bea255bf31fe3b1b295583d0"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a1e06f5e9bea255bf31fe3b1b295583d0">tolt</a> =1.0E-4_DEFAULT_PRECISION</td></tr>
<tr class="separator:a1e06f5e9bea255bf31fe3b1b295583d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aced5f8511935639826bb09ab33b40178"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#aced5f8511935639826bb09ab33b40178">tstrcona</a></td></tr>
<tr class="separator:aced5f8511935639826bb09ab33b40178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad314cc0c36d082b9a231ee7f4bc44877"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#ad314cc0c36d082b9a231ee7f4bc44877">rhmbc</a></td></tr>
<tr class="separator:ad314cc0c36d082b9a231ee7f4bc44877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6f3740a54a7a66edae226acae2714d0"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#ad6f3740a54a7a66edae226acae2714d0">ddbc</a></td></tr>
<tr class="separator:ad6f3740a54a7a66edae226acae2714d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6b9bbf1b28960345f467054a9fc627"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a3f6b9bbf1b28960345f467054a9fc627">ddbc_x4</a></td></tr>
<tr class="separator:a3f6b9bbf1b28960345f467054a9fc627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54b9b1064deeb658e0f2ae4b52f01e06"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a54b9b1064deeb658e0f2ae4b52f01e06">eecon</a></td></tr>
<tr class="separator:a54b9b1064deeb658e0f2ae4b52f01e06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bb57c7352de3bade00ee5dd8a728734"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a0bb57c7352de3bade00ee5dd8a728734">r2ddbc</a></td></tr>
<tr class="separator:a0bb57c7352de3bade00ee5dd8a728734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78ecc44c07960053f9d830c875576322"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a78ecc44c07960053f9d830c875576322">rcmbc</a></td></tr>
<tr class="separator:a78ecc44c07960053f9d830c875576322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a750b25438a4d55b3ddf705d75c003bd1"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a750b25438a4d55b3ddf705d75c003bd1">tstrconb</a></td></tr>
<tr class="separator:a750b25438a4d55b3ddf705d75c003bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa19d030df1c2c3df73261717ed5d6fdd"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#aa19d030df1c2c3df73261717ed5d6fdd">x4con</a></td></tr>
<tr class="separator:aa19d030df1c2c3df73261717ed5d6fdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a267b9de88f367aca800288371d159ba4"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a267b9de88f367aca800288371d159ba4">xx0con</a></td></tr>
<tr class="separator:a267b9de88f367aca800288371d159ba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac86952501766e86cc6c4ff25dc6bdaae"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#ac86952501766e86cc6c4ff25dc6bdaae">y2con</a></td></tr>
<tr class="separator:ac86952501766e86cc6c4ff25dc6bdaae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc8b8003765f05e26ade25567f577904"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#abc8b8003765f05e26ade25567f577904">yy0con</a></td></tr>
<tr class="separator:abc8b8003765f05e26ade25567f577904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdf0fb94beeaa5b68510276192d8788b"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#afdf0fb94beeaa5b68510276192d8788b">viscous_courant_coefficient</a></td></tr>
<tr class="separator:afdf0fb94beeaa5b68510276192d8788b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5048dfa12d3654d20309e2924bcd206d"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a5048dfa12d3654d20309e2924bcd206d">x_wrapping_send_buffer</a></td></tr>
<tr class="separator:a5048dfa12d3654d20309e2924bcd206d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc2c558581632bd04311fe235f67debb"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#abc2c558581632bd04311fe235f67debb">y_wrapping_send_buffer</a></td></tr>
<tr class="separator:abc2c558581632bd04311fe235f67debb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8408c5127816f7042eb1af8a40862af5"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a8408c5127816f7042eb1af8a40862af5">x_wrapping_recv_buffer</a></td></tr>
<tr class="separator:a8408c5127816f7042eb1af8a40862af5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a803091c0618aa41f2af473670f97a2af"><td class="memItemLeft" align="right" valign="top">real(kind=default_precision), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a803091c0618aa41f2af473670f97a2af">y_wrapping_recv_buffer</a></td></tr>
<tr class="separator:a803091c0618aa41f2af473670f97a2af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb20c5057d5bfc9deb5cc26fed953b28"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#afb20c5057d5bfc9deb5cc26fed953b28">iqv</a></td></tr>
<tr class="separator:afb20c5057d5bfc9deb5cc26fed953b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7c4635785f10e8ac83c3377d9009592"><td class="memItemLeft" align="right" valign="top">integer, dimension(4)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#af7c4635785f10e8ac83c3377d9009592">wrapping_comm_requests</a></td></tr>
<tr class="separator:af7c4635785f10e8ac83c3377d9009592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43bb6e10f4e67194f36d8831ba400ac0"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a43bb6e10f4e67194f36d8831ba400ac0">y_wrapping_target_id</a></td></tr>
<tr class="separator:a43bb6e10f4e67194f36d8831ba400ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a723a120ab7487889fa0dbf7391a75448"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelowerbc__mod.html#a723a120ab7487889fa0dbf7391a75448">x_wrapping_target_id</a></td></tr>
<tr class="separator:a723a120ab7487889fa0dbf7391a75448"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This sets the lower boundary conditions for theta and the q variables. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a083d888e8af68d1137d2a70cf069fa61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a083d888e8af68d1137d2a70cf069fa61">&#9670;&nbsp;</a></span>allocate_applicable_fields()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::allocate_applicable_fields </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00156">156</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">integer</span> :: z_size, y_size, x_size, i</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    z_size=current_state%local_grid%size(z_index) + current_state%local_grid%halo_size(z_index) * 2</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    y_size=current_state%local_grid%size(y_index) + current_state%local_grid%halo_size(y_index) * 2</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    x_size=current_state%local_grid%size(x_index) + current_state%local_grid%halo_size(x_index) * 2</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">allocate</span>(current_state%dis%data(z_size, y_size, x_size), &amp;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;         current_state%dis_th%data(z_size, y_size, x_size), current_state%disq(current_state%number_q_fields))</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">do</span> i=1,current_state%number_q_fields</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keyword">allocate</span>(current_state%disq(i)%data(z_size, y_size, x_size))</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordflow">    end do</span>   </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a083d888e8af68d1137d2a70cf069fa61_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a083d888e8af68d1137d2a70cf069fa61_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a083d888e8af68d1137d2a70cf069fa61_icgraph" id="anamespacelowerbc__mod_a083d888e8af68d1137d2a70cf069fa61_icgraph">
<area shape="rect" title=" " alt="" coords="425,5,576,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a5b0b38f86fb2bc11d7e91d23e9e72ea8" title=" " alt="" coords="204,5,377,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<a id="ad583a541b4fc06d748de229212a2bef9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad583a541b4fc06d748de229212a2bef9">&#9670;&nbsp;</a></span>complete_async_wrapping()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::complete_async_wrapping </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>zth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>zq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Completes the asynchronous wrapping if required for periodic boundary conditions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">zth</td><td>Temperature field </td></tr>
    <tr><td class="paramname">zq</td><td>Q fields </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00282">282</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: zth</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: zq</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">integer</span> :: ierr, n</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(x_wrapping_send_buffer) .or. <span class="keyword">allocated</span>(y_wrapping_send_buffer)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(y_wrapping_send_buffer)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">if</span> (current_state%parallel%my_coords(y_index) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <span class="keyword">call </span>package_y_wrapping_send_buffer(current_state, zth, zq, current_state%local_grid%local_domain_start_index(y_index),&amp;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;               current_state%local_grid%local_domain_start_index(y_index)+1)        </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          <span class="keyword">call </span>package_y_wrapping_send_buffer(current_state, zth, zq, current_state%local_grid%local_domain_end_index(y_index)-1,&amp;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;               current_state%local_grid%local_domain_end_index(y_index))        </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordflow">        end if</span>        </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keyword">call </span>mpi_isend(y_wrapping_send_buffer, <span class="keyword">size</span>(y_wrapping_send_buffer), precision_type, &amp;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;             y_wrapping_target_id, 0, current_state%parallel%neighbour_comm, &amp;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;             wrapping_comm_requests(2), ierr)       </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(x_wrapping_send_buffer)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">if</span> (current_state%parallel%my_coords(x_index) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          <span class="keyword">call </span>package_x_wrapping_send_buffer(current_state, zth, zq, current_state%local_grid%local_domain_start_index(x_index),&amp;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;               current_state%local_grid%local_domain_start_index(x_index)+1)        </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <span class="keyword">call </span>package_x_wrapping_send_buffer(current_state, zth, zq, current_state%local_grid%local_domain_end_index(x_index)-1,&amp;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;               current_state%local_grid%local_domain_end_index(x_index))        </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordflow">        end if</span>        </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keyword">call </span>mpi_isend(x_wrapping_send_buffer, <span class="keyword">size</span>(x_wrapping_send_buffer), precision_type, &amp;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;             x_wrapping_target_id, 0, current_state%parallel%neighbour_comm, &amp;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;             wrapping_comm_requests(4), ierr)        </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">! If send buffer is allocated then recv buffer is allocated, therefore only test the send buffer here and assume recv</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keyword">call </span>mpi_waitall(4, wrapping_comm_requests, mpi_statuses_ignore, ierr)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      wrapping_comm_requests=mpi_request_null</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(y_wrapping_recv_buffer)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">if</span> (current_state%parallel%my_coords(y_index) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          <span class="keyword">call </span>unpackage_y_wrapping_recv_buffer(current_state, zth, zq, 1, 2)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          <span class="keyword">call </span>unpackage_y_wrapping_recv_buffer(current_state, zth, zq, &amp;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;               current_state%local_grid%local_domain_end_index(y_index)+1, &amp;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;               current_state%local_grid%local_domain_end_index(y_index)+2)          </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(x_wrapping_recv_buffer)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">if</span> (current_state%parallel%my_coords(x_index) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          <span class="keyword">call </span>unpackage_x_wrapping_recv_buffer(current_state, zth, zq, 1, 2)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          <span class="keyword">call </span>unpackage_x_wrapping_recv_buffer(current_state, zth, zq, &amp;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;               current_state%local_grid%local_domain_end_index(x_index)+1, &amp;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;               current_state%local_grid%local_domain_end_index(x_index)+2)          </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordflow">    end if</span> </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> (current_state%parallel%my_rank == y_wrapping_target_id) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        zth%data(1,1,:)=zth%data(1, current_state%local_grid%local_domain_end_index(y_index)-1, :)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        zth%data(1,2,:)=zth%data(1, current_state%local_grid%local_domain_end_index(y_index), :)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        zth%data(1,current_state%local_grid%local_domain_end_index(y_index)+1,:)=&amp;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;             zth%data(1, current_state%local_grid%local_domain_start_index(y_index), :)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        zth%data(1,current_state%local_grid%local_domain_end_index(y_index)+2,:)=&amp;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;             zth%data(1, current_state%local_grid%local_domain_start_index(y_index)+1, :)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">do</span> n=1, current_state%number_q_fields</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          zq(n)%data(1,1,:)=zq(n)%data(1, current_state%local_grid%local_domain_end_index(y_index)-1, :)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;          zq(n)%data(1,2,:)=zq(n)%data(1, current_state%local_grid%local_domain_end_index(y_index), :)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          zq(n)%data(1,current_state%local_grid%local_domain_end_index(y_index)+1,:)=&amp;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;             zq(n)%data(1, current_state%local_grid%local_domain_start_index(y_index), :)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          zq(n)%data(1,current_state%local_grid%local_domain_end_index(y_index)+2,:)=&amp;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;             zq(n)%data(1, current_state%local_grid%local_domain_start_index(y_index)+1, :)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (current_state%parallel%my_rank == x_wrapping_target_id) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        zth%data(1,:,1)=zth%data(1,:,current_state%local_grid%local_domain_end_index(x_index)-1)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        zth%data(1,:,2)=zth%data(1,:,current_state%local_grid%local_domain_end_index(x_index))</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        zth%data(1,:,current_state%local_grid%local_domain_end_index(x_index)+1)=&amp;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;             zth%data(1,:,current_state%local_grid%local_domain_start_index(x_index))</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        zth%data(1,:,current_state%local_grid%local_domain_end_index(x_index)+2)=&amp;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;             zth%data(1,:,current_state%local_grid%local_domain_start_index(x_index)+1)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">do</span> n=1, current_state%number_q_fields</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          zq(n)%data(1,:,1)=zq(n)%data(1,:,current_state%local_grid%local_domain_end_index(x_index)-1)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          zq(n)%data(1,:,2)=zq(n)%data(1,:,current_state%local_grid%local_domain_end_index(x_index))</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;          zq(n)%data(1,:,current_state%local_grid%local_domain_end_index(x_index)+1)=&amp;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;               zq(n)%data(1,:,current_state%local_grid%local_domain_start_index(x_index))</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          zq(n)%data(1,:,current_state%local_grid%local_domain_end_index(x_index)+2)=&amp;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;               zq(n)%data(1,:,current_state%local_grid%local_domain_start_index(x_index)+1)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_ad583a541b4fc06d748de229212a2bef9_cgraph.png" border="0" usemap="#anamespacelowerbc__mod_ad583a541b4fc06d748de229212a2bef9_cgraph" alt=""/></div>
<map name="namespacelowerbc__mod_ad583a541b4fc06d748de229212a2bef9_cgraph" id="anamespacelowerbc__mod_ad583a541b4fc06d748de229212a2bef9_cgraph">
<area shape="rect" title="Completes the asynchronous wrapping if required for periodic boundary conditions." alt="" coords="5,104,164,145"/>
<area shape="rect" href="namespacelowerbc__mod.html#aa60c943e6353850120f27cbce43b9362" title="Packages theta and Q fields (if enabled) into the send buffer for X." alt="" coords="212,5,380,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a4a1838d4210babb8412f95daaf13ceb6" title="Packages theta and Q fields (if enabled) into the send buffer for Y." alt="" coords="212,71,380,112"/>
<area shape="rect" href="namespacelowerbc__mod.html#a40ad183f436b44987b0d86222d23767e" title="Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for X." alt="" coords="212,136,380,177"/>
<area shape="rect" href="namespacelowerbc__mod.html#a18bf5e755161004bd2c4822469236b8a" title="Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for Y." alt="" coords="212,201,380,243"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_ad583a541b4fc06d748de229212a2bef9_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_ad583a541b4fc06d748de229212a2bef9_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_ad583a541b4fc06d748de229212a2bef9_icgraph" id="anamespacelowerbc__mod_ad583a541b4fc06d748de229212a2bef9_icgraph">
<area shape="rect" title="Completes the asynchronous wrapping if required for periodic boundary conditions." alt="" coords="640,5,799,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,5,592,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,5,359,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<a id="a936327adbe2f9c869bc068a9c4541c2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a936327adbe2f9c869bc068a9c4541c2a">&#9670;&nbsp;</a></span>compute_lower_boundary_conditions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::compute_lower_boundary_conditions </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>zu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>zv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>zth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>zq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00195">195</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: zu, zv, th, zth</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: q, zq</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: current_y_index, current_x_index</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">integer</span> :: n</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: horizontal_velocity_at_k2</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span> (.not. current_state%use_viscosity_and_diffusion .or. .not. current_state%use_surface_boundary_conditions) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;       <span class="keyword">call </span>simple_boundary_values(current_state, current_y_index, current_x_index, th, q)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;       <span class="comment">! one level in for the halo-column</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;       <span class="keywordflow">if</span> (.not. (current_state%column_local_y .lt. current_state%local_grid%local_domain_start_index(y_index)-1 .or.&amp;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;         current_state%column_local_x .lt. current_state%local_grid%local_domain_start_index(x_index)-1 .or.&amp;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;         current_state%column_local_y .gt. current_state%local_grid%local_domain_end_index(y_index)+1 .or.&amp;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;         current_state%column_local_x .gt. current_state%local_grid%local_domain_end_index(x_index)+1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          <span class="comment">!if (.not. current_state%halo_column) then</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <span class="comment">! Include one halo to ensure that the halo is set in tvdadvection. This is done using the </span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="comment">! logic from the timestep callback in tvdadvection in the timestep callback above</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          horizontal_velocity_at_k2=0.0_default_precision</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#ifdef U_ACTIVE</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor"></span>         horizontal_velocity_at_k2=(0.5_default_precision*(current_state%zu%data(2,current_y_index,current_x_index)+&amp;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;              zu%data(2,current_y_index,current_x_index-1))+ current_state%ugal)**2</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef V_ACTIVE</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor"></span>         horizontal_velocity_at_k2=horizontal_velocity_at_k2+(0.5_default_precision*(zv%data(&amp;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;              2,current_y_index,current_x_index)+zv%data(2,current_y_index-1,current_x_index))+current_state%vgal)**2</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor"></span>         horizontal_velocity_at_k2=sqrt(horizontal_velocity_at_k2)+smallp      </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;         <span class="keywordflow">if</span> (current_state%type_of_surface_boundary_conditions == prescribed_surface_fluxes) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keyword">call </span>compute_using_fixed_surface_fluxes(current_state, current_y_index, current_x_index, &amp;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                 horizontal_velocity_at_k2, th, q)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keyword">call </span>compute_using_fixed_surface_temperature(current_state, current_y_index, current_x_index, &amp;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;               horizontal_velocity_at_k2, zth, th, zq, q)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;         current_state%dis%data(1, current_y_index, current_x_index)=0.0_default_precision</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;         current_state%dis_th%data(1, current_y_index, current_x_index)=0.0_default_precision</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;         <span class="keywordflow">if</span> (current_state%backscatter) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">do</span> n=1, current_state%number_q_fields</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;               current_state%disq(n)%data(1,current_y_index,current_x_index)=0.0_default_precision</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="comment">!-----------------------</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">! _return viscous number</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="comment">!-----------------------</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        current_state%cvis=max(current_state%cvis,max(current_state%vis_coefficient%data(1, current_y_index, current_x_index),&amp;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;             current_state%diff_coefficient%data(1, current_y_index, current_x_index))*viscous_courant_coefficient)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="comment">!            CVIS will be multiplied by DTM_X4 in TESTCFL</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current_x_index == 1 .and. current_y_index == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keyword">call </span>register_async_wrapping_recv_requests(current_state)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current_x_index == current_state%local_grid%local_domain_end_index(x_index)+&amp;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;             current_state%local_grid%halo_size(x_index) .and. current_y_index == &amp;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;             current_state%local_grid%local_domain_end_index(y_index)+current_state%local_grid%halo_size(y_index)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">call </span>complete_async_wrapping(current_state, zth, zq)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordflow">     end if</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">  end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a936327adbe2f9c869bc068a9c4541c2a_cgraph.png" border="0" usemap="#anamespacelowerbc__mod_a936327adbe2f9c869bc068a9c4541c2a_cgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a936327adbe2f9c869bc068a9c4541c2a_cgraph" id="anamespacelowerbc__mod_a936327adbe2f9c869bc068a9c4541c2a_cgraph">
<area shape="rect" title=" " alt="" coords="5,412,191,453"/>
<area shape="rect" href="namespacelowerbc__mod.html#ad583a541b4fc06d748de229212a2bef9" title="Completes the asynchronous wrapping if required for periodic boundary conditions." alt="" coords="239,136,397,177"/>
<area shape="rect" href="namespacelowerbc__mod.html#a1949fccdff268f7bb7d728476f08844d" title=" " alt="" coords="241,325,395,381"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6bf0bcbc5026584a7a88fd13973f3a07" title=" " alt="" coords="241,405,395,461"/>
<area shape="rect" href="namespacelowerbc__mod.html#a229cbb79a21eb832c2120efa2ebe9648" title="Registers asynchronous wrapping recv requests as needed." alt="" coords="241,485,395,541"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9cf23db09102d82c7b15a2c1aae40c0d" title=" " alt="" coords="247,564,389,605"/>
<area shape="rect" href="namespacelowerbc__mod.html#aa60c943e6353850120f27cbce43b9362" title="Packages theta and Q fields (if enabled) into the send buffer for X." alt="" coords="445,5,613,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a4a1838d4210babb8412f95daaf13ceb6" title="Packages theta and Q fields (if enabled) into the send buffer for Y." alt="" coords="445,71,613,112"/>
<area shape="rect" href="namespacelowerbc__mod.html#a40ad183f436b44987b0d86222d23767e" title="Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for X." alt="" coords="445,136,613,177"/>
<area shape="rect" href="namespacelowerbc__mod.html#a18bf5e755161004bd2c4822469236b8a" title="Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for Y." alt="" coords="445,201,613,243"/>
<area shape="rect" href="namespacelowerbc__mod.html#ac49dca339dbb94d484fd3a63fec7c768" title=" " alt="" coords="458,267,601,308"/>
<area shape="rect" href="namespacelowerbc__mod.html#a08f2b603916c77f427fbad748a1fa9ab" title=" " alt="" coords="458,332,601,373"/>
<area shape="rect" href="namespacelowerbc__mod.html#a21cd44bf71a728dd75c95253ee3a9d41" title=" " alt="" coords="458,397,601,439"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6b00bb0c62bf9b11c7ffca03b7f4c1d3" title=" " alt="" coords="702,274,831,301"/>
<area shape="rect" href="namespacelowerbc__mod.html#acde8d0932ff3e7ec747211af3e958e5e" title="Solves the Monin&#45;Obukhov equations in the case of specified surface values of temperature and mixing ..." alt="" coords="455,463,603,490"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9be31e8991ba29fe4cbe8e5628098494" title=" " alt="" coords="668,423,865,464"/>
<area shape="rect" href="namespacelowerbc__mod.html#afb152571350643368a0a0f745c92c6f9" title=" " alt="" coords="661,488,872,529"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a936327adbe2f9c869bc068a9c4541c2a_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a936327adbe2f9c869bc068a9c4541c2a_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a936327adbe2f9c869bc068a9c4541c2a_icgraph" id="anamespacelowerbc__mod_a936327adbe2f9c869bc068a9c4541c2a_icgraph">
<area shape="rect" title=" " alt="" coords="407,5,592,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,5,359,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<a id="a1949fccdff268f7bb7d728476f08844d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1949fccdff268f7bb7d728476f08844d">&#9670;&nbsp;</a></span>compute_using_fixed_surface_fluxes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::compute_using_fixed_surface_fluxes </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision)&#160;</td>
          <td class="paramname"><em>horizontal_velocity_at_k2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00636">636</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: th</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: q</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: current_y_index, current_x_index</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: horizontal_velocity_at_k2</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">if</span> (current_state%fbuoy .gt. 0.0_default_precision) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keyword">call </span>handle_convective_fluxes(current_state, current_y_index, current_x_index, horizontal_velocity_at_k2, th, q)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current_state%fbuoy .eq. 0.0_default_precision) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keyword">call </span>handle_neutral_fluxes(current_state, current_y_index, current_x_index, horizontal_velocity_at_k2, th, q)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="keyword">call </span>handle_stable_fluxes(current_state, current_y_index, current_x_index, horizontal_velocity_at_k2, th, q)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a1949fccdff268f7bb7d728476f08844d_cgraph.png" border="0" usemap="#anamespacelowerbc__mod_a1949fccdff268f7bb7d728476f08844d_cgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a1949fccdff268f7bb7d728476f08844d_cgraph" id="anamespacelowerbc__mod_a1949fccdff268f7bb7d728476f08844d_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,160,119"/>
<area shape="rect" href="namespacelowerbc__mod.html#ac49dca339dbb94d484fd3a63fec7c768" title=" " alt="" coords="208,5,351,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a08f2b603916c77f427fbad748a1fa9ab" title=" " alt="" coords="208,71,351,112"/>
<area shape="rect" href="namespacelowerbc__mod.html#a21cd44bf71a728dd75c95253ee3a9d41" title=" " alt="" coords="208,136,351,177"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6b00bb0c62bf9b11c7ffca03b7f4c1d3" title=" " alt="" coords="399,13,528,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a1949fccdff268f7bb7d728476f08844d_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a1949fccdff268f7bb7d728476f08844d_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a1949fccdff268f7bb7d728476f08844d_icgraph" id="anamespacelowerbc__mod_a1949fccdff268f7bb7d728476f08844d_icgraph">
<area shape="rect" title=" " alt="" coords="640,5,795,61"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,13,592,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,13,359,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,13,156,54"/>
</map>
</div>

</div>
</div>
<a id="a6bf0bcbc5026584a7a88fd13973f3a07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bf0bcbc5026584a7a88fd13973f3a07">&#9670;&nbsp;</a></span>compute_using_fixed_surface_temperature()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::compute_using_fixed_surface_temperature </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>horizontal_velocity_at_k2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>zth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>zq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00653">653</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: th, zth</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: q, zq</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span> :: horizontal_velocity_at_k2</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: current_y_index, current_x_index</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: dthv_surf, ustr, thvstr</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordtype">integer</span> :: convergence_status, n</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">if</span> (current_state%passive_q) <span class="keywordflow">then</span> <span class="comment">! i.e. q is not active </span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="comment">! Assuming no liquid water at level 2</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      dthv_surf = zth%data(2, current_y_index, current_x_index) + &amp;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;         current_state%global_grid%configuration%vertical%thref(2) - current_state%theta_virtual_surf</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">else</span>   </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      dthv_surf=zth%data(2, current_y_index, current_x_index) + current_state%global_grid%configuration%vertical%thref(2)&amp;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;         *(1.0_default_precision + current_state%cq(current_state%water_vapour_mixing_ratio_index)*&amp;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;         zq(current_state%water_vapour_mixing_ratio_index)%data(2,current_y_index,current_x_index)) - &amp;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;         current_state%theta_virtual_surf                                                                        </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    convergence_status = mostbc(current_state, horizontal_velocity_at_k2, dthv_surf,&amp;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;         current_state%global_grid%configuration%vertical%zn(2), ustr, thvstr)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                                    </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    current_state%vis_coefficient%data(1, current_y_index, current_x_index)=&amp;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;         current_state%global_grid%configuration%vertical%czn*ustr**2/horizontal_velocity_at_k2</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    current_state%diff_coefficient%data(1, current_y_index, current_x_index)=&amp;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;         current_state%global_grid%configuration%vertical%czn*ustr*thvstr/(dthv_surf+smallp)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    zth%data(1, current_y_index, current_x_index)=2.0*current_state%theta_surf-zth%data(2, current_y_index, current_x_index)-&amp;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;         (current_state%global_grid%configuration%vertical%thref(2)+current_state%global_grid%configuration%vertical%thref(1))</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    th%data(1, current_y_index, current_x_index)=2.0*current_state%theta_surf-th%data(2, current_y_index, current_x_index)-&amp;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;         (current_state%global_grid%configuration%vertical%thref(2)+current_state%global_grid%configuration%vertical%thref(1))</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;       n=iqv</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;       zq(n)%data(1, current_y_index, current_x_index)=zq(n)%data(2, current_y_index, current_x_index)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;       q(n)%data(1, current_y_index, current_x_index)=q(n)%data(2, current_y_index, current_x_index)</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;       <span class="keywordflow">if</span> (.not. current_state%passive_q) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          zq(current_state%water_vapour_mixing_ratio_index)%data(1,current_y_index,current_x_index)=&amp;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;               2.0_default_precision*current_state%surface_vapour_mixing_ratio-&amp;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;               zq(current_state%water_vapour_mixing_ratio_index)%data(2,current_y_index,current_x_index)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          q(current_state%water_vapour_mixing_ratio_index)%data(1,current_y_index,current_x_index)=&amp;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;               2.0_default_precision*current_state%surface_vapour_mixing_ratio-&amp;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;               q(current_state%water_vapour_mixing_ratio_index)%data(2,current_y_index,current_x_index)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="keywordflow">       endif</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a6bf0bcbc5026584a7a88fd13973f3a07_cgraph.png" border="0" usemap="#anamespacelowerbc__mod_a6bf0bcbc5026584a7a88fd13973f3a07_cgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a6bf0bcbc5026584a7a88fd13973f3a07_cgraph" id="anamespacelowerbc__mod_a6bf0bcbc5026584a7a88fd13973f3a07_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,160,87"/>
<area shape="rect" href="namespacelowerbc__mod.html#acde8d0932ff3e7ec747211af3e958e5e" title="Solves the Monin&#45;Obukhov equations in the case of specified surface values of temperature and mixing ..." alt="" coords="208,46,356,73"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9be31e8991ba29fe4cbe8e5628098494" title=" " alt="" coords="411,5,608,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#afb152571350643368a0a0f745c92c6f9" title=" " alt="" coords="404,71,615,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a6bf0bcbc5026584a7a88fd13973f3a07_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a6bf0bcbc5026584a7a88fd13973f3a07_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a6bf0bcbc5026584a7a88fd13973f3a07_icgraph" id="anamespacelowerbc__mod_a6bf0bcbc5026584a7a88fd13973f3a07_icgraph">
<area shape="rect" title=" " alt="" coords="640,5,795,61"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,13,592,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,13,359,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,13,156,54"/>
</map>
</div>

</div>
</div>
<a id="a45038b8627049e5012c6753e42a21bab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45038b8627049e5012c6753e42a21bab">&#9670;&nbsp;</a></span>finalisation_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::finalisation_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00147">147</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(x_wrapping_send_buffer)) <span class="keyword">deallocate</span>(x_wrapping_send_buffer)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(y_wrapping_send_buffer)) <span class="keyword">deallocate</span>(y_wrapping_send_buffer)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(x_wrapping_recv_buffer)) <span class="keyword">deallocate</span>(x_wrapping_recv_buffer)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(y_wrapping_recv_buffer)) <span class="keyword">deallocate</span>(y_wrapping_recv_buffer)</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a45038b8627049e5012c6753e42a21bab_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a45038b8627049e5012c6753e42a21bab_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a45038b8627049e5012c6753e42a21bab_icgraph" id="anamespacelowerbc__mod_a45038b8627049e5012c6753e42a21bab_icgraph">
<area shape="rect" title=" " alt="" coords="204,5,371,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<a id="ac49dca339dbb94d484fd3a63fec7c768"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49dca339dbb94d484fd3a63fec7c768">&#9670;&nbsp;</a></span>handle_convective_fluxes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::handle_convective_fluxes </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>horizontal_velocity_at_k2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00492">492</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: th</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: q</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: current_y_index, current_x_index</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span> :: horizontal_velocity_at_k2</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">integer</span> :: n</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: ustr</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    ustr=look(current_state, horizontal_velocity_at_k2)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    current_state%vis_coefficient%data(1, current_y_index, current_x_index)=&amp;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;         current_state%global_grid%configuration%vertical%czn*ustr**2/ horizontal_velocity_at_k2</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    current_state%diff_coefficient%data(1, current_y_index, current_x_index)=&amp;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;         (von_karman_constant*current_state%global_grid%configuration%vertical%czn*ustr/alphah)/&amp;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;         (current_state%global_grid%configuration%vertical%zlogth- 2.*log(&amp;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;         (1.+sqrt(1.+gammah*von_karman_constant*current_state%fbuoy*(current_state%global_grid%configuration%vertical%zn(2)+z0)&amp;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;         /ustr**3))/ (1.+sqrt(1.+gammah*von_karman_constant*current_state%fbuoy*z0th/ustr**3))))</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span> (current_state%th%active) th%data(1, current_y_index, current_x_index)= &amp;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;         (current_state%surface_temperature_flux*current_state%global_grid%configuration%vertical%dzn(2)/&amp;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;         current_state%diff_coefficient%data(1, current_y_index, current_x_index))+th%data(2, current_y_index, current_x_index)-&amp; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;         current_state%global_grid%configuration%vertical%thref(1)+&amp; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;         current_state%global_grid%configuration%vertical%thref(2)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">! Surface Flux of vapour</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;       n=iqv</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;       q(n)%data(1, current_y_index, current_x_index)=q(n)%data(2, current_y_index, current_x_index)+&amp;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            current_state%surface_vapour_flux*current_state%global_grid%configuration%vertical%dzn(2)/&amp;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            current_state%diff_coefficient%data(1, current_y_index, current_x_index)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="keywordflow">    endif</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_ac49dca339dbb94d484fd3a63fec7c768_cgraph.png" border="0" usemap="#anamespacelowerbc__mod_ac49dca339dbb94d484fd3a63fec7c768_cgraph" alt=""/></div>
<map name="namespacelowerbc__mod_ac49dca339dbb94d484fd3a63fec7c768_cgraph" id="anamespacelowerbc__mod_ac49dca339dbb94d484fd3a63fec7c768_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,148,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6b00bb0c62bf9b11c7ffca03b7f4c1d3" title=" " alt="" coords="196,13,325,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_ac49dca339dbb94d484fd3a63fec7c768_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_ac49dca339dbb94d484fd3a63fec7c768_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_ac49dca339dbb94d484fd3a63fec7c768_icgraph" id="anamespacelowerbc__mod_ac49dca339dbb94d484fd3a63fec7c768_icgraph">
<area shape="rect" title=" " alt="" coords="843,13,985,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a1949fccdff268f7bb7d728476f08844d" title=" " alt="" coords="640,5,795,61"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,13,592,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,13,359,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,13,156,54"/>
</map>
</div>

</div>
</div>
<a id="a08f2b603916c77f427fbad748a1fa9ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08f2b603916c77f427fbad748a1fa9ab">&#9670;&nbsp;</a></span>handle_neutral_fluxes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::handle_neutral_fluxes </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision)&#160;</td>
          <td class="paramname"><em>horizontal_velocity_at_k2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00551">551</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: th</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: q</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: current_y_index, current_x_index</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: horizontal_velocity_at_k2</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">integer</span> :: n</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: ustr</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    ustr=horizontal_velocity_at_k2*current_state%global_grid%configuration%vertical%vk_on_zlogm</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    current_state%vis_coefficient%data(1, current_y_index, current_x_index)=current_state%global_grid%configuration%vertical%czn*&amp;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;         ustr**2/horizontal_velocity_at_k2</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    current_state%diff_coefficient%data(1, current_y_index, current_x_index)=&amp;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;         current_state%vis_coefficient%data(1, current_y_index, current_x_index)*&amp;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;         current_state%global_grid%configuration%vertical%zlogm/(alphah*current_state%global_grid%configuration%vertical%zlogth)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">if</span> (current_state%th%active) th%data(1, current_y_index, current_x_index)=  &amp;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;         (current_state%surface_temperature_flux*current_state%global_grid%configuration%vertical%dzn(2)/&amp;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;         current_state%diff_coefficient%data(1, current_y_index, current_x_index))+th%data(2, current_y_index, current_x_index)-&amp; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;         current_state%global_grid%configuration%vertical%thref(1)+&amp; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;         current_state%global_grid%configuration%vertical%thref(2)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">! Flux of vapour</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;       n=iqv</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;       q(n)%data(1, current_y_index, current_x_index)=q(n)%data(2, current_y_index, current_x_index)+&amp;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            current_state%surface_vapour_flux*current_state%global_grid%configuration%vertical%dzn(2)/&amp;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            current_state%diff_coefficient%data(1, current_y_index, current_x_index)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keywordflow">    endif</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a08f2b603916c77f427fbad748a1fa9ab_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a08f2b603916c77f427fbad748a1fa9ab_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a08f2b603916c77f427fbad748a1fa9ab_icgraph" id="anamespacelowerbc__mod_a08f2b603916c77f427fbad748a1fa9ab_icgraph">
<area shape="rect" title=" " alt="" coords="843,13,985,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a1949fccdff268f7bb7d728476f08844d" title=" " alt="" coords="640,5,795,61"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,13,592,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,13,359,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,13,156,54"/>
</map>
</div>

</div>
</div>
<a id="a21cd44bf71a728dd75c95253ee3a9d41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21cd44bf71a728dd75c95253ee3a9d41">&#9670;&nbsp;</a></span>handle_stable_fluxes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::handle_stable_fluxes </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision)&#160;</td>
          <td class="paramname"><em>horizontal_velocity_at_k2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00582">582</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: th</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: q</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: current_y_index, current_x_index</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: horizontal_velocity_at_k2</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: ustr</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordtype">integer</span> :: n</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    ustr=horizontal_velocity_at_k2*current_state%global_grid%configuration%vertical%vk_on_zlogm</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">if</span>((current_state%fbuoy - 1.e-9_default_precision) .lt. -4.0_default_precision*&amp;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;         von_karman_constant**2*horizontal_velocity_at_k2**3/ (27.0_default_precision*betam*&amp;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;         current_state%global_grid%configuration%vertical%zn(2)*current_state%global_grid%configuration%vertical%zlogm**2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="comment">! Too stable for turbulence</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      current_state%vis_coefficient%data(1, current_y_index, current_x_index)=0.0_default_precision</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      current_state%diff_coefficient%data(1, current_y_index, current_x_index)=0.0_default_precision</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="comment">! Level 1 values of l_th and l_q set to be harmless for advection scheme</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">if</span> (current_state%th%active) th%data(1, current_y_index, current_x_index)=th%data(2, current_y_index, current_x_index)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordflow">do</span> n=1, current_state%number_q_fields</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          q(n)%data(1, current_y_index, current_x_index)=q(n)%data(2, current_y_index, current_x_index)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      ustr=ustr/3.0_default_precision*(1.0_default_precision-2.0_default_precision*&amp;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;           cos((acos(-27.0_default_precision*betam*von_karman_constant*current_state%global_grid%configuration%vertical%zn(2)*&amp;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;           current_state%fbuoy/(current_state%global_grid%configuration%vertical%zlogm*&amp;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;           2.0_default_precision*ustr**3)-1.0_default_precision)+ 2.0_default_precision*<a class="code" href="namespacescience__constants__mod.html#ae8033eb104cc11fddfcf12d79fae0bd1">pi</a>)/3.0_default_precision))</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      current_state%vis_coefficient%data(1, current_y_index, current_x_index)=&amp;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;           current_state%global_grid%configuration%vertical%czn*ustr**2/horizontal_velocity_at_k2</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      current_state%diff_coefficient%data(1, current_y_index, current_x_index)=&amp;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;           current_state%vis_coefficient%data(1, current_y_index, current_x_index)*&amp;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;           (current_state%global_grid%configuration%vertical%zlogm-betam*current_state%global_grid%configuration%vertical%zn(2)*&amp;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;           von_karman_constant*current_state%fbuoy/ustr**3)/(alphah*current_state%global_grid%configuration%vertical%zlogth-betah*&amp;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;           von_karman_constant*current_state%fbuoy* (current_state%global_grid%configuration%vertical%zn(2)+ z0-z0th)/ustr**3)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">if</span> (current_state%th%active) th%data(1, current_y_index, current_x_index)= &amp;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;           (current_state%surface_temperature_flux*current_state%global_grid%configuration%vertical%dzn(2)/&amp;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;           current_state%diff_coefficient%data(1, current_y_index, current_x_index))+th%data(2, current_y_index, current_x_index)-&amp; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;           current_state%global_grid%configuration%vertical%thref(1)+&amp; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;           current_state%global_grid%configuration%vertical%thref(2)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="comment">!Flux of vapour</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;         n=iqv</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;         q(n)%data(1, current_y_index, current_x_index)=q(n)%data(2, current_y_index, current_x_index)+&amp;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;              current_state%surface_vapour_flux*current_state%global_grid%configuration%vertical%dzn(2)/&amp;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;              current_state%diff_coefficient%data(1, current_y_index, current_x_index)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a21cd44bf71a728dd75c95253ee3a9d41_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a21cd44bf71a728dd75c95253ee3a9d41_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a21cd44bf71a728dd75c95253ee3a9d41_icgraph" id="anamespacelowerbc__mod_a21cd44bf71a728dd75c95253ee3a9d41_icgraph">
<area shape="rect" title=" " alt="" coords="843,13,985,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a1949fccdff268f7bb7d728476f08844d" title=" " alt="" coords="640,5,795,61"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,13,592,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,13,359,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,13,156,54"/>
</map>
</div>

</div>
</div>
<a id="a5b0b38f86fb2bc11d7e91d23e9e72ea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b0b38f86fb2bc11d7e91d23e9e72ea8">&#9670;&nbsp;</a></span>initialisation_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::initialisation_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00049">49</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: bhbc</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">integer</span> :: num_wrapped_fields</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">! Adhill - this check is only required so that the vis_ and diff_coefficients</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">!          are allocated in their respective components</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (.not. is_component_enabled(current_state%options_database, <span class="stringliteral">&quot;diffusion&quot;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Lowerbc requires the diffusion component to be enabled&quot;</span>)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordflow">    end if</span>    </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (.not. is_component_enabled(current_state%options_database, <span class="stringliteral">&quot;viscosity&quot;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">log_master_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Lowerbc requires the viscosity component to be enabled&quot;</span>)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">call </span>allocate_applicable_fields(current_state)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    wrapping_comm_requests=mpi_request_null</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    num_wrapped_fields=0</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span> (current_state%th%active) num_wrapped_fields=1</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    num_wrapped_fields=num_wrapped_fields+current_state%number_q_fields</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (num_wrapped_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">if</span> (current_state%parallel%my_coords(y_index) == 0  .or. &amp;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;           current_state%parallel%my_coords(y_index) == current_state%parallel%dim_sizes(y_index)-1) <span class="keywordflow">then</span>        </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span> (current_state%parallel%my_coords(y_index) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          y_wrapping_target_id=current_state%local_grid%neighbours(y_index, 1)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          y_wrapping_target_id=current_state%local_grid%neighbours(y_index, 3)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span> (current_state%parallel%my_rank .ne. y_wrapping_target_id) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          <span class="keyword">allocate</span>(y_wrapping_send_buffer(current_state%local_grid%size(x_index)+4, 2, num_wrapped_fields), &amp;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;               y_wrapping_recv_buffer(current_state%local_grid%size(x_index)+4, 2, num_wrapped_fields))</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">if</span> (current_state%parallel%my_coords(x_index) == 0  .or. &amp;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;           current_state%parallel%my_coords(x_index) == current_state%parallel%dim_sizes(x_index)-1) <span class="keywordflow">then</span>        </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">if</span> (current_state%parallel%my_coords(x_index) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;          x_wrapping_target_id=current_state%local_grid%neighbours(x_index, 1)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          x_wrapping_target_id=current_state%local_grid%neighbours(x_index, 3)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">if</span> (current_state%parallel%my_rank .ne. x_wrapping_target_id) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          <span class="keyword">allocate</span>(x_wrapping_send_buffer(current_state%local_grid%size(y_index)+4, 2, num_wrapped_fields), &amp;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;               x_wrapping_recv_buffer(current_state%local_grid%size(y_index)+4, 2, num_wrapped_fields))</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    viscous_courant_coefficient=1.0_default_precision/current_state%global_grid%configuration%vertical%dzn(2)**2+&amp;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;         1.0_default_precision/(current_state%global_grid%configuration%horizontal%dx*&amp;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;         current_state%global_grid%configuration%horizontal%dx)+&amp;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;         1.0_default_precision/(current_state%global_grid%configuration%horizontal%dy*&amp;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;         current_state%global_grid%configuration%horizontal%dy)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> ( current_state%use_surface_boundary_conditions .and.  &amp;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;         current_state%type_of_surface_boundary_conditions == prescribed_surface_values) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="comment">! variables below are only required when PRESCRIBED_SURFACE_VALUES are used. </span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;       tstrcona=von_karman_constant/alphah*current_state%global_grid%configuration%vertical%zlogth</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;       bhbc=alphah*current_state%global_grid%configuration%vertical%zlogth</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;       rhmbc=betah*(current_state%global_grid%configuration%vertical%zn(2)+z0-z0th)/&amp;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            (betam*current_state%global_grid%configuration%vertical%zn(2))</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;       ddbc=current_state%global_grid%configuration%vertical%zlogm*(bhbc-&amp;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            rhmbc*current_state%global_grid%configuration%vertical%zlogm)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;       ddbc_x4=4.*ddbc</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;       r2ddbc=0.5_default_precision/ddbc</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;       eecon=2.0_default_precision*rhmbc*current_state%global_grid%configuration%vertical%zlogm-bhbc</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;       rcmbc=1.0_default_precision/current_state%cmbc</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;       tstrconb=von_karman_constant/alphah</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;       x4con=gammam*(current_state%global_grid%configuration%vertical%zn(2)+z0)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;       xx0con=gammam*z0</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;       y2con=gammah*(current_state%global_grid%configuration%vertical%zn(2)+z0)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;       yy0con=gammah*z0th</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;       tstrcona=0.0</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;       bhbc=0.0</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;       rhmbc=0.0</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;       ddbc=0.0</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;       ddbc_x4=0.0</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;       r2ddbc=0.0</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;       eecon=0.0</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;       rcmbc=0.0</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;       tstrconb=0.0</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;       x4con=0.0</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;       xx0con=0.0</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;       y2con=0.0</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;       yy0con=0.0</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordflow">    endif</span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">! Determine vapour index</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (.not. current_state%passive_q) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;       iqv = get_q_index(standard_q_names%VAPOUR, <span class="stringliteral">&#39;lowerbc&#39;</span>)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a5b0b38f86fb2bc11d7e91d23e9e72ea8_cgraph.png" border="0" usemap="#anamespacelowerbc__mod_a5b0b38f86fb2bc11d7e91d23e9e72ea8_cgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a5b0b38f86fb2bc11d7e91d23e9e72ea8_cgraph" id="anamespacelowerbc__mod_a5b0b38f86fb2bc11d7e91d23e9e72ea8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,179,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a083d888e8af68d1137d2a70cf069fa61" title=" " alt="" coords="227,5,377,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a5b0b38f86fb2bc11d7e91d23e9e72ea8_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a5b0b38f86fb2bc11d7e91d23e9e72ea8_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a5b0b38f86fb2bc11d7e91d23e9e72ea8_icgraph" id="anamespacelowerbc__mod_a5b0b38f86fb2bc11d7e91d23e9e72ea8_icgraph">
<area shape="rect" title=" " alt="" coords="204,5,377,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<a id="a6b00bb0c62bf9b11c7ffca03b7f4c1d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b00bb0c62bf9b11c7ffca03b7f4c1d3">&#9670;&nbsp;</a></span>look()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) function lowerbc_mod::look </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>vel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00526">526</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span> :: vel     <span class="comment">! Horizontal speed at lowest model level</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: lookup_real_posn</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordtype">integer</span> :: lookup_int_posn</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    lookup_real_posn=1.0_default_precision+real(current_state%lookup_table_entries-1)*&amp;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;         log(vel/current_state%velmin)*current_state%aloginv</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    lookup_int_posn=int(lookup_real_posn)                                                         </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">if</span> (lookup_int_posn .ge. 1) <span class="keywordflow">then</span>                                                       </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">if</span> (lookup_int_posn .lt. current_state%lookup_table_entries) <span class="keywordflow">then</span>      <span class="comment">! Linear interpolation</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        look=current_state%lookup_table_ustr(lookup_int_posn)+ (lookup_real_posn-real(lookup_int_posn))*&amp;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;             (current_state%lookup_table_ustr(lookup_int_posn+1)-current_state%lookup_table_ustr(lookup_int_posn))</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">else</span>     <span class="comment">! Near neutral</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        look=vel*current_state%cneut</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">else</span>       <span class="comment">! Nearly free convection                                     </span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      look=vel**(-convective_limit)*current_state%cfc</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a6b00bb0c62bf9b11c7ffca03b7f4c1d3_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a6b00bb0c62bf9b11c7ffca03b7f4c1d3_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a6b00bb0c62bf9b11c7ffca03b7f4c1d3_icgraph" id="anamespacelowerbc__mod_a6b00bb0c62bf9b11c7ffca03b7f4c1d3_icgraph">
<area shape="rect" title=" " alt="" coords="1033,20,1163,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#ac49dca339dbb94d484fd3a63fec7c768" title=" " alt="" coords="843,13,985,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a1949fccdff268f7bb7d728476f08844d" title=" " alt="" coords="640,5,795,61"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,13,592,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,13,359,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,13,156,54"/>
</map>
</div>

</div>
</div>
<a id="a343916bf8438789e9c1e7d2a0374868d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a343916bf8438789e9c1e7d2a0374868d">&#9670;&nbsp;</a></span>lowerbc_get_descriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structmonc__component__mod_1_1component__descriptor__type.html">component_descriptor_type</a>) function, public lowerbc_mod::lowerbc_get_descriptor</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Descriptor of this component for registration. </p>
<dl class="section return"><dt>Returns</dt><dd>The diverr component descriptor </dd></dl>

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00041">41</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    lowerbc_get_descriptor%name=<span class="stringliteral">&quot;lower_bc&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    lowerbc_get_descriptor%version=0.1</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    lowerbc_get_descriptor%initialisation=&gt;initialisation_callback</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    lowerbc_get_descriptor%timestep=&gt;timestep_callback</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    lowerbc_get_descriptor%finalisation=&gt;finalisation_callback</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a343916bf8438789e9c1e7d2a0374868d_cgraph.png" border="0" usemap="#anamespacelowerbc__mod_a343916bf8438789e9c1e7d2a0374868d_cgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a343916bf8438789e9c1e7d2a0374868d_cgraph" id="anamespacelowerbc__mod_a343916bf8438789e9c1e7d2a0374868d_cgraph">
<area shape="rect" title="Descriptor of this component for registration." alt="" coords="5,347,156,388"/>
<area shape="rect" href="namespacelowerbc__mod.html#a45038b8627049e5012c6753e42a21bab" title=" " alt="" coords="207,281,374,323"/>
<area shape="rect" href="namespacelowerbc__mod.html#a5b0b38f86fb2bc11d7e91d23e9e72ea8" title=" " alt="" coords="204,347,377,388"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="213,412,368,453"/>
<area shape="rect" href="namespacelowerbc__mod.html#a083d888e8af68d1137d2a70cf069fa61" title=" " alt="" coords="443,347,593,388"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="425,412,611,453"/>
<area shape="rect" href="namespacelowerbc__mod.html#ad583a541b4fc06d748de229212a2bef9" title="Completes the asynchronous wrapping if required for periodic boundary conditions." alt="" coords="659,136,817,177"/>
<area shape="rect" href="namespacelowerbc__mod.html#a1949fccdff268f7bb7d728476f08844d" title=" " alt="" coords="661,325,815,381"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6bf0bcbc5026584a7a88fd13973f3a07" title=" " alt="" coords="661,405,815,461"/>
<area shape="rect" href="namespacelowerbc__mod.html#a229cbb79a21eb832c2120efa2ebe9648" title="Registers asynchronous wrapping recv requests as needed." alt="" coords="661,485,815,541"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9cf23db09102d82c7b15a2c1aae40c0d" title=" " alt="" coords="667,564,809,605"/>
<area shape="rect" href="namespacelowerbc__mod.html#aa60c943e6353850120f27cbce43b9362" title="Packages theta and Q fields (if enabled) into the send buffer for X." alt="" coords="865,5,1033,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a4a1838d4210babb8412f95daaf13ceb6" title="Packages theta and Q fields (if enabled) into the send buffer for Y." alt="" coords="865,71,1033,112"/>
<area shape="rect" href="namespacelowerbc__mod.html#a40ad183f436b44987b0d86222d23767e" title="Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for X." alt="" coords="865,136,1033,177"/>
<area shape="rect" href="namespacelowerbc__mod.html#a18bf5e755161004bd2c4822469236b8a" title="Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for Y." alt="" coords="865,201,1033,243"/>
<area shape="rect" href="namespacelowerbc__mod.html#ac49dca339dbb94d484fd3a63fec7c768" title=" " alt="" coords="878,267,1021,308"/>
<area shape="rect" href="namespacelowerbc__mod.html#a08f2b603916c77f427fbad748a1fa9ab" title=" " alt="" coords="878,332,1021,373"/>
<area shape="rect" href="namespacelowerbc__mod.html#a21cd44bf71a728dd75c95253ee3a9d41" title=" " alt="" coords="878,397,1021,439"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6b00bb0c62bf9b11c7ffca03b7f4c1d3" title=" " alt="" coords="1122,274,1251,301"/>
<area shape="rect" href="namespacelowerbc__mod.html#acde8d0932ff3e7ec747211af3e958e5e" title="Solves the Monin&#45;Obukhov equations in the case of specified surface values of temperature and mixing ..." alt="" coords="875,463,1023,490"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9be31e8991ba29fe4cbe8e5628098494" title=" " alt="" coords="1088,423,1285,464"/>
<area shape="rect" href="namespacelowerbc__mod.html#afb152571350643368a0a0f745c92c6f9" title=" " alt="" coords="1081,488,1292,529"/>
</map>
</div>

</div>
</div>
<a id="acde8d0932ff3e7ec747211af3e958e5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acde8d0932ff3e7ec747211af3e958e5e">&#9670;&nbsp;</a></span>mostbc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function lowerbc_mod::mostbc </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>delu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>delt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(out)&#160;</td>
          <td class="paramname"><em>ustrdg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(out)&#160;</td>
          <td class="paramname"><em>tstrdg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solves the Monin-Obukhov equations in the case of specified surface values of temperature and mixing ratio,combined into a specified value of virtual temperature. It is a modified version of the subroutine described in Bull and Derbyshire (TDN197) based on the assumption that the similarity functions and roughness lengths for temperature and mixing ratio are the same. In that case, all the original theory can be used if we replace temperature by virtual temperature. The form of the non-dimensionalised wind shear used is 1.0 + BETAM z/L for the stable case and (1.0 - GAMMAM z/L)**1/4 for the unstable case. The form of the non-dimensionalised temperature gradient used is 1.0 + BETAH z/L for the stable case and (1.0 - GAMMAH z/L)**1/2 for the unstable case. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">delu</td><td>The wind speed at the lowest grid point </td></tr>
    <tr><td class="paramname">delt</td><td>The virtual potential temperature difference between the lowest grid point and the surface </td></tr>
    <tr><td class="paramname">z1</td><td>The height of the lowest grid point ABOVE the roughness length Z0 </td></tr>
    <tr><td class="paramname">ustrdg</td><td>The diagnosed value of friction velocity </td></tr>
    <tr><td class="paramname">tstrdg</td><td>The diagnosed value of surface virtual temperature scale </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The convergence criteria - success, richardson number too large or failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00740">740</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span>  :: delu, delt, z1</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(out)</span> :: ustrdg, tstrdg</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">if</span> (delt .lt. 0.0_default_precision) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <span class="keywordflow">if</span> (delu .le. smallp) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        ustrdg=0.0_default_precision</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        tstrdg=tstrcona*delt</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;         <span class="comment">! The unstable case</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;         mostbc=solve_monin_obukhov_unstable_case(delu, delt, current_state%ellmocon, &amp;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;           ustrdg, tstrdg, current_state%global_grid%configuration%vertical)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (delt .gt. 0.0_default_precision) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="comment">! The stable case</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      mostbc=solve_monin_obukhov_stable_case(delu, delt, current_state%global_grid%configuration%vertical%zlogm, &amp;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;           current_state%cmbc, ustrdg, tstrdg)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="comment">! Trivial neutral case</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        ustrdg=current_state%global_grid%configuration%vertical%vk_on_zlogm*delu</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        tstrdg=0.0_default_precision </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        mostbc=convergence_success</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">if</span> (mostbc .ne. convergence_success) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">if</span> (mostbc .eq. convergence_richardson_too_large) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="comment">!call log_log(LOG_WARN, &quot;Richardson number greater than critical value&quot;)</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mostbc .eq. convergence_failure) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Convergence failure after 200 iterations&quot;</span>)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keywordflow">    end if</span>   </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_acde8d0932ff3e7ec747211af3e958e5e_cgraph.png" border="0" usemap="#anamespacelowerbc__mod_acde8d0932ff3e7ec747211af3e958e5e_cgraph" alt=""/></div>
<map name="namespacelowerbc__mod_acde8d0932ff3e7ec747211af3e958e5e_cgraph" id="anamespacelowerbc__mod_acde8d0932ff3e7ec747211af3e958e5e_cgraph">
<area shape="rect" title="Solves the Monin&#45;Obukhov equations in the case of specified surface values of temperature and mixing ..." alt="" coords="5,46,153,73"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9be31e8991ba29fe4cbe8e5628098494" title=" " alt="" coords="208,5,405,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#afb152571350643368a0a0f745c92c6f9" title=" " alt="" coords="201,71,412,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_acde8d0932ff3e7ec747211af3e958e5e_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_acde8d0932ff3e7ec747211af3e958e5e_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_acde8d0932ff3e7ec747211af3e958e5e_icgraph" id="anamespacelowerbc__mod_acde8d0932ff3e7ec747211af3e958e5e_icgraph">
<area shape="rect" title="Solves the Monin&#45;Obukhov equations in the case of specified surface values of temperature and mixing ..." alt="" coords="843,20,991,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6bf0bcbc5026584a7a88fd13973f3a07" title=" " alt="" coords="640,5,795,61"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,13,592,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,13,359,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,13,156,54"/>
</map>
</div>

</div>
</div>
<a id="aa60c943e6353850120f27cbce43b9362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa60c943e6353850120f27cbce43b9362">&#9670;&nbsp;</a></span>package_x_wrapping_send_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::package_x_wrapping_send_buffer </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>zth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>zq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>first_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>second_x_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Packages theta and Q fields (if enabled) into the send buffer for X. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">zth</td><td>Temperature field </td></tr>
    <tr><td class="paramname">zq</td><td>Q fields </td></tr>
    <tr><td class="paramname">first_x_index</td><td>The first X index to read from the data field </td></tr>
    <tr><td class="paramname">second_x_index</td><td>The second X index to read from the data field </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00414">414</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: zth</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: zq</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: first_x_index, second_x_index</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">integer</span> :: index_start, n</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    index_start=0</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      x_wrapping_send_buffer(:,1,1)=zth%data(1,:,first_x_index)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      x_wrapping_send_buffer(:,2,1)=zth%data(1,:,second_x_index)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      index_start=index_start+1</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">do</span> n=1, current_state%number_q_fields</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        x_wrapping_send_buffer(:,1,index_start+n)= zq(n)%data(1,:,first_x_index)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        x_wrapping_send_buffer(:,2,index_start+n)= zq(n)%data(1,:,second_x_index)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_aa60c943e6353850120f27cbce43b9362_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_aa60c943e6353850120f27cbce43b9362_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_aa60c943e6353850120f27cbce43b9362_icgraph" id="anamespacelowerbc__mod_aa60c943e6353850120f27cbce43b9362_icgraph">
<area shape="rect" title="Packages theta and Q fields (if enabled) into the send buffer for X." alt="" coords="847,5,1015,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#ad583a541b4fc06d748de229212a2bef9" title="Completes the asynchronous wrapping if required for periodic boundary conditions." alt="" coords="640,5,799,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,5,592,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,5,359,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<a id="a4a1838d4210babb8412f95daaf13ceb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a1838d4210babb8412f95daaf13ceb6">&#9670;&nbsp;</a></span>package_y_wrapping_send_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::package_y_wrapping_send_buffer </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>zth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>zq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>first_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>second_y_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Packages theta and Q fields (if enabled) into the send buffer for Y. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">zth</td><td>Temperature field </td></tr>
    <tr><td class="paramname">zq</td><td>Q fields </td></tr>
    <tr><td class="paramname">first_y_index</td><td>The first Y index to read from the data field </td></tr>
    <tr><td class="paramname">second_y_index</td><td>The second Y index to read from the data field </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00386">386</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: zth</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: zq</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: first_y_index, second_y_index</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordtype">integer</span> :: index_start, n</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    index_start=0</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      y_wrapping_send_buffer(:,1,1)=zth%data(1,first_y_index,:)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      y_wrapping_send_buffer(:,2,1)=zth%data(1,second_y_index,:)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      index_start=index_start+1</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">do</span> n=1, current_state%number_q_fields</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        y_wrapping_send_buffer(:,1,index_start+n)=zq(n)%data(1,first_y_index,:)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        y_wrapping_send_buffer(:,2,index_start+n)=zq(n)%data(1,second_y_index,:)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a4a1838d4210babb8412f95daaf13ceb6_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a4a1838d4210babb8412f95daaf13ceb6_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a4a1838d4210babb8412f95daaf13ceb6_icgraph" id="anamespacelowerbc__mod_a4a1838d4210babb8412f95daaf13ceb6_icgraph">
<area shape="rect" title="Packages theta and Q fields (if enabled) into the send buffer for Y." alt="" coords="847,5,1015,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#ad583a541b4fc06d748de229212a2bef9" title="Completes the asynchronous wrapping if required for periodic boundary conditions." alt="" coords="640,5,799,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,5,592,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,5,359,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<a id="a229cbb79a21eb832c2120efa2ebe9648"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a229cbb79a21eb832c2120efa2ebe9648">&#9670;&nbsp;</a></span>register_async_wrapping_recv_requests()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::register_async_wrapping_recv_requests </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Registers asynchronous wrapping recv requests as needed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00263">263</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">integer</span> :: ierr</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(y_wrapping_recv_buffer)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keyword">call </span>mpi_irecv(y_wrapping_recv_buffer, <span class="keyword">size</span>(y_wrapping_recv_buffer), precision_type, &amp;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;           y_wrapping_target_id, 0, current_state%parallel%neighbour_comm, wrapping_comm_requests(1), ierr)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(x_wrapping_recv_buffer)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keyword">call </span>mpi_irecv(x_wrapping_recv_buffer, <span class="keyword">size</span>(x_wrapping_recv_buffer), precision_type, &amp;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;           x_wrapping_target_id, 0, current_state%parallel%neighbour_comm, wrapping_comm_requests(3), ierr)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a229cbb79a21eb832c2120efa2ebe9648_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a229cbb79a21eb832c2120efa2ebe9648_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a229cbb79a21eb832c2120efa2ebe9648_icgraph" id="anamespacelowerbc__mod_a229cbb79a21eb832c2120efa2ebe9648_icgraph">
<area shape="rect" title="Registers asynchronous wrapping recv requests as needed." alt="" coords="640,5,795,61"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,13,592,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,13,359,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,13,156,54"/>
</map>
</div>

</div>
</div>
<a id="a9cf23db09102d82c7b15a2c1aae40c0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cf23db09102d82c7b15a2c1aae40c0d">&#9670;&nbsp;</a></span>simple_boundary_values()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::simple_boundary_values </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>current_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00701">701</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: th</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: q</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: current_y_index, current_x_index</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">integer</span> :: n</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    current_state%vis_coefficient%data(1, current_y_index, current_x_index)=0.0_default_precision</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    current_state%diff_coefficient%data(1, current_y_index, current_x_index)=0.0_default_precision</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span>(current_state%backscatter) current_state%dis%data(1, current_y_index, current_x_index)=0.0_default_precision</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">if</span>(current_state%backscatter .and. current_state%th%active) &amp;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;         current_state%dis_th%data(1, current_y_index, current_x_index)=0.0_default_precision</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      th%data(1, current_y_index, current_x_index) = th%data(2, current_y_index, current_x_index)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordflow">do</span> n=1, current_state%number_q_fields</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        q(n)%data(1, current_y_index, current_x_index) = q(n)%data(2, current_y_index, current_x_index)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordflow">if</span> (current_state%backscatter) current_state%disq(n)%data(1, current_y_index, current_x_index) = 0.0_default_precision</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a9cf23db09102d82c7b15a2c1aae40c0d_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a9cf23db09102d82c7b15a2c1aae40c0d_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a9cf23db09102d82c7b15a2c1aae40c0d_icgraph" id="anamespacelowerbc__mod_a9cf23db09102d82c7b15a2c1aae40c0d_icgraph">
<area shape="rect" title=" " alt="" coords="640,5,783,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,5,592,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,5,359,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<a id="a9be31e8991ba29fe4cbe8e5628098494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9be31e8991ba29fe4cbe8e5628098494">&#9670;&nbsp;</a></span>solve_monin_obukhov_stable_case()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function lowerbc_mod::solve_monin_obukhov_stable_case </td>
          <td>(</td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>delu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>delt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>zlogm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>cmbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(out)&#160;</td>
          <td class="paramname"><em>ustrdg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(out)&#160;</td>
          <td class="paramname"><em>tstrdg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00824">824</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span> :: delu, delt, zlogm, cmbc</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(out)</span> :: ustrdg, tstrdg</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: am, ah, ee, ff, det</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    am=von_karman_constant*delu</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    ah=von_karman_constant*delt</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    ee=am*eecon</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    ff=ah*cmbc-rhmbc*am*am  <span class="comment">!</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    det=ee*ee-ddbc_x4*ff</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    solve_monin_obukhov_stable_case=convergence_success</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">! Test for laminar flow</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordflow">if</span> (ff .gt. 0.0_default_precision) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <span class="keywordflow">if</span> ((ee .lt. 0.0_default_precision).and.(det .gt. 0.0_default_precision)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        ustrdg=(-ee+sqrt(det))*r2ddbc</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        tstrdg=ustrdg*(am-zlogm*ustrdg)*rcmbc</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        solve_monin_obukhov_stable_case=convergence_richardson_too_large        </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        ustrdg=0.0_default_precision</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        tstrdg=0.0_default_precision</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="keywordflow">      end if</span>      </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ddbc .eq. 0.0_default_precision) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="comment">! Degenerate case</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      ustrdg=-ff/ee</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      tstrdg=delt*ustrdg/delu</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="comment">! Solve quadratic for USTRDG</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      ustrdg=(-ee+sqrt(det))*r2ddbc</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      tstrdg=ustrdg*(am-zlogm*ustrdg)*rcmbc</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a9be31e8991ba29fe4cbe8e5628098494_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a9be31e8991ba29fe4cbe8e5628098494_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a9be31e8991ba29fe4cbe8e5628098494_icgraph" id="anamespacelowerbc__mod_a9be31e8991ba29fe4cbe8e5628098494_icgraph">
<area shape="rect" title=" " alt="" coords="1039,13,1236,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#acde8d0932ff3e7ec747211af3e958e5e" title="Solves the Monin&#45;Obukhov equations in the case of specified surface values of temperature and mixing ..." alt="" coords="843,20,991,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6bf0bcbc5026584a7a88fd13973f3a07" title=" " alt="" coords="640,5,795,61"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,13,592,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,13,359,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,13,156,54"/>
</map>
</div>

</div>
</div>
<a id="afb152571350643368a0a0f745c92c6f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb152571350643368a0a0f745c92c6f9">&#9670;&nbsp;</a></span>solve_monin_obukhov_unstable_case()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function lowerbc_mod::solve_monin_obukhov_unstable_case </td>
          <td>(</td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>delu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>delt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(in)&#160;</td>
          <td class="paramname"><em>ellmocon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(out)&#160;</td>
          <td class="paramname"><em>ustrdg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=default_precision), intent(out)&#160;</td>
          <td class="paramname"><em>tstrdg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgrids__mod_1_1vertical__grid__configuration__type.html">vertical_grid_configuration_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>vertical_grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00774">774</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(in)</span> :: delu, delt, ellmocon</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">intent(out)</span> :: ustrdg, tstrdg</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordtype">type</span>(vertical_grid_configuration_type), <span class="keywordtype">intent(inout)</span> :: vertical_grid</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="keywordtype">    real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: ellmo, psim, psih, x4, xx, xx0, y2, yy, yy0, err_ustr, err_tstr, &amp;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;         ustrl, tstrl, &amp; <span class="comment">! U and T star at start of iteration</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;         ustrpl, tstrpl <span class="comment">! U and T star at end of iteration</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">! First set initial values</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    ustrl=vertical_grid%vk_on_zlogm*delu</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    tstrl=tstrcona*delt</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">! Now start iteration</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">do</span> i=1, 200</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      ellmo=ustrl*ustrl*ellmocon/tstrl</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="comment">! Test for possible square root of negative quantity</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      x4=1.0_default_precision-x4con/ellmo      </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordflow">if</span> (x4 .lt. 0.0_default_precision) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Negative square root in x4&quot;</span>)        </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      xx=sqrt(sqrt(x4))</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      xx0=sqrt(sqrt(1.0_default_precision-xx0con / ellmo))        </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      psim=2.*( log((xx+1.0_default_precision)/(xx0+1.0_default_precision))-atan(xx)+atan(xx0) )+&amp;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;           log((xx*xx+1.0_default_precision)/(xx0*xx0+1.0_default_precision))</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      ustrpl=von_karman_constant*delu/(vertical_grid%zlogm-psim)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="comment">! Test for possible square root of negative quantity</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      y2=1.-y2con/ellmo</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">if</span> (y2 .lt. 0.0_default_precision) <span class="keyword">call </span><a class="code" href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">log_log</a>(<a class="code" href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">log_error</a>, <span class="stringliteral">&quot;Negative square root in y2&quot;</span>)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      yy=sqrt(y2)</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      yy0=sqrt(1.0_default_precision-yy0con/ellmo)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      psih=2.*log((1.0_default_precision+yy)/(1.0_default_precision+yy0))</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      tstrpl=tstrconb*delt/(vertical_grid%zlogth-psih)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      err_ustr=abs((ustrpl-ustrl)/ ustrl)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      err_tstr=abs((tstrpl-tstrl)/ tstrl)                                       </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">if</span> ((err_tstr .lt. tolt) .and. (err_ustr .lt. tolm))  <span class="keywordflow">then</span>                                                 </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        ustrdg=ustrpl</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        tstrdg=tstrpl</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        solve_monin_obukhov_unstable_case=convergence_success</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keywordflow">else</span>                                                                 </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        ustrl=(1.0_default_precision-smth)*ustrpl+smth*ustrl</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        tstrl=(1.0_default_precision-smth)*tstrpl+smth*tstrl</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    solve_monin_obukhov_unstable_case=convergence_failure</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_afb152571350643368a0a0f745c92c6f9_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_afb152571350643368a0a0f745c92c6f9_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_afb152571350643368a0a0f745c92c6f9_icgraph" id="anamespacelowerbc__mod_afb152571350643368a0a0f745c92c6f9_icgraph">
<area shape="rect" title=" " alt="" coords="1039,13,1249,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#acde8d0932ff3e7ec747211af3e958e5e" title="Solves the Monin&#45;Obukhov equations in the case of specified surface values of temperature and mixing ..." alt="" coords="843,20,991,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6bf0bcbc5026584a7a88fd13973f3a07" title=" " alt="" coords="640,5,795,61"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,13,592,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,13,359,54"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,13,156,54"/>
</map>
</div>

</div>
</div>
<a id="a9527a3669b5d258f88b3378dd0981aa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9527a3669b5d258f88b3378dd0981aa1">&#9670;&nbsp;</a></span>timestep_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::timestep_callback </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00173">173</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">integer</span> :: current_y_index, current_x_index</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    current_y_index=current_state%column_local_y</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    current_x_index=current_state%column_local_x</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (current_state%field_stepping == forward_stepping) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keyword">call </span>compute_lower_boundary_conditions(current_state, current_y_index, current_x_index, &amp;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;           current_state%u, current_state%v, current_state%th, current_state%th, current_state%q, current_state%q)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">if</span> (current_state%scalar_stepping == forward_stepping) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keyword">call </span>compute_lower_boundary_conditions(current_state, current_y_index, current_x_index, &amp;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;           current_state%zu, current_state%zv, current_state%th, current_state%zth, current_state%q, current_state%zq)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keyword">call </span>compute_lower_boundary_conditions(current_state, current_y_index, current_x_index, &amp;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;           current_state%zu, current_state%zv, current_state%zth, current_state%zth, current_state%zq, current_state%zq)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keywordflow">    end if</span>    </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a9527a3669b5d258f88b3378dd0981aa1_cgraph.png" border="0" usemap="#anamespacelowerbc__mod_a9527a3669b5d258f88b3378dd0981aa1_cgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a9527a3669b5d258f88b3378dd0981aa1_cgraph" id="anamespacelowerbc__mod_a9527a3669b5d258f88b3378dd0981aa1_cgraph">
<area shape="rect" title=" " alt="" coords="5,412,160,453"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="208,412,393,453"/>
<area shape="rect" href="namespacelowerbc__mod.html#ad583a541b4fc06d748de229212a2bef9" title="Completes the asynchronous wrapping if required for periodic boundary conditions." alt="" coords="441,136,600,177"/>
<area shape="rect" href="namespacelowerbc__mod.html#a1949fccdff268f7bb7d728476f08844d" title=" " alt="" coords="443,325,598,381"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6bf0bcbc5026584a7a88fd13973f3a07" title=" " alt="" coords="443,405,598,461"/>
<area shape="rect" href="namespacelowerbc__mod.html#a229cbb79a21eb832c2120efa2ebe9648" title="Registers asynchronous wrapping recv requests as needed." alt="" coords="443,485,598,541"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9cf23db09102d82c7b15a2c1aae40c0d" title=" " alt="" coords="449,564,592,605"/>
<area shape="rect" href="namespacelowerbc__mod.html#aa60c943e6353850120f27cbce43b9362" title="Packages theta and Q fields (if enabled) into the send buffer for X." alt="" coords="648,5,816,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a4a1838d4210babb8412f95daaf13ceb6" title="Packages theta and Q fields (if enabled) into the send buffer for Y." alt="" coords="648,71,816,112"/>
<area shape="rect" href="namespacelowerbc__mod.html#a40ad183f436b44987b0d86222d23767e" title="Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for X." alt="" coords="648,136,816,177"/>
<area shape="rect" href="namespacelowerbc__mod.html#a18bf5e755161004bd2c4822469236b8a" title="Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for Y." alt="" coords="648,201,816,243"/>
<area shape="rect" href="namespacelowerbc__mod.html#ac49dca339dbb94d484fd3a63fec7c768" title=" " alt="" coords="661,267,803,308"/>
<area shape="rect" href="namespacelowerbc__mod.html#a08f2b603916c77f427fbad748a1fa9ab" title=" " alt="" coords="661,332,803,373"/>
<area shape="rect" href="namespacelowerbc__mod.html#a21cd44bf71a728dd75c95253ee3a9d41" title=" " alt="" coords="661,397,803,439"/>
<area shape="rect" href="namespacelowerbc__mod.html#a6b00bb0c62bf9b11c7ffca03b7f4c1d3" title=" " alt="" coords="905,274,1034,301"/>
<area shape="rect" href="namespacelowerbc__mod.html#acde8d0932ff3e7ec747211af3e958e5e" title="Solves the Monin&#45;Obukhov equations in the case of specified surface values of temperature and mixing ..." alt="" coords="658,463,806,490"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9be31e8991ba29fe4cbe8e5628098494" title=" " alt="" coords="871,423,1068,464"/>
<area shape="rect" href="namespacelowerbc__mod.html#afb152571350643368a0a0f745c92c6f9" title=" " alt="" coords="864,488,1075,529"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a9527a3669b5d258f88b3378dd0981aa1_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a9527a3669b5d258f88b3378dd0981aa1_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a9527a3669b5d258f88b3378dd0981aa1_icgraph" id="anamespacelowerbc__mod_a9527a3669b5d258f88b3378dd0981aa1_icgraph">
<area shape="rect" title=" " alt="" coords="204,5,359,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<a id="a40ad183f436b44987b0d86222d23767e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40ad183f436b44987b0d86222d23767e">&#9670;&nbsp;</a></span>unpackage_x_wrapping_recv_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::unpackage_x_wrapping_recv_buffer </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>zth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>zq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>first_x_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>second_x_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for X. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">zth</td><td>Temperature field </td></tr>
    <tr><td class="paramname">zq</td><td>Q fields </td></tr>
    <tr><td class="paramname">first_x_index</td><td>The first X index to read from the data field </td></tr>
    <tr><td class="paramname">second_x_index</td><td>The second X index to read from the data field </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00470">470</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: zth</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: zq</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: first_x_index, second_x_index</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">integer</span> :: index_start, n</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    index_start=0</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      zth%data(1,:,first_x_index)=x_wrapping_recv_buffer(:,1,1)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      zth%data(1,:,second_x_index)=x_wrapping_recv_buffer(:,2,1)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      index_start=index_start+1</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">do</span> n=1, current_state%number_q_fields</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        zq(n)%data(1,:,first_x_index)=x_wrapping_recv_buffer(:,1,index_start+n)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        zq(n)%data(1,:,second_x_index)=x_wrapping_recv_buffer(:,2,index_start+n)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a40ad183f436b44987b0d86222d23767e_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a40ad183f436b44987b0d86222d23767e_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a40ad183f436b44987b0d86222d23767e_icgraph" id="anamespacelowerbc__mod_a40ad183f436b44987b0d86222d23767e_icgraph">
<area shape="rect" title="Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for X." alt="" coords="847,5,1015,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#ad583a541b4fc06d748de229212a2bef9" title="Completes the asynchronous wrapping if required for periodic boundary conditions." alt="" coords="640,5,799,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,5,592,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,5,359,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<a id="a18bf5e755161004bd2c4822469236b8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18bf5e755161004bd2c4822469236b8a">&#9670;&nbsp;</a></span>unpackage_y_wrapping_recv_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lowerbc_mod::unpackage_y_wrapping_recv_buffer </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structstate__mod_1_1model__state__type.html">model_state_type</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>current_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>zth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structprognostics__mod_1_1prognostic__field__type.html">prognostic_field_type</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>zq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>first_y_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>second_y_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for Y. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_state</td><td>The current model state </td></tr>
    <tr><td class="paramname">zth</td><td>Temperature field </td></tr>
    <tr><td class="paramname">zq</td><td>Q fields </td></tr>
    <tr><td class="paramname">first_y_index</td><td>The first Y index to read from the data field </td></tr>
    <tr><td class="paramname">second_y_index</td><td>The second Y index to read from the data field </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00442">442</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">type</span>(model_state_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: current_state</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">intent(inout)</span> :: zth</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">type</span>(prognostic_field_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: zq</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: first_y_index, second_y_index</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordtype">integer</span> :: index_start, n</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    index_start=0</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (current_state%th%active) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      zth%data(1,first_y_index,:)=y_wrapping_recv_buffer(:,1,1)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      zth%data(1,second_y_index,:)=y_wrapping_recv_buffer(:,2,1)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      index_start=index_start+1</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (current_state%number_q_fields .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordflow">do</span> n=1, current_state%number_q_fields</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        zq(n)%data(1,first_y_index,:)=y_wrapping_recv_buffer(:,1,index_start+n)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        zq(n)%data(1,second_y_index,:)=y_wrapping_recv_buffer(:,2,index_start+n)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelowerbc__mod_a18bf5e755161004bd2c4822469236b8a_icgraph.png" border="0" usemap="#anamespacelowerbc__mod_a18bf5e755161004bd2c4822469236b8a_icgraph" alt=""/></div>
<map name="namespacelowerbc__mod_a18bf5e755161004bd2c4822469236b8a_icgraph" id="anamespacelowerbc__mod_a18bf5e755161004bd2c4822469236b8a_icgraph">
<area shape="rect" title="Unpackages theta and Q fields from the receive buffer into the fields themselves (if enabled) for Y." alt="" coords="847,5,1015,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#ad583a541b4fc06d748de229212a2bef9" title="Completes the asynchronous wrapping if required for periodic boundary conditions." alt="" coords="640,5,799,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a936327adbe2f9c869bc068a9c4541c2a" title=" " alt="" coords="407,5,592,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a9527a3669b5d258f88b3378dd0981aa1" title=" " alt="" coords="204,5,359,47"/>
<area shape="rect" href="namespacelowerbc__mod.html#a343916bf8438789e9c1e7d2a0374868d" title="Descriptor of this component for registration." alt="" coords="5,5,156,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7d8f3161ac289a1ce512a34cd1df8a71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d8f3161ac289a1ce512a34cd1df8a71">&#9670;&nbsp;</a></span>convergence_failure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter lowerbc_mod::convergence_failure =3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00022">22</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="af0198362b96cac12d1c02725771052b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0198362b96cac12d1c02725771052b9">&#9670;&nbsp;</a></span>convergence_richardson_too_large</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter lowerbc_mod::convergence_richardson_too_large =2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00022">22</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="a42cf0a4c6111355a878b4aed084d0f59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42cf0a4c6111355a878b4aed084d0f59">&#9670;&nbsp;</a></span>convergence_success</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter lowerbc_mod::convergence_success =1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00022">22</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: CONVERGENCE_SUCCESS=1, convergence_richardson_too_large=2, convergence_failure=3</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6f3740a54a7a66edae226acae2714d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6f3740a54a7a66edae226acae2714d0">&#9670;&nbsp;</a></span>ddbc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::ddbc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="a3f6b9bbf1b28960345f467054a9fc627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f6b9bbf1b28960345f467054a9fc627">&#9670;&nbsp;</a></span>ddbc_x4</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::ddbc_x4</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="a54b9b1064deeb658e0f2ae4b52f01e06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54b9b1064deeb658e0f2ae4b52f01e06">&#9670;&nbsp;</a></span>eecon</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::eecon</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="afb20c5057d5bfc9deb5cc26fed953b28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb20c5057d5bfc9deb5cc26fed953b28">&#9670;&nbsp;</a></span>iqv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer lowerbc_mod::iqv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00033">33</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">integer</span> :: iqv  <span class="comment">! index for vapour</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bb57c7352de3bade00ee5dd8a728734"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bb57c7352de3bade00ee5dd8a728734">&#9670;&nbsp;</a></span>r2ddbc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::r2ddbc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="a78ecc44c07960053f9d830c875576322"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78ecc44c07960053f9d830c875576322">&#9670;&nbsp;</a></span>rcmbc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::rcmbc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="ad314cc0c36d082b9a231ee7f4bc44877"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad314cc0c36d082b9a231ee7f4bc44877">&#9670;&nbsp;</a></span>rhmbc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::rhmbc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="ad674491162046b0d800e0db40a4d15c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad674491162046b0d800e0db40a4d15c0">&#9670;&nbsp;</a></span>smth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), parameter lowerbc_mod::smth = 0.05_DEFAULT_PRECISION</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00024">24</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keywordtype">  real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">parameter</span> :: smth = 0.05_default_precision,&amp; <span class="comment">! Smoothing between iterations</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        tolm=1.0e-4_default_precision,  tolt=1.0e-4_default_precision <span class="comment">! Convergence tollerance for u and t star</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab9c6ba03c9259bd57376fbd31bc9cb92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9c6ba03c9259bd57376fbd31bc9cb92">&#9670;&nbsp;</a></span>tolm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), parameter lowerbc_mod::tolm =1.0E-4_DEFAULT_PRECISION</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00024">24</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="a1e06f5e9bea255bf31fe3b1b295583d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e06f5e9bea255bf31fe3b1b295583d0">&#9670;&nbsp;</a></span>tolt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), parameter lowerbc_mod::tolt =1.0E-4_DEFAULT_PRECISION</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00024">24</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="aced5f8511935639826bb09ab33b40178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aced5f8511935639826bb09ab33b40178">&#9670;&nbsp;</a></span>tstrcona</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::tstrcona</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keywordtype">  real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>) :: tstrcona, rhmbc, ddbc, ddbc_x4, eecon, r2ddbc, rcmbc, tstrconb, &amp;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;       x4con, xx0con, y2con, yy0con, viscous_courant_coefficient</div>
</div><!-- fragment -->
</div>
</div>
<a id="a750b25438a4d55b3ddf705d75c003bd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a750b25438a4d55b3ddf705d75c003bd1">&#9670;&nbsp;</a></span>tstrconb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::tstrconb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="afdf0fb94beeaa5b68510276192d8788b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdf0fb94beeaa5b68510276192d8788b">&#9670;&nbsp;</a></span>viscous_courant_coefficient</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::viscous_courant_coefficient</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="af7c4635785f10e8ac83c3377d9009592"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7c4635785f10e8ac83c3377d9009592">&#9670;&nbsp;</a></span>wrapping_comm_requests</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(4) lowerbc_mod::wrapping_comm_requests</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00034">34</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">integer</span> :: wrapping_comm_requests(4), y_wrapping_target_id, x_wrapping_target_id</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa19d030df1c2c3df73261717ed5d6fdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa19d030df1c2c3df73261717ed5d6fdd">&#9670;&nbsp;</a></span>x4con</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::x4con</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="a8408c5127816f7042eb1af8a40862af5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8408c5127816f7042eb1af8a40862af5">&#9670;&nbsp;</a></span>x_wrapping_recv_buffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), allocatable lowerbc_mod::x_wrapping_recv_buffer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00030">30</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="a5048dfa12d3654d20309e2924bcd206d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5048dfa12d3654d20309e2924bcd206d">&#9670;&nbsp;</a></span>x_wrapping_send_buffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), allocatable lowerbc_mod::x_wrapping_send_buffer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00030">30</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keywordtype">  real</span>(kind=<a class="code" href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">default_precision</a>), <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span> :: x_wrapping_send_buffer, y_wrapping_send_buffer, &amp;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;       x_wrapping_recv_buffer, y_wrapping_recv_buffer</div>
</div><!-- fragment -->
</div>
</div>
<a id="a723a120ab7487889fa0dbf7391a75448"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a723a120ab7487889fa0dbf7391a75448">&#9670;&nbsp;</a></span>x_wrapping_target_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer lowerbc_mod::x_wrapping_target_id</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00034">34</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="a267b9de88f367aca800288371d159ba4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a267b9de88f367aca800288371d159ba4">&#9670;&nbsp;</a></span>xx0con</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::xx0con</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="ac86952501766e86cc6c4ff25dc6bdaae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac86952501766e86cc6c4ff25dc6bdaae">&#9670;&nbsp;</a></span>y2con</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::y2con</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="a803091c0618aa41f2af473670f97a2af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a803091c0618aa41f2af473670f97a2af">&#9670;&nbsp;</a></span>y_wrapping_recv_buffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), allocatable lowerbc_mod::y_wrapping_recv_buffer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00030">30</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="abc2c558581632bd04311fe235f67debb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc2c558581632bd04311fe235f67debb">&#9670;&nbsp;</a></span>y_wrapping_send_buffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision), dimension(:,:,:), allocatable lowerbc_mod::y_wrapping_send_buffer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00030">30</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="a43bb6e10f4e67194f36d8831ba400ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43bb6e10f4e67194f36d8831ba400ac0">&#9670;&nbsp;</a></span>y_wrapping_target_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer lowerbc_mod::y_wrapping_target_id</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00034">34</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
<a id="abc8b8003765f05e26ade25567f577904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc8b8003765f05e26ade25567f577904">&#9670;&nbsp;</a></span>yy0con</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=default_precision) lowerbc_mod::yy0con</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lowerbc_8F90_source.html#l00027">27</a> of file <a class="el" href="lowerbc_8F90_source.html">lowerbc.F90</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="anamespacelogging__mod_html_ad68309846cd8f9e77edaa6abd02f65a0"><div class="ttname"><a href="namespacelogging__mod.html#ad68309846cd8f9e77edaa6abd02f65a0">logging_mod::log_error</a></div><div class="ttdeci">integer, parameter, public log_error</div><div class="ttdoc">Only log ERROR messages.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00011">logging.F90:11</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ac4f13ac385499c85190cb184030e4f45"><div class="ttname"><a href="namespacelogging__mod.html#ac4f13ac385499c85190cb184030e4f45">logging_mod::log_log</a></div><div class="ttdeci">subroutine, public log_log(level, message, str)</div><div class="ttdoc">Logs a message at the specified level. If the level is above the current level then the message is ig...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00074">logging.F90:75</a></div></div>
<div class="ttc" id="anamespacelogging__mod_html_ad95937a250467334622daeb5cff78c20"><div class="ttname"><a href="namespacelogging__mod.html#ad95937a250467334622daeb5cff78c20">logging_mod::log_master_log</a></div><div class="ttdeci">subroutine, public log_master_log(level, message)</div><div class="ttdoc">Will log just from the master process.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8F90_source.html#l00046">logging.F90:47</a></div></div>
<div class="ttc" id="anamespacescience__constants__mod_html_ae8033eb104cc11fddfcf12d79fae0bd1"><div class="ttname"><a href="namespacescience__constants__mod.html#ae8033eb104cc11fddfcf12d79fae0bd1">science_constants_mod::pi</a></div><div class="ttdeci">real(kind=default_precision), public pi</div><div class="ttdef"><b>Definition:</b> <a href="scienceconstants_8F90_source.html#l00013">scienceconstants.F90:13</a></div></div>
<div class="ttc" id="anamespacedatadefn__mod_html_a39b79f8cc843d236d3b47f5c81b64368"><div class="ttname"><a href="namespacedatadefn__mod.html#a39b79f8cc843d236d3b47f5c81b64368">datadefn_mod::default_precision</a></div><div class="ttdeci">integer, parameter, public default_precision</div><div class="ttdoc">MPI communication type which we use for the prognostic and calculation data.</div><div class="ttdef"><b>Definition:</b> <a href="datadefn_8F90_source.html#l00017">datadefn.F90:17</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
